<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:11:17              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 defined("\x42\101\123\105\120\x41\124\110") or exit("\x4e\x6f\x20\144\x69\162\145\x63\x74\40\163\143\x72\151\x70\x74\40\x61\x63\143\145\163\x73\40\141\x6c\154\x6f\167\x65\144"); if (!function_exists("\143\x72\145\141\164\145\x5f\x63\141\x70\x74\143\150\x61")) { function create_captcha($data = '', $img_path = '', $img_url = '', $font_path = '') { goto CoiR1; XnjFl: foreach ($defaults as $key => $val) { if (!is_array($data) && empty(${$key})) { ${$key} = $val; } else { ${$key} = isset($data[$key]) ? $data[$key] : $val; } } goto cSRwC; Yr5cQ: $points = 32; goto XE0Vf; CkuHP: if ($use_font === FALSE) { goto AyuLC; mwRMV: $y = 0; goto ypoeA; KYQjU: $x = mt_rand(0, $img_width / ($length / 3)); goto mwRMV; AyuLC: $font_size > 5 && ($font_size = 5); goto KYQjU; ypoeA: } else { goto VC2Km; Qg2fW: $x = mt_rand(0, $img_width / ($length / 1.5)); goto NuKUU; VC2Km: $font_size > 30 && ($font_size = 30); goto Qg2fW; NuKUU: $y = $font_size + 2; goto k0th3; k0th3: } goto JqrLM; Raezd: if (empty($word)) { for ($i = 0; $i < $word_length; $i++) { $word .= $pool[mt_rand(0, $rand_max)]; } } elseif (!is_string($word)) { $word = (string) $word; } goto hBbis; MY28I: return array("\167\x6f\x72\144" => $word, "\x74\151\x6d\145" => $now, "\151\x6d\141\147\145" => $img, "\x66\x69\x6c\x65\156\141\x6d\145" => $img_filename); goto DVjDt; SMKob: if (function_exists("\151\x6d\141\147\145\152\160\x65\147")) { $img_filename = $now . "\x2e\152\160\x67"; imagejpeg($im, $img_path . $img_filename); } elseif (function_exists("\151\155\x61\x67\x65\160\x6e\147")) { $img_filename = $now . "\x2e\160\x6e\x67"; imagepng($im, $img_path . $img_filename); } else { return FALSE; } goto Q912j; Lq3EB: $use_font = $font_path !== '' && file_exists($font_path) && function_exists("\151\155\x61\x67\145\x74\x74\x66\164\x65\x78\x74"); goto CkuHP; dZwjt: $y_axis = $angle >= 0 ? mt_rand($img_height, $img_width) : mt_rand(6, $img_height); goto FAXwr; l1T9U: ImageFilledRectangle($im, 0, 0, $img_width, $img_height, $colors["\x62\x61\x63\x6b\x67\x72\157\x75\156\x64"]); goto utDRk; hBbis: $length = strlen($word); goto cmym1; XE0Vf: for ($i = 0, $cp = $circles * $points - 1; $i < $cp; $i++) { $theta += $thetac; $rad = $radius * ($i / $points); $x = $rad * cos($theta) + $x_axis; $y = $rad * sin($theta) + $y_axis; $theta += $thetac; $rad1 = $radius * (($i + 1) / $points); $x1 = $rad1 * cos($theta) + $x_axis; $y1 = $rad1 * sin($theta) + $y_axis; imageline($im, $x, $y, $x1, $y1, $colors["\147\x72\151\x64"]); $theta -= $thetac; } goto Lq3EB; clrn6: $circles = 20; goto Yr5cQ; X0a02: $current_dir = @opendir($img_path); goto GryF0; cSRwC: if ($img_path === '' or $img_url === '' or !is_dir($img_path) or !is_really_writable($img_path) or !extension_loaded("\x67\144")) { return FALSE; } goto yCr6p; Esm50: $thetac = 7; goto bx3nV; DuYrw: ImageDestroy($im); goto MY28I; bx3nV: $radius = 16; goto clrn6; CoiR1: $defaults = array("\x77\157\162\144" => '', "\x69\155\x67\137\x70\141\164\x68" => '', "\151\x6d\147\x5f\x75\x72\x6c" => '', "\151\x6d\147\x5f\167\x69\144\x74\150" => "\x31\x35\60", "\x69\155\147\137\150\145\x69\147\x68\164" => "\63\x30", "\146\157\x6e\164\x5f\160\141\164\150" => '', "\145\x78\x70\x69\x72\x61\164\151\157\x6e" => 7200, "\167\x6f\162\x64\137\154\x65\x6e\x67\x74\x68" => 8, "\146\x6f\x6e\164\x5f\x73\151\172\x65" => 16, "\x69\155\x67\137\x69\144" => '', "\x70\x6f\x6f\x6c" => "\60\61\x32\x33\x34\x35\66\67\x38\71\x61\x62\143\144\x65\146\x67\150\151\152\153\154\155\156\157\160\x71\x72\x73\164\x75\x76\167\x78\x79\x7a\101\x42\x43\x44\x45\x46\x47\x48\111\x4a\x4b\114\115\116\117\120\x51\122\x53\124\x55\126\x57\x58\131\132", "\x63\157\x6c\x6f\162\163" => array("\142\141\143\x6b\x67\162\x6f\165\156\x64" => array(255, 255, 255), "\142\x6f\x72\144\x65\x72" => array(153, 102, 102), "\164\145\170\x74" => array(204, 153, 153), "\x67\162\151\144" => array(255, 182, 182))); goto XnjFl; jOWhj: is_array($colors) or $colors = $defaults["\x63\x6f\154\157\162\x73"]; goto KwUXu; yCr6p: $now = microtime(TRUE); goto X0a02; ez1pa: if (empty($word)) { goto fdEA9; lW8cQ: if (function_exists("\162\x61\x6e\144\157\155\x5f\x69\156\x74")) { try { for ($i = 0; $i < $word_length; $i++) { $word .= $pool[random_int(0, $rand_max)]; } } catch (Exception $e) { $word = ''; } } goto dK2fX; LWLT9: $pool_length = strlen($pool); goto oHzND; fdEA9: $word = ''; goto LWLT9; oHzND: $rand_max = $pool_length - 1; goto lW8cQ; dK2fX: } goto owBAB; GryF0: while ($filename = @readdir($current_dir)) { if (in_array(substr($filename, -4), array("\56\x6a\160\147", "\56\x70\156\147")) && str_replace(array("\x2e\x6a\160\x67", "\56\x70\156\x67"), '', $filename) + $expiration < $now) { @unlink($img_path . $filename); } } goto LlTpf; Q912j: $img = "\74\x69\155\147\x20" . ($img_id === '' ? '' : "\x69\x64\75\42" . $img_id . "\42") . "\40\163\162\x63\x3d\42" . $img_url . $img_filename . "\x22\x20\x73\164\171\154\145\x3d\42\167\x69\x64\164\x68\x3a\x20" . $img_width . "\160\170\73\40\150\145\x69\x67\x68\164\72\40" . $img_height . "\160\170\x3b\x20\x62\157\x72\x64\145\162\x3a\40\x30\73\x22\40\141\x6c\x74\x3d\x22\x20\x22\40\57\x3e"; goto DuYrw; owBAB: if (empty($word)) { goto XteZB; tElnb: if (($bytes = $security->get_random_bytes($pool_length)) !== FALSE) { $byte_index = $word_index = 0; while ($word_index < $word_length) { if ($byte_index === $pool_length) { for ($i = 0; $i < 5; $i++) { if (($bytes = $security->get_random_bytes($pool_length)) === FALSE) { continue; } $byte_index = 0; break; } if ($bytes === FALSE) { $word = ''; break; } } list(, $rand_index) = unpack("\103", $bytes[$byte_index++]); if ($rand_index > $rand_max) { continue; } $word .= $pool[$rand_index]; $word_index++; } } goto TZ7Zi; kxSDs: $security = get_instance()->security; goto tElnb; XteZB: if ($pool_length > 256) { return FALSE; } goto kxSDs; TZ7Zi: } goto Raezd; cmym1: $angle = $length >= 6 ? mt_rand(-($length - 6), $length - 6) : 0; goto hfcPa; JqrLM: for ($i = 0; $i < $length; $i++) { if ($use_font === FALSE) { goto ahsiS; Vf3kx: imagestring($im, $font_size, $x, $y, $word[$i], $colors["\x74\145\170\164"]); goto A8v1V; A8v1V: $x += $font_size * 2; goto BoCq9; ahsiS: $y = mt_rand(0, $img_height / 2); goto Vf3kx; BoCq9: } else { goto BZS2D; BZS2D: $y = mt_rand($img_height / 2, $img_height - 3); goto EEh0h; EEh0h: imagettftext($im, $font_size, $angle, $x, $y, $colors["\164\x65\170\164"], $font_path, $word[$i]); goto HoTJz; HoTJz: $x += $font_size; goto SwTqw; SwTqw: } } goto n92B8; KwUXu: foreach (array_keys($defaults["\143\x6f\154\157\x72\163"]) as $key) { is_array($colors[$key]) or $colors[$key] = $defaults["\143\157\x6c\x6f\162\163"][$key]; $colors[$key] = imagecolorallocate($im, $colors[$key][0], $colors[$key][1], $colors[$key][2]); } goto l1T9U; ScdUq: $img_url = rtrim($img_url, "\57") . "\x2f"; goto SMKob; FAXwr: $im = function_exists("\151\x6d\141\147\x65\x63\x72\x65\141\x74\145\x74\162\165\x65\143\x6f\154\157\162") ? imagecreatetruecolor($img_width, $img_height) : imagecreate($img_width, $img_height); goto jOWhj; hfcPa: $x_axis = mt_rand(6, 360 / $length - 16); goto dZwjt; utDRk: $theta = 1; goto Esm50; LlTpf: @closedir($current_dir); goto ez1pa; n92B8: imagerectangle($im, 0, 0, $img_width - 1, $img_height - 1, $colors["\x62\157\x72\x64\x65\162"]); goto ScdUq; DVjDt: } }
