<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:11:17              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 defined("\102\x41\123\x45\x50\101\x54\110") or exit("\116\157\x20\144\151\162\x65\x63\164\40\x73\143\162\x69\160\x74\40\x61\143\x63\x65\x73\x73\x20\141\x6c\x6c\x6f\167\145\144"); class CI_Session { public $userdata; protected $_driver = "\x66\151\x6c\145\163"; protected $_config; protected $_sid_regexp; public function __construct(array $params = array()) { goto QFr_J; hQObv: if ((empty($_SERVER["\x48\x54\x54\x50\x5f\130\x5f\x52\105\121\125\x45\x53\x54\x45\x44\x5f\x57\111\x54\110"]) or strtolower($_SERVER["\x48\124\x54\120\x5f\x58\x5f\x52\x45\x51\x55\x45\123\124\105\104\137\127\111\124\x48"]) !== "\x78\155\154\150\164\164\x70\162\145\x71\165\x65\163\164") && ($regenerate_time = config_item("\x73\145\x73\163\x5f\164\x69\155\145\x5f\164\x6f\x5f\x75\160\x64\141\164\x65")) > 0) { if (!isset($_SESSION["\137\x5f\x63\151\137\154\141\x73\x74\137\162\x65\x67\145\156\x65\x72\x61\164\x65"])) { $_SESSION["\137\137\x63\151\x5f\x6c\141\x73\164\x5f\x72\x65\147\x65\x6e\145\162\x61\164\145"] = time(); } elseif ($_SESSION["\137\x5f\143\151\137\154\x61\163\x74\x5f\162\x65\147\145\x6e\x65\x72\141\164\145"] < time() - $regenerate_time) { $this->sess_regenerate((bool) config_item("\163\145\x73\x73\x5f\x72\x65\x67\145\x6e\145\162\141\x74\145\x5f\144\x65\x73\x74\162\x6f\x79")); } } elseif (isset($_COOKIE[$this->_config["\143\157\x6f\153\151\x65\137\x6e\x61\x6d\145"]]) && $_COOKIE[$this->_config["\x63\157\157\153\151\145\137\x6e\141\x6d\x65"]] === session_id()) { setcookie($this->_config["\143\157\x6f\153\x69\145\137\x6e\141\x6d\x65"], session_id(), empty($this->_config["\x63\157\x6f\x6b\151\145\x5f\x6c\151\x66\x65\164\x69\x6d\x65"]) ? 0 : time() + $this->_config["\x63\x6f\157\x6b\151\x65\x5f\154\x69\146\145\164\151\155\145"], $this->_config["\143\x6f\x6f\153\151\145\x5f\x70\x61\x74\150"], $this->_config["\143\x6f\157\x6b\151\145\x5f\144\157\155\x61\x69\x6e"], $this->_config["\x63\x6f\x6f\x6b\x69\145\x5f\163\145\x63\165\x72\145"], TRUE); } goto GiW4P; ekBOJ: if ($class instanceof SessionHandlerInterface) { if (is_php("\x35\56\64")) { session_set_save_handler($class, TRUE); } else { session_set_save_handler(array($class, "\157\x70\x65\x6e"), array($class, "\x63\x6c\x6f\x73\145"), array($class, "\162\x65\141\x64"), array($class, "\x77\x72\x69\x74\x65"), array($class, "\x64\x65\163\164\162\157\171"), array($class, "\147\143")); register_shutdown_function("\163\145\x73\x73\151\x6f\x6e\137\x77\x72\151\164\x65\x5f\x63\154\157\163\145"); } } else { log_message("\x65\162\x72\157\x72", "\123\x65\163\163\151\x6f\x6e\x3a\x20\104\x72\x69\x76\x65\x72\x20\47" . $this->_driver . "\47\40\144\157\145\163\156\47\x74\x20\x69\155\x70\154\145\155\x65\156\164\x20\x53\x65\x73\x73\151\x6f\156\110\x61\x6e\x64\154\x65\162\111\156\x74\145\x72\x66\x61\143\x65\x2e\40\x41\x62\157\162\164\x69\x6e\x67\56"); return; } goto w11zk; eCDWj: $class = $this->_ci_load_classes($this->_driver); goto XUPSr; XUPSr: $this->_configure($params); goto lvQ9g; Mueq1: $class = new $class($this->_config); goto ekBOJ; KMn1G: session_start(); goto hQObv; lvQ9g: $this->_config["\137\x73\151\x64\137\162\145\147\x65\x78\160"] = $this->_sid_regexp; goto Mueq1; QFr_J: if (is_cli()) { log_message("\x64\x65\x62\165\x67", "\x53\145\x73\x73\x69\x6f\156\72\40\111\x6e\151\x74\151\x61\x6c\x69\172\141\x74\x69\157\156\x20\x75\156\x64\145\162\x20\x43\x4c\111\x20\141\142\157\x72\x74\145\x64\56"); return; } elseif ((bool) ini_get("\163\145\163\x73\x69\157\x6e\56\141\x75\x74\x6f\137\163\164\141\162\164")) { log_message("\x65\x72\162\157\162", "\x53\145\163\163\151\x6f\156\72\40\x73\145\x73\x73\x69\157\x6e\56\141\x75\164\x6f\137\x73\x74\x61\162\x74\40\151\x73\40\x65\x6e\141\x62\154\x65\x64\40\x69\156\x20\160\150\160\56\151\x6e\151\x2e\40\101\142\157\162\x74\151\156\x67\x2e"); return; } elseif (!empty($params["\144\x72\151\x76\x65\162"])) { $this->_driver = $params["\144\x72\x69\166\145\x72"]; unset($params["\x64\x72\x69\x76\x65\x72"]); } elseif ($driver = config_item("\163\x65\163\163\x5f\144\162\x69\166\x65\x72")) { $this->_driver = $driver; } elseif (config_item("\163\x65\163\x73\x5f\x75\163\145\137\x64\x61\x74\141\x62\x61\x73\x65")) { log_message("\144\145\142\x75\x67", "\x53\x65\163\163\x69\x6f\156\72\40\42\x73\145\x73\163\137\144\162\151\166\x65\162\42\40\x69\x73\x20\145\155\x70\164\171\73\x20\x75\163\x69\x6e\147\x20\x42\x43\x20\146\x61\154\x6c\x62\x61\143\x6b\40\164\157\x20\42\x73\145\163\163\x5f\x75\x73\145\137\x64\141\x74\141\x62\x61\x73\x65\x22\x2e"); $this->_driver = "\144\141\164\x61\x62\x61\163\145"; } goto eCDWj; xsdvA: log_message("\151\156\146\x6f", "\x53\x65\163\x73\x69\x6f\x6e\72\40\103\x6c\x61\163\x73\x20\151\x6e\x69\164\151\141\x6c\x69\x7a\145\x64\x20\165\163\151\156\147\x20\47" . $this->_driver . "\47\40\144\x72\x69\x76\x65\x72\56"); goto gKJXR; w11zk: if (isset($_COOKIE[$this->_config["\x63\x6f\157\x6b\x69\x65\137\156\x61\x6d\145"]]) && (!is_string($_COOKIE[$this->_config["\143\x6f\x6f\153\151\x65\x5f\x6e\141\155\145"]]) or !preg_match("\43\134\x41" . $this->_sid_regexp . "\134\x7a\43", $_COOKIE[$this->_config["\143\x6f\x6f\153\151\x65\137\156\141\155\x65"]]))) { unset($_COOKIE[$this->_config["\143\x6f\157\x6b\151\145\x5f\x6e\x61\x6d\x65"]]); } goto KMn1G; GiW4P: $this->_ci_init_vars(); goto xsdvA; gKJXR: } protected function _ci_load_classes($driver) { goto lGZ7p; lGZ7p: interface_exists("\x53\145\x73\163\151\x6f\156\x48\141\x6e\144\154\x65\162\x49\156\x74\x65\162\x66\141\x63\x65", FALSE) or (require_once BASEPATH . "\154\151\142\x72\x61\x72\151\145\x73\x2f\123\x65\x73\163\x69\x6f\156\57\x53\x65\163\163\x69\x6f\156\110\x61\156\144\154\145\x72\x49\156\164\145\x72\x66\x61\x63\x65\x2e\160\150\x70"); goto rqzAs; mqmG5: $class = "\123\x65\x73\163\151\x6f\156\137" . $driver . "\137\x64\162\x69\x76\x65\x72"; goto m0501; EQ1z1: return "\103\111\x5f" . $class; goto Do1Jz; m0501: if (!class_exists($class, FALSE) && file_exists($file_path = APPPATH . "\x6c\151\x62\x72\141\x72\151\145\x73\57\x53\145\x73\163\x69\157\x6e\57\x64\x72\x69\x76\145\x72\x73\x2f" . $class . "\x2e\160\x68\x70")) { require_once $file_path; if (class_exists($class, FALSE)) { return $class; } } goto NOsh3; NOsh3: if (!class_exists("\x43\111\137" . $class, FALSE)) { if (file_exists($file_path = APPPATH . "\x6c\x69\x62\x72\x61\x72\x69\145\x73\x2f\123\x65\x73\163\x69\x6f\156\57\144\x72\151\x76\x65\162\x73\57" . $class . "\x2e\x70\150\x70") or file_exists($file_path = BASEPATH . "\154\151\142\x72\141\x72\x69\x65\x73\57\x53\x65\163\x73\x69\x6f\x6e\x2f\144\162\151\166\145\162\163\57" . $class . "\56\160\150\160")) { require_once $file_path; } if (!class_exists("\103\x49\x5f" . $class, FALSE) && !class_exists($class, FALSE)) { throw new UnexpectedValueException("\x53\x65\x73\x73\x69\x6f\156\x3a\x20\103\157\x6e\x66\x69\x67\x75\x72\145\x64\x20\x64\x72\151\x76\145\162\x20\47" . $driver . "\x27\40\167\x61\163\x20\156\157\x74\x20\146\157\x75\156\x64\56\x20\x41\142\157\x72\x74\151\x6e\147\56"); } } goto wvYM9; wvYM9: if (!class_exists($prefix . $class, FALSE) && file_exists($file_path = APPPATH . "\154\x69\x62\x72\141\162\x69\145\163\57\x53\145\x73\x73\151\157\x6e\x2f\x64\x72\x69\166\145\x72\x73\x2f" . $prefix . $class . "\x2e\160\x68\x70")) { goto JGSBy; JGSBy: require_once $file_path; goto kQsG0; kQsG0: if (class_exists($prefix . $class, FALSE)) { return $prefix . $class; } goto iogfD; iogfD: log_message("\144\145\142\x75\x67", "\123\x65\163\163\x69\157\156\x3a\40" . $prefix . $class . "\x2e\x70\150\x70\x20\146\157\x75\x6e\144\x20\x62\x75\x74\40\x69\164\x20\x64\157\145\x73\x6e\x27\164\x20\144\145\x63\154\141\162\x65\40\x63\154\x61\x73\163\x20" . $prefix . $class . "\x2e"); goto gmlEs; gmlEs: } goto EQ1z1; rqzAs: $prefix = config_item("\163\165\142\143\154\141\163\163\137\160\162\145\x66\151\170"); goto It7b9; It7b9: if (!class_exists("\x43\x49\x5f\123\x65\x73\x73\x69\x6f\x6e\137\x64\x72\x69\166\x65\162", FALSE)) { require_once file_exists(APPPATH . "\x6c\x69\x62\162\141\162\x69\x65\x73\57\123\x65\163\163\151\x6f\x6e\57\x53\x65\x73\163\151\x6f\156\137\x64\162\151\166\x65\162\56\x70\150\160") ? APPPATH . "\154\x69\x62\162\x61\x72\x69\145\163\x2f\123\x65\163\163\151\x6f\x6e\x2f\123\x65\163\163\151\x6f\156\137\144\162\x69\166\145\x72\56\160\x68\160" : BASEPATH . "\x6c\x69\142\x72\x61\162\151\x65\163\57\x53\145\163\163\151\x6f\x6e\x2f\123\145\163\163\151\157\x6e\x5f\144\x72\151\166\x65\x72\56\x70\x68\160"; if (file_exists($file_path = APPPATH . "\x6c\151\142\x72\x61\162\151\x65\163\x2f\123\145\163\x73\151\157\x6e\x2f" . $prefix . "\x53\x65\163\x73\151\x6f\156\137\144\162\151\x76\x65\x72\x2e\x70\x68\x70")) { require_once $file_path; } } goto mqmG5; Do1Jz: } protected function _configure(&$params) { goto aESBT; aESBT: $expiration = config_item("\163\x65\163\x73\x5f\x65\x78\160\x69\x72\141\164\x69\157\x6e"); goto UScUX; quKU1: if (empty($params["\143\157\x6f\x6b\x69\145\137\x6e\x61\x6d\145"])) { $params["\143\x6f\x6f\153\x69\x65\137\x6e\141\x6d\145"] = ini_get("\163\145\x73\x73\x69\157\x6e\x2e\x6e\x61\155\145"); } else { ini_set("\x73\145\x73\x73\x69\x6f\156\56\156\x61\155\x65", $params["\x63\157\x6f\153\151\145\x5f\x6e\x61\x6d\145"]); } goto bl6M5; Q1LBK: isset($params["\143\x6f\x6f\153\151\x65\137\156\x61\155\x65"]) or $params["\143\x6f\157\x6b\151\145\x5f\156\141\155\145"] = config_item("\x73\x65\163\163\x5f\x63\157\x6f\x6b\x69\145\137\x6e\141\155\x65"); goto quKU1; iguRF: ini_set("\163\x65\163\163\x69\x6f\x6e\x2e\x75\x73\145\137\x74\x72\x61\156\163\x5f\x73\x69\x64", 0); goto a5QND; vHyiR: $this->_config = $params; goto iguRF; bl6M5: isset($params["\x63\x6f\x6f\153\151\145\137\x70\x61\x74\x68"]) or $params["\143\157\x6f\x6b\151\x65\137\x70\141\x74\x68"] = config_item("\143\x6f\x6f\x6b\x69\x65\x5f\x70\x61\x74\x68"); goto tDVyg; a8kKe: ini_set("\163\x65\163\x73\x69\157\156\x2e\165\x73\145\137\x6f\156\x6c\x79\x5f\143\157\x6f\x6b\151\x65\163", 1); goto i8S7h; JzQUJ: ini_set("\163\145\x73\x73\151\157\x6e\x2e\165\163\145\x5f\143\x6f\157\153\x69\x65\163", 1); goto a8kKe; pt1ok: $params["\x6d\x61\164\143\150\x5f\x69\160"] = (bool) (isset($params["\x6d\141\164\x63\150\x5f\151\160"]) ? $params["\x6d\141\164\x63\150\137\151\160"] : config_item("\x73\x65\163\x73\137\155\141\164\143\x68\x5f\x69\x70")); goto FW7Z0; a5QND: ini_set("\x73\x65\163\x73\x69\x6f\x6e\56\165\163\x65\x5f\x73\x74\x72\x69\x63\164\x5f\x6d\x6f\x64\145", 1); goto JzQUJ; FW7Z0: isset($params["\163\141\x76\x65\137\160\x61\164\x68"]) or $params["\x73\141\x76\x65\x5f\160\x61\164\150"] = config_item("\163\145\x73\163\137\163\x61\x76\145\137\x70\141\x74\150"); goto vHyiR; vW3Fn: isset($params["\143\157\x6f\x6b\x69\x65\137\163\145\143\x75\162\145"]) or $params["\143\157\x6f\x6b\x69\145\x5f\163\x65\143\165\x72\x65"] = (bool) config_item("\143\x6f\157\x6b\151\x65\137\163\x65\x63\165\162\145"); goto oOofS; NmC5m: if (empty($expiration)) { $params["\145\x78\x70\151\x72\x61\164\x69\157\x6e"] = (int) ini_get("\x73\145\163\x73\x69\x6f\156\56\x67\143\x5f\155\x61\170\154\151\x66\x65\164\x69\x6d\x65"); } else { $params["\145\x78\160\x69\x72\141\164\x69\x6f\156"] = (int) $expiration; ini_set("\x73\x65\163\163\x69\x6f\156\x2e\x67\143\137\155\141\170\154\151\x66\145\x74\x69\155\x65", $expiration); } goto pt1ok; UScUX: if (isset($params["\143\x6f\157\x6b\x69\x65\137\154\x69\x66\145\164\x69\155\145"])) { $params["\143\157\157\x6b\x69\145\137\154\x69\146\x65\164\151\155\145"] = (int) $params["\x63\x6f\x6f\153\151\x65\137\x6c\x69\146\145\x74\151\155\x65"]; } else { $params["\143\157\x6f\153\151\145\x5f\154\x69\x66\x65\164\151\155\x65"] = !isset($expiration) && config_item("\x73\x65\163\163\x5f\x65\x78\x70\151\x72\145\137\x6f\x6e\x5f\x63\154\x6f\163\x65") ? 0 : (int) $expiration; } goto Q1LBK; i8S7h: $this->_configure_sid_length(); goto iN2jf; tDVyg: isset($params["\x63\x6f\x6f\x6b\x69\145\137\144\x6f\155\141\x69\x6e"]) or $params["\x63\157\157\153\151\x65\x5f\144\x6f\155\141\x69\156"] = config_item("\143\x6f\157\153\151\x65\137\144\157\155\x61\x69\x6e"); goto vW3Fn; oOofS: session_set_cookie_params($params["\143\x6f\x6f\153\151\145\137\x6c\x69\x66\x65\x74\151\155\x65"], $params["\x63\x6f\x6f\153\151\x65\x5f\x70\141\x74\x68"], $params["\x63\x6f\x6f\x6b\x69\x65\x5f\144\x6f\155\141\x69\x6e"], $params["\143\157\157\x6b\151\145\137\x73\x65\x63\x75\x72\145"], TRUE); goto NmC5m; iN2jf: } protected function _configure_sid_length() { goto U1ZdO; U1ZdO: if (PHP_VERSION_ID < 70100) { goto Bot0e; Bot0e: $hash_function = ini_get("\x73\x65\163\x73\151\x6f\x6e\x2e\150\x61\x73\x68\x5f\x66\165\156\143\164\151\x6f\x6e"); goto qJaFs; qJaFs: if (ctype_digit($hash_function)) { if ($hash_function !== "\x31") { ini_set("\x73\145\x73\x73\x69\x6f\x6e\x2e\150\141\x73\x68\137\x66\165\x6e\x63\x74\151\157\156", 1); } $bits = 160; } elseif (!in_array($hash_function, hash_algos(), TRUE)) { ini_set("\163\x65\x73\163\151\157\156\x2e\150\141\x73\150\137\x66\x75\x6e\143\164\x69\x6f\156", 1); $bits = 160; } elseif (($bits = strlen(hash($hash_function, "\144\x75\x6d\155\171", false)) * 4) < 160) { ini_set("\x73\145\x73\163\151\x6f\x6e\x2e\x68\x61\x73\150\137\x66\165\156\143\164\x69\157\156", 1); $bits = 160; } goto x0LK_; bHPyR: $sid_length = (int) ceil($bits / $bits_per_character); goto nwe09; x0LK_: $bits_per_character = (int) ini_get("\x73\x65\x73\x73\x69\157\x6e\x2e\150\141\x73\150\x5f\x62\151\x74\163\137\160\145\x72\137\143\150\141\x72\x61\x63\x74\x65\162"); goto bHPyR; nwe09: } else { goto HWWbG; HWWbG: $bits_per_character = (int) ini_get("\163\x65\163\x73\x69\157\x6e\56\163\151\144\x5f\x62\x69\x74\163\x5f\160\145\x72\137\x63\150\x61\x72\141\143\x74\145\x72"); goto SCgAH; FKxEt: if (($bits = $sid_length * $bits_per_character) < 160) { $sid_length += (int) ceil(160 % $bits / $bits_per_character); ini_set("\x73\x65\163\x73\x69\x6f\156\56\x73\151\x64\x5f\154\x65\x6e\x67\164\x68", $sid_length); } goto unidB; SCgAH: $sid_length = (int) ini_get("\x73\x65\163\x73\x69\157\156\56\163\x69\144\x5f\x6c\145\x6e\x67\x74\150"); goto FKxEt; unidB: } goto loInJ; kX1qD: $this->_sid_regexp .= "\173" . $sid_length . "\x7d"; goto KiTf2; loInJ: switch ($bits_per_character) { case 4: $this->_sid_regexp = "\133\60\x2d\71\x61\55\x66\135"; break; case 5: $this->_sid_regexp = "\x5b\x30\x2d\71\141\x2d\x76\x5d"; break; case 6: $this->_sid_regexp = "\133\60\55\x39\141\x2d\x7a\x41\55\x5a\54\x2d\135"; break; } goto kX1qD; KiTf2: } protected function _ci_init_vars() { if (!empty($_SESSION["\137\x5f\x63\151\137\x76\x61\162\163"])) { goto Syv3A; MtI1D: if (empty($_SESSION["\137\x5f\143\151\x5f\166\x61\162\x73"])) { unset($_SESSION["\137\137\x63\x69\137\x76\141\162\163"]); } goto CX9xG; Syv3A: $current_time = time(); goto qnfqF; qnfqF: foreach ($_SESSION["\x5f\x5f\x63\151\137\x76\141\x72\163"] as $key => &$value) { if ($value === "\156\x65\x77") { $_SESSION["\137\137\143\151\137\x76\x61\x72\163"][$key] = "\x6f\154\x64"; } elseif ($value < $current_time) { unset($_SESSION[$key], $_SESSION["\x5f\137\143\x69\137\166\x61\162\163"][$key]); } } goto MtI1D; CX9xG: } $this->userdata =& $_SESSION; } public function mark_as_flash($key) { goto I0NgN; I0NgN: if (is_array($key)) { goto jc0MJ; J3op1: $_SESSION["\x5f\137\x63\x69\x5f\166\141\162\163"] = isset($_SESSION["\x5f\137\x63\x69\137\x76\141\x72\163"]) ? array_merge($_SESSION["\137\x5f\x63\x69\137\x76\141\162\163"], $new) : $new; goto LTGne; iWEBb: $new = array_fill_keys($key, "\156\145\x77"); goto J3op1; jc0MJ: for ($i = 0, $c = count($key); $i < $c; $i++) { if (!isset($_SESSION[$key[$i]])) { return FALSE; } } goto iWEBb; LTGne: return TRUE; goto TQd0T; TQd0T: } goto TUU41; XY1ME: $_SESSION["\x5f\x5f\x63\x69\137\166\x61\162\x73"][$key] = "\156\145\x77"; goto QFnTA; QFnTA: return TRUE; goto BVUpB; TUU41: if (!isset($_SESSION[$key])) { return FALSE; } goto XY1ME; BVUpB: } public function get_flash_keys() { goto O8lkt; l7PKJ: return $keys; goto YVK_U; Q3gnm: foreach (array_keys($_SESSION["\x5f\x5f\x63\x69\137\x76\141\162\x73"]) as $key) { is_int($_SESSION["\x5f\137\143\151\137\x76\x61\x72\x73"][$key]) or $keys[] = $key; } goto l7PKJ; WUjJp: $keys = array(); goto Q3gnm; O8lkt: if (!isset($_SESSION["\137\x5f\x63\x69\137\166\x61\162\163"])) { return array(); } goto WUjJp; YVK_U: } public function unmark_flash($key) { goto DJHJP; eBg1r: foreach ($key as $k) { if (isset($_SESSION["\x5f\137\x63\x69\137\166\141\162\x73"][$k]) && !is_int($_SESSION["\x5f\137\x63\x69\x5f\x76\x61\x72\163"][$k])) { unset($_SESSION["\x5f\137\x63\x69\137\166\x61\x72\x73"][$k]); } } goto nkCgT; nkCgT: if (empty($_SESSION["\x5f\x5f\x63\x69\137\x76\141\x72\163"])) { unset($_SESSION["\137\x5f\143\151\x5f\166\141\x72\x73"]); } goto inv3K; DJHJP: if (empty($_SESSION["\137\137\143\x69\x5f\166\x61\x72\x73"])) { return; } goto ZGEYM; ZGEYM: is_array($key) or $key = array($key); goto eBg1r; inv3K: } public function mark_as_temp($key, $ttl = 300) { goto ajo6l; O5jDO: if (!isset($_SESSION[$key])) { return FALSE; } goto PZxny; ajo6l: $ttl += time(); goto xvxRH; PZxny: $_SESSION["\137\x5f\143\151\137\x76\141\x72\x73"][$key] = $ttl; goto i3Tk1; xvxRH: if (is_array($key)) { goto QGHCk; xVrtJ: return TRUE; goto NAI8S; D0hHY: $_SESSION["\137\x5f\143\151\137\x76\x61\162\163"] = isset($_SESSION["\137\137\143\151\x5f\x76\141\162\163"]) ? array_merge($_SESSION["\x5f\137\x63\x69\x5f\x76\141\162\163"], $temp) : $temp; goto xVrtJ; QGHCk: $temp = array(); goto MJw9a; MJw9a: foreach ($key as $k => $v) { goto uDYhi; R3CdP: if (!isset($_SESSION[$k])) { return FALSE; } goto UGH1o; UGH1o: $temp[$k] = $v; goto GEklE; uDYhi: if (is_int($k)) { $k = $v; $v = $ttl; } else { $v += time(); } goto R3CdP; GEklE: } goto D0hHY; NAI8S: } goto O5jDO; i3Tk1: return TRUE; goto ONtLr; ONtLr: } public function get_temp_keys() { goto cFsks; Cvjgk: foreach (array_keys($_SESSION["\137\137\x63\x69\x5f\x76\141\x72\163"]) as $key) { is_int($_SESSION["\137\137\143\x69\137\166\141\162\163"][$key]) && ($keys[] = $key); } goto bV3wR; cFsks: if (!isset($_SESSION["\137\x5f\143\x69\137\166\x61\162\163"])) { return array(); } goto XNEqa; XNEqa: $keys = array(); goto Cvjgk; bV3wR: return $keys; goto KOAaZ; KOAaZ: } public function unmark_temp($key) { goto uwfGg; zYSVQ: if (empty($_SESSION["\137\137\x63\151\137\166\x61\162\163"])) { unset($_SESSION["\137\137\143\151\x5f\x76\x61\162\x73"]); } goto M5Nfk; A_Rfw: foreach ($key as $k) { if (isset($_SESSION["\137\137\143\151\x5f\x76\141\x72\x73"][$k]) && is_int($_SESSION["\x5f\137\x63\151\x5f\166\x61\162\x73"][$k])) { unset($_SESSION["\x5f\137\143\x69\137\166\141\x72\x73"][$k]); } } goto zYSVQ; Pkm20: is_array($key) or $key = array($key); goto A_Rfw; uwfGg: if (empty($_SESSION["\x5f\x5f\143\x69\137\166\141\162\x73"])) { return; } goto Pkm20; M5Nfk: } public function __get($key) { if (isset($_SESSION[$key])) { return $_SESSION[$key]; } elseif ($key === "\x73\145\163\163\151\x6f\x6e\137\151\x64") { return session_id(); } return NULL; } public function __isset($key) { if ($key === "\x73\x65\163\x73\x69\x6f\x6e\137\151\144") { return session_status() === PHP_SESSION_ACTIVE; } return isset($_SESSION[$key]); } public function __set($key, $value) { $_SESSION[$key] = $value; } public function sess_destroy() { session_destroy(); } public function sess_regenerate($destroy = FALSE) { $_SESSION["\137\x5f\x63\151\x5f\154\x61\x73\164\x5f\162\x65\x67\x65\x6e\145\162\x61\164\145"] = time(); session_regenerate_id($destroy); } public function &get_userdata() { return $_SESSION; } public function userdata($key = NULL) { goto Snd1y; iKWTD: return $userdata; goto kqiKB; Snd1y: if (isset($key)) { return isset($_SESSION[$key]) ? $_SESSION[$key] : NULL; } elseif (empty($_SESSION)) { return array(); } goto mKWgH; z50vw: foreach (array_keys($_SESSION) as $key) { if (!in_array($key, $_exclude, TRUE)) { $userdata[$key] = $_SESSION[$key]; } } goto iKWTD; mKWgH: $userdata = array(); goto bik6o; bik6o: $_exclude = array_merge(array("\x5f\x5f\143\151\137\166\x61\x72\163"), $this->get_flash_keys(), $this->get_temp_keys()); goto z50vw; kqiKB: } public function set_userdata($data, $value = NULL) { if (is_array($data)) { foreach ($data as $key => &$value) { $_SESSION[$key] = $value; } return; } $_SESSION[$data] = $value; } public function unset_userdata($key) { if (is_array($key)) { foreach ($key as $k) { unset($_SESSION[$k]); } return; } unset($_SESSION[$key]); } public function all_userdata() { return $this->userdata(); } public function has_userdata($key) { return isset($_SESSION[$key]); } public function flashdata($key = NULL) { goto EIWqz; j6LSq: if (!empty($_SESSION["\137\x5f\x63\x69\x5f\166\141\x72\163"])) { foreach ($_SESSION["\x5f\137\x63\x69\x5f\x76\x61\x72\163"] as $key => &$value) { is_int($value) or $flashdata[$key] = $_SESSION[$key]; } } goto uUwrJ; uUwrJ: return $flashdata; goto lnhQo; EIWqz: if (isset($key)) { return isset($_SESSION["\x5f\x5f\143\x69\x5f\x76\141\162\163"], $_SESSION["\x5f\x5f\x63\151\137\166\x61\162\163"][$key], $_SESSION[$key]) && !is_int($_SESSION["\137\137\x63\151\137\x76\x61\x72\x73"][$key]) ? $_SESSION[$key] : NULL; } goto toG9h; toG9h: $flashdata = array(); goto j6LSq; lnhQo: } public function set_flashdata($data, $value = NULL) { $this->set_userdata($data, $value); $this->mark_as_flash(is_array($data) ? array_keys($data) : $data); } public function keep_flashdata($key) { $this->mark_as_flash($key); } public function tempdata($key = NULL) { goto IBrsq; ZFeuT: $tempdata = array(); goto K_IgS; IBrsq: if (isset($key)) { return isset($_SESSION["\137\x5f\x63\x69\x5f\x76\x61\x72\163"], $_SESSION["\x5f\137\x63\151\137\x76\x61\x72\163"][$key], $_SESSION[$key]) && is_int($_SESSION["\137\137\143\151\x5f\x76\x61\x72\x73"][$key]) ? $_SESSION[$key] : NULL; } goto ZFeuT; K6Sf1: return $tempdata; goto Gj7LM; K_IgS: if (!empty($_SESSION["\x5f\137\143\x69\137\x76\141\x72\x73"])) { foreach ($_SESSION["\x5f\x5f\x63\151\x5f\x76\141\x72\x73"] as $key => &$value) { is_int($value) && ($tempdata[$key] = $_SESSION[$key]); } } goto K6Sf1; Gj7LM: } public function set_tempdata($data, $value = NULL, $ttl = 300) { $this->set_userdata($data, $value); $this->mark_as_temp(is_array($data) ? array_keys($data) : $data, $ttl); } public function unset_tempdata($key) { $this->unmark_temp($key); } }
