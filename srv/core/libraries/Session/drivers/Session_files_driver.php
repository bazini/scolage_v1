<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:11:17              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 defined("\x42\101\123\105\120\101\x54\110") or exit("\x4e\x6f\40\x64\151\162\x65\x63\x74\x20\163\x63\162\151\160\x74\x20\141\x63\143\145\163\x73\x20\141\154\154\157\x77\145\144"); class CI_Session_files_driver extends CI_Session_driver implements SessionHandlerInterface { protected $_save_path; protected $_file_handle; protected $_file_path; protected $_file_new; protected $_sid_regexp; protected static $func_overload; public function __construct(&$params) { goto ryXRZ; ryXRZ: parent::__construct($params); goto Jj6FV; Jj6FV: if (isset($this->_config["\163\x61\166\145\137\160\x61\x74\150"])) { $this->_config["\x73\141\166\145\137\x70\x61\164\150"] = rtrim($this->_config["\163\141\166\x65\137\x70\141\x74\x68"], "\x2f\x5c"); ini_set("\163\x65\163\163\151\157\156\56\163\x61\x76\145\137\x70\x61\164\x68", $this->_config["\x73\141\x76\145\x5f\160\141\164\x68"]); } else { log_message("\x64\x65\142\x75\147", "\x53\x65\x73\163\151\x6f\x6e\72\40\42\x73\x65\x73\x73\137\163\141\x76\x65\137\x70\x61\x74\x68\x22\x20\x69\x73\x20\x65\155\x70\164\171\73\x20\x75\x73\151\x6e\x67\40\x22\163\145\x73\x73\x69\157\156\x2e\163\141\x76\x65\137\160\x61\x74\x68\42\40\x76\x61\x6c\x75\x65\x20\x66\162\x6f\x6d\40\160\x68\160\x2e\151\x6e\x69\56"); $this->_config["\x73\141\x76\x65\137\x70\141\164\x68"] = rtrim(ini_get("\163\x65\163\x73\x69\157\156\56\163\x61\x76\145\x5f\160\x61\x74\150"), "\57\134"); } goto VyENO; VyENO: $this->_sid_regexp = $this->_config["\x5f\163\151\144\137\x72\x65\x67\145\170\x70"]; goto SX1XY; SX1XY: isset(self::$func_overload) or self::$func_overload = extension_loaded("\155\142\x73\x74\x72\x69\156\x67") && ini_get("\155\142\x73\x74\162\x69\x6e\x67\56\x66\165\156\x63\137\x6f\x76\145\x72\154\157\x61\x64"); goto RSNjP; RSNjP: } public function open($save_path, $name) { goto pAMsc; oIRI0: $this->_file_path = $this->_config["\163\x61\166\145\137\160\141\x74\150"] . DIRECTORY_SEPARATOR . $name . ($this->_config["\155\x61\x74\x63\x68\x5f\151\160"] ? md5($_SERVER["\x52\x45\115\117\124\105\137\101\x44\104\x52"]) : ''); goto dWsyP; pAMsc: if (!is_dir($save_path)) { if (!mkdir($save_path, 0700, TRUE)) { log_message("\145\x72\162\157\162", "\123\x65\x73\163\151\157\156\72\40\103\x6f\x6e\x66\x69\147\x75\x72\x65\144\40\x73\141\166\145\40\160\x61\164\150\x20\47" . $this->_config["\x73\141\x76\145\x5f\160\x61\164\x68"] . "\47\40\151\163\40\156\157\x74\40\x61\40\144\151\162\x65\x63\164\x6f\x72\x79\x2c\40\x64\157\x65\x73\156\47\x74\x20\x65\x78\151\163\x74\40\x6f\162\x20\143\x61\x6e\156\x6f\x74\40\x62\x65\x20\x63\x72\x65\141\164\x65\x64\56"); return $this->_failure; } } elseif (!is_writable($save_path)) { log_message("\145\x72\162\157\x72", "\123\x65\x73\163\151\x6f\156\72\x20\103\x6f\x6e\x66\x69\x67\x75\162\145\x64\x20\163\x61\x76\145\x20\160\141\x74\x68\40\47" . $this->_config["\x73\x61\166\x65\x5f\160\141\x74\x68"] . "\47\40\x69\163\x20\156\157\164\40\167\162\151\164\x61\142\x6c\145\x20\x62\171\40\164\x68\x65\40\120\x48\x50\40\x70\162\157\143\145\x73\x73\x2e"); return $this->_failure; } goto w8r6G; dWsyP: $this->php5_validate_id(); goto m1jNY; w8r6G: $this->_config["\163\141\166\x65\137\160\141\164\150"] = $save_path; goto oIRI0; m1jNY: return $this->_success; goto mBagc; mBagc: } public function read($session_id) { goto YNvRE; HhgCk: return $session_data; goto U0gt7; YNvRE: if ($this->_file_handle === NULL) { goto dmxf_; mtVa7: if (($this->_file_handle = fopen($this->_file_path . $session_id, "\x63\53\142")) === FALSE) { log_message("\145\162\162\x6f\x72", "\x53\145\x73\x73\x69\157\156\x3a\x20\125\x6e\141\x62\x6c\x65\x20\x74\157\40\x6f\160\145\156\40\x66\x69\x6c\x65\40\x27" . $this->_file_path . $session_id . "\47\56"); return $this->_failure; } goto kiAE2; kiAE2: if (flock($this->_file_handle, LOCK_EX) === FALSE) { goto NmRK0; jHVvd: return $this->_failure; goto fqIwQ; hm5Ia: fclose($this->_file_handle); goto IvyGQ; IvyGQ: $this->_file_handle = NULL; goto jHVvd; NmRK0: log_message("\x65\162\162\x6f\x72", "\123\145\163\163\151\x6f\156\x3a\x20\x55\x6e\x61\142\154\145\x20\164\157\x20\x6f\x62\x74\x61\151\156\x20\x6c\x6f\143\x6b\40\146\157\162\x20\x66\x69\154\x65\40\47" . $this->_file_path . $session_id . "\x27\56"); goto hm5Ia; fqIwQ: } goto iaWol; iaWol: $this->_session_id = $session_id; goto Y2jop; Y2jop: if ($this->_file_new) { goto DvAA8; gGDKT: return ''; goto EJscj; aJ3VB: $this->_fingerprint = md5(''); goto gGDKT; DvAA8: chmod($this->_file_path . $session_id, 0600); goto aJ3VB; EJscj: } goto Z8IDX; dmxf_: $this->_file_new = !file_exists($this->_file_path . $session_id); goto mtVa7; Z8IDX: } elseif ($this->_file_handle === FALSE) { return $this->_failure; } else { rewind($this->_file_handle); } goto Z9m9I; HKZGR: for ($read = 0, $length = filesize($this->_file_path . $session_id); $read < $length; $read += self::strlen($buffer)) { if (($buffer = fread($this->_file_handle, $length - $read)) === FALSE) { break; } $session_data .= $buffer; } goto keBSD; Z9m9I: $session_data = ''; goto HKZGR; keBSD: $this->_fingerprint = md5($session_data); goto HhgCk; U0gt7: } public function write($session_id, $session_data) { goto CS0xM; aa4oy: $this->_fingerprint = md5($session_data); goto FsvEI; DJ2hM: if (!$this->_file_new) { ftruncate($this->_file_handle, 0); rewind($this->_file_handle); } goto tpbmm; FsvEI: return $this->_success; goto fcKVr; tpbmm: if (($length = strlen($session_data)) > 0) { for ($written = 0; $written < $length; $written += $result) { if (($result = fwrite($this->_file_handle, substr($session_data, $written))) === FALSE) { break; } } if (!is_int($result)) { goto Ew_KT; LYY4N: return $this->_failure; goto wc2tp; GH5U3: log_message("\x65\x72\162\x6f\x72", "\123\x65\x73\163\x69\x6f\156\x3a\40\125\x6e\141\142\x6c\x65\x20\164\x6f\40\x77\x72\151\x74\x65\x20\144\141\164\x61\x2e"); goto LYY4N; Ew_KT: $this->_fingerprint = md5(substr($session_data, 0, $written)); goto GH5U3; wc2tp: } } goto aa4oy; CS0xM: if ($session_id !== $this->_session_id && ($this->close() === $this->_failure or $this->read($session_id) === $this->_failure)) { return $this->_failure; } goto QB2t2; QB2t2: if (!is_resource($this->_file_handle)) { return $this->_failure; } elseif ($this->_fingerprint === md5($session_data)) { return !$this->_file_new && !touch($this->_file_path . $session_id) ? $this->_failure : $this->_success; } goto DJ2hM; fcKVr: } public function close() { if (is_resource($this->_file_handle)) { goto WO8sj; WO8sj: flock($this->_file_handle, LOCK_UN); goto Sg6oE; WUgfT: $this->_file_handle = $this->_file_new = $this->_session_id = NULL; goto lDivA; Sg6oE: fclose($this->_file_handle); goto WUgfT; lDivA: } return $this->_success; } public function destroy($session_id) { if ($this->close() === $this->_success) { if (file_exists($this->_file_path . $session_id)) { $this->_cookie_destroy(); return unlink($this->_file_path . $session_id) ? $this->_success : $this->_failure; } return $this->_success; } elseif ($this->_file_path !== NULL) { goto gUguD; d3mNg: if (file_exists($this->_file_path . $session_id)) { $this->_cookie_destroy(); return unlink($this->_file_path . $session_id) ? $this->_success : $this->_failure; } goto nSKNv; nSKNv: return $this->_success; goto G4ngM; gUguD: clearstatcache(); goto d3mNg; G4ngM: } return $this->_failure; } public function gc($maxlifetime) { goto fQvHm; iODeG: while (($file = readdir($directory)) !== FALSE) { if (!preg_match($pattern, $file) or !is_file($this->_config["\x73\x61\166\145\x5f\160\141\164\x68"] . DIRECTORY_SEPARATOR . $file) or ($mtime = filemtime($this->_config["\163\x61\166\145\x5f\160\x61\164\x68"] . DIRECTORY_SEPARATOR . $file)) === FALSE or $mtime > $ts) { continue; } unlink($this->_config["\163\x61\166\x65\137\x70\x61\164\150"] . DIRECTORY_SEPARATOR . $file); } goto YeLHT; GGn0d: $pattern = sprintf("\x23\x5c\101\45\163" . $pattern . $this->_sid_regexp . "\x5c\x7a\x23", preg_quote($this->_config["\143\157\157\153\x69\x65\x5f\156\x61\155\x65"])); goto iODeG; Z0Nc6: $pattern = $this->_config["\x6d\141\x74\x63\x68\137\x69\x70"] === TRUE ? "\133\60\55\x39\141\55\146\135\x7b\63\62\175" : ''; goto GGn0d; fQvHm: if (!is_dir($this->_config["\163\x61\166\145\137\160\141\x74\x68"]) or ($directory = opendir($this->_config["\x73\x61\x76\x65\x5f\160\x61\164\x68"])) === FALSE) { log_message("\144\145\x62\x75\147", "\123\x65\x73\x73\151\x6f\156\x3a\40\107\141\162\x62\141\x67\x65\x20\x63\x6f\x6c\154\145\x63\x74\x6f\162\40\143\157\x75\x6c\x64\x6e\47\164\40\154\151\163\x74\x20\146\151\154\x65\163\x20\x75\x6e\x64\145\x72\x20\144\151\162\x65\x63\x74\157\162\x79\40\x27" . $this->_config["\x73\141\166\145\137\x70\x61\x74\x68"] . "\x27\56"); return $this->_failure; } goto kmhl1; kmhl1: $ts = time() - $maxlifetime; goto Z0Nc6; KdKpV: return $this->_success; goto wON7D; YeLHT: closedir($directory); goto KdKpV; wON7D: } public function validateSessionId($id) { goto KwJhi; weDjH: clearstatcache(TRUE, $this->_file_path . $id); goto HdSFY; KwJhi: $result = is_file($this->_file_path . $id); goto weDjH; HdSFY: return $result; goto Q63Ho; Q63Ho: } protected static function strlen($str) { return self::$func_overload ? mb_strlen($str, "\x38\x62\x69\x74") : strlen($str); } }
