<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:11:17              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 defined("\x42\101\x53\105\x50\101\x54\110") or exit("\116\157\40\x64\x69\162\145\x63\x74\x20\163\x63\x72\151\160\x74\40\141\143\143\145\x73\x73\x20\141\x6c\x6c\157\167\x65\x64"); class CI_Session_database_driver extends CI_Session_driver implements SessionHandlerInterface { protected $_db; protected $_row_exists = FALSE; protected $_platform; public function __construct(&$params) { goto Zk6wP; k0U0R: if (!isset($this->_config["\x73\x61\x76\x65\x5f\x70\x61\164\x68"]) && ($this->_config["\x73\141\166\x65\137\160\141\164\x68"] = config_item("\x73\145\163\163\137\164\x61\142\x6c\145\x5f\x6e\x61\155\145"))) { log_message("\144\145\x62\165\147", "\123\x65\x73\x73\151\157\156\72\40\x22\x73\145\163\163\x5f\163\x61\166\145\x5f\x70\x61\164\x68\42\40\x69\163\x20\145\x6d\x70\x74\x79\73\x20\x75\163\151\156\x67\40\x42\x43\40\146\x61\x6c\x6c\142\141\143\153\40\164\x6f\40\42\x73\x65\163\x73\x5f\x74\141\x62\x6c\145\x5f\156\x61\155\145\x22\56"); } goto YCdL7; LnVEm: isset($CI->db) or $CI->load->database(); goto RodW6; RodW6: $this->_db = $CI->db; goto tSXTN; tSXTN: if (!$this->_db instanceof CI_DB_query_builder) { throw new Exception("\x51\x75\x65\x72\x79\x20\102\165\151\154\144\145\162\x20\156\157\x74\40\x65\x6e\x61\x62\154\x65\x64\x20\146\x6f\x72\x20\x74\150\145\x20\143\157\156\x66\151\x67\x75\162\145\144\40\x64\x61\164\141\x62\141\163\145\x2e\x20\101\142\x6f\x72\x74\151\156\147\x2e"); } elseif ($this->_db->pconnect) { throw new Exception("\103\x6f\x6e\146\151\147\165\162\x65\144\40\x64\141\164\x61\x62\141\163\145\40\143\157\x6e\x6e\145\x63\164\x69\157\156\40\151\163\x20\x70\145\162\163\x69\163\x74\x65\156\x74\56\x20\x41\x62\157\162\164\x69\x6e\x67\56"); } elseif ($this->_db->cache_on) { throw new Exception("\103\x6f\156\146\x69\147\165\x72\145\144\40\144\141\164\141\x62\x61\163\145\x20\x63\x6f\156\156\145\143\x74\151\157\156\x20\x68\141\x73\40\x63\141\x63\150\145\x20\145\x6e\x61\x62\x6c\x65\144\56\x20\x41\142\x6f\x72\x74\151\156\147\56"); } goto Ez06q; lUNjb: $CI =& get_instance(); goto LnVEm; Zk6wP: parent::__construct($params); goto lUNjb; wtARu: if (strpos($db_driver, "\x6d\171\163\161\154") !== FALSE) { $this->_platform = "\155\171\x73\x71\x6c"; } elseif (in_array($db_driver, array("\160\157\x73\164\147\162\x65", "\160\x64\x6f\x5f\x70\x67\x73\161\154"), TRUE)) { $this->_platform = "\x70\157\163\164\147\162\x65"; } goto k0U0R; Ez06q: $db_driver = $this->_db->dbdriver . (empty($this->_db->subdriver) ? '' : "\x5f" . $this->_db->subdriver); goto wtARu; YCdL7: } public function open($save_path, $name) { goto t3e5o; t3e5o: if (empty($this->_db->conn_id) && !$this->_db->db_connect()) { return $this->_failure; } goto DCwT1; C8iiS: return $this->_success; goto yrol9; DCwT1: $this->php5_validate_id(); goto C8iiS; yrol9: } public function read($session_id) { goto m0eRa; WHhcb: $this->_session_id = $session_id; goto wyxAx; j_7kH: $this->_row_exists = TRUE; goto mxKaX; FhUyj: if (!($result = $this->_db->get()) or ($result = $result->row()) === NULL) { goto bVOQZ; M6yLQ: $this->_fingerprint = md5(''); goto hT3Qq; bVOQZ: $this->_row_exists = FALSE; goto M6yLQ; hT3Qq: return ''; goto orhZg; orhZg: } goto eXfAV; eXfAV: $result = $this->_platform === "\160\157\x73\x74\x67\162\x65" ? base64_decode(rtrim($result->data)) : $result->data; goto NH3kD; mxKaX: return $result; goto PRWhS; m0eRa: if ($this->_get_lock($session_id) === FALSE) { return $this->_failure; } goto tsGa3; wyxAx: $this->_db->select("\x64\x61\x74\x61")->from($this->_config["\x73\x61\166\145\x5f\160\x61\x74\x68"])->where("\151\x64", $session_id); goto KnlMh; tsGa3: $this->_db->reset_query(); goto WHhcb; NH3kD: $this->_fingerprint = md5($result); goto j_7kH; KnlMh: if ($this->_config["\x6d\141\x74\143\x68\x5f\151\x70"]) { $this->_db->where("\151\x70\137\141\144\144\162\x65\163\x73", $_SERVER["\x52\x45\x4d\x4f\124\105\x5f\x41\104\104\122"]); } goto FhUyj; PRWhS: } public function write($session_id, $session_data) { goto Toha4; blj11: if ($this->_db->update($this->_config["\163\141\166\x65\x5f\160\141\164\150"], $update_data)) { $this->_fingerprint = md5($session_data); return $this->_success; } goto RcowC; lEmSp: if ($this->_fingerprint !== md5($session_data)) { $update_data["\x64\x61\164\x61"] = $this->_platform === "\x70\157\163\x74\x67\x72\x65" ? base64_encode($session_data) : $session_data; } goto blj11; zLbRE: $update_data = array("\x74\151\x6d\145\163\164\141\155\160" => time()); goto lEmSp; v8Rf1: if ($this->_config["\x6d\141\x74\x63\x68\137\151\160"]) { $this->_db->where("\151\x70\x5f\141\144\x64\x72\x65\163\163", $_SERVER["\x52\105\x4d\117\x54\x45\137\x41\104\x44\x52"]); } goto zLbRE; ycVlB: $this->_db->where("\151\x64", $session_id); goto v8Rf1; Toha4: $this->_db->reset_query(); goto Lo49N; RcowC: return $this->_failure; goto LmWTM; Wi_gP: if ($this->_row_exists === FALSE) { goto VgVBf; uJKUh: if ($this->_db->insert($this->_config["\163\x61\x76\x65\137\160\141\164\150"], $insert_data)) { goto oqNkT; oqNkT: $this->_fingerprint = md5($session_data); goto d70q4; CNWqQ: return $this->_success; goto LnHtW; d70q4: $this->_row_exists = TRUE; goto CNWqQ; LnHtW: } goto AwBDL; VgVBf: $insert_data = array("\151\144" => $session_id, "\x69\160\137\x61\144\144\x72\145\163\x73" => $_SERVER["\x52\x45\x4d\x4f\x54\x45\x5f\101\104\x44\x52"], "\x74\x69\155\x65\x73\164\141\x6d\x70" => time(), "\x64\x61\164\141" => $this->_platform === "\x70\x6f\x73\x74\x67\x72\145" ? base64_encode($session_data) : $session_data); goto uJKUh; AwBDL: return $this->_failure; goto F2RSB; F2RSB: } goto ycVlB; Lo49N: if (isset($this->_session_id) && $session_id !== $this->_session_id) { goto kk3n1; IqcxR: $this->_row_exists = FALSE; goto rgAaV; rgAaV: $this->_session_id = $session_id; goto l_P4O; kk3n1: if (!$this->_release_lock() or !$this->_get_lock($session_id)) { return $this->_failure; } goto IqcxR; l_P4O: } elseif ($this->_lock === FALSE) { return $this->_failure; } goto Wi_gP; LmWTM: } public function close() { return $this->_lock && !$this->_release_lock() ? $this->_failure : $this->_success; } public function destroy($session_id) { goto Xrbif; airvl: return $this->_failure; goto X1D_H; Xrbif: if ($this->_lock) { goto V82yB; z6sR_: $this->_db->where("\151\x64", $session_id); goto nfWjN; V82yB: $this->_db->reset_query(); goto z6sR_; FqmWv: if (!$this->_db->delete($this->_config["\163\141\x76\x65\x5f\x70\141\164\150"])) { return $this->_failure; } goto BxBwG; nfWjN: if ($this->_config["\x6d\141\x74\143\150\x5f\x69\x70"]) { $this->_db->where("\151\160\x5f\x61\x64\144\162\145\x73\x73", $_SERVER["\x52\x45\x4d\117\124\105\x5f\101\104\104\122"]); } goto FqmWv; BxBwG: } goto ikoiM; ikoiM: if ($this->close() === $this->_success) { $this->_cookie_destroy(); return $this->_success; } goto airvl; X1D_H: } public function gc($maxlifetime) { $this->_db->reset_query(); return $this->_db->delete($this->_config["\x73\x61\166\145\x5f\x70\x61\164\x68"], "\x74\x69\x6d\145\x73\x74\x61\x6d\160\40\74\x20" . (time() - $maxlifetime)) ? $this->_success : $this->_failure; } public function validateSessionId($id) { goto tfW1i; IFn_W: return !empty($result); goto jORaq; V07o3: empty($this->_config["\155\141\164\x63\150\137\x69\x70"]) or $this->_db->where("\151\x70\137\141\144\144\162\x65\163\x73", $_SERVER["\x52\105\x4d\x4f\124\x45\x5f\101\x44\104\122"]); goto Tf604; tfW1i: $this->_db->reset_query(); goto MDWqc; MDWqc: $this->_db->select("\61")->from($this->_config["\163\x61\x76\145\x5f\160\x61\x74\150"])->where("\151\144", $id); goto V07o3; Tf604: $result = $this->_db->get(); goto lCtuf; lCtuf: empty($result) or $result = $result->row(); goto IFn_W; jORaq: } protected function _get_lock($session_id) { if ($this->_platform === "\x6d\171\x73\161\154") { goto AX4hY; d4T9d: if ($this->_db->query("\x53\x45\x4c\105\x43\124\40\107\105\x54\x5f\114\x4f\x43\113\50\47" . $arg . "\x27\x2c\x20\x33\x30\x30\51\40\x41\x53\x20\143\151\137\x73\x65\x73\x73\x69\157\x6e\137\x6c\x6f\x63\153")->row()->ci_session_lock) { $this->_lock = $arg; return TRUE; } goto Z3xcw; Z3xcw: return FALSE; goto otrkm; AX4hY: $arg = md5($session_id . ($this->_config["\155\141\x74\x63\x68\x5f\x69\x70"] ? "\x5f" . $_SERVER["\x52\x45\115\117\x54\x45\x5f\101\104\x44\122"] : '')); goto d4T9d; otrkm: } elseif ($this->_platform === "\x70\157\x73\164\147\x72\145") { goto EKoaL; EKoaL: $arg = "\150\x61\x73\150\164\x65\x78\164\50\47" . $session_id . "\x27\x29" . ($this->_config["\x6d\x61\164\143\x68\137\x69\x70"] ? "\x2c\x20\150\141\163\x68\x74\145\x78\x74\x28\x27" . $_SERVER["\x52\x45\115\117\x54\105\137\101\104\104\x52"] . "\x27\x29" : ''); goto DRsSr; DRsSr: if ($this->_db->simple_query("\123\105\x4c\x45\103\124\x20\160\147\x5f\141\144\166\x69\x73\x6f\x72\x79\x5f\x6c\157\x63\x6b\x28" . $arg . "\x29")) { $this->_lock = $arg; return TRUE; } goto GJlNv; GJlNv: return FALSE; goto gykVn; gykVn: } return parent::_get_lock($session_id); } protected function _release_lock() { goto axoPH; PlyT0: return parent::_release_lock(); goto qs0KB; axoPH: if (!$this->_lock) { return TRUE; } goto ltPj1; ltPj1: if ($this->_platform === "\x6d\x79\x73\161\x6c") { if ($this->_db->query("\123\105\114\105\x43\x54\40\x52\x45\114\x45\101\x53\105\x5f\114\x4f\x43\x4b\50\47" . $this->_lock . "\47\51\40\101\x53\40\x63\151\137\163\145\x73\x73\151\x6f\156\137\x6c\x6f\x63\153")->row()->ci_session_lock) { $this->_lock = FALSE; return TRUE; } return FALSE; } elseif ($this->_platform === "\x70\157\163\x74\147\x72\x65") { if ($this->_db->simple_query("\123\x45\x4c\x45\x43\x54\40\160\147\137\141\x64\x76\151\163\x6f\162\x79\137\x75\x6e\x6c\x6f\143\153\50" . $this->_lock . "\x29")) { $this->_lock = FALSE; return TRUE; } return FALSE; } goto PlyT0; qs0KB: } }
