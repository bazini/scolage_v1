<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:07              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Writer_Excel2007_ContentTypes extends PHPExcel_Writer_Excel2007_WriterPart { public function writeContentTypes(PHPExcel $pPHPExcel = null, $includeCharts = false) { goto Ppz0x; xySg1: $sheetCount = $pPHPExcel->getSheetCount(); goto F8zTg; ELIYO: $customPropertyList = $pPHPExcel->getProperties()->getCustomProperties(); goto AmeWW; TeQA0: $sheetCount = $pPHPExcel->getSheetCount(); goto Bc5lk; k9GbQ: if ($pPHPExcel->hasMacros()) { goto rWWu3; rWWu3: $this->writeOverrideContentType($objWriter, "\57\x78\x6c\57\x77\157\162\153\142\x6f\x6f\153\56\x78\155\154", "\141\160\160\154\x69\x63\141\164\x69\x6f\156\x2f\x76\156\144\x2e\x6d\x73\55\145\170\143\x65\154\x2e\163\150\x65\x65\164\56\x6d\x61\143\162\157\105\156\x61\142\154\x65\x64\56\x6d\x61\x69\156\53\170\x6d\154"); goto ndFKo; ndFKo: $this->writeDefaultContentType($objWriter, "\142\x69\156", "\141\160\160\154\x69\143\x61\164\151\x6f\156\x2f\166\156\144\56\155\163\x2d\x6f\146\146\x69\x63\x65\x2e\x76\142\x61\x50\162\x6f\152\x65\x63\164"); goto vwb6d; vwb6d: if ($pPHPExcel->hasMacrosCertificate()) { $this->writeOverrideContentType($objWriter, "\57\x78\154\x2f\166\142\x61\120\x72\157\x6a\x65\143\164\x53\x69\147\x6e\141\164\x75\x72\x65\56\x62\151\x6e", "\x61\160\x70\154\151\143\141\164\x69\x6f\x6e\x2f\x76\x6e\x64\56\x6d\x73\55\x6f\x66\x66\151\x63\x65\56\x76\142\x61\x50\162\x6f\152\x65\143\x74\123\151\x67\156\141\x74\165\162\145"); } goto DaBHY; DaBHY: } else { $this->writeOverrideContentType($objWriter, "\x2f\170\154\57\167\x6f\162\x6b\142\x6f\157\x6b\x2e\170\155\x6c", "\141\x70\x70\x6c\x69\143\x61\164\151\157\156\x2f\x76\156\144\56\157\x70\145\156\x78\x6d\154\146\157\x72\155\x61\164\x73\x2d\157\x66\x66\151\x63\x65\144\x6f\x63\165\x6d\145\x6e\x74\56\x73\160\x72\145\141\144\x73\x68\145\145\164\x6d\154\56\163\x68\x65\145\164\x2e\x6d\141\151\x6e\x2b\170\155\x6c"); } goto kk6wz; gnxLz: $this->writeOverrideContentType($objWriter, "\57\x78\154\57\163\x68\x61\x72\x65\x64\x53\164\x72\x69\x6e\147\x73\56\170\x6d\x6c", "\141\160\160\x6c\151\x63\141\164\x69\x6f\x6e\57\166\x6e\144\56\x6f\x70\x65\x6e\x78\x6d\154\x66\x6f\x72\x6d\141\164\x73\55\157\x66\x66\x69\143\145\x64\157\143\165\x6d\x65\x6e\164\56\x73\160\x72\x65\x61\144\x73\150\145\145\x74\x6d\x6c\56\163\x68\x61\x72\145\144\x53\x74\x72\x69\156\147\x73\53\x78\x6d\x6c"); goto g3l0r; Bc5lk: for ($i = 0; $i < $sheetCount; ++$i) { if (count($pPHPExcel->getSheet()->getHeaderFooter()->getImages()) > 0) { foreach ($pPHPExcel->getSheet()->getHeaderFooter()->getImages() as $image) { if (!isset($aMediaContentTypes[strtolower($image->getExtension())])) { $aMediaContentTypes[strtolower($image->getExtension())] = $this->getImageMimeType($image->getPath()); $this->writeDefaultContentType($objWriter, strtolower($image->getExtension()), $aMediaContentTypes[strtolower($image->getExtension())]); } } } } goto kCDZ5; n9vZP: $this->writeOverrideContentType($objWriter, "\57\170\x6c\57\164\150\x65\155\x65\57\x74\x68\145\155\145\61\x2e\x78\x6d\154", "\141\x70\x70\154\151\143\141\164\x69\x6f\x6e\x2f\166\x6e\x64\x2e\x6f\160\x65\156\170\x6d\154\x66\x6f\162\155\x61\x74\x73\x2d\157\146\146\x69\143\x65\144\x6f\143\x75\155\145\x6e\164\56\164\150\x65\x6d\x65\x2b\x78\155\154"); goto U69t7; wlLMk: $this->writeDefaultContentType($objWriter, "\162\x65\x6c\163", "\141\x70\x70\154\151\143\141\164\151\x6f\x6e\57\x76\x6e\144\x2e\x6f\x70\145\156\170\x6d\154\146\x6f\x72\155\141\164\163\x2d\160\141\x63\153\141\x67\145\x2e\x72\x65\x6c\141\x74\151\157\x6e\x73\150\x69\160\163\x2b\170\155\154"); goto UrEep; spaDR: for ($i = 0; $i < $sheetCount; ++$i) { if (count($pPHPExcel->getSheet($i)->getComments()) > 0) { $this->writeOverrideContentType($objWriter, "\x2f\x78\154\57\x63\x6f\155\155\145\156\164\x73" . ($i + 1) . "\x2e\x78\155\x6c", "\141\160\x70\154\151\143\x61\164\x69\x6f\156\x2f\166\x6e\x64\x2e\x6f\160\x65\x6e\170\x6d\x6c\x66\x6f\162\155\141\x74\x73\x2d\157\x66\x66\x69\x63\145\x64\x6f\143\x75\x6d\145\156\x74\56\x73\160\x72\145\x61\144\163\150\x65\x65\164\x6d\154\x2e\x63\x6f\155\x6d\145\156\x74\x73\53\x78\x6d\154"); } } goto UAS9_; DC7no: if ($pPHPExcel->hasRibbonBinObjects()) { $tabRibbonTypes = array_diff($pPHPExcel->getRibbonBinObjects("\x74\171\x70\145\163"), array_keys($aMediaContentTypes)); foreach ($tabRibbonTypes as $aRibbonType) { $mimeType = "\151\x6d\141\147\x65\x2f\56" . $aRibbonType; $this->writeDefaultContentType($objWriter, $aRibbonType, $mimeType); } } goto TeQA0; U69t7: $this->writeOverrideContentType($objWriter, "\x2f\x78\154\x2f\x73\x74\171\154\x65\163\56\170\x6d\x6c", "\x61\x70\160\x6c\x69\x63\141\164\x69\x6f\x6e\x2f\x76\156\144\x2e\x6f\x70\145\156\170\155\154\x66\x6f\162\155\141\164\x73\55\157\x66\x66\x69\x63\x65\x64\157\143\x75\x6d\x65\x6e\164\x2e\x73\160\162\145\x61\x64\x73\x68\x65\x65\x74\155\154\x2e\163\x74\171\x6c\x65\163\x2b\170\155\x6c"); goto wlLMk; RSOK8: for ($i = 0; $i < $sheetCount; ++$i) { $drawings = $pPHPExcel->getSheet($i)->getDrawingCollection(); $drawingCount = count($drawings); $chartCount = $includeCharts ? $pPHPExcel->getSheet($i)->getChartCount() : 0; if ($drawingCount > 0 || $chartCount > 0) { $this->writeOverrideContentType($objWriter, "\57\x78\x6c\57\144\162\141\x77\x69\x6e\x67\x73\x2f\144\162\141\167\x69\156\x67" . ($i + 1) . "\x2e\170\x6d\x6c", "\x61\160\160\154\151\143\141\164\x69\157\x6e\57\166\x6e\x64\x2e\157\160\145\x6e\x78\x6d\x6c\x66\157\x72\x6d\x61\x74\163\x2d\157\146\x66\x69\143\x65\x64\x6f\x63\165\x6d\145\x6e\164\56\x64\x72\x61\167\x69\156\147\x2b\170\x6d\154"); } if ($chartCount > 0) { for ($c = 0; $c < $chartCount; ++$c) { $this->writeOverrideContentType($objWriter, "\57\170\x6c\57\x63\x68\141\x72\164\x73\x2f\x63\x68\x61\162\164" . $chart++ . "\x2e\x78\155\154", "\x61\160\x70\x6c\151\x63\141\164\151\x6f\156\x2f\166\x6e\144\56\157\160\145\x6e\170\x6d\154\146\x6f\162\x6d\141\x74\163\x2d\x6f\x66\146\x69\143\x65\144\x6f\x63\x75\x6d\145\156\x74\x2e\144\162\141\167\151\156\147\x6d\154\x2e\143\x68\141\162\x74\53\x78\155\x6c"); } } } goto spaDR; AmeWW: if (!empty($customPropertyList)) { $this->writeOverrideContentType($objWriter, "\x2f\x64\x6f\x63\120\x72\157\x70\x73\57\143\x75\x73\164\x6f\155\56\x78\x6d\154", "\141\x70\x70\x6c\151\143\x61\164\151\157\156\x2f\x76\x6e\144\x2e\x6f\160\x65\x6e\170\155\x6c\146\x6f\x72\155\x61\x74\x73\55\157\146\x66\151\143\x65\144\x6f\143\165\x6d\x65\156\x74\x2e\143\x75\163\164\157\155\x2d\160\x72\x6f\x70\145\162\164\151\x65\x73\53\x78\155\154"); } goto xySg1; VxeBT: $this->writeDefaultContentType($objWriter, "\x76\x6d\x6c", "\141\160\160\x6c\x69\x63\141\164\151\157\156\x2f\166\x6e\x64\x2e\x6f\x70\x65\x6e\x78\155\x6c\x66\157\x72\155\141\x74\x73\x2d\157\x66\x66\151\x63\x65\x64\157\143\165\x6d\x65\x6e\x74\56\x76\155\x6c\104\x72\141\167\x69\x6e\147"); goto k9GbQ; g3l0r: $chart = 1; goto RSOK8; drl0A: $objWriter->startDocument("\x31\56\x30", "\x55\x54\x46\x2d\70", "\171\145\163"); goto OBLrg; UAS9_: $aMediaContentTypes = array(); goto dVQlH; C5Ycl: for ($i = 0; $i < $mediaCount; ++$i) { $extension = ''; $mimeType = ''; if ($this->getParentWriter()->getDrawingHashTable()->getByIndex($i) instanceof PHPExcel_Worksheet_Drawing) { $extension = strtolower($this->getParentWriter()->getDrawingHashTable()->getByIndex($i)->getExtension()); $mimeType = $this->getImageMimeType($this->getParentWriter()->getDrawingHashTable()->getByIndex($i)->getPath()); } elseif ($this->getParentWriter()->getDrawingHashTable()->getByIndex($i) instanceof PHPExcel_Worksheet_MemoryDrawing) { goto XvAQC; VaUs1: $extension = explode("\x2f", $extension); goto x0Iqe; XvAQC: $extension = strtolower($this->getParentWriter()->getDrawingHashTable()->getByIndex($i)->getMimeType()); goto VaUs1; CbwRw: $mimeType = $this->getParentWriter()->getDrawingHashTable()->getByIndex($i)->getMimeType(); goto BIPyj; x0Iqe: $extension = $extension[1]; goto CbwRw; BIPyj: } if (!isset($aMediaContentTypes[$extension])) { $aMediaContentTypes[$extension] = $mimeType; $this->writeDefaultContentType($objWriter, $extension, $mimeType); } } goto DC7no; Ppz0x: $objWriter = null; goto gPYpX; UrEep: $this->writeDefaultContentType($objWriter, "\170\x6d\x6c", "\141\160\160\154\151\143\141\x74\151\x6f\156\57\170\155\154"); goto VxeBT; gPYpX: if ($this->getParentWriter()->getUseDiskCaching()) { $objWriter = new PHPExcel_Shared_XMLWriter(PHPExcel_Shared_XMLWriter::STORAGE_DISK, $this->getParentWriter()->getDiskCachingDirectory()); } else { $objWriter = new PHPExcel_Shared_XMLWriter(PHPExcel_Shared_XMLWriter::STORAGE_MEMORY); } goto drl0A; NZvbv: $objWriter->writeAttribute("\170\155\154\x6e\163", "\150\x74\x74\160\72\x2f\57\163\143\x68\x65\x6d\x61\163\56\157\x70\x65\x6e\170\x6d\154\146\x6f\162\155\x61\164\x73\56\157\x72\x67\57\x70\141\143\x6b\x61\x67\x65\x2f\62\60\x30\66\57\143\x6f\156\x74\145\x6e\164\55\164\x79\x70\145\x73"); goto n9vZP; kCDZ5: $objWriter->endElement(); goto i3yZG; i3yZG: return $objWriter->getData(); goto fB3Qx; OBLrg: $objWriter->startElement("\x54\x79\x70\x65\x73"); goto NZvbv; dVQlH: $mediaCount = $this->getParentWriter()->getDrawingHashTable()->count(); goto C5Ycl; F8zTg: for ($i = 0; $i < $sheetCount; ++$i) { $this->writeOverrideContentType($objWriter, "\57\x78\x6c\x2f\167\157\162\x6b\x73\150\x65\145\x74\x73\x2f\163\150\x65\145\164" . ($i + 1) . "\56\x78\155\x6c", "\x61\160\160\x6c\151\143\141\x74\151\157\156\x2f\x76\x6e\x64\56\x6f\x70\x65\156\170\155\x6c\x66\157\x72\x6d\x61\x74\x73\55\157\146\x66\x69\x63\x65\144\x6f\143\x75\155\145\x6e\164\x2e\163\x70\162\145\x61\144\163\150\x65\x65\x74\x6d\x6c\x2e\167\157\x72\x6b\x73\150\x65\145\164\53\x78\x6d\154"); } goto gnxLz; kk6wz: $this->writeOverrideContentType($objWriter, "\x2f\144\x6f\143\x50\162\157\160\163\x2f\x61\x70\x70\x2e\x78\x6d\154", "\141\x70\160\x6c\x69\143\x61\x74\151\157\156\57\x76\x6e\144\x2e\157\x70\145\156\x78\x6d\154\x66\x6f\162\155\141\x74\x73\x2d\157\x66\146\x69\x63\145\x64\157\143\x75\x6d\x65\156\164\56\145\170\164\145\x6e\x64\145\x64\x2d\160\162\157\160\x65\162\164\151\145\163\x2b\x78\155\x6c"); goto OtQIe; OtQIe: $this->writeOverrideContentType($objWriter, "\57\144\157\x63\x50\x72\x6f\x70\x73\x2f\143\x6f\162\145\56\170\155\x6c", "\141\x70\160\x6c\151\x63\x61\164\x69\157\156\57\166\x6e\144\x2e\x6f\x70\x65\x6e\x78\155\154\x66\157\162\x6d\x61\164\x73\55\160\x61\x63\x6b\141\x67\145\x2e\143\x6f\162\145\x2d\x70\162\x6f\x70\x65\162\164\x69\x65\163\x2b\x78\155\154"); goto ELIYO; fB3Qx: } private function getImageMimeType($pFile = '') { if (PHPExcel_Shared_File::file_exists($pFile)) { $image = getimagesize($pFile); return image_type_to_mime_type($image[2]); } else { throw new PHPExcel_Writer_Exception("\106\151\x6c\x65\40{$pFile}\40\144\x6f\145\163\x20\156\x6f\x74\x20\145\x78\151\x73\x74"); } } private function writeDefaultContentType(PHPExcel_Shared_XMLWriter $objWriter = null, $pPartname = '', $pContentType = '') { if ($pPartname != '' && $pContentType != '') { goto C9vz2; BElI1: $objWriter->endElement(); goto BwZUC; yoLZt: $objWriter->writeAttribute("\x45\170\x74\145\156\163\151\157\x6e", $pPartname); goto XPjZ2; XPjZ2: $objWriter->writeAttribute("\103\x6f\156\x74\145\156\164\124\x79\160\145", $pContentType); goto BElI1; C9vz2: $objWriter->startElement("\x44\145\x66\141\165\x6c\x74"); goto yoLZt; BwZUC: } else { throw new PHPExcel_Writer_Exception("\111\156\166\141\x6c\151\144\40\160\x61\162\141\155\x65\x74\x65\x72\x73\40\x70\141\163\163\x65\x64\x2e"); } } private function writeOverrideContentType(PHPExcel_Shared_XMLWriter $objWriter = null, $pPartname = '', $pContentType = '') { if ($pPartname != '' && $pContentType != '') { goto Mt3wG; acq3B: $objWriter->endElement(); goto NeOVY; A1517: $objWriter->writeAttribute("\120\x61\162\164\116\141\x6d\145", $pPartname); goto kb6i3; kb6i3: $objWriter->writeAttribute("\x43\x6f\156\x74\145\156\164\124\171\x70\145", $pContentType); goto acq3B; Mt3wG: $objWriter->startElement("\117\x76\145\x72\162\x69\144\145"); goto A1517; NeOVY: } else { throw new PHPExcel_Writer_Exception("\x49\x6e\x76\x61\x6c\x69\144\x20\x70\141\162\141\x6d\x65\164\145\162\x73\x20\x70\x61\x73\163\145\x64\56"); } } }
