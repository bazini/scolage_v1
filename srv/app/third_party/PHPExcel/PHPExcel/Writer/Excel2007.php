<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:06              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Writer_Excel2007 extends PHPExcel_Writer_Abstract implements PHPExcel_Writer_IWriter { protected $preCalculateFormulas = false; private $office2003compatibility = false; private $writerParts = array(); private $spreadSheet; private $stringTable = array(); private $stylesConditionalHashTable; private $styleHashTable; private $fillHashTable; private $fontHashTable; private $bordersHashTable; private $numFmtHashTable; private $drawingHashTable; public function __construct(PHPExcel $pPHPExcel = null) { goto QqPs4; wd1W5: foreach ($hashTablesArray as $tableName) { $this->{$tableName} = new PHPExcel_HashTable(); } goto jGzv9; r6UAj: $writerPartsArray = array("\x73\x74\x72\x69\156\147\x74\x61\x62\x6c\x65" => "\120\110\120\x45\x78\x63\x65\x6c\137\127\162\x69\x74\145\162\x5f\x45\x78\143\x65\x6c\62\x30\x30\x37\x5f\x53\164\x72\151\x6e\x67\124\141\x62\x6c\145", "\143\x6f\x6e\x74\145\x6e\x74\164\x79\160\x65\x73" => "\120\x48\120\x45\170\143\x65\x6c\x5f\x57\162\151\x74\x65\162\x5f\x45\x78\x63\x65\x6c\62\60\60\67\137\x43\157\x6e\x74\x65\156\164\x54\171\160\145\163", "\144\157\143\x70\162\157\x70\x73" => "\120\x48\x50\105\170\143\x65\154\x5f\127\162\151\x74\145\162\x5f\x45\170\x63\x65\154\x32\60\x30\x37\x5f\x44\157\x63\x50\162\157\x70\x73", "\x72\x65\x6c\163" => "\x50\110\120\x45\170\x63\x65\154\x5f\127\162\151\x74\145\162\x5f\105\170\143\145\x6c\62\x30\60\x37\x5f\122\145\x6c\x73", "\x74\150\x65\x6d\x65" => "\120\110\120\105\170\x63\145\154\x5f\x57\162\x69\164\145\162\137\x45\x78\x63\145\x6c\x32\x30\60\x37\137\124\150\145\x6d\x65", "\163\164\x79\x6c\x65" => "\x50\110\120\105\x78\x63\x65\154\137\x57\x72\x69\164\145\162\x5f\x45\170\143\x65\154\62\60\60\x37\x5f\123\164\171\x6c\145", "\167\157\x72\x6b\x62\x6f\x6f\153" => "\120\x48\x50\105\x78\143\x65\x6c\137\x57\x72\x69\164\145\x72\137\105\170\x63\145\154\62\60\x30\x37\x5f\x57\x6f\x72\153\142\x6f\157\x6b", "\x77\x6f\162\153\x73\x68\x65\x65\164" => "\120\110\x50\x45\170\143\x65\x6c\x5f\127\162\x69\164\145\x72\137\105\x78\143\x65\154\62\x30\x30\x37\x5f\127\x6f\x72\153\163\150\145\x65\x74", "\144\162\x61\167\151\x6e\x67" => "\x50\110\120\x45\170\x63\145\x6c\x5f\x57\162\151\x74\145\162\137\105\170\143\x65\x6c\x32\x30\60\x37\137\x44\x72\x61\167\x69\x6e\x67", "\x63\157\x6d\x6d\x65\x6e\164\x73" => "\120\110\120\105\x78\143\x65\154\x5f\127\x72\x69\164\x65\x72\137\105\x78\143\145\x6c\62\60\60\x37\137\103\x6f\155\x6d\145\x6e\x74\163", "\x63\150\x61\162\164" => "\x50\110\x50\105\170\143\145\x6c\x5f\x57\x72\x69\x74\145\x72\x5f\x45\x78\143\145\x6c\x32\60\60\67\x5f\x43\150\141\x72\x74", "\x72\x65\x6c\x73\166\142\x61" => "\120\110\120\x45\170\143\145\x6c\x5f\x57\162\x69\164\145\162\x5f\x45\170\143\145\x6c\62\60\x30\x37\137\122\145\154\x73\126\x42\x41", "\x72\x65\x6c\x73\162\151\x62\x62\x6f\x6e\157\142\x6a\145\x63\164\163" => "\x50\110\x50\105\170\143\145\154\x5f\x57\x72\151\x74\x65\162\137\105\x78\143\145\x6c\x32\60\60\x37\x5f\122\145\x6c\x73\x52\x69\142\x62\157\156"); goto hnCmV; hnCmV: foreach ($writerPartsArray as $writer => $class) { $this->writerParts[$writer] = new $class($this); } goto F5Oef; QqPs4: $this->setPHPExcel($pPHPExcel); goto r6UAj; F5Oef: $hashTablesArray = array("\163\164\171\x6c\x65\163\103\x6f\156\x64\151\164\x69\x6f\156\141\x6c\x48\141\163\x68\124\x61\142\154\x65", "\146\x69\154\154\110\141\x73\x68\x54\x61\x62\154\145", "\146\x6f\x6e\x74\x48\x61\x73\150\124\141\142\154\145", "\x62\x6f\x72\144\145\162\163\x48\x61\163\150\x54\141\x62\154\x65", "\156\x75\155\x46\x6d\x74\110\141\x73\150\124\141\x62\154\145", "\144\x72\141\x77\151\156\147\x48\x61\x73\x68\124\x61\142\154\145", "\163\164\x79\x6c\x65\x48\141\x73\x68\x54\x61\142\x6c\x65"); goto wd1W5; jGzv9: } public function getWriterPart($pPartName = '') { if ($pPartName != '' && isset($this->writerParts[strtolower($pPartName)])) { return $this->writerParts[strtolower($pPartName)]; } else { return null; } } public function save($pFilename = null) { if ($this->spreadSheet !== null) { goto Eucq2; HeUDT: $this->styleHashTable->addFromSource($this->getWriterPart("\x53\164\171\154\145")->allStyles($this->spreadSheet)); goto jiSgb; Eucq2: $this->spreadSheet->garbageCollect(); goto DLlME; b8Cyc: $objZip->addFromString("\x5b\103\157\x6e\164\145\x6e\164\x5f\124\x79\x70\x65\163\135\x2e\x78\155\154", $this->getWriterPart("\x43\x6f\156\164\145\x6e\x74\124\x79\160\x65\163")->writeContentTypes($this->spreadSheet, $this->includeCharts)); goto i7Sq1; ZLYsc: $saveDateReturnType = PHPExcel_Calculation_Functions::getReturnDateType(); goto h87jW; owycL: for ($i = 0; $i < $this->getDrawingHashTable()->count(); ++$i) { if ($this->getDrawingHashTable()->getByIndex($i) instanceof PHPExcel_Worksheet_Drawing) { goto i7X2Q; iI5_B: $objZip->addFromString("\x78\154\x2f\x6d\145\x64\151\x61\57" . str_replace("\40", "\137", $this->getDrawingHashTable()->getByIndex($i)->getIndexedFilename()), $imageContents); goto y76Nn; i7X2Q: $imageContents = null; goto Xi0yN; hr15D: if (strpos($imagePath, "\172\151\x70\x3a\57\57") !== false) { goto Gv71D; Gv71D: $imagePath = substr($imagePath, 6); goto SFG_x; hzZZs: $imageZip->open($imagePathSplitted[0]); goto JZgvN; JZgvN: $imageContents = $imageZip->getFromName($imagePathSplitted[1]); goto LeZQ0; I_odB: $imageZip = new ZipArchive(); goto hzZZs; rs3u2: unset($imageZip); goto kioQa; LeZQ0: $imageZip->close(); goto rs3u2; SFG_x: $imagePathSplitted = explode("\43", $imagePath); goto I_odB; kioQa: } else { $imageContents = file_get_contents($imagePath); } goto iI5_B; Xi0yN: $imagePath = $this->getDrawingHashTable()->getByIndex($i)->getPath(); goto hr15D; y76Nn: } elseif ($this->getDrawingHashTable()->getByIndex($i) instanceof PHPExcel_Worksheet_MemoryDrawing) { goto FYleW; CFz_e: $objZip->addFromString("\x78\x6c\57\x6d\x65\144\x69\x61\x2f" . str_replace("\x20", "\137", $this->getDrawingHashTable()->getByIndex($i)->getIndexedFilename()), $imageContents); goto Tboul; uCJeU: call_user_func($this->getDrawingHashTable()->getByIndex($i)->getRenderingFunction(), $this->getDrawingHashTable()->getByIndex($i)->getImageResource()); goto Voe3j; lGU7w: ob_end_clean(); goto CFz_e; Voe3j: $imageContents = ob_get_contents(); goto lGU7w; FYleW: ob_start(); goto uCJeU; Tboul: } } goto HFmgI; KCZuD: if ($customPropertiesPart !== null) { $objZip->addFromString("\x64\x6f\x63\120\x72\157\x70\x73\57\143\165\163\164\x6f\155\56\170\155\154", $customPropertiesPart); } goto VK5bE; UizFi: $objZip->addFromString("\x78\154\57\x73\164\171\x6c\x65\163\x2e\170\x6d\x6c", $this->getWriterPart("\x53\164\x79\154\x65")->writeStyles($this->spreadSheet)); goto onAz3; tW4dI: for ($i = 0; $i < $this->spreadSheet->getSheetCount(); ++$i) { $objZip->addFromString("\170\x6c\x2f\167\x6f\x72\153\x73\x68\145\145\x74\163\57\x73\150\145\x65\x74" . ($i + 1) . "\x2e\x78\x6d\154", $this->getWriterPart("\x57\x6f\x72\x6b\x73\150\x65\145\x74")->writeWorksheet($this->spreadSheet->getSheet($i), $this->stringTable, $this->includeCharts)); if ($this->includeCharts) { $charts = $this->spreadSheet->getSheet($i)->getChartCollection(); if (count($charts) > 0) { foreach ($charts as $chart) { $objZip->addFromString("\x78\x6c\57\143\x68\x61\162\x74\163\x2f\x63\150\x61\162\x74" . ($chartCount + 1) . "\56\x78\155\154", $this->getWriterPart("\103\150\x61\162\164")->writeChart($chart, $this->preCalculateFormulas)); $chartCount++; } } } } goto iBYld; NrzWH: $objZip->addFromString("\x64\x6f\x63\x50\x72\x6f\x70\163\57\143\157\162\x65\x2e\x78\155\154", $this->getWriterPart("\x44\x6f\x63\x50\162\x6f\160\x73")->writeDocPropsCore($this->spreadSheet)); goto yfdT3; k8eKQ: $zipCreate = $ro->getConstant("\103\x52\x45\x41\124\105"); goto sLkS0; AdjHX: if ($objZip->open($pFilename, $zipOverWrite) !== true) { if ($objZip->open($pFilename, $zipCreate) !== true) { throw new PHPExcel_Writer_Exception("\103\157\165\x6c\144\x20\156\x6f\x74\40\157\x70\145\156\40" . $pFilename . "\40\x66\x6f\x72\x20\167\162\x69\164\x69\x6e\147\56"); } } goto b8Cyc; HFmgI: PHPExcel_Calculation_Functions::setReturnDateType($saveDateReturnType); goto g850s; DLlME: $originalFilename = $pFilename; goto HzxnU; i7Sq1: if ($this->spreadSheet->hasMacros()) { $macrosCode = $this->spreadSheet->getMacrosCode(); if (!is_null($macrosCode)) { $objZip->addFromString("\x78\x6c\x2f\166\142\141\x50\x72\x6f\x6a\145\143\x74\x2e\x62\x69\x6e", $macrosCode); if ($this->spreadSheet->hasMacrosCertificate()) { $objZip->addFromString("\170\x6c\57\x76\142\x61\x50\162\157\x6a\145\143\x74\x53\x69\x67\156\x61\164\x75\x72\145\x2e\142\x69\x6e", $this->spreadSheet->getMacrosCertificate()); $objZip->addFromString("\170\154\57\137\x72\x65\x6c\163\57\x76\142\x61\120\162\157\x6a\145\143\164\x2e\x62\x69\x6e\x2e\162\145\x6c\163", $this->getWriterPart("\122\x65\x6c\163\126\102\x41")->writeVBARelationships($this->spreadSheet)); } } } goto yEbOD; XkBAC: for ($i = 0; $i < $this->spreadSheet->getSheetCount(); ++$i) { $objZip->addFromString("\170\154\57\x77\x6f\x72\153\x73\150\x65\x65\164\x73\x2f\137\x72\x65\x6c\x73\57\x73\150\145\145\164" . ($i + 1) . "\56\x78\155\x6c\56\162\145\x6c\163", $this->getWriterPart("\x52\x65\x6c\163")->writeWorksheetRelationships($this->spreadSheet->getSheet($i), $i + 1, $this->includeCharts)); $drawings = $this->spreadSheet->getSheet($i)->getDrawingCollection(); $drawingCount = count($drawings); if ($this->includeCharts) { $chartCount = $this->spreadSheet->getSheet($i)->getChartCount(); } if ($drawingCount > 0 || $chartCount > 0) { $objZip->addFromString("\x78\154\57\144\162\141\x77\151\156\x67\163\57\137\162\145\154\x73\x2f\x64\162\141\x77\151\x6e\147" . ($i + 1) . "\x2e\x78\155\x6c\x2e\162\145\x6c\x73", $this->getWriterPart("\122\145\154\x73")->writeDrawingRelationships($this->spreadSheet->getSheet($i), $chartRef1, $this->includeCharts)); $objZip->addFromString("\170\154\x2f\x64\162\141\x77\151\156\147\x73\x2f\x64\162\x61\x77\x69\156\x67" . ($i + 1) . "\x2e\x78\x6d\154", $this->getWriterPart("\104\162\x61\x77\x69\x6e\147")->writeDrawings($this->spreadSheet->getSheet($i), $chartRef2, $this->includeCharts)); } if (count($this->spreadSheet->getSheet($i)->getComments()) > 0) { $objZip->addFromString("\x78\x6c\57\x64\162\x61\167\151\x6e\147\163\x2f\166\155\x6c\x44\162\141\167\x69\x6e\x67" . ($i + 1) . "\x2e\166\x6d\154", $this->getWriterPart("\103\x6f\x6d\x6d\x65\156\164\x73")->writeVMLComments($this->spreadSheet->getSheet($i))); $objZip->addFromString("\170\154\x2f\143\x6f\155\155\145\156\164\163" . ($i + 1) . "\x2e\170\155\154", $this->getWriterPart("\x43\157\155\x6d\x65\156\x74\x73")->writeComments($this->spreadSheet->getSheet($i))); } if (count($this->spreadSheet->getSheet($i)->getHeaderFooter()->getImages()) > 0) { goto QHmFM; FjTIb: $objZip->addFromString("\x78\154\57\x64\x72\141\x77\151\156\x67\x73\57\137\162\145\154\163\57\x76\x6d\x6c\104\162\141\x77\151\x6e\x67\x48\x46" . ($i + 1) . "\x2e\x76\155\x6c\x2e\162\145\154\163", $this->getWriterPart("\122\145\154\163")->writeHeaderFooterDrawingRelationships($this->spreadSheet->getSheet($i))); goto hK8KX; hK8KX: foreach ($this->spreadSheet->getSheet($i)->getHeaderFooter()->getImages() as $image) { $objZip->addFromString("\170\154\x2f\x6d\145\144\151\x61\57" . $image->getIndexedFilename(), file_get_contents($image->getPath())); } goto Bz2TF; QHmFM: $objZip->addFromString("\170\154\x2f\144\x72\x61\x77\151\156\147\163\x2f\x76\155\154\x44\162\141\167\x69\x6e\147\x48\106" . ($i + 1) . "\56\x76\x6d\154", $this->getWriterPart("\x44\x72\141\167\151\x6e\147")->writeVMLHeaderFooterImages($this->spreadSheet->getSheet($i))); goto FjTIb; Bz2TF: } } goto owycL; onAz3: $objZip->addFromString("\x78\x6c\57\x77\x6f\x72\153\x62\157\x6f\x6b\x2e\x78\x6d\x6c", $this->getWriterPart("\127\157\x72\x6b\x62\157\157\x6b")->writeWorkbook($this->spreadSheet, $this->preCalculateFormulas)); goto xbo2X; sLkS0: if (file_exists($pFilename)) { unlink($pFilename); } goto AdjHX; yEbOD: if ($this->spreadSheet->hasRibbon()) { goto TK5IW; won0N: $objZip->addFromString($tmpRibbonTarget, $this->spreadSheet->getRibbonXMLData("\x64\x61\164\x61")); goto OCUlM; OCUlM: if ($this->spreadSheet->hasRibbonBinObjects()) { goto ywquk; dtsqr: $objZip->addFromString($tmpRootPath . "\137\162\145\154\x73\57" . basename($tmpRibbonTarget) . "\56\162\145\x6c\x73", $this->getWriterPart("\x52\145\x6c\x73\122\151\x62\142\157\x6e\x4f\x62\x6a\x65\143\x74\x73")->writeRibbonRelationships($this->spreadSheet)); goto vVoW4; Z2URT: $ribbonBinObjects = $this->spreadSheet->getRibbonBinObjects("\x64\141\x74\141"); goto KE28s; KE28s: foreach ($ribbonBinObjects as $aPath => $aContent) { $objZip->addFromString($tmpRootPath . $aPath, $aContent); } goto dtsqr; ywquk: $tmpRootPath = dirname($tmpRibbonTarget) . "\x2f"; goto Z2URT; vVoW4: } goto Za3J7; TK5IW: $tmpRibbonTarget = $this->spreadSheet->getRibbonXMLData("\164\141\162\x67\x65\164"); goto won0N; Za3J7: } goto xNAUT; yfdT3: $customPropertiesPart = $this->getWriterPart("\x44\157\x63\120\x72\x6f\160\x73")->writeDocPropsCustom($this->spreadSheet); goto KCZuD; x3lcu: $this->fillHashTable->addFromSource($this->getWriterPart("\x53\164\x79\x6c\145")->allFills($this->spreadSheet)); goto UR4Al; vtaQj: $objZip = new $zipClass(); goto UBXAY; fZEAO: $this->drawingHashTable->addFromSource($this->getWriterPart("\104\162\141\167\151\x6e\x67")->allDrawings($this->spreadSheet)); goto gKoi4; jiSgb: $this->stylesConditionalHashTable->addFromSource($this->getWriterPart("\123\164\171\x6c\x65")->allConditionalStyles($this->spreadSheet)); goto x3lcu; rPzwX: if ($objZip->close() === false) { throw new PHPExcel_Writer_Exception("\x43\157\x75\154\144\40\x6e\157\164\40\143\154\x6f\x73\x65\40\x7a\x69\160\x20\146\151\x6c\145\x20{$pFilename}\56"); } goto CngjI; ejOZV: $this->bordersHashTable->addFromSource($this->getWriterPart("\123\164\x79\154\x65")->allBorders($this->spreadSheet)); goto MamLt; HhzW0: $objZip->addFromString("\170\x6c\57\137\162\145\154\x73\x2f\x77\157\162\x6b\142\157\157\153\x2e\170\x6d\154\x2e\162\145\x6c\163", $this->getWriterPart("\x52\x65\x6c\x73")->writeWorkbookRelationships($this->spreadSheet)); goto pBQgH; pBQgH: $objZip->addFromString("\144\x6f\143\120\x72\157\160\163\x2f\x61\160\x70\56\170\x6d\x6c", $this->getWriterPart("\x44\x6f\143\120\162\157\160\163")->writeDocPropsApp($this->spreadSheet)); goto NrzWH; HzxnU: if (strtolower($pFilename) == "\160\x68\x70\x3a\x2f\x2f\x6f\x75\164\160\x75\x74" || strtolower($pFilename) == "\160\150\x70\x3a\57\x2f\163\x74\144\x6f\165\x74") { $pFilename = @tempnam(PHPExcel_Shared_File::sys_get_temp_dir(), "\160\150\160\x78\x6c\x74\x6d\x70"); if ($pFilename == '') { $pFilename = $originalFilename; } } goto dt8yg; FgKbo: PHPExcel_Calculation::getInstance($this->spreadSheet)->getDebugLog()->setWriteDebugLog(false); goto ZLYsc; xNAUT: $objZip->addFromString("\x5f\x72\145\x6c\163\x2f\x2e\162\145\154\x73", $this->getWriterPart("\x52\x65\x6c\163")->writeRelationships($this->spreadSheet)); goto HhzW0; UBXAY: $ro = new ReflectionObject($objZip); goto jL3C1; UR4Al: $this->fontHashTable->addFromSource($this->getWriterPart("\123\x74\171\x6c\x65")->allFonts($this->spreadSheet)); goto ejOZV; jL3C1: $zipOverWrite = $ro->getConstant("\x4f\x56\x45\x52\127\122\111\124\x45"); goto k8eKQ; F2spl: $this->stringTable = array(); goto RqM32; g850s: PHPExcel_Calculation::getInstance($this->spreadSheet)->getDebugLog()->setWriteDebugLog($saveDebugLog); goto rPzwX; MamLt: $this->numFmtHashTable->addFromSource($this->getWriterPart("\x53\x74\171\154\x65")->allNumberFormats($this->spreadSheet)); goto fZEAO; dt8yg: $saveDebugLog = PHPExcel_Calculation::getInstance($this->spreadSheet)->getDebugLog()->getWriteDebugLog(); goto FgKbo; RqM32: for ($i = 0; $i < $this->spreadSheet->getSheetCount(); ++$i) { $this->stringTable = $this->getWriterPart("\x53\164\x72\151\156\x67\x54\x61\142\x6c\x65")->createStringTable($this->spreadSheet->getSheet($i), $this->stringTable); } goto HeUDT; h87jW: PHPExcel_Calculation_Functions::setReturnDateType(PHPExcel_Calculation_Functions::RETURNDATE_EXCEL); goto F2spl; CngjI: if ($originalFilename != $pFilename) { if (copy($pFilename, $originalFilename) === false) { throw new PHPExcel_Writer_Exception("\103\x6f\x75\x6c\144\x20\x6e\x6f\164\40\143\157\160\x79\x20\164\x65\155\160\157\x72\x61\x72\x79\x20\x7a\x69\160\x20\x66\x69\x6c\x65\x20{$pFilename}\40\x74\157\40{$originalFilename}\56"); } @unlink($pFilename); } goto B47FT; xbo2X: $chartCount = 0; goto tW4dI; ZLj28: $objZip->addFromString("\170\154\57\163\150\141\162\x65\x64\x53\164\x72\x69\x6e\147\163\56\170\x6d\x6c", $this->getWriterPart("\x53\164\x72\x69\156\147\x54\141\142\154\145")->writeStringTable($this->stringTable)); goto UizFi; VK5bE: $objZip->addFromString("\x78\x6c\x2f\x74\150\x65\x6d\145\57\x74\150\145\155\x65\61\56\x78\155\x6c", $this->getWriterPart("\x54\x68\x65\155\145")->writeTheme($this->spreadSheet)); goto ZLj28; gKoi4: $zipClass = PHPExcel_Settings::getZipClass(); goto vtaQj; iBYld: $chartRef1 = $chartRef2 = 0; goto XkBAC; B47FT: } else { throw new PHPExcel_Writer_Exception("\120\110\120\105\170\x63\x65\x6c\40\x6f\x62\152\145\143\x74\40\x75\156\141\x73\x73\x69\x67\x6e\x65\144\x2e"); } } public function getPHPExcel() { if ($this->spreadSheet !== null) { return $this->spreadSheet; } else { throw new PHPExcel_Writer_Exception("\x4e\157\40\120\x48\120\105\x78\x63\145\x6c\40\157\x62\x6a\145\143\164\40\x61\x73\163\151\x67\156\145\144\56"); } } public function setPHPExcel(PHPExcel $pPHPExcel = null) { $this->spreadSheet = $pPHPExcel; return $this; } public function getStringTable() { return $this->stringTable; } public function getStyleHashTable() { return $this->styleHashTable; } public function getStylesConditionalHashTable() { return $this->stylesConditionalHashTable; } public function getFillHashTable() { return $this->fillHashTable; } public function getFontHashTable() { return $this->fontHashTable; } public function getBordersHashTable() { return $this->bordersHashTable; } public function getNumFmtHashTable() { return $this->numFmtHashTable; } public function getDrawingHashTable() { return $this->drawingHashTable; } public function getOffice2003Compatibility() { return $this->office2003compatibility; } public function setOffice2003Compatibility($pValue = false) { $this->office2003compatibility = $pValue; return $this; } }
