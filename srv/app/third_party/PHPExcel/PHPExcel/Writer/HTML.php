<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:07              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Writer_HTML extends PHPExcel_Writer_Abstract implements PHPExcel_Writer_IWriter { protected $phpExcel; private $sheetIndex = 0; private $imagesRoot = "\56"; private $embedImages = false; private $useInlineCss = false; private $cssStyles; private $columnWidths; private $defaultFont; private $spansAreCalculated = false; private $isSpannedCell = array(); private $isBaseCell = array(); private $isSpannedRow = array(); protected $isPdf = false; private $generateSheetNavigationBlock = true; public function __construct(PHPExcel $phpExcel) { $this->phpExcel = $phpExcel; $this->defaultFont = $this->phpExcel->getDefaultStyle()->getFont(); } public function save($pFilename = null) { goto pZXNl; Cg7y0: fwrite($fileHandle, $this->generateSheetData()); goto s8KEK; hCAPh: $saveDebugLog = PHPExcel_Calculation::getInstance($this->phpExcel)->getDebugLog()->getWriteDebugLog(); goto dLuiw; s8KEK: fwrite($fileHandle, $this->generateHTMLFooter()); goto fKn1Q; dLuiw: PHPExcel_Calculation::getInstance($this->phpExcel)->getDebugLog()->setWriteDebugLog(false); goto iWiWH; A1uyQ: $fileHandle = fopen($pFilename, "\x77\142\53"); goto Kh2nI; w9ln2: PHPExcel_Calculation::setArrayReturnType(PHPExcel_Calculation::RETURN_ARRAY_AS_VALUE); goto BOysu; Ur7U0: PHPExcel_Calculation::getInstance($this->phpExcel)->getDebugLog()->setWriteDebugLog($saveDebugLog); goto ReC39; iNbTG: if (!$this->isPdf && $this->generateSheetNavigationBlock) { fwrite($fileHandle, $this->generateNavigation()); } goto Cg7y0; iWiWH: $saveArrayReturnType = PHPExcel_Calculation::getArrayReturnType(); goto w9ln2; fKn1Q: fclose($fileHandle); goto f141V; BOysu: $this->buildCSS(!$this->useInlineCss); goto A1uyQ; pZXNl: $this->phpExcel->garbageCollect(); goto hCAPh; JU1oF: fwrite($fileHandle, $this->generateHTMLHeader(!$this->useInlineCss)); goto iNbTG; Kh2nI: if ($fileHandle === false) { throw new PHPExcel_Writer_Exception("\x43\x6f\165\154\x64\x20\156\x6f\164\x20\157\x70\145\x6e\x20\x66\x69\154\145\x20{$pFilename}\40\146\157\x72\x20\167\x72\151\164\151\156\x67\x2e"); } goto JU1oF; f141V: PHPExcel_Calculation::setArrayReturnType($saveArrayReturnType); goto Ur7U0; ReC39: } private function mapVAlign($vAlign) { switch ($vAlign) { case PHPExcel_Style_Alignment::VERTICAL_BOTTOM: return "\142\x6f\x74\x74\x6f\155"; case PHPExcel_Style_Alignment::VERTICAL_TOP: return "\x74\157\x70"; case PHPExcel_Style_Alignment::VERTICAL_CENTER: case PHPExcel_Style_Alignment::VERTICAL_JUSTIFY: return "\155\x69\144\144\x6c\x65"; default: return "\x62\x61\x73\x65\154\x69\156\145"; } } private function mapHAlign($hAlign) { switch ($hAlign) { case PHPExcel_Style_Alignment::HORIZONTAL_GENERAL: return false; case PHPExcel_Style_Alignment::HORIZONTAL_LEFT: return "\154\x65\x66\164"; case PHPExcel_Style_Alignment::HORIZONTAL_RIGHT: return "\162\x69\147\150\164"; case PHPExcel_Style_Alignment::HORIZONTAL_CENTER: case PHPExcel_Style_Alignment::HORIZONTAL_CENTER_CONTINUOUS: return "\143\x65\x6e\x74\x65\162"; case PHPExcel_Style_Alignment::HORIZONTAL_JUSTIFY: return "\152\165\x73\x74\151\x66\171"; default: return false; } } private function mapBorderStyle($borderStyle) { switch ($borderStyle) { case PHPExcel_Style_Border::BORDER_NONE: return "\x6e\x6f\x6e\145"; case PHPExcel_Style_Border::BORDER_DASHDOT: return "\61\160\x78\x20\x64\x61\163\x68\145\144"; case PHPExcel_Style_Border::BORDER_DASHDOTDOT: return "\61\160\170\40\144\157\x74\x74\x65\x64"; case PHPExcel_Style_Border::BORDER_DASHED: return "\x31\160\170\40\x64\x61\163\x68\145\144"; case PHPExcel_Style_Border::BORDER_DOTTED: return "\61\x70\170\x20\144\x6f\x74\164\x65\x64"; case PHPExcel_Style_Border::BORDER_DOUBLE: return "\63\x70\x78\40\x64\x6f\165\142\x6c\145"; case PHPExcel_Style_Border::BORDER_HAIR: return "\61\160\x78\x20\x73\x6f\x6c\151\144"; case PHPExcel_Style_Border::BORDER_MEDIUM: return "\x32\x70\170\x20\x73\x6f\154\x69\x64"; case PHPExcel_Style_Border::BORDER_MEDIUMDASHDOT: return "\62\x70\x78\40\x64\141\x73\x68\x65\x64"; case PHPExcel_Style_Border::BORDER_MEDIUMDASHDOTDOT: return "\62\x70\170\40\x64\157\164\164\145\x64"; case PHPExcel_Style_Border::BORDER_MEDIUMDASHED: return "\x32\160\170\x20\144\x61\163\x68\x65\x64"; case PHPExcel_Style_Border::BORDER_SLANTDASHDOT: return "\x32\160\170\x20\144\141\163\x68\145\144"; case PHPExcel_Style_Border::BORDER_THICK: return "\63\160\x78\x20\163\x6f\x6c\151\144"; case PHPExcel_Style_Border::BORDER_THIN: return "\x31\160\170\40\163\x6f\154\x69\144"; default: return "\61\160\x78\x20\163\157\154\x69\x64"; } } public function getSheetIndex() { return $this->sheetIndex; } public function setSheetIndex($pValue = 0) { $this->sheetIndex = $pValue; return $this; } public function getGenerateSheetNavigationBlock() { return $this->generateSheetNavigationBlock; } public function setGenerateSheetNavigationBlock($pValue = true) { $this->generateSheetNavigationBlock = (bool) $pValue; return $this; } public function writeAllSheets() { $this->sheetIndex = null; return $this; } public function generateHTMLHeader($pIncludeStyles = false) { goto Z2hkZ; Frd0e: if ($properties->getCategory() > '') { $html .= "\x20\x20\x20\x20\x20\40\x3c\155\x65\x74\141\40\x6e\141\155\x65\75\42\x63\141\x74\145\147\x6f\162\x79\42\x20\x63\x6f\x6e\x74\145\156\x74\x3d\x22" . htmlspecialchars($properties->getCategory()) . "\x22\40\57\x3e" . PHP_EOL; } goto Kvwy3; sLe3z: $properties = $this->phpExcel->getProperties(); goto B61Wt; tKPe7: $html .= "\x3c\150\x74\155\154\76" . PHP_EOL; goto tndRu; Z2hkZ: if (is_null($this->phpExcel)) { throw new PHPExcel_Writer_Exception("\111\x6e\x74\x65\162\x6e\141\154\40\120\x48\120\x45\170\x63\x65\154\40\157\142\x6a\x65\x63\x74\x20\156\157\164\x20\163\145\x74\x20\x74\157\x20\x61\x6e\x20\151\156\x73\164\141\x6e\143\x65\x20\157\x66\40\x61\156\40\157\142\x6a\145\x63\164\56"); } goto sLe3z; TkGBr: if ($properties->getCreator() > '') { $html .= "\40\40\x20\40\40\x20\74\x6d\145\164\x61\40\x6e\141\x6d\145\75\x22\141\165\164\x68\157\162\42\40\x63\x6f\156\164\145\156\164\x3d\x22" . htmlspecialchars($properties->getCreator()) . "\42\x20\57\76" . PHP_EOL; } goto H6Zmn; kf2sb: if ($properties->getTitle() > '') { $html .= "\x20\x20\40\x20\x20\x20\x3c\164\151\164\x6c\x65\76" . htmlspecialchars($properties->getTitle()) . "\x3c\x2f\164\x69\164\x6c\x65\x3e" . PHP_EOL; } goto TkGBr; qr9vc: if ($properties->getSubject() > '') { $html .= "\x20\x20\40\40\x20\x20\x3c\155\145\x74\x61\x20\x6e\x61\x6d\145\x3d\42\163\165\x62\152\x65\x63\x74\x22\40\143\x6f\156\164\145\x6e\164\75\42" . htmlspecialchars($properties->getSubject()) . "\42\40\57\76" . PHP_EOL; } goto lwXCM; lwXCM: if ($properties->getKeywords() > '') { $html .= "\x20\x20\x20\x20\x20\40\74\x6d\145\164\141\x20\156\x61\155\x65\75\x22\153\145\x79\167\x6f\162\x64\x73\x22\40\143\157\156\x74\145\x6e\164\75\42" . htmlspecialchars($properties->getKeywords()) . "\x22\40\x2f\x3e" . PHP_EOL; } goto Frd0e; tuiKf: if ($pIncludeStyles) { $html .= $this->generateStyles(true); } goto QI9dj; MTkfA: $html .= "\40\40\x20\x20\40\40\x3c\x6d\x65\164\x61\40\x68\x74\164\160\55\145\x71\165\x69\166\x3d\x22\103\x6f\156\x74\x65\156\x74\55\124\x79\160\x65\42\x20\143\157\156\164\x65\x6e\164\75\42\164\x65\x78\164\57\150\164\155\x6c\x3b\40\x63\x68\141\162\x73\145\x74\75\x75\x74\x66\x2d\70\x22\76" . PHP_EOL; goto kf2sb; r_jyi: if ($properties->getDescription() > '') { $html .= "\40\x20\x20\40\40\x20\x3c\155\145\164\141\40\156\141\155\x65\x3d\x22\144\145\163\143\162\x69\160\164\x69\157\x6e\x22\x20\143\x6f\x6e\x74\x65\156\164\75\x22" . htmlspecialchars($properties->getDescription()) . "\x22\40\57\x3e" . PHP_EOL; } goto qr9vc; q0p8H: $html .= '' . PHP_EOL; goto tEklK; B61Wt: $html = "\74\x21\104\117\x43\124\131\x50\x45\x20\x68\164\x6d\154\x20\120\125\x42\x4c\x49\103\40\42\55\57\x2f\x57\x33\103\x2f\x2f\104\x54\104\x20\x48\x54\x4d\114\40\x34\56\x30\61\x2f\57\105\x4e\x22\40\42\x68\x74\x74\160\x3a\x2f\57\x77\x77\x77\x2e\x77\x33\x2e\157\x72\x67\x2f\x54\x52\x2f\x68\x74\x6d\154\64\x2f\x73\x74\x72\x69\143\x74\56\x64\164\144\42\x3e" . PHP_EOL; goto PhlRm; Kvwy3: if ($properties->getCompany() > '') { $html .= "\x20\x20\40\40\40\40\74\x6d\145\x74\141\40\x6e\x61\x6d\145\75\42\x63\x6f\155\x70\x61\156\x79\42\40\143\157\156\x74\145\x6e\x74\x3d\42" . htmlspecialchars($properties->getCompany()) . "\42\x20\57\76" . PHP_EOL; } goto ajANn; tEklK: $html .= "\x20\40\74\x62\x6f\144\171\x3e" . PHP_EOL; goto Wz8te; tndRu: $html .= "\40\40\x3c\150\145\141\x64\76" . PHP_EOL; goto MTkfA; H6Zmn: if ($properties->getTitle() > '') { $html .= "\x20\x20\x20\x20\40\40\74\155\x65\x74\141\40\156\141\155\x65\75\42\164\x69\x74\154\x65\x22\x20\x63\x6f\x6e\164\x65\156\164\75\42" . htmlspecialchars($properties->getTitle()) . "\42\40\57\76" . PHP_EOL; } goto r_jyi; Wz8te: return $html; goto kxaTN; ajANn: if ($properties->getManager() > '') { $html .= "\x20\40\x20\x20\40\40\x3c\x6d\x65\x74\x61\40\x6e\x61\x6d\145\x3d\x22\x6d\x61\156\x61\147\145\162\42\x20\143\x6f\156\164\x65\x6e\164\x3d\x22" . htmlspecialchars($properties->getManager()) . "\42\40\57\x3e" . PHP_EOL; } goto tuiKf; PhlRm: $html .= "\74\x21\55\55\x20\107\x65\156\145\x72\x61\x74\x65\144\x20\x62\171\40\x50\x48\120\105\x78\143\x65\x6c\x20\55\40\150\164\164\x70\x3a\x2f\x2f\167\167\x77\x2e\160\150\x70\x65\x78\x63\145\x6c\56\x6e\x65\164\x20\55\x2d\76" . PHP_EOL; goto tKPe7; QI9dj: $html .= "\40\40\x3c\57\150\x65\141\x64\76" . PHP_EOL; goto q0p8H; kxaTN: } public function generateSheetData() { goto rcFe3; CFigo: if (is_null($this->sheetIndex)) { $sheets = $this->phpExcel->getAllSheets(); } else { $sheets[] = $this->phpExcel->getSheet($this->sheetIndex); } goto fCz7Y; rcFe3: if (is_null($this->phpExcel)) { throw new PHPExcel_Writer_Exception("\111\156\x74\x65\x72\156\x61\x6c\x20\120\x48\120\105\x78\143\x65\x6c\x20\x6f\142\152\145\143\164\x20\x6e\x6f\x74\x20\x73\x65\164\40\x74\157\x20\141\x6e\40\x69\156\163\164\141\x6e\143\x65\40\157\x66\40\x61\x6e\x20\157\142\x6a\145\x63\164\x2e"); } goto V59p0; xEbmm: $sheets = array(); goto CFigo; iROCu: foreach ($sheets as $sheet) { goto aM147; tQDhA: $dimension[1] = PHPExcel_Cell::coordinateFromString($dimension[1]); goto HGo6r; HfiDk: $html .= "\x20\40\40\40\40\40\x20\x20\74\x2f\x74\142\x6f\144\171\76" . PHP_EOL; goto H2p3t; bgPAZ: $row = $rowMin - 1; goto Sb83P; Sb83P: while ($row++ < $rowMax) { if ($row == $theadStart) { $html .= "\40\x20\x20\x20\40\x20\x20\40\74\x74\x68\x65\x61\x64\x3e" . PHP_EOL; $cellType = "\x74\150"; } if ($row == $tbodyStart) { $html .= "\40\40\40\x20\40\x20\40\40\x3c\x74\142\x6f\144\x79\76" . PHP_EOL; $cellType = "\x74\x64"; } if (!isset($this->isSpannedRow[$sheet->getParent()->getIndex($sheet)][$row])) { goto zI7RA; tqSjS: $column = $dimension[0][0] - 1; goto NzalW; zI7RA: $rowData = array(); goto tqSjS; NzalW: while ($column++ < $dimension[1][0]) { if ($sheet->cellExistsByColumnAndRow($column, $row)) { $rowData[$column] = PHPExcel_Cell::stringFromColumnIndex($column) . $row; } else { $rowData[$column] = ''; } } goto RCDss; RCDss: $html .= $this->generateRow($sheet, $rowData, $row - 1, $cellType); goto KpzlE; KpzlE: } if ($row == $theadEnd) { $html .= "\x20\x20\40\40\x20\40\40\x20\74\x2f\164\150\x65\x61\144\x3e" . PHP_EOL; } } goto mPXvo; A9twA: $theadStart = $theadEnd = 0; goto W2uEw; CZxkt: $dimension[0] = PHPExcel_Cell::coordinateFromString($dimension[0]); goto UZelh; aM147: $html .= $this->generateTableHeader($sheet); goto KkPvq; mPXvo: $html .= $this->extendRowsForChartsAndImages($sheet, $row); goto HfiDk; KkPvq: $dimension = explode("\72", $sheet->calculateWorksheetDimension()); goto CZxkt; UZelh: $dimension[0][0] = PHPExcel_Cell::columnIndexFromString($dimension[0][0]) - 1; goto tQDhA; dcg2V: if ($this->isPdf) { if (is_null($this->sheetIndex) && $sheetId + 1 < $this->phpExcel->getSheetCount()) { $html .= "\x3c\x64\x69\x76\x20\163\x74\171\154\145\75\42\x70\141\147\x65\x2d\142\162\145\x61\x6b\x2d\142\x65\x66\x6f\x72\145\x3a\x61\154\x77\141\171\163\x22\40\57\x3e"; } } goto CII7F; wX1ng: $tbodyStart = $rowMin; goto A9twA; W2uEw: if ($sheet->getPageSetup()->isRowsToRepeatAtTopSet()) { $rowsToRepeatAtTop = $sheet->getPageSetup()->getRowsToRepeatAtTop(); if ($rowsToRepeatAtTop[0] == 1) { goto CLXMX; jrL0G: $theadEnd = $rowsToRepeatAtTop[1]; goto luYVZ; luYVZ: $tbodyStart = $rowsToRepeatAtTop[1] + 1; goto VqnFA; CLXMX: $theadStart = $rowsToRepeatAtTop[0]; goto jrL0G; VqnFA: } } goto bgPAZ; CII7F: ++$sheetId; goto KIdmp; NQZaA: $rowMin = $dimension[0][1]; goto LgxLr; LgxLr: $rowMax = $dimension[1][1]; goto wX1ng; H2p3t: $html .= $this->generateTableFooter(); goto dcg2V; HGo6r: $dimension[1][0] = PHPExcel_Cell::columnIndexFromString($dimension[1][0]) - 1; goto NQZaA; KIdmp: } goto zoljV; V59p0: if ($this->sheetIndex !== null || !$this->spansAreCalculated) { $this->calculateSpans(); } goto xEbmm; zoljV: return $html; goto dbIwj; DZ62k: $sheetId = 0; goto iROCu; fCz7Y: $html = ''; goto DZ62k; dbIwj: } public function generateNavigation() { goto rcA8o; rcA8o: if (is_null($this->phpExcel)) { throw new PHPExcel_Writer_Exception("\x49\x6e\164\145\162\156\141\x6c\x20\x50\x48\120\105\170\143\x65\154\40\x6f\142\x6a\145\143\164\x20\156\x6f\x74\40\163\x65\x74\x20\164\x6f\40\x61\156\x20\x69\x6e\163\x74\141\x6e\143\145\40\x6f\x66\x20\x61\156\x20\x6f\x62\x6a\x65\143\x74\56"); } goto kwTPS; gYkN2: $html = ''; goto FfiOG; Fn1i2: if (is_null($this->sheetIndex)) { $sheets = $this->phpExcel->getAllSheets(); } else { $sheets[] = $this->phpExcel->getSheet($this->sheetIndex); } goto gYkN2; Pur56: return $html; goto oM_Je; kwTPS: $sheets = array(); goto Fn1i2; FfiOG: if (count($sheets) > 1) { goto Lz1ob; KP7ur: $html .= "\x3c\165\154\40\143\x6c\141\x73\x73\x3d\42\156\x61\166\x69\147\x61\x74\151\157\x6e\42\x3e" . PHP_EOL; goto W75WT; W75WT: foreach ($sheets as $sheet) { $html .= "\40\40\x3c\154\x69\40\143\x6c\x61\163\163\x3d\42\163\x68\x65\145\x74" . $sheetId . "\42\76\74\141\x20\150\162\145\146\x3d\x22\43\163\150\x65\145\164" . $sheetId . "\42\x3e" . $sheet->getTitle() . "\74\57\x61\76\74\x2f\154\151\76" . PHP_EOL; ++$sheetId; } goto B8Qz2; Lz1ob: $sheetId = 0; goto KP7ur; B8Qz2: $html .= "\x3c\57\165\154\76" . PHP_EOL; goto ElZnx; ElZnx: } goto Pur56; oM_Je: } private function extendRowsForChartsAndImages(PHPExcel_Worksheet $pSheet, $row) { goto YFzfi; NulNt: $colMax = "\x41"; goto tPs3g; ZP7gD: $html = ''; goto A44fi; HpTdQ: foreach ($pSheet->getDrawingCollection() as $drawing) { if ($drawing instanceof PHPExcel_Worksheet_Drawing) { goto e6KcC; e6KcC: $imageTL = PHPExcel_Cell::coordinateFromString($drawing->getCoordinates()); goto p2z5v; m3vYt: if ($imageTL[1] > $rowMax) { $rowMax = $imageTL[1]; if ($imageCol > PHPExcel_Cell::columnIndexFromString($colMax)) { $colMax = $imageTL[0]; } } goto u7VFC; p2z5v: $imageCol = PHPExcel_Cell::columnIndexFromString($imageTL[0]); goto m3vYt; u7VFC: } } goto ZP7gD; YFzfi: $rowMax = $row; goto NulNt; Z2vSi: return $html; goto m0Ms6; A44fi: $colMax++; goto oBX8k; oBX8k: while ($row <= $rowMax) { $html .= "\74\164\x72\x3e"; for ($col = "\101"; $col != $colMax; ++$col) { $html .= "\x3c\164\x64\x3e"; $html .= $this->writeImageInCell($pSheet, $col . $row); if ($this->includeCharts) { $html .= $this->writeChartInCell($pSheet, $col . $row); } $html .= "\x3c\57\164\x64\76"; } ++$row; $html .= "\x3c\57\164\x72\x3e"; } goto Z2vSi; tPs3g: if ($this->includeCharts) { foreach ($pSheet->getChartCollection() as $chart) { if ($chart instanceof PHPExcel_Chart) { goto Cr2N7; Cr2N7: $chartCoordinates = $chart->getTopLeftPosition(); goto T17qT; UWpyo: if ($chartTL[1] > $rowMax) { $rowMax = $chartTL[1]; if ($chartCol > PHPExcel_Cell::columnIndexFromString($colMax)) { $colMax = $chartTL[0]; } } goto S_Qv9; T17qT: $chartTL = PHPExcel_Cell::coordinateFromString($chartCoordinates["\143\x65\x6c\x6c"]); goto PhiJK; PhiJK: $chartCol = PHPExcel_Cell::columnIndexFromString($chartTL[0]); goto UWpyo; S_Qv9: } } } goto HpTdQ; m0Ms6: } private function writeImageInCell(PHPExcel_Worksheet $pSheet, $coordinates) { goto SoreU; Xa4AJ: foreach ($pSheet->getDrawingCollection() as $drawing) { if ($drawing instanceof PHPExcel_Worksheet_Drawing) { if ($drawing->getCoordinates() == $coordinates) { goto hEIfz; h9x54: $html .= "\74\151\155\147\x20\x73\164\171\x6c\x65\75\x22\160\157\163\x69\164\151\157\156\x3a\x20\141\x62\163\157\x6c\x75\x74\145\73\x20\172\x2d\x69\156\x64\145\x78\x3a\x20\x31\73\x20\x6c\x65\146\x74\x3a\40" . $drawing->getOffsetX() . "\160\170\x3b\x20\x74\157\x70\x3a\x20" . $drawing->getOffsetY() . "\160\x78\x3b\40\x77\151\144\x74\x68\72\x20" . $drawing->getWidth() . "\160\170\73\x20\150\x65\151\x67\150\164\x3a\40" . $drawing->getHeight() . "\160\170\73\x22\40\x73\x72\143\75\42" . $imageData . "\x22\x20\142\157\162\x64\x65\x72\x3d\x22\60\42\40\x2f\x3e"; goto CPzlZ; WFfAH: if (substr($filename, 0, 1) == "\56" && substr($filename, 0, 2) != "\56\57") { $filename = substr($filename, 1); } goto pKQos; rmk5I: $html .= PHP_EOL; goto GB0y9; GB0y9: if (!$this->embedImages || $this->isPdf) { $imageData = $filename; } else { $imageDetails = getimagesize($filename); if ($fp = fopen($filename, "\x72\x62", 0)) { goto m3pva; m3pva: $picture = fread($fp, filesize($filename)); goto o9t_c; v3dht: $base64 = chunk_split(base64_encode($picture)); goto FigGF; FigGF: $imageData = "\x64\x61\164\x61\x3a" . $imageDetails["\155\x69\155\x65"] . "\73\x62\141\163\145\66\64\x2c" . $base64; goto BHhjz; o9t_c: fclose($fp); goto v3dht; BHhjz: } else { $imageData = $filename; } } goto Dp1aw; CPzlZ: $html .= "\74\x2f\144\x69\x76\76"; goto glW76; MfQJZ: if (substr($filename, 0, 1) == "\x2e") { $filename = substr($filename, 1); } goto UabyV; pKQos: $filename = htmlspecialchars($filename); goto rmk5I; Dp1aw: $html .= "\74\x64\x69\166\x20\163\164\171\154\145\75\x22\x70\x6f\x73\151\164\x69\x6f\x6e\x3a\40\x72\145\x6c\x61\x74\151\x76\x65\x3b\x22\76"; goto h9x54; hEIfz: $filename = $drawing->getPath(); goto MfQJZ; UabyV: $filename = $this->getImagesRoot() . $filename; goto WFfAH; glW76: } } elseif ($drawing instanceof PHPExcel_Worksheet_MemoryDrawing) { goto OS6QR; OS6QR: if ($drawing->getCoordinates() != $coordinates) { continue; } goto WYo1Z; Jsn7V: ob_end_clean(); goto mPLqJ; mPLqJ: $dataUri = "\x64\141\164\141\x3a\x69\155\141\147\x65\57\152\x70\x65\x67\x3b\142\141\163\x65\66\x34\x2c" . base64_encode($contents); goto jMma6; EUlTv: $contents = ob_get_contents(); goto Jsn7V; WYo1Z: ob_start(); goto RxdYF; RxdYF: imagepng($drawing->getImageResource()); goto EUlTv; jMma6: $html .= "\74\x69\155\147\40\163\x72\x63\75\42" . $dataUri . "\x22\40\163\x74\x79\x6c\145\x3d\42\155\141\170\55\167\151\x64\164\x68\72\x31\x30\60\x25\73\x77\x69\x64\164\x68\72" . $drawing->getWidth() . "\x70\170\x3b\x22\x20\x2f\76"; goto T5030; T5030: } } goto ivET2; SoreU: $html = ''; goto Xa4AJ; ivET2: return $html; goto a8FdB; a8FdB: } private function writeChartInCell(PHPExcel_Worksheet $pSheet, $coordinates) { goto E00_C; u576U: return $html; goto k7KoJ; E00_C: $html = ''; goto KdjkK; KdjkK: foreach ($pSheet->getChartCollection() as $chart) { if ($chart instanceof PHPExcel_Chart) { $chartCoordinates = $chart->getTopLeftPosition(); if ($chartCoordinates["\143\145\x6c\x6c"] == $coordinates) { goto eQGg9; eQGg9: $chartFileName = PHPExcel_Shared_File::sys_get_temp_dir() . "\x2f" . uniqid() . "\56\x70\156\x67"; goto O3_vR; buJ9M: $html .= PHP_EOL; goto wSZk0; XG70T: if ($fp = fopen($chartFileName, "\162\x62", 0)) { goto wpy_y; brOdG: $html .= "\x3c\151\x6d\x67\x20\163\164\171\154\145\x3d\x22\160\157\163\x69\x74\151\157\x6e\x3a\40\141\142\163\x6f\154\165\164\145\x3b\40\x7a\x2d\151\156\144\145\170\72\40\x31\73\x20\x6c\145\x66\x74\x3a\x20" . $chartCoordinates["\x78\x4f\x66\x66\163\x65\164"] . "\160\170\73\x20\164\157\160\72\x20" . $chartCoordinates["\x79\x4f\146\x66\163\x65\x74"] . "\160\170\x3b\x20\x77\151\x64\164\150\72\x20" . $imageDetails[0] . "\x70\170\73\40\150\145\x69\147\x68\164\72\40" . $imageDetails[1] . "\x70\x78\x3b\42\40\163\162\143\75\x22" . $imageData . "\42\x20\142\x6f\x72\x64\x65\x72\75\42\60\x22\x20\57\x3e" . PHP_EOL; goto Jierq; Jierq: $html .= "\74\x2f\x64\151\166\x3e"; goto cliWh; cliWh: unlink($chartFileName); goto J1zQ0; wpy_y: $picture = fread($fp, filesize($chartFileName)); goto r8faL; MkRgZ: $html .= "\x3c\144\x69\166\x20\x73\x74\x79\x6c\145\x3d\x22\160\157\x73\151\x74\151\x6f\156\72\x20\162\145\x6c\141\x74\x69\166\x65\73\42\x3e"; goto brOdG; g3j41: $imageData = "\144\141\164\x61\72" . $imageDetails["\x6d\151\155\145"] . "\73\142\x61\163\x65\x36\64\54" . $base64; goto MkRgZ; InYIm: $base64 = chunk_split(base64_encode($picture)); goto g3j41; r8faL: fclose($fp); goto InYIm; J1zQ0: } goto oUKSp; wSZk0: $imageDetails = getimagesize($chartFileName); goto XG70T; O3_vR: if (!$chart->render($chartFileName)) { return; } goto buJ9M; oUKSp: } } } goto u576U; k7KoJ: } public function generateStyles($generateSurroundingHTML = true) { goto C47Yz; TtcV0: $html = ''; goto pcD3A; u2W6j: $css = $this->buildCSS($generateSurroundingHTML); goto TtcV0; pcD3A: if ($generateSurroundingHTML) { $html .= "\40\x20\40\x20\x3c\x73\164\x79\154\145\x20\x74\171\160\145\x3d\42\164\x65\x78\164\57\x63\163\x73\42\76" . PHP_EOL; $html .= "\40\x20\40\x20\x20\40\150\164\155\x6c\x20\173\x20" . $this->assembleCSS($css["\x68\164\x6d\154"]) . "\40\x7d" . PHP_EOL; } goto TY4PI; C47Yz: if (is_null($this->phpExcel)) { throw new PHPExcel_Writer_Exception("\x49\x6e\x74\145\162\x6e\141\x6c\x20\120\x48\120\105\x78\x63\145\x6c\x20\157\x62\152\145\143\164\x20\156\157\164\x20\x73\145\164\x20\164\157\40\x61\156\x20\151\x6e\x73\x74\141\x6e\143\145\x20\x6f\x66\40\x61\156\x20\x6f\142\152\x65\143\164\x2e"); } goto u2W6j; JL7AG: return $html; goto xdaCF; KeaBL: if ($generateSurroundingHTML) { $html .= "\40\x20\x20\x20\74\57\x73\164\171\154\x65\x3e" . PHP_EOL; } goto JL7AG; TY4PI: foreach ($css as $styleName => $styleDefinition) { if ($styleName != "\150\x74\x6d\154") { $html .= "\x20\40\40\40\40\40" . $styleName . "\40\x7b\x20" . $this->assembleCSS($styleDefinition) . "\x20\175" . PHP_EOL; } } goto KeaBL; xdaCF: } public function buildCSS($generateSurroundingHTML = true) { goto YPwF1; YPwF1: if (is_null($this->phpExcel)) { throw new PHPExcel_Writer_Exception("\x49\x6e\164\145\162\156\x61\154\x20\x50\110\x50\x45\x78\143\145\x6c\40\157\x62\x6a\145\143\164\x20\x6e\x6f\164\x20\163\x65\x74\x20\164\x6f\40\x61\x6e\40\151\x6e\163\164\x61\x6e\143\x65\x20\157\146\x20\x61\156\x20\x6f\x62\x6a\x65\x63\164\x2e"); } goto Sz_8o; mPPy9: foreach ($sheets as $sheet) { goto x08JU; CKXgj: $rowDimension = $sheet->getDefaultRowDimension(); goto OCwv3; VoxQv: $sheet->calculateColumnWidths(); goto NDyPj; bKbFR: foreach ($sheet->getColumnDimensions() as $columnDimension) { if (($width = PHPExcel_Shared_Drawing::cellDimensionToPixels($columnDimension->getWidth(), $this->defaultFont)) >= 0) { goto j3aX9; N_kwK: $css["\164\x61\142\154\145\x2e\163\x68\x65\145\x74" . $sheetIndex . "\40\x63\157\x6c\x2e\x63\x6f\x6c" . $column]["\x77\x69\x64\164\150"] = $width . "\x70\164"; goto E5zBG; z42jB: $this->columnWidths[$sheetIndex][$column] = $width; goto N_kwK; mW_9H: $column = PHPExcel_Cell::columnIndexFromString($columnDimension->getColumnIndex()) - 1; goto z42jB; E5zBG: if ($columnDimension->getVisible() === false) { $css["\x74\x61\142\x6c\x65\56\x73\x68\145\x65\164" . $sheetIndex . "\40\143\157\154\x2e\x63\x6f\x6c" . $column]["\166\x69\163\x69\142\151\x6c\x69\164\171"] = "\143\157\x6c\x6c\x61\160\x73\x65"; $css["\x74\141\142\154\145\56\163\x68\145\x65\164" . $sheetIndex . "\x20\143\x6f\154\56\143\157\x6c" . $column]["\x2a\144\x69\x73\160\x6c\x61\171"] = "\x6e\x6f\156\145"; } goto vDCuw; j3aX9: $width = PHPExcel_Shared_Drawing::pixelsToPoints($width); goto mW_9H; vDCuw: } } goto CKXgj; NDyPj: $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($sheet->getHighestColumn()) - 1; goto MeCh2; drOBH: while ($column++ < $highestColumnIndex) { $this->columnWidths[$sheetIndex][$column] = 42; $css["\x74\x61\142\154\x65\56\x73\150\x65\x65\x74" . $sheetIndex . "\x20\143\x6f\154\x2e\x63\157\x6c" . $column]["\x77\x69\144\x74\150"] = "\x34\x32\160\x74"; } goto bKbFR; xtbem: foreach ($sheet->getRowDimensions() as $rowDimension) { goto o5xTE; o5xTE: $row = $rowDimension->getRowIndex() - 1; goto u3WtL; HXeu4: $css["\164\x61\x62\154\145\56\163\150\x65\145\164" . $sheetIndex . "\x20\164\162\x2e\162\x6f\167" . $row]["\150\x65\x69\147\x68\164"] = $pt_height . "\160\x74"; goto pHr8X; u3WtL: $css["\164\x61\142\x6c\145\56\163\150\145\x65\x74" . $sheetIndex . "\x20\164\162\x2e\x72\x6f\167" . $row] = array(); goto ZFqmQ; ZFqmQ: if ($rowDimension->getRowHeight() == -1) { $pt_height = PHPExcel_Shared_Font::getDefaultRowHeightByFont($this->phpExcel->getDefaultStyle()->getFont()); } else { $pt_height = $rowDimension->getRowHeight(); } goto HXeu4; pHr8X: if ($rowDimension->getVisible() === false) { $css["\164\141\x62\154\145\56\x73\x68\x65\x65\x74" . $sheetIndex . "\40\164\x72\56\x72\x6f\x77" . $row]["\x64\151\x73\160\x6c\141\171"] = "\156\157\156\145"; $css["\x74\141\142\154\x65\56\x73\x68\x65\145\x74" . $sheetIndex . "\40\x74\x72\56\x72\157\167" . $row]["\166\151\163\151\x62\x69\x6c\x69\164\x79"] = "\x68\x69\144\x64\x65\156"; } goto FM6o1; FM6o1: } goto hjv97; OCwv3: $css["\x74\141\x62\x6c\145\x2e\x73\x68\145\145\164" . $sheetIndex . "\40\x74\162"] = array(); goto MXah8; MeCh2: $column = -1; goto drOBH; DvcMF: if ($rowDimension->getVisible() === false) { $css["\x74\141\x62\x6c\145\56\x73\150\145\145\164" . $sheetIndex . "\x20\164\x72"]["\144\151\x73\x70\x6c\141\171"] = "\x6e\157\x6e\x65"; $css["\x74\x61\142\x6c\x65\x2e\163\x68\x65\145\164" . $sheetIndex . "\x20\x74\162"]["\166\x69\x73\x69\142\151\154\x69\164\171"] = "\x68\x69\x64\144\x65\156"; } goto xtbem; x08JU: $sheetIndex = $sheet->getParent()->getIndex($sheet); goto VoxQv; MXah8: if ($rowDimension->getRowHeight() == -1) { $pt_height = PHPExcel_Shared_Font::getDefaultRowHeightByFont($this->phpExcel->getDefaultStyle()->getFont()); } else { $pt_height = $rowDimension->getRowHeight(); } goto OFiVQ; OFiVQ: $css["\164\x61\x62\x6c\x65\56\x73\x68\x65\145\x74" . $sheetIndex . "\40\x74\x72"]["\x68\x65\x69\x67\x68\x74"] = $pt_height . "\x70\164"; goto DvcMF; hjv97: } goto Eg2SN; Sz_8o: if (!is_null($this->cssStyles)) { return $this->cssStyles; } goto nrBmD; OT3MJ: $sheets = array(); goto F4BD_; nrBmD: if (!$this->spansAreCalculated) { $this->calculateSpans(); } goto xfSxu; Eg2SN: if (is_null($this->cssStyles)) { $this->cssStyles = $css; } goto ib9KA; gpRKu: $css["\56\x69\x6e\x6c\151\x6e\x65\123\x74\x72"]["\x74\145\170\x74\x2d\x61\154\151\x67\x6e"] = "\x6c\145\146\x74"; goto HT29m; b5qh8: if (!$this->isPdf) { $css["\164\x61\142\154\x65"]["\x70\x61\x67\145\55\142\162\x65\141\x6b\55\141\146\164\x65\162"] = "\x61\x6c\167\x61\x79\163"; } goto Z_z4Q; U8fKa: $css["\56\142"]["\164\x65\170\164\x2d\141\x6c\151\x67\x6e"] = "\x63\145\x6e\164\x65\x72"; goto N3dGK; HT29m: $css["\56\156"]["\x74\x65\x78\x74\55\x61\154\x69\x67\156"] = "\162\151\147\150\x74"; goto Nel2_; OKTmf: foreach ($this->phpExcel->getCellXfCollection() as $index => $style) { $css["\x74\144\56\163\164\x79\154\x65" . $index] = $this->createCSSStyle($style); $css["\x74\x68\x2e\x73\x74\x79\154\x65" . $index] = $this->createCSSStyle($style); } goto OT3MJ; l0kmE: $css["\56\x66"]["\x74\x65\x78\x74\x2d\x61\154\151\x67\x6e"] = "\162\151\x67\x68\164"; goto gpRKu; RfHho: $css["\x2e\147\162\x69\x64\154\x69\156\x65\x73\x20\164\150"]["\142\x6f\162\x64\x65\162"] = "\x31\x70\x78\x20\x64\157\164\164\x65\144\40\x62\x6c\141\x63\x6b"; goto U8fKa; Ifnnj: $css["\164\141\142\x6c\x65"]["\142\x6f\x72\x64\145\162\x2d\143\x6f\x6c\x6c\x61\160\x73\x65"] = "\143\x6f\154\x6c\141\x70\x73\145"; goto b5qh8; Z_z4Q: $css["\56\x67\x72\151\144\x6c\151\156\x65\163\40\164\144"]["\142\157\x72\144\x65\162"] = "\61\160\170\x20\144\x6f\164\164\x65\x64\40\142\x6c\x61\x63\x6b"; goto RfHho; ib9KA: return $css; goto Qgsc1; xfSxu: $css = array(); goto slJ8J; F4BD_: if (is_null($this->sheetIndex)) { $sheets = $this->phpExcel->getAllSheets(); } else { $sheets[] = $this->phpExcel->getSheet($this->sheetIndex); } goto mPPy9; N3dGK: $css["\56\x65"]["\164\x65\170\x74\x2d\x61\154\151\x67\x6e"] = "\x63\145\156\164\145\x72"; goto l0kmE; slJ8J: if ($generateSurroundingHTML) { goto OIrzk; YPwQC: $css["\x68\x74\155\154"]["\x66\157\x6e\x74\x2d\x73\x69\x7a\145"] = "\61\x31\160\164"; goto k_TJi; OIrzk: $css["\150\x74\155\x6c"]["\x66\157\156\x74\x2d\x66\141\x6d\x69\x6c\171"] = "\x43\x61\154\x69\x62\x72\x69\54\40\101\x72\x69\141\x6c\54\x20\x48\145\x6c\x76\145\x74\151\x63\141\x2c\40\163\x61\156\x73\x2d\x73\145\162\x69\146"; goto YPwQC; k_TJi: $css["\150\x74\x6d\154"]["\142\x61\x63\x6b\x67\x72\x6f\165\x6e\x64\55\143\157\154\157\x72"] = "\x77\150\151\x74\x65"; goto IslEn; IslEn: } goto Ifnnj; Nel2_: $css["\56\163"]["\x74\145\x78\x74\x2d\141\154\151\147\x6e"] = "\x6c\x65\x66\164"; goto OKTmf; Qgsc1: } private function createCSSStyle(PHPExcel_Style $pStyle) { goto HyLgP; HyLgP: $css = ''; goto JYCL1; mJBcb: return $css; goto itT1R; JYCL1: $css = array_merge($this->createCSSStyleAlignment($pStyle->getAlignment()), $this->createCSSStyleBorders($pStyle->getBorders()), $this->createCSSStyleFont($pStyle->getFont()), $this->createCSSStyleFill($pStyle->getFill())); goto mJBcb; itT1R: } private function createCSSStyleAlignment(PHPExcel_Style_Alignment $pStyle) { goto kuq3G; dByWy: $css["\x76\145\x72\x74\x69\143\x61\154\x2d\141\154\x69\147\156"] = $this->mapVAlign($pStyle->getVertical()); goto v6cae; v6cae: if ($textAlign = $this->mapHAlign($pStyle->getHorizontal())) { $css["\164\x65\170\x74\55\x61\x6c\x69\147\156"] = $textAlign; if (in_array($textAlign, array("\x6c\145\146\x74", "\162\151\x67\150\164"))) { $css["\160\141\x64\x64\x69\156\x67\x2d" . $textAlign] = (string) ((int) $pStyle->getIndent() * 9) . "\160\170"; } } goto I5KvS; kuq3G: $css = array(); goto dByWy; I5KvS: return $css; goto Cojzy; Cojzy: } private function createCSSStyleFont(PHPExcel_Style_Font $pStyle) { goto sTtBw; J0iet: return $css; goto o8OYB; sTtBw: $css = array(); goto fZ1Lr; fZ1Lr: if ($pStyle->getBold()) { $css["\x66\157\156\164\55\x77\x65\x69\x67\150\x74"] = "\x62\x6f\x6c\x64"; } goto M200b; zxVQz: $css["\143\x6f\154\x6f\162"] = "\x23" . $pStyle->getColor()->getRGB(); goto tlCnY; DCKPi: $css["\146\x6f\156\x74\x2d\x73\x69\172\x65"] = $pStyle->getSize() . "\x70\x74"; goto J0iet; c_jaV: if ($pStyle->getItalic()) { $css["\x66\157\x6e\x74\55\163\164\x79\x6c\x65"] = "\x69\164\x61\154\151\143"; } goto zxVQz; tlCnY: $css["\x66\x6f\156\x74\x2d\x66\141\x6d\151\x6c\171"] = "\x27" . $pStyle->getName() . "\47"; goto DCKPi; M200b: if ($pStyle->getUnderline() != PHPExcel_Style_Font::UNDERLINE_NONE && $pStyle->getStrikethrough()) { $css["\164\x65\170\x74\55\x64\x65\143\157\x72\x61\x74\x69\157\156"] = "\165\x6e\144\x65\x72\154\x69\156\x65\x20\x6c\x69\x6e\x65\x2d\164\x68\x72\157\x75\147\150"; } elseif ($pStyle->getUnderline() != PHPExcel_Style_Font::UNDERLINE_NONE) { $css["\164\x65\x78\164\x2d\x64\x65\x63\x6f\x72\x61\164\151\157\156"] = "\165\x6e\144\x65\162\154\151\x6e\145"; } elseif ($pStyle->getStrikethrough()) { $css["\x74\x65\170\164\x2d\144\145\x63\157\162\141\164\x69\x6f\x6e"] = "\x6c\x69\156\145\55\164\150\x72\x6f\165\147\150"; } goto c_jaV; o8OYB: } private function createCSSStyleBorders(PHPExcel_Style_Borders $pStyle) { goto XCV5I; WSpYv: $css["\142\157\162\x64\x65\162\x2d\x6c\145\146\164"] = $this->createCSSStyleBorder($pStyle->getLeft()); goto IFIJ3; gCdd5: $css["\142\157\162\x64\145\x72\55\x74\x6f\x70"] = $this->createCSSStyleBorder($pStyle->getTop()); goto WSpYv; IFIJ3: $css["\142\x6f\x72\144\145\162\55\162\x69\x67\150\x74"] = $this->createCSSStyleBorder($pStyle->getRight()); goto L4_SI; L4_SI: return $css; goto HWekJ; XNcwh: $css["\142\157\162\x64\145\162\x2d\x62\x6f\x74\164\157\x6d"] = $this->createCSSStyleBorder($pStyle->getBottom()); goto gCdd5; XCV5I: $css = array(); goto XNcwh; HWekJ: } private function createCSSStyleBorder(PHPExcel_Style_Border $pStyle) { goto mSM0z; xRa8u: $css = $borderStyle . "\40\43" . $pStyle->getColor()->getRGB() . ($borderStyle == "\156\x6f\156\x65" ? '' : "\x20\41\x69\155\160\157\x72\x74\x61\156\164"); goto EF2_p; EF2_p: return $css; goto Jo0Gb; mSM0z: $borderStyle = $this->mapBorderStyle($pStyle->getBorderStyle()); goto xRa8u; Jo0Gb: } private function createCSSStyleFill(PHPExcel_Style_Fill $pStyle) { goto M0pWc; K9sB1: return $css; goto y6hc_; NZ4cM: $css["\142\x61\x63\153\x67\x72\157\x75\x6e\144\x2d\143\157\x6c\x6f\162"] = $value; goto K9sB1; M0pWc: $css = array(); goto fd6XP; fd6XP: $value = $pStyle->getFillType() == PHPExcel_Style_Fill::FILL_NONE ? "\167\x68\151\x74\x65" : "\43" . $pStyle->getStartColor()->getRGB(); goto NZ4cM; y6hc_: } public function generateHTMLFooter() { goto xLX7g; Cgu9H: $html .= "\40\x20\74\57\x62\x6f\x64\x79\x3e" . PHP_EOL; goto B_mY8; ezNbO: return $html; goto p_xqb; B_mY8: $html .= "\74\57\x68\164\155\x6c\76" . PHP_EOL; goto ezNbO; xLX7g: $html = ''; goto Cgu9H; p_xqb: } private function generateTableHeader($pSheet) { goto t2mpz; o32qy: $i = -1; goto wClur; GqMyI: $html .= $this->setMargins($pSheet); goto wplui; t2mpz: $sheetIndex = $pSheet->getParent()->getIndex($pSheet); goto EjA9c; e10TZ: $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($pSheet->getHighestColumn()) - 1; goto o32qy; wplui: if (!$this->useInlineCss) { $gridlines = $pSheet->getShowGridlines() ? "\x20\147\162\x69\x64\x6c\x69\156\x65\x73" : ''; $html .= "\40\x20\x20\40\74\164\141\142\154\x65\40\x62\157\162\144\x65\x72\75\42\x30\x22\40\x63\145\x6c\x6c\160\x61\144\x64\151\x6e\x67\75\42\x30\42\40\143\145\154\x6c\163\x70\141\143\x69\156\147\75\x22\60\42\x20\x69\144\75\42\x73\x68\145\x65\x74" . $sheetIndex . "\x22\40\143\154\x61\163\163\x3d\42\163\x68\x65\x65\164" . $sheetIndex . $gridlines . "\x22\x3e" . PHP_EOL; } else { $style = isset($this->cssStyles["\x74\141\142\154\145"]) ? $this->assembleCSS($this->cssStyles["\x74\141\x62\x6c\x65"]) : ''; if ($this->isPdf && $pSheet->getShowGridlines()) { $html .= "\x20\x20\x20\x20\74\x74\x61\x62\154\145\x20\142\x6f\162\x64\145\x72\x3d\x22\61\42\40\143\145\154\x6c\x70\x61\144\144\x69\x6e\x67\75\42\x31\42\x20\151\x64\75\42\x73\150\x65\x65\x74" . $sheetIndex . "\42\40\x63\145\154\154\163\x70\x61\143\151\x6e\147\75\42\61\x22\40\x73\x74\x79\x6c\x65\x3d\42" . $style . "\42\76" . PHP_EOL; } else { $html .= "\x20\x20\x20\x20\x3c\164\141\x62\x6c\145\x20\142\x6f\x72\x64\145\x72\x3d\x22\60\x22\40\x63\x65\154\x6c\160\141\x64\144\x69\x6e\147\75\42\61\x22\40\151\x64\x3d\42\x73\x68\145\x65\x74" . $sheetIndex . "\42\40\143\x65\154\154\163\160\141\143\x69\x6e\147\x3d\42\60\x22\x20\x73\164\x79\x6c\x65\x3d\42" . $style . "\42\x3e" . PHP_EOL; } } goto e10TZ; EjA9c: $html = ''; goto GqMyI; wClur: while ($i++ < $highestColumnIndex) { if (!$this->isPdf) { if (!$this->useInlineCss) { $html .= "\40\40\40\40\40\40\40\x20\x3c\x63\157\154\40\143\154\141\x73\163\x3d\x22\143\x6f\154" . $i . "\42\x3e" . PHP_EOL; } else { $style = isset($this->cssStyles["\x74\x61\142\x6c\x65\56\x73\x68\x65\x65\x74" . $sheetIndex . "\x20\143\157\154\x2e\143\x6f\154" . $i]) ? $this->assembleCSS($this->cssStyles["\164\x61\x62\154\x65\56\163\150\145\145\164" . $sheetIndex . "\40\x63\157\154\56\143\157\x6c" . $i]) : ''; $html .= "\x20\40\40\40\x20\40\40\x20\74\x63\157\x6c\40\x73\x74\171\154\x65\x3d\x22" . $style . "\42\x3e" . PHP_EOL; } } } goto TS3B2; TS3B2: return $html; goto hPzHU; hPzHU: } private function generateTableFooter() { $html = "\40\40\x20\x20\74\x2f\x74\x61\x62\154\x65\x3e" . PHP_EOL; return $html; } private function generateRow(PHPExcel_Worksheet $pSheet, $pValues = null, $pRow = 0, $cellType = "\164\x64") { if (is_array($pValues)) { goto Zlljq; eS_Oe: if ($this->isPdf && count($pSheet->getBreaks()) > 0) { $breaks = $pSheet->getBreaks(); if (isset($breaks["\101" . $pRow])) { goto IFzE1; qoL_B: $html .= $this->generateTableHeader($pSheet); goto U8p85; IFzE1: $html .= $this->generateTableFooter(); goto pszki; pszki: $html .= "\74\x64\x69\166\x20\163\164\171\154\145\x3d\42\x70\x61\x67\x65\55\x62\162\145\141\153\x2d\142\x65\x66\x6f\162\x65\72\141\x6c\x77\141\171\x73\42\40\x2f\76"; goto qoL_B; U8p85: } } goto eMfY0; zeC03: foreach ($pValues as $cellAddress) { goto OEDqy; KMvJY: if (!$this->useInlineCss) { $cssClass = ''; $cssClass = "\143\157\x6c\165\x6d\x6e" . $colNum; } else { $cssClass = array(); if ($cellType == "\x74\150") { if (isset($this->cssStyles["\x74\x61\x62\x6c\145\x2e\x73\150\x65\x65\x74" . $sheetIndex . "\40\164\x68\56\143\x6f\x6c\165\155\x6e" . $colNum])) { $this->cssStyles["\164\141\x62\x6c\x65\x2e\x73\150\x65\x65\164" . $sheetIndex . "\40\x74\150\56\x63\x6f\x6c\165\155\x6e" . $colNum]; } } else { if (isset($this->cssStyles["\x74\x61\142\154\145\56\x73\x68\x65\x65\164" . $sheetIndex . "\40\164\x64\56\143\157\154\x75\x6d\x6e" . $colNum])) { $this->cssStyles["\x74\x61\142\154\145\x2e\x73\x68\145\145\164" . $sheetIndex . "\40\x74\x64\56\143\157\x6c\x75\155\156" . $colNum]; } } } goto hc1nb; kZtS7: if ($writeCell) { goto H3fTi; a8s3W: if ($rowSpan > 1) { $html .= "\40\x72\157\167\x73\x70\x61\156\x3d\x22" . $rowSpan . "\x22"; } goto FkRRX; cSL0M: $html .= "\74\57" . $cellType . "\76" . PHP_EOL; goto OIkRo; O0QvS: if ($colSpan > 1) { $html .= "\x20\x63\x6f\x6c\x73\x70\x61\156\75\42" . $colSpan . "\x22"; } goto a8s3W; KC57C: $html .= $this->writeImageInCell($pSheet, $coordinate); goto RmtGe; FkRRX: $html .= "\76"; goto KC57C; RmtGe: if ($this->includeCharts) { $html .= $this->writeChartInCell($pSheet, $coordinate); } goto L_o_i; JzfRH: if (!$this->useInlineCss) { $html .= "\40\143\x6c\141\163\163\x3d\x22" . $cssClass . "\42"; } else { goto BrKVT; xYG9c: $html .= "\x20\163\164\171\x6c\x65\x3d\42" . $this->assembleCSS($cssClass) . "\x22"; goto sI2NB; hgRn5: while ($i++ < $e) { if (isset($this->columnWidths[$sheetIndex][$i])) { $width += $this->columnWidths[$sheetIndex][$i]; } } goto zZyQ8; rKN_P: if (isset($this->cssStyles["\x74\x61\x62\154\145\x2e\163\x68\145\x65\164" . $sheetIndex . "\40\x74\x72\x2e\x72\157\167" . $pRow]["\150\x65\x69\147\150\x74"])) { $height = $this->cssStyles["\164\141\142\154\x65\x2e\x73\x68\x65\145\164" . $sheetIndex . "\x20\164\162\56\x72\x6f\167" . $pRow]["\x68\x65\x69\147\150\164"]; $cssClass["\150\145\x69\147\150\164"] = $height; } goto xYG9c; zZyQ8: $cssClass["\167\151\x64\x74\x68"] = $width . "\160\164"; goto rKN_P; djFpq: $i = $colNum - 1; goto XGkKY; BrKVT: $width = 0; goto djFpq; XGkKY: $e = $colNum + $colSpan - 1; goto hgRn5; sI2NB: } goto O0QvS; L_o_i: $html .= $cellData; goto cSL0M; H3fTi: $html .= "\x20\40\x20\40\x20\40\x20\x20\40\x20\40\x20\x3c" . $cellType; goto JzfRH; OIkRo: } goto QbURe; OEDqy: $cell = $cellAddress > '' ? $pSheet->getCell($cellAddress) : ''; goto Y4PJQ; NMP0K: if (isset($this->isBaseCell[$pSheet->getParent()->getIndex($pSheet)][$pRow + 1][$colNum])) { goto D0ACN; iHeVQ: $rowSpan = $spans["\162\x6f\167\x73\160\x61\x6e"]; goto im1Zc; YBs5J: $endCellCoord = PHPExcel_Cell::stringFromColumnIndex($colNum + $colSpan - 1) . ($pRow + $rowSpan); goto HActu; HActu: if (!$this->useInlineCss) { $cssClass .= "\40\x73\x74\x79\154\145" . $pSheet->getCell($endCellCoord)->getXfIndex(); } goto WsetK; im1Zc: $colSpan = $spans["\143\157\x6c\x73\x70\141\156"]; goto YBs5J; D0ACN: $spans = $this->isBaseCell[$pSheet->getParent()->getIndex($pSheet)][$pRow + 1][$colNum]; goto iHeVQ; WsetK: } goto kZtS7; UVJLt: $cellData = "\46\156\142\163\x70\73"; goto nGEzn; lLGJ5: $writeCell = !(isset($this->isSpannedCell[$pSheet->getParent()->getIndex($pSheet)][$pRow + 1][$colNum]) && $this->isSpannedCell[$pSheet->getParent()->getIndex($pSheet)][$pRow + 1][$colNum]); goto UNEWw; g4R3b: $rowSpan = 1; goto UVJLt; Y4PJQ: $coordinate = PHPExcel_Cell::stringFromColumnIndex($colNum) . ($pRow + 1); goto KMvJY; hc1nb: $colSpan = 1; goto g4R3b; QbURe: ++$colNum; goto QixKc; PlmNe: if ($pSheet->hyperlinkExists($coordinate) && !$pSheet->getHyperlink($coordinate)->isInternal()) { $cellData = "\74\x61\40\150\x72\145\x66\75\42" . htmlspecialchars($pSheet->getHyperlink($coordinate)->getUrl()) . "\x22\40\x74\x69\164\x6c\x65\75\x22" . htmlspecialchars($pSheet->getHyperlink($coordinate)->getTooltip()) . "\x22\76" . $cellData . "\74\57\141\76"; } goto lLGJ5; nGEzn: if ($cell instanceof PHPExcel_Cell) { goto PXf3K; b3z6y: $cellData = nl2br($cellData); goto hiB5U; PXf3K: $cellData = ''; goto mJ2d3; mJ2d3: if (is_null($cell->getParent())) { $cell->attach($pSheet); } goto MUimN; aPksA: $cellData = preg_replace("\x2f\50\77\155\x29\x28\x3f\72\136\x7c\134\x47\51\40\57", "\x26\x6e\x62\x73\x70\x3b", $cellData); goto b3z6y; MUimN: if ($cell->getValue() instanceof PHPExcel_RichText) { $elements = $cell->getValue()->getRichTextElements(); foreach ($elements as $element) { goto bvCaX; xK__j: if ($element instanceof PHPExcel_RichText_Run) { if ($element->getFont()->getSuperScript()) { $cellData .= "\74\57\163\165\160\x3e"; } elseif ($element->getFont()->getSubScript()) { $cellData .= "\x3c\57\163\165\142\76"; } $cellData .= "\x3c\x2f\163\160\141\x6e\76"; } goto d3qOb; OWrqA: $cellData .= htmlspecialchars($cellText); goto xK__j; bvCaX: if ($element instanceof PHPExcel_RichText_Run) { $cellData .= "\74\x73\x70\x61\x6e\x20\163\164\171\x6c\x65\75\x22" . $this->assembleCSS($this->createCSSStyleFont($element->getFont())) . "\x22\x3e"; if ($element->getFont()->getSuperScript()) { $cellData .= "\74\x73\x75\x70\x3e"; } elseif ($element->getFont()->getSubScript()) { $cellData .= "\74\x73\x75\142\x3e"; } } goto OmZY9; OmZY9: $cellText = $element->getText(); goto OWrqA; d3qOb: } } else { goto jWvd6; oM0QW: $cellData = htmlspecialchars($cellData); goto fp0O9; fp0O9: if ($pSheet->getParent()->getCellXfByIndex($cell->getXfIndex())->getFont()->getSuperScript()) { $cellData = "\x3c\x73\x75\160\76" . $cellData . "\74\x2f\163\x75\160\x3e"; } elseif ($pSheet->getParent()->getCellXfByIndex($cell->getXfIndex())->getFont()->getSubScript()) { $cellData = "\x3c\x73\x75\142\76" . $cellData . "\x3c\57\x73\x75\x62\x3e"; } goto Lq0fg; jWvd6: if ($this->preCalculateFormulas) { $cellData = PHPExcel_Style_NumberFormat::toFormattedString($cell->getCalculatedValue(), $pSheet->getParent()->getCellXfByIndex($cell->getXfIndex())->getNumberFormat()->getFormatCode(), array($this, "\x66\x6f\x72\155\141\x74\x43\157\154\157\x72")); } else { $cellData = PHPExcel_Style_NumberFormat::toFormattedString($cell->getValue(), $pSheet->getParent()->getCellXfByIndex($cell->getXfIndex())->getNumberFormat()->getFormatCode(), array($this, "\x66\x6f\162\155\x61\164\x43\157\154\x6f\162")); } goto oM0QW; Lq0fg: } goto aPksA; hiB5U: if (!$this->useInlineCss) { $cssClass .= "\40\x73\164\171\x6c\145" . $cell->getXfIndex(); $cssClass .= "\x20" . $cell->getDataType(); } else { goto X421L; shXR4: $sharedStyle = $pSheet->getParent()->getCellXfByIndex($cell->getXfIndex()); goto D7d91; D7d91: if ($sharedStyle->getAlignment()->getHorizontal() == PHPExcel_Style_Alignment::HORIZONTAL_GENERAL && isset($this->cssStyles["\56" . $cell->getDataType()]["\x74\145\x78\x74\55\x61\x6c\x69\x67\x6e"])) { $cssClass["\164\145\170\x74\55\141\154\151\147\x6e"] = $this->cssStyles["\56" . $cell->getDataType()]["\164\145\170\164\x2d\141\x6c\151\x67\x6e"]; } goto g_W2T; X421L: if ($cellType == "\164\150") { if (isset($this->cssStyles["\x74\x68\x2e\x73\x74\171\154\x65" . $cell->getXfIndex()])) { $cssClass = array_merge($cssClass, $this->cssStyles["\164\150\56\163\164\x79\154\x65" . $cell->getXfIndex()]); } } else { if (isset($this->cssStyles["\x74\144\x2e\x73\x74\x79\154\145" . $cell->getXfIndex()])) { $cssClass = array_merge($cssClass, $this->cssStyles["\x74\144\x2e\163\164\x79\x6c\145" . $cell->getXfIndex()]); } } goto shXR4; g_W2T: } goto sJ57Y; sJ57Y: } goto PlmNe; l1QB1: $rowspan = 1; goto NMP0K; UNEWw: $colspan = 1; goto l1QB1; QixKc: } goto F26mA; sueZ2: return $html; goto aj3vt; v1kdk: $sheetIndex = $pSheet->getParent()->getIndex($pSheet); goto eS_Oe; Zlljq: $html = ''; goto v1kdk; F26mA: $html .= "\x20\40\x20\x20\40\40\x20\x20\x20\x20\x3c\57\164\x72\x3e" . PHP_EOL; goto sueZ2; eMfY0: if (!$this->useInlineCss) { $html .= "\40\40\x20\x20\40\40\x20\40\x20\40\x3c\x74\162\40\143\154\141\163\163\x3d\42\162\x6f\167" . $pRow . "\x22\x3e" . PHP_EOL; } else { $style = isset($this->cssStyles["\x74\141\x62\154\x65\x2e\163\150\x65\145\x74" . $sheetIndex . "\40\164\162\x2e\x72\x6f\167" . $pRow]) ? $this->assembleCSS($this->cssStyles["\164\141\142\154\x65\56\163\150\x65\145\164" . $sheetIndex . "\40\x74\x72\x2e\162\157\x77" . $pRow]) : ''; $html .= "\x20\x20\40\x20\x20\x20\40\x20\40\x20\x3c\164\162\x20\x73\164\171\x6c\x65\75\x22" . $style . "\x22\x3e" . PHP_EOL; } goto uw7qX; uw7qX: $colNum = 0; goto zeC03; aj3vt: } else { throw new PHPExcel_Writer_Exception("\111\156\166\x61\x6c\x69\x64\x20\x70\x61\162\141\x6d\x65\x74\145\162\163\x20\160\141\x73\x73\145\144\x2e"); } } private function assembleCSS($pValue = array()) { goto L1L_4; L1L_4: $pairs = array(); goto ef9my; Li_lf: $string = implode("\73\40", $pairs); goto f669X; f669X: return $string; goto QxszV; ef9my: foreach ($pValue as $property => $value) { $pairs[] = $property . "\x3a" . $value; } goto Li_lf; QxszV: } public function getImagesRoot() { return $this->imagesRoot; } public function setImagesRoot($pValue = "\x2e") { $this->imagesRoot = $pValue; return $this; } public function getEmbedImages() { return $this->embedImages; } public function setEmbedImages($pValue = "\56") { $this->embedImages = $pValue; return $this; } public function getUseInlineCss() { return $this->useInlineCss; } public function setUseInlineCss($pValue = false) { $this->useInlineCss = $pValue; return $this; } public function formatColor($pValue, $pFormat) { goto F3a9e; XKBUI: $color_regex = "\x2f\x5e\x5c\x5b\x5b\x61\55\x7a\101\x2d\132\135\x2b\134\135\57"; goto jZZQH; hBDDZ: $value = htmlspecialchars($pValue); goto OldUg; Jt4HP: $matches = array(); goto XKBUI; OldUg: if ($color !== null) { $value = "\74\x73\x70\141\156\40\x73\164\171\x6c\145\75\x22\143\157\154\157\x72\72" . $color . "\x22\76" . $value . "\74\x2f\163\x70\141\156\x3e"; } goto gYXfj; gYXfj: return $value; goto Hap17; F3a9e: $color = null; goto Jt4HP; jZZQH: if (preg_match($color_regex, $pFormat, $matches)) { goto Vi9yx; Vi9yx: $color = str_replace("\x5b", '', $matches[0]); goto costj; costj: $color = str_replace("\135", '', $color); goto tfqLi; tfqLi: $color = strtolower($color); goto squd9; squd9: } goto hBDDZ; Hap17: } private function calculateSpans() { goto Hkomt; R1uB1: foreach ($sheetIndexes as $sheetIndex) { goto srdWP; x5fOZ: $candidateSpannedRow = array(); goto MMQ0T; IFGDS: $countColumns = PHPExcel_Cell::columnIndexFromString($sheet->getHighestColumn()); goto pf0xa; pf0xa: foreach ($candidateSpannedRow as $rowIndex) { if (isset($this->isSpannedCell[$sheetIndex][$rowIndex])) { if (count($this->isSpannedCell[$sheetIndex][$rowIndex]) == $countColumns) { $this->isSpannedRow[$sheetIndex][$rowIndex] = $rowIndex; } } } goto zhvtW; srdWP: $sheet = $this->phpExcel->getSheet($sheetIndex); goto x5fOZ; MMQ0T: foreach ($sheet->getMergeCells() as $cells) { goto B4flx; OXaqY: $lc = PHPExcel_Cell::columnIndexFromString($lc) - 1; goto bPunK; wWBXL: list($lc, $lr) = PHPExcel_Cell::coordinateFromString($last); goto OXaqY; bPunK: $r = $fr - 1; goto actbC; hUd_y: $first = $cells[0]; goto n2pqT; ooC3V: $fc = PHPExcel_Cell::columnIndexFromString($fc) - 1; goto wWBXL; actbC: while ($r++ < $lr) { $candidateSpannedRow[$r] = $r; $c = $fc - 1; while ($c++ < $lc) { if (!($c == $fc && $r == $fr)) { $this->isSpannedCell[$sheetIndex][$r][$c] = array("\142\x61\163\145\x43\x65\154\x6c" => array($fr, $fc)); } else { $this->isBaseCell[$sheetIndex][$r][$c] = array("\170\154\162\157\167\x73\x70\x61\x6e" => $lr - $fr + 1, "\x72\157\167\163\x70\x61\x6e" => $lr - $fr + 1, "\x78\x6c\143\157\154\x73\160\x61\x6e" => $lc - $fc + 1, "\x63\x6f\x6c\x73\x70\x61\x6e" => $lc - $fc + 1); } } } goto FmqeB; SrSwK: list($fc, $fr) = PHPExcel_Cell::coordinateFromString($first); goto ooC3V; B4flx: list($cells, ) = PHPExcel_Cell::splitRange($cells); goto hUd_y; n2pqT: $last = $cells[1]; goto SrSwK; FmqeB: } goto IFGDS; zhvtW: if (isset($this->isSpannedRow[$sheetIndex])) { foreach ($this->isSpannedRow[$sheetIndex] as $rowIndex) { goto qqN2C; J4dw6: $e = $countColumns - 1; goto x4c2q; K1jXy: $c = -1; goto J4dw6; qqN2C: $adjustedBaseCells = array(); goto K1jXy; x4c2q: while ($c++ < $e) { $baseCell = $this->isSpannedCell[$sheetIndex][$rowIndex][$c]["\142\x61\163\145\103\x65\154\154"]; if (!in_array($baseCell, $adjustedBaseCells)) { --$this->isBaseCell[$sheetIndex][$baseCell[0]][$baseCell[1]]["\x72\x6f\167\163\160\141\156"]; $adjustedBaseCells[] = $baseCell; } } goto G0bXs; G0bXs: } } goto wonsh; wonsh: } goto ENEGI; Hkomt: $sheetIndexes = $this->sheetIndex !== null ? array($this->sheetIndex) : range(0, $this->phpExcel->getSheetCount() - 1); goto R1uB1; ENEGI: $this->spansAreCalculated = true; goto LJt62; LJt62: } private function setMargins(PHPExcel_Worksheet $pSheet) { goto Krirg; r86fZ: $htmlPage .= "\175\12"; goto e_c92; nMWKv: $htmlPage .= "\155\x61\x72\x67\151\x6e\x2d\x72\151\147\x68\x74\x3a\x20" . $right; goto wH_lw; Krirg: $htmlPage = "\100\160\x61\x67\x65\x20\173\40"; goto Vq55u; I1imt: $htmlPage .= "\155\x61\x72\x67\151\156\x2d\x6c\x65\x66\164\x3a\40" . $left; goto p8wtr; gddx8: $htmlPage .= "\155\141\x72\x67\x69\156\55\142\x6f\x74\x74\x6f\155\72\x20" . $bottom; goto XzU0w; Vq55u: $htmlBody = "\x62\x6f\144\171\x20\x7b\40"; goto G8TQ0; kK0uX: return "\x3c\x73\164\171\x6c\145\x3e\12" . $htmlPage . $htmlBody . "\74\57\x73\x74\x79\154\145\76\xa"; goto bMUB2; RwjW9: $htmlBody .= "\x6d\141\162\x67\x69\x6e\x2d\x74\157\160\x3a\40" . $top; goto MYsiK; p8wtr: $htmlBody .= "\155\141\x72\147\151\x6e\x2d\154\x65\146\164\72\40" . $left; goto TPDB1; wH_lw: $htmlBody .= "\x6d\x61\162\x67\151\x6e\55\162\x69\x67\150\x74\x3a\40" . $right; goto IEzFm; ICJNf: $htmlPage .= "\x6d\141\162\147\151\156\55\164\x6f\x70\72\x20" . $top; goto RwjW9; G8TQ0: $left = PHPExcel_Shared_String::FormatNumber($pSheet->getPageMargins()->getLeft()) . "\151\156\x3b\40"; goto I1imt; XzU0w: $htmlBody .= "\155\x61\x72\x67\151\156\55\142\157\x74\164\157\155\x3a\40" . $bottom; goto r86fZ; TPDB1: $right = PHPExcel_Shared_String::FormatNumber($pSheet->getPageMargins()->getRight()) . "\151\x6e\73\x20"; goto nMWKv; e_c92: $htmlBody .= "\175\12"; goto kK0uX; MYsiK: $bottom = PHPExcel_Shared_String::FormatNumber($pSheet->getPageMargins()->getBottom()) . "\151\x6e\73\x20"; goto gddx8; IEzFm: $top = PHPExcel_Shared_String::FormatNumber($pSheet->getPageMargins()->getTop()) . "\151\x6e\73\x20"; goto ICJNf; bMUB2: } }
