<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:07              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Writer_Excel5_Workbook extends PHPExcel_Writer_Excel5_BIFFwriter { private $parser; private $biffSize; private $xfWriters = array(); private $palette; private $codepage; private $countryCode; private $phpExcel; private $fontWriters = array(); private $addedFonts = array(); private $numberFormats = array(); private $addedNumberFormats = array(); private $worksheetSizes = array(); private $worksheetOffsets = array(); private $stringTotal; private $stringUnique; private $stringTable; private $colors; private $escher; public function __construct(PHPExcel $phpExcel = null, &$str_total, &$str_unique, &$str_table, &$colors, $parser) { goto tQivM; tYhSv: for ($i = 0; $i < $countSheets; ++$i) { $phpSheet = $phpExcel->getSheet($i); $this->parser->setExtSheet($phpSheet->getTitle(), $i); $supbook_index = 0x0; $ref = pack("\x76\x76\166", $supbook_index, $i, $i); $this->parser->references[] = $ref; if ($phpSheet->isTabColorSet()) { $this->addColor($phpSheet->getTabColor()->getRGB()); } } goto BD7ty; eiszx: $this->parser = $parser; goto oqmXi; tQivM: parent::__construct(); goto eiszx; DPZG9: $countSheets = $phpExcel->getSheetCount(); goto tYhSv; oqmXi: $this->biffSize = 0; goto WbqxJ; JhwTN: $this->countryCode = -1; goto LbAOu; U58Sg: $this->stringUnique =& $str_unique; goto jhd3g; K3JDp: $this->codepage = 0x4b0; goto DPZG9; JMDkd: $this->setPaletteXl97(); goto Yl8V4; jhd3g: $this->stringTable =& $str_table; goto zSte5; WbqxJ: $this->palette = array(); goto JhwTN; LbAOu: $this->stringTotal =& $str_total; goto U58Sg; Yl8V4: $this->phpExcel = $phpExcel; goto K3JDp; zSte5: $this->colors =& $colors; goto JMDkd; BD7ty: } public function addXfWriter($style, $isStyleXf = false) { goto PSbej; FhGva: $xfWriter->setLeftColor($this->addColor($style->getBorders()->getLeft()->getColor()->getRGB())); goto e4qgW; nzcok: $xfWriter->setNumberFormatIndex($numberFormatIndex); goto gQWct; Dmm3M: if ($style->getNumberFormat()->getBuiltInFormatCode() === false) { $numberFormatHashCode = $style->getNumberFormat()->getHashCode(); if (isset($this->addedNumberFormats[$numberFormatHashCode])) { $numberFormatIndex = $this->addedNumberFormats[$numberFormatHashCode]; } else { goto DWIQV; NHIru: $this->addedNumberFormats[$numberFormatHashCode] = $numberFormatIndex; goto wzjKT; cp7zi: $this->numberFormats[$numberFormatIndex] = $style->getNumberFormat(); goto NHIru; DWIQV: $numberFormatIndex = 164 + count($this->numberFormats); goto cp7zi; wzjKT: } } else { $numberFormatIndex = (int) $style->getNumberFormat()->getBuiltInFormatCode(); } goto nzcok; drvVL: $xfWriter->setBottomColor($this->addColor($style->getBorders()->getBottom()->getColor()->getRGB())); goto q4Ikv; NzYU3: $xfIndex = count($this->xfWriters) - 1; goto KmsM_; PSbej: $xfWriter = new PHPExcel_Writer_Excel5_Xf($style); goto ZZbRp; gQWct: $this->xfWriters[] = $xfWriter; goto NzYU3; qmKVi: $xfWriter->setBgColor($this->addColor($style->getFill()->getEndColor()->getRGB())); goto drvVL; ZZbRp: $xfWriter->setIsStyleXf($isStyleXf); goto a6wsg; a6wsg: $fontIndex = $this->addFont($style->getFont()); goto WmRIj; cBxF1: $xfWriter->setFgColor($this->addColor($style->getFill()->getStartColor()->getRGB())); goto qmKVi; HwBaP: $xfWriter->setRightColor($this->addColor($style->getBorders()->getRight()->getColor()->getRGB())); goto FhGva; e4qgW: $xfWriter->setDiagColor($this->addColor($style->getBorders()->getDiagonal()->getColor()->getRGB())); goto Dmm3M; KmsM_: return $xfIndex; goto TRGa6; WmRIj: $xfWriter->setFontIndex($fontIndex); goto cBxF1; q4Ikv: $xfWriter->setTopColor($this->addColor($style->getBorders()->getTop()->getColor()->getRGB())); goto HwBaP; TRGa6: } public function addFont(PHPExcel_Style_Font $font) { goto tDbOR; tDbOR: $fontHashCode = $font->getHashCode(); goto zsCiZ; zE01s: return $fontIndex; goto nyVfw; zsCiZ: if (isset($this->addedFonts[$fontHashCode])) { $fontIndex = $this->addedFonts[$fontHashCode]; } else { goto CTxhb; Oj8ct: $fontIndex = $countFonts < 4 ? $countFonts : $countFonts + 1; goto gZQxM; l0FaK: $this->addedFonts[$fontHashCode] = $fontIndex; goto yDxI0; Z1Djd: $this->fontWriters[] = $fontWriter; goto l0FaK; CTxhb: $countFonts = count($this->fontWriters); goto Oj8ct; qTU31: $fontWriter->setColorIndex($this->addColor($font->getColor()->getRGB())); goto Z1Djd; gZQxM: $fontWriter = new PHPExcel_Writer_Excel5_Font($font); goto qTU31; yDxI0: } goto zE01s; nyVfw: } private function addColor($rgb) { if (!isset($this->colors[$rgb])) { if (count($this->colors) < 57) { goto aStJx; ZGReO: $this->palette[$colorIndex] = array(hexdec(substr($rgb, 0, 2)), hexdec(substr($rgb, 2, 2)), hexdec(substr($rgb, 4)), 0); goto P3KFM; P3KFM: $this->colors[$rgb] = $colorIndex; goto nVW6k; aStJx: $colorIndex = 8 + count($this->colors); goto ZGReO; nVW6k: } else { $colorIndex = 0; } } else { $colorIndex = $this->colors[$rgb]; } return $colorIndex; } private function setPaletteXl97() { $this->palette = array(0x8 => array(0x0, 0x0, 0x0, 0x0), 0x9 => array(0xff, 0xff, 0xff, 0x0), 0xa => array(0xff, 0x0, 0x0, 0x0), 0xb => array(0x0, 0xff, 0x0, 0x0), 0xc => array(0x0, 0x0, 0xff, 0x0), 0xd => array(0xff, 0xff, 0x0, 0x0), 0xe => array(0xff, 0x0, 0xff, 0x0), 0xf => array(0x0, 0xff, 0xff, 0x0), 0x10 => array(0x80, 0x0, 0x0, 0x0), 0x11 => array(0x0, 0x80, 0x0, 0x0), 0x12 => array(0x0, 0x0, 0x80, 0x0), 0x13 => array(0x80, 0x80, 0x0, 0x0), 0x14 => array(0x80, 0x0, 0x80, 0x0), 0x15 => array(0x0, 0x80, 0x80, 0x0), 0x16 => array(0xc0, 0xc0, 0xc0, 0x0), 0x17 => array(0x80, 0x80, 0x80, 0x0), 0x18 => array(0x99, 0x99, 0xff, 0x0), 0x19 => array(0x99, 0x33, 0x66, 0x0), 0x1a => array(0xff, 0xff, 0xcc, 0x0), 0x1b => array(0xcc, 0xff, 0xff, 0x0), 0x1c => array(0x66, 0x0, 0x66, 0x0), 0x1d => array(0xff, 0x80, 0x80, 0x0), 0x1e => array(0x0, 0x66, 0xcc, 0x0), 0x1f => array(0xcc, 0xcc, 0xff, 0x0), 0x20 => array(0x0, 0x0, 0x80, 0x0), 0x21 => array(0xff, 0x0, 0xff, 0x0), 0x22 => array(0xff, 0xff, 0x0, 0x0), 0x23 => array(0x0, 0xff, 0xff, 0x0), 0x24 => array(0x80, 0x0, 0x80, 0x0), 0x25 => array(0x80, 0x0, 0x0, 0x0), 0x26 => array(0x0, 0x80, 0x80, 0x0), 0x27 => array(0x0, 0x0, 0xff, 0x0), 0x28 => array(0x0, 0xcc, 0xff, 0x0), 0x29 => array(0xcc, 0xff, 0xff, 0x0), 0x2a => array(0xcc, 0xff, 0xcc, 0x0), 0x2b => array(0xff, 0xff, 0x99, 0x0), 0x2c => array(0x99, 0xcc, 0xff, 0x0), 0x2d => array(0xff, 0x99, 0xcc, 0x0), 0x2e => array(0xcc, 0x99, 0xff, 0x0), 0x2f => array(0xff, 0xcc, 0x99, 0x0), 0x30 => array(0x33, 0x66, 0xff, 0x0), 0x31 => array(0x33, 0xcc, 0xcc, 0x0), 0x32 => array(0x99, 0xcc, 0x0, 0x0), 0x33 => array(0xff, 0xcc, 0x0, 0x0), 0x34 => array(0xff, 0x99, 0x0, 0x0), 0x35 => array(0xff, 0x66, 0x0, 0x0), 0x36 => array(0x66, 0x66, 0x99, 0x0), 0x37 => array(0x96, 0x96, 0x96, 0x0), 0x38 => array(0x0, 0x33, 0x66, 0x0), 0x39 => array(0x33, 0x99, 0x66, 0x0), 0x3a => array(0x0, 0x33, 0x0, 0x0), 0x3b => array(0x33, 0x33, 0x0, 0x0), 0x3c => array(0x99, 0x33, 0x0, 0x0), 0x3d => array(0x99, 0x33, 0x66, 0x0), 0x3e => array(0x33, 0x33, 0x99, 0x0), 0x3f => array(0x33, 0x33, 0x33, 0x0)); } public function writeWorkbook($pWorksheetSizes = null) { goto r0fn4; OzSQU: return $this->_data; goto q2CfX; Tenl1: $this->writeAllNumberFormats(); goto mtq1C; MknFk: $part3 .= $this->writeSharedStringsTable(); goto T1quf; tSMec: $this->writePalette(); goto Sm0NY; hWQNw: $this->_data .= $part3; goto OzSQU; r0fn4: $this->worksheetSizes = $pWorksheetSizes; goto vaPHa; TedF2: $this->writeAllStyles(); goto tSMec; T1quf: $part3 .= $this->writeEof(); goto mA88H; JqnFo: if ($this->countryCode != -1) { $part3 .= $this->writeCountry(); } goto E1yvu; rHuWR: $part3 .= $this->writeAllDefinedNamesBiff8(); goto nyi7I; mtq1C: $this->writeAllXfs(); goto TedF2; nyi7I: $part3 .= $this->writeMsoDrawingGroup(); goto MknFk; vaPHa: $total_worksheets = $this->phpExcel->getSheetCount(); goto Gljun; JHKmB: $this->writeCodepage(); goto ABSKr; gBV5e: for ($i = 0; $i < $total_worksheets; ++$i) { $this->writeBoundSheet($this->phpExcel->getSheet($i), $this->worksheetOffsets[$i]); } goto hWQNw; Sm0NY: $part3 = ''; goto JqnFo; Gljun: $this->storeBof(0x5); goto JHKmB; tCx0u: $this->writeDateMode(); goto RdjbY; mA88H: $this->calcSheetOffsets(); goto gBV5e; CN9qy: $part3 .= $this->writeSupbookInternal(); goto pmeRO; ABSKr: $this->writeWindow1(); goto tCx0u; RdjbY: $this->writeAllFonts(); goto Tenl1; E1yvu: $part3 .= $this->writeRecalcId(); goto CN9qy; pmeRO: $part3 .= $this->writeExternalsheetBiff8(); goto rHuWR; q2CfX: } private function calcSheetOffsets() { goto DZM3G; iM6Kv: $total_worksheets = count($this->phpExcel->getAllSheets()); goto fcaVC; fcaVC: foreach ($this->phpExcel->getWorksheetIterator() as $sheet) { $offset += $boundsheet_length + strlen(PHPExcel_Shared_String::UTF8toBIFF8UnicodeShort($sheet->getTitle())); } goto oUU7Y; oUU7Y: for ($i = 0; $i < $total_worksheets; ++$i) { $this->worksheetOffsets[$i] = $offset; $offset += $this->worksheetSizes[$i]; } goto eDZ5k; FwT3o: $offset = $this->_datasize; goto iM6Kv; eDZ5k: $this->biffSize = $offset; goto N_tc2; DZM3G: $boundsheet_length = 10; goto FwT3o; N_tc2: } private function writeAllFonts() { foreach ($this->fontWriters as $fontWriter) { $this->append($fontWriter->writeFont()); } } private function writeAllNumberFormats() { foreach ($this->numberFormats as $numberFormatIndex => $numberFormat) { $this->writeNumberFormat($numberFormat->getFormatCode(), $numberFormatIndex); } } private function writeAllXfs() { foreach ($this->xfWriters as $xfWriter) { $this->append($xfWriter->writeXf()); } } private function writeAllStyles() { $this->writeStyle(); } private function writeExternals() { goto Gnm3c; dmBB1: $this->writeExternalCount($countSheets); goto EdeFV; Gnm3c: $countSheets = $this->phpExcel->getSheetCount(); goto dmBB1; EdeFV: for ($i = 0; $i < $countSheets; ++$i) { $this->writeExternalSheet($this->phpExcel->getSheet($i)->getTitle()); } goto v3wDl; v3wDl: } private function writeNames() { goto IPdHY; k7bdO: for ($i = 0; $i < $total_worksheets; ++$i) { $sheetSetup = $this->phpExcel->getSheet($i)->getPageSetup(); if ($sheetSetup->isPrintAreaSet()) { goto VWElc; CXTS1: $print_colmin = PHPExcel_Cell::columnIndexFromString($printArea[0][0]) - 1; goto zrXlE; nty7L: $printArea = $printArea[0]; goto WJcyG; WJcyG: $printArea[0] = PHPExcel_Cell::coordinateFromString($printArea[0]); goto XATKX; P47oG: $this->writeNameShort($i, 0x6, $print_rowmin, $print_rowmax, $print_colmin, $print_colmax); goto dLFzj; DjAhT: $print_rowmax = $printArea[1][1] - 1; goto CXTS1; XATKX: $printArea[1] = PHPExcel_Cell::coordinateFromString($printArea[1]); goto Wl4N2; zrXlE: $print_colmax = PHPExcel_Cell::columnIndexFromString($printArea[1][0]) - 1; goto P47oG; Wl4N2: $print_rowmin = $printArea[0][1] - 1; goto DjAhT; VWElc: $printArea = PHPExcel_Cell::splitRange($sheetSetup->getPrintArea()); goto nty7L; dLFzj: } } goto xyKDj; IPdHY: $total_worksheets = $this->phpExcel->getSheetCount(); goto k7bdO; xyKDj: for ($i = 0; $i < $total_worksheets; ++$i) { $sheetSetup = $this->phpExcel->getSheet($i)->getPageSetup(); if ($sheetSetup->isColumnsToRepeatAtLeftSet() && $sheetSetup->isRowsToRepeatAtTopSet()) { goto YvG9V; aSJFP: $repeat = $sheetSetup->getRowsToRepeatAtTop(); goto B0Cy8; B0Cy8: $rowmin = $repeat[0] - 1; goto b3dJe; jQZpe: $colmin = PHPExcel_Cell::columnIndexFromString($repeat[0]) - 1; goto xkS9b; b3dJe: $rowmax = $repeat[1] - 1; goto N4NNO; YvG9V: $repeat = $sheetSetup->getColumnsToRepeatAtLeft(); goto jQZpe; xkS9b: $colmax = PHPExcel_Cell::columnIndexFromString($repeat[1]) - 1; goto aSJFP; N4NNO: $this->writeNameLong($i, 0x7, $rowmin, $rowmax, $colmin, $colmax); goto j8e38; j8e38: } elseif ($sheetSetup->isColumnsToRepeatAtLeftSet() || $sheetSetup->isRowsToRepeatAtTopSet()) { goto SGbvn; jYWxq: if ($sheetSetup->isRowsToRepeatAtTopSet()) { goto yo9Qc; yo9Qc: $repeat = $sheetSetup->getRowsToRepeatAtTop(); goto Wzgaz; Wzgaz: $rowmin = $repeat[0] - 1; goto LOpkR; LOpkR: $rowmax = $repeat[1] - 1; goto uU4w1; uU4w1: } else { $rowmin = 0; $rowmax = 65535; } goto xQy5h; xQy5h: $this->writeNameShort($i, 0x7, $rowmin, $rowmax, $colmin, $colmax); goto vz1ke; SGbvn: if ($sheetSetup->isColumnsToRepeatAtLeftSet()) { goto xiW_w; kkTaN: $colmax = PHPExcel_Cell::columnIndexFromString($repeat[1]) - 1; goto eKSil; xiW_w: $repeat = $sheetSetup->getColumnsToRepeatAtLeft(); goto cL4yK; cL4yK: $colmin = PHPExcel_Cell::columnIndexFromString($repeat[0]) - 1; goto kkTaN; eKSil: } else { $colmin = 0; $colmax = 255; } goto jYWxq; vz1ke: } } goto zvjXr; zvjXr: } private function writeAllDefinedNamesBiff8() { goto I1wMc; Jj816: if (count($this->phpExcel->getNamedRanges()) > 0) { $namedRanges = $this->phpExcel->getNamedRanges(); foreach ($namedRanges as $namedRange) { goto Ircpx; Ircpx: $range = PHPExcel_Cell::splitRange($namedRange->getRange()); goto aX1Ve; cEhmh: $range = PHPExcel_Cell::buildRange($range); goto PxeRK; PxeRK: try { goto tMTRb; p0n43: if ($namedRange->getLocalOnly()) { $scope = $this->phpExcel->getIndex($namedRange->getScope()) + 1; } else { $scope = 0; } goto qU11G; tMTRb: $error = $this->parser->parse($range); goto lPAtC; cFC1w: if (isset($formulaData[0]) and ($formulaData[0] == "\172" or $formulaData[0] == "\x5a")) { $formulaData = "\72" . substr($formulaData, 1); } goto p0n43; qU11G: $chunk .= $this->writeData($this->writeDefinedNameBiff8($namedRange->getName(), $formulaData, $scope, false)); goto SZblp; lPAtC: $formulaData = $this->parser->toReversePolish(); goto cFC1w; SZblp: } catch (PHPExcel_Exception $e) { } goto xNRlC; aX1Ve: for ($i = 0; $i < count($range); $i++) { $range[$i][0] = "\47" . str_replace("\x27", "\x27\47", $namedRange->getWorksheet()->getTitle()) . "\x27\41" . PHPExcel_Cell::absoluteCoordinate($range[$i][0]); if (isset($range[$i][1])) { $range[$i][1] = PHPExcel_Cell::absoluteCoordinate($range[$i][1]); } } goto cEhmh; xNRlC: } } goto XBJb3; fHffT: for ($i = 0; $i < $total_worksheets; ++$i) { $sheetSetup = $this->phpExcel->getSheet($i)->getPageSetup(); if ($sheetSetup->isPrintAreaSet()) { goto WIFCL; WIFCL: $printArea = PHPExcel_Cell::splitRange($sheetSetup->getPrintArea()); goto RUmeP; RUmeP: $countPrintArea = count($printArea); goto D34T4; o4j3B: $chunk .= $this->writeData($this->writeDefinedNameBiff8(pack("\103", 0x6), $formulaData, $i + 1, true)); goto FWav6; D34T4: $formulaData = ''; goto iYBoD; iYBoD: for ($j = 0; $j < $countPrintArea; ++$j) { $printAreaRect = $printArea[$j]; $printAreaRect[0] = PHPExcel_Cell::coordinateFromString($printAreaRect[0]); $printAreaRect[1] = PHPExcel_Cell::coordinateFromString($printAreaRect[1]); $print_rowmin = $printAreaRect[0][1] - 1; $print_rowmax = $printAreaRect[1][1] - 1; $print_colmin = PHPExcel_Cell::columnIndexFromString($printAreaRect[0][0]) - 1; $print_colmax = PHPExcel_Cell::columnIndexFromString($printAreaRect[1][0]) - 1; $formulaData .= pack("\103\166\x76\166\166\x76", 0x3b, $i, $print_rowmin, $print_rowmax, $print_colmin, $print_colmax); if ($j > 0) { $formulaData .= pack("\x43", 0x10); } } goto o4j3B; FWav6: } } goto S4AcY; XBJb3: $total_worksheets = $this->phpExcel->getSheetCount(); goto wprC7; I1wMc: $chunk = ''; goto Jj816; S4AcY: for ($i = 0; $i < $total_worksheets; ++$i) { $sheetAutoFilter = $this->phpExcel->getSheet($i)->getAutoFilter(); $autoFilterRange = $sheetAutoFilter->getRange(); if (!empty($autoFilterRange)) { goto yG4If; wdzy4: $name = pack("\x43", 0xd); goto hULVj; yG4If: $rangeBounds = PHPExcel_Cell::rangeBoundaries($autoFilterRange); goto wdzy4; hULVj: $chunk .= $this->writeData($this->writeShortNameBiff8($name, $i + 1, $rangeBounds, true)); goto t_qfi; t_qfi: } } goto w5grY; w5grY: return $chunk; goto XRtJw; wprC7: for ($i = 0; $i < $total_worksheets; ++$i) { $sheetSetup = $this->phpExcel->getSheet($i)->getPageSetup(); if ($sheetSetup->isColumnsToRepeatAtLeftSet() && $sheetSetup->isRowsToRepeatAtTopSet()) { goto bGEyn; bGEyn: $repeat = $sheetSetup->getColumnsToRepeatAtLeft(); goto LIKP5; rig2m: $repeat = $sheetSetup->getRowsToRepeatAtTop(); goto yXSgQ; LIKP5: $colmin = PHPExcel_Cell::columnIndexFromString($repeat[0]) - 1; goto Q0jGQ; yXSgQ: $rowmin = $repeat[0] - 1; goto ia4K3; wC0Oz: $formulaData .= pack("\x43\x76\x76\166\x76\166", 0x3b, $i, $rowmin, $rowmax, 0, 255); goto m3RZK; K4YP2: $formulaData = pack("\x43\166", 0x29, 0x17); goto RWJjx; KmhZj: $chunk .= $this->writeData($this->writeDefinedNameBiff8(pack("\103", 0x7), $formulaData, $i + 1, true)); goto d4CCJ; m3RZK: $formulaData .= pack("\x43", 0x10); goto KmhZj; ia4K3: $rowmax = $repeat[1] - 1; goto K4YP2; RWJjx: $formulaData .= pack("\x43\166\x76\x76\166\x76", 0x3b, $i, 0, 65535, $colmin, $colmax); goto wC0Oz; Q0jGQ: $colmax = PHPExcel_Cell::columnIndexFromString($repeat[1]) - 1; goto rig2m; d4CCJ: } elseif ($sheetSetup->isColumnsToRepeatAtLeftSet() || $sheetSetup->isRowsToRepeatAtTopSet()) { goto xym2v; QW2Hd: $chunk .= $this->writeData($this->writeDefinedNameBiff8(pack("\103", 0x7), $formulaData, $i + 1, true)); goto GUEs7; xym2v: if ($sheetSetup->isColumnsToRepeatAtLeftSet()) { goto a0cje; HD59P: $colmax = PHPExcel_Cell::columnIndexFromString($repeat[1]) - 1; goto NCeUv; a0cje: $repeat = $sheetSetup->getColumnsToRepeatAtLeft(); goto fMhnp; fMhnp: $colmin = PHPExcel_Cell::columnIndexFromString($repeat[0]) - 1; goto HD59P; NCeUv: } else { $colmin = 0; $colmax = 255; } goto IJt9R; mD2O8: $formulaData = pack("\x43\x76\x76\x76\166\166", 0x3b, $i, $rowmin, $rowmax, $colmin, $colmax); goto QW2Hd; IJt9R: if ($sheetSetup->isRowsToRepeatAtTopSet()) { goto bD76X; bD76X: $repeat = $sheetSetup->getRowsToRepeatAtTop(); goto BY6sW; BY6sW: $rowmin = $repeat[0] - 1; goto hT9_4; hT9_4: $rowmax = $repeat[1] - 1; goto s3iiw; s3iiw: } else { $rowmin = 0; $rowmax = 65535; } goto mD2O8; GUEs7: } } goto fHffT; XRtJw: } private function writeDefinedNameBiff8($name, $formulaData, $sheetIndex = 0, $isBuiltIn = false) { goto FFC9k; NJDOa: $nlen = PHPExcel_Shared_String::CountCharacters($name); goto Kb27W; FFC9k: $record = 0x18; goto bD6Qm; DdcbQ: $sz = strlen($formulaData); goto CHRmc; joYMK: $header = pack("\x76\x76", $record, $length); goto WDhT1; FjjEB: $length = strlen($data); goto joYMK; CHRmc: $data = pack("\x76\103\x43\x76\166\166\x43\x43\x43\x43", $options, 0, $nlen, $sz, 0, $sheetIndex, 0, 0, 0, 0) . $name . $formulaData; goto FjjEB; Kb27W: $name = substr(PHPExcel_Shared_String::UTF8toBIFF8UnicodeLong($name), 2); goto DdcbQ; WDhT1: return $header . $data; goto Zq36o; bD6Qm: $options = $isBuiltIn ? 0x20 : 0x0; goto NJDOa; Zq36o: } private function writeShortNameBiff8($name, $sheetIndex = 0, $rangeBounds, $isHidden = false) { goto leSb2; X7Ai_: $data = pack("\166\103\x43\x76\x76\x76\103\x43\x43\103\103", $options, 0, 1, $sz, 0, $sheetIndex, 0, 0, 0, 0, 0) . $name . $extra; goto KT15y; PUCQV: $extra = pack("\103\x76\166\x76\166\x76", 0x3b, $sheetIndex - 1, $rangeBounds[0][1] - 1, $rangeBounds[1][1] - 1, $rangeBounds[0][0] - 1, $rangeBounds[1][0] - 1); goto DXqmv; leSb2: $record = 0x18; goto bPBNj; KT15y: $length = strlen($data); goto XsxBD; DXqmv: $sz = strlen($extra); goto X7Ai_; FKayY: return $header . $data; goto KuQ6D; bPBNj: $options = $isHidden ? 0x21 : 0x0; goto PUCQV; XsxBD: $header = pack("\x76\166", $record, $length); goto FKayY; KuQ6D: } private function writeCodepage() { goto DbRHk; fXlE8: $this->append($header . $data); goto N99SK; MT2JL: $header = pack("\166\166", $record, $length); goto YGTKy; KJuv4: $cv = $this->codepage; goto MT2JL; YGTKy: $data = pack("\x76", $cv); goto fXlE8; lqed2: $length = 0x2; goto KJuv4; DbRHk: $record = 0x42; goto lqed2; N99SK: } private function writeWindow1() { goto FgLOj; e05DT: $grbit = 0x38; goto njRi3; njRi3: $ctabsel = 1; goto EOxef; iraR9: $xWn = 0x0; goto otPCS; EOxef: $wTabRatio = 0x258; goto X9b1L; xDL60: $this->append($header . $data); goto cATtY; Zyr3X: $data = pack("\166\x76\x76\x76\166\166\x76\x76\x76", $xWn, $yWn, $dxWn, $dyWn, $grbit, $itabCur, $itabFirst, $ctabsel, $wTabRatio); goto xDL60; otPCS: $yWn = 0x0; goto KQ1O4; SzI65: $header = pack("\166\166", $record, $length); goto Zyr3X; KQ1O4: $dxWn = 0x25bc; goto V1KQX; FgLOj: $record = 0x3d; goto KWVUJ; KWVUJ: $length = 0x12; goto iraR9; UaSy5: $itabCur = $this->phpExcel->getActiveSheetIndex(); goto SzI65; V1KQX: $dyWn = 0x1572; goto e05DT; X9b1L: $itabFirst = 0; goto UaSy5; cATtY: } private function writeBoundSheet($sheet, $offset) { goto ICprc; vaU8e: $this->append($header . $data); goto wAfbF; vEzJ8: $data .= PHPExcel_Shared_String::UTF8toBIFF8UnicodeShort($sheetname); goto kOSaJ; kOSaJ: $length = strlen($data); goto ALgbo; iSt3C: $st = 0x0; goto b0RVm; pEbnr: switch ($sheet->getSheetState()) { case PHPExcel_Worksheet::SHEETSTATE_VISIBLE: $ss = 0x0; break; case PHPExcel_Worksheet::SHEETSTATE_HIDDEN: $ss = 0x1; break; case PHPExcel_Worksheet::SHEETSTATE_VERYHIDDEN: $ss = 0x2; break; default: $ss = 0x0; break; } goto iSt3C; SkZuo: $data = pack("\126\103\103", $offset, $ss, $st); goto vEzJ8; ICprc: $sheetname = $sheet->getTitle(); goto VS_JD; ALgbo: $header = pack("\x76\166", $record, $length); goto vaU8e; VS_JD: $record = 0x85; goto pEbnr; b0RVm: $grbit = 0x0; goto SkZuo; wAfbF: } private function writeSupbookInternal() { goto GusA1; GusA1: $record = 0x1ae; goto w05z_; n_W65: return $this->writeData($header . $data); goto Hjlrp; aWFUs: $header = pack("\166\166", $record, $length); goto P5vl2; w05z_: $length = 0x4; goto aWFUs; P5vl2: $data = pack("\x76\166", $this->phpExcel->getSheetCount(), 0x401); goto n_W65; Hjlrp: } private function writeExternalsheetBiff8() { goto Y71BI; WgPHT: for ($i = 0; $i < $totalReferences; ++$i) { $data .= $this->parser->references[$i]; } goto kHhA2; cWqlO: $header = pack("\166\166", $record, $length); goto dBvm2; hoVXf: $length = 2 + 6 * $totalReferences; goto o4Rt_; Y71BI: $totalReferences = count($this->parser->references); goto XPI7m; o4Rt_: $supbook_index = 0; goto cWqlO; XPI7m: $record = 0x17; goto hoVXf; dBvm2: $data = pack("\166", $totalReferences); goto WgPHT; kHhA2: return $this->writeData($header . $data); goto XiDSf; XiDSf: } private function writeStyle() { goto RK4l0; ZQRCS: $header = pack("\x76\x76", $record, $length); goto wbv02; dixIU: $BuiltIn = 0x0; goto ayAdP; ayAdP: $iLevel = 0xff; goto ZQRCS; rpdAq: $length = 0x4; goto UXjqW; iZEuK: $this->append($header . $data); goto ZY2C9; wbv02: $data = pack("\166\103\103", $ixfe, $BuiltIn, $iLevel); goto iZEuK; UXjqW: $ixfe = 0x8000; goto dixIU; RK4l0: $record = 0x293; goto rpdAq; ZY2C9: } private function writeNumberFormat($format, $ifmt) { goto wfBUF; JZo9s: $header = pack("\166\166", $record, $length); goto TvVCa; lgO3r: $length = 2 + strlen($numberFormatString); goto JZo9s; GFobR: $numberFormatString = PHPExcel_Shared_String::UTF8toBIFF8UnicodeLong($format); goto lgO3r; EiR_a: $this->append($header . $data); goto QSE8a; TvVCa: $data = pack("\x76", $ifmt) . $numberFormatString; goto EiR_a; wfBUF: $record = 0x41e; goto GFobR; QSE8a: } private function writeDateMode() { goto Q7tpw; VkFjX: $length = 0x2; goto vQEBm; Q7tpw: $record = 0x22; goto VkFjX; vQEBm: $f1904 = PHPExcel_Shared_Date::getExcelCalendar() == PHPExcel_Shared_Date::CALENDAR_MAC_1904 ? 1 : 0; goto MHhBX; Z6f9h: $this->append($header . $data); goto NtwbQ; MHhBX: $header = pack("\166\x76", $record, $length); goto fASRv; fASRv: $data = pack("\x76", $f1904); goto Z6f9h; NtwbQ: } private function writeExternalCount($cxals) { goto GlYKo; GlYKo: $record = 0x16; goto uAV3M; uAV3M: $length = 0x2; goto vzDHK; DNaw_: $this->append($header . $data); goto yy2QX; vzDHK: $header = pack("\166\x76", $record, $length); goto g0sHG; g0sHG: $data = pack("\x76", $cxals); goto DNaw_; yy2QX: } private function writeExternalSheet($sheetname) { goto B3Vnh; DMSAd: $cch = strlen($sheetname); goto Y3nws; qo665: $header = pack("\166\166", $record, $length); goto oZugI; B3Vnh: $record = 0x17; goto iRjwh; Y3nws: $rgch = 0x3; goto qo665; iRjwh: $length = 0x2 + strlen($sheetname); goto DMSAd; jDNYc: $this->append($header . $data . $sheetname); goto BFSvF; oZugI: $data = pack("\103\103", $cch, $rgch); goto jDNYc; BFSvF: } private function writeNameShort($index, $type, $rowmin, $rowmax, $colmin, $colmax) { goto dgUdy; H8DCo: $data .= pack("\166", $rowmax); goto usUYQ; nBMJR: $data .= pack("\166", $cce); goto ROZaX; OGpds: $chKey = 0x0; goto E60fC; elDMo: $data .= pack("\x76", $index); goto Y1bZP; FPwIa: $cchStatustext = 0x0; goto wJE3p; G2a2L: $data .= pack("\x43", $rgch); goto bEHOT; fWIen: $data .= pack("\x43", $cchCustMenu); goto TsvhZ; TsvhZ: $data .= pack("\x43", $cchDescription); goto GGmQG; VazQi: $itab = $ixals; goto qRY_S; r_BZ9: $unknown04 = 0xffff - $index; goto E_XzW; E_XzW: $unknown05 = 0x0; goto hsn0g; DpLlj: $this->append($header . $data); goto lAFg2; tzeSQ: $cce = 0x15; goto j3J1_; dgUdy: $record = 0x18; goto PyPpS; OGz9P: $data .= pack("\166", $itab); goto fWIen; ROZaX: $data .= pack("\x76", $ixals); goto OGz9P; D6iIC: $data .= pack("\x43", $cch); goto nBMJR; j3J1_: $ixals = $index + 1; goto VazQi; yoArN: $unknown07 = 0x1087; goto tMGu2; vQ6TK: $cchHelptopic = 0x0; goto FPwIa; o4gn9: $data .= pack("\x76", $unknown08); goto elDMo; FaavA: $data .= pack("\166", $rowmin); goto H8DCo; qRY_S: $cchCustMenu = 0x0; goto FHCAn; tMGu2: $unknown08 = 0x8005; goto XbH95; V300d: $grbit = 0x20; goto OGpds; jFgxI: $data .= pack("\x43", $chKey); goto D6iIC; usUYQ: $data .= pack("\103", $colmin); goto NMT0M; IazIw: $data .= pack("\166", $unknown06); goto H33BV; GGmQG: $data .= pack("\103", $cchHelptopic); goto t9s69; E60fC: $cch = 0x1; goto tzeSQ; t9s69: $data .= pack("\103", $cchStatustext); goto G2a2L; ljdCP: $data .= pack("\166", $unknown05); goto IazIw; wJE3p: $rgch = $type; goto M7VhU; pU2nr: $data .= pack("\166", $unknown04); goto ljdCP; NMT0M: $data .= pack("\x43", $colmax); goto DpLlj; bEHOT: $data .= pack("\103", $unknown03); goto pU2nr; H33BV: $data .= pack("\x76", $unknown07); goto o4gn9; FHCAn: $cchDescription = 0x0; goto vQ6TK; PyPpS: $length = 0x24; goto V300d; hsn0g: $unknown06 = 0x0; goto yoArN; M7VhU: $unknown03 = 0x3b; goto r_BZ9; Y1bZP: $data .= pack("\166", $index); goto FaavA; kKEc6: $data = pack("\166", $grbit); goto jFgxI; XbH95: $header = pack("\166\166", $record, $length); goto kKEc6; lAFg2: } private function writeNameLong($index, $type, $rowmin, $rowmax, $colmin, $colmax) { goto SsSNS; Odco3: $this->append($header . $data); goto RopUs; ADfOk: $data .= pack("\103", $cchDescription); goto jB_oo; N8j_V: $data .= pack("\x76", $index); goto OzHWl; jWRs5: $data .= pack("\x76", $itab); goto RpFQj; r7rkB: $itab = $ixals; goto zLgeR; QjRWJ: $grbit = 0x20; goto FQk30; Baf0N: $data .= pack("\103", $colmax); goto NGm1z; Fw4W1: $data .= pack("\x43", $unknown01); goto cGPuf; F8CHA: $unknown07 = 0x1087; goto QW0yb; P3JwN: $data .= pack("\166", 0x0); goto YOx3n; qrXuu: $data .= pack("\x76", $ixals); goto jWRs5; Tbk_r: $data .= pack("\166", $unknown06); goto bZyan; bSYsx: $data .= pack("\103", $cchStatustext); goto boUlu; cYiHe: $unknown02 = 0x2b; goto yMauI; NXnZD: $data .= pack("\103", $unknown03); goto SD39v; OX_UU: $data .= pack("\103", $chKey); goto z39gw; QW0yb: $unknown08 = 0x8008; goto BggZ1; Vns8P: $data .= pack("\x43", 0x10); goto Odco3; zbqnl: $unknown06 = 0x0; goto F8CHA; YOx3n: $data .= pack("\166", 0x3fff); goto dbUZt; rPy1y: $data .= pack("\166", $unknown04); goto BQ6EN; EX5v5: $data .= pack("\x76", $unknown06); goto JFA10; ml2fd: $data .= pack("\x76", $index); goto xqX2p; zLgeR: $cchCustMenu = 0x0; goto SLcsz; xqX2p: $data .= pack("\166", $index); goto P3JwN; jB_oo: $data .= pack("\x43", $cchHelptopic); goto bSYsx; MyCR3: $data .= pack("\x76", $unknown05); goto EX5v5; SsSNS: $record = 0x18; goto E2_P3; JFA10: $data .= pack("\x76", $unknown07); goto oUNT9; pY5UL: $unknown04 = 0xffff - $index; goto j7ZD2; SLcsz: $cchDescription = 0x0; goto lm7E3; Al0Sh: $cce = 0x2e; goto kMOVI; SD39v: $data .= pack("\166", $unknown04); goto MyCR3; WXObl: $cchStatustext = 0x0; goto lMZzX; z39gw: $data .= pack("\x43", $cch); goto ot1tQ; bZyan: $data .= pack("\x76", $unknown07); goto zJdHz; kMOVI: $ixals = $index + 1; goto r7rkB; E2_P3: $length = 0x3d; goto QjRWJ; dbUZt: $data .= pack("\103", $colmin); goto Baf0N; RpFQj: $data .= pack("\x43", $cchCustMenu); goto ADfOk; cGPuf: $data .= pack("\x76", $unknown02); goto NXnZD; BggZ1: $header = pack("\166\166", $record, $length); goto Ia3s8; lm7E3: $cchHelptopic = 0x0; goto WXObl; zJdHz: $data .= pack("\x76", $unknown08); goto N8j_V; mWLQF: $data .= pack("\x43", 0xff); goto Vns8P; TO3NE: $data .= pack("\x76", $rowmin); goto a2Wuo; a2Wuo: $data .= pack("\166", $rowmax); goto shYch; kaICC: $unknown01 = 0x29; goto cYiHe; yMauI: $unknown03 = 0x3b; goto pY5UL; OzHWl: $data .= pack("\166", $index); goto TO3NE; I2yJc: $cch = 0x1; goto Al0Sh; FQk30: $chKey = 0x0; goto I2yJc; shYch: $data .= pack("\x43", 0x0); goto mWLQF; boUlu: $data .= pack("\103", $rgch); goto Fw4W1; j7ZD2: $unknown05 = 0x0; goto zbqnl; NGm1z: $data .= pack("\103", $unknown03); goto rPy1y; BQ6EN: $data .= pack("\x76", $unknown05); goto Tbk_r; lMZzX: $rgch = $type; goto kaICC; ot1tQ: $data .= pack("\x76", $cce); goto qrXuu; oUNT9: $data .= pack("\x76", $unknown08); goto ml2fd; Ia3s8: $data = pack("\166", $grbit); goto OX_UU; RopUs: } private function writeCountry() { goto T6kvl; MGABM: return $this->writeData($header . $data); goto GJrsc; TbHC4: $header = pack("\x76\166", $record, $length); goto Ab01l; Ab01l: $data = pack("\x76\166", $this->countryCode, $this->countryCode); goto MGABM; T6kvl: $record = 0x8c; goto h4I2P; h4I2P: $length = 4; goto TbHC4; GJrsc: } private function writeRecalcId() { goto h0Y0Q; kVkcw: $length = 8; goto Ty7VF; KlK4a: return $this->writeData($header . $data); goto nLpNZ; h0Y0Q: $record = 0x1c1; goto kVkcw; Ty7VF: $header = pack("\x76\x76", $record, $length); goto aXOoj; aXOoj: $data = pack("\126\126", 0x1c1, 0x1e667); goto KlK4a; nLpNZ: } private function writePalette() { goto M7VCe; kwiGT: $header = pack("\x76\166\x76", $record, $length, $ccv); goto POJZ7; koB72: foreach ($aref as $color) { foreach ($color as $byte) { $data .= pack("\x43", $byte); } } goto kwiGT; al6bQ: $record = 0x92; goto tuajS; tuajS: $length = 2 + 4 * count($aref); goto roqkZ; POJZ7: $this->append($header . $data); goto pQys8; gWh15: $data = ''; goto koB72; roqkZ: $ccv = count($aref); goto gWh15; M7VCe: $aref = $this->palette; goto al6bQ; pQys8: } private function writeSharedStringsTable() { goto o5FT0; mS_1a: foreach (array_keys($this->stringTable) as $string) { goto K5Bf9; FFcLp: $finished = false; goto E78Ml; jP2UF: $encoding = $headerinfo["\145\x6e\143\157\144\151\x6e\x67"]; goto FFcLp; K5Bf9: $headerinfo = unpack("\166\154\145\156\x67\x74\x68\57\x43\145\156\143\157\144\151\x6e\x67", $string); goto jP2UF; E78Ml: while ($finished === false) { if (strlen($recordData) + strlen($string) <= $continue_limit) { goto FlscP; sTZxC: if (strlen($recordData) + strlen($string) == $continue_limit) { $recordDatas[] = $recordData; $recordData = ''; } goto EPlkj; FlscP: $recordData .= $string; goto sTZxC; EPlkj: $finished = true; goto XyFOo; XyFOo: } else { goto uWHtG; uWHtG: $space_remaining = $continue_limit - strlen($recordData); goto QulAU; QulAU: $min_space_needed = $encoding == 1 ? 5 : 4; goto shC3h; shC3h: if ($space_remaining < $min_space_needed) { $recordDatas[] = $recordData; $recordData = ''; } else { goto bN_BR; PA8k2: $recordDatas[] = $recordData; goto gocEE; ePzNH: $string = substr($string, $effective_space_remaining); goto PA8k2; YTGez: if ($encoding == 1 && (strlen($string) - $space_remaining) % 2 == 1) { --$effective_space_remaining; } goto XFPHr; gocEE: $recordData = pack("\103", $encoding); goto btuID; XFPHr: $recordData .= substr($string, 0, $effective_space_remaining); goto ePzNH; bN_BR: $effective_space_remaining = $space_remaining; goto YTGez; btuID: } goto UrRqp; UrRqp: } } goto SsyKq; SsyKq: } goto Jl5xb; gBBBG: $recordData = pack("\x56\x56", $this->stringTotal, $this->stringUnique); goto mS_1a; RPBWH: return $chunk; goto V0Md4; Jl5xb: if (strlen($recordData) > 0) { $recordDatas[] = $recordData; } goto aI5kD; o5FT0: $continue_limit = 8224; goto iu4da; xNgOD: foreach ($recordDatas as $i => $recordData) { goto w2yX7; jZ0QT: $chunk .= $this->writeData($data); goto fx4V1; iJ80Z: $data = $header . $recordData; goto jZ0QT; w2yX7: $record = $i == 0 ? 0xfc : 0x3c; goto Xa_00; Xa_00: $header = pack("\x76\x76", $record, strlen($recordData)); goto iJ80Z; fx4V1: } goto RPBWH; iu4da: $recordDatas = array(); goto gBBBG; aI5kD: $chunk = ''; goto xNgOD; V0Md4: } private function writeMsoDrawingGroup() { if (isset($this->escher)) { goto V2nz4; f9PG4: $data = $writer->close(); goto HL8C8; bN_KU: $header = pack("\166\x76", $record, $length); goto FAhZM; FAhZM: return $this->writeData($header . $data); goto NroJi; HL8C8: $record = 0xeb; goto RZOAq; RZOAq: $length = strlen($data); goto bN_KU; V2nz4: $writer = new PHPExcel_Writer_Excel5_Escher($this->escher); goto f9PG4; NroJi: } else { return ''; } } public function getEscher() { return $this->escher; } public function setEscher(PHPExcel_Shared_Escher $pValue = null) { $this->escher = $pValue; } }
