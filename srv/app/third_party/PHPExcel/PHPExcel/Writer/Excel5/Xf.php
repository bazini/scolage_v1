<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:07              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Writer_Excel5_Xf { private $isStyleXf; private $fontIndex; private $numberFormatIndex; private $textJustLast; private $foregroundColor; private $backgroundColor; private $bottomBorderColor; private $topBorderColor; private $leftBorderColor; private $rightBorderColor; public function __construct(PHPExcel_Style $style = null) { goto otTlJ; z73LA: $this->_diag_color = 0x40; goto SADYl; rHB3U: $this->numberFormatIndex = 0; goto JfE0D; CxEa9: $this->_diag = 0; goto pN2YS; VdTBO: $this->rightBorderColor = 0x40; goto z73LA; H_P2m: $this->leftBorderColor = 0x40; goto VdTBO; JfE0D: $this->textJustLast = 0; goto JLcBI; otTlJ: $this->isStyleXf = false; goto GH0_5; UQOsq: $this->topBorderColor = 0x40; goto H_P2m; JLcBI: $this->foregroundColor = 0x40; goto rFIWH; pN2YS: $this->bottomBorderColor = 0x40; goto UQOsq; GH0_5: $this->fontIndex = 0; goto rHB3U; SADYl: $this->_style = $style; goto Bko3h; rFIWH: $this->backgroundColor = 0x41; goto CxEa9; Bko3h: } public function writeXf() { goto XBFLE; p4Lci: $biff8_options |= (int) $this->_style->getAlignment()->getShrinkToFit() << 4; goto WrjsT; si58V: $ifnt = $this->fontIndex; goto xc5tQ; xc5tQ: $ifmt = $this->numberFormatIndex; goto oXR5c; FhkYZ: $data .= pack("\x56\x56\166", $border1, $border2, $icv); goto aSI1g; oXR5c: $align = $this->mapHAlign($this->_style->getAlignment()->getHorizontal()); goto mPn69; IP08j: $border1 |= self::mapBorderStyle($this->_style->getBorders()->getRight()->getBorderStyle()) << 4; goto uj12O; CXzu7: $border1 = self::mapBorderStyle($this->_style->getBorders()->getLeft()->getBorderStyle()); goto IP08j; mPn69: $align |= (int) $this->_style->getAlignment()->getWrapText() << 3; goto EaQpK; dhjfW: $atr_prot = self::mapLocked($this->_style->getProtection()->getLocked()) | self::mapHidden($this->_style->getProtection()->getHidden()); goto p7w3O; DOFZN: $border1 |= $diag_tl_to_rb << 30; goto HAUpm; Hg24r: $icv |= $this->backgroundColor << 7; goto CXzu7; xSZIf: $used_attrib |= $atr_fnt << 3; goto UmF3M; lz2xd: $border1 |= self::mapBorderStyle($this->_style->getBorders()->getBottom()->getBorderStyle()) << 12; goto oLy3l; XTUF0: $border1 |= $this->rightBorderColor << 23; goto gkuHm; L54Tr: $atr_num = $this->numberFormatIndex != 0 ? 1 : 0; goto KYghQ; aSI1g: return $header . $data; goto sQcN1; W9D_1: $border2 = $this->topBorderColor; goto gByqE; kHfYa: $diag_tr_to_lb = $diagonalDirection == PHPExcel_Style_Borders::DIAGONAL_BOTH || $diagonalDirection == PHPExcel_Style_Borders::DIAGONAL_UP; goto DOFZN; LYrJl: if (self::mapBorderStyle($this->_style->getBorders()->getDiagonal()->getBorderStyle()) == 0) { $this->_diag_color = 0; } goto UeQQT; UmF3M: $used_attrib |= $atr_alc << 4; goto G0oeW; E5MqW: $length = 0x14; goto si58V; Lz98V: if (self::mapBorderStyle($this->_style->getBorders()->getLeft()->getBorderStyle()) == 0) { $this->leftBorderColor = 0; } goto LYrJl; vAt3_: $biff8_options = $this->_style->getAlignment()->getIndent(); goto p4Lci; XBFLE: if ($this->isStyleXf) { $style = 0xfff5; } else { $style = self::mapLocked($this->_style->getProtection()->getLocked()); $style |= self::mapHidden($this->_style->getProtection()->getHidden()) << 1; } goto L54Tr; G0oeW: $used_attrib |= $atr_bdr << 5; goto zSibJ; vcPAS: $border2 |= self::mapFillType($this->_style->getFill()->getFillType()) << 26; goto M84kr; zSibJ: $used_attrib |= $atr_pat << 6; goto cWLh5; YEyZx: $used_attrib = $atr_num << 2; goto xSZIf; FGgI4: if (self::mapBorderStyle($this->_style->getBorders()->getRight()->getBorderStyle()) == 0) { $this->rightBorderColor = 0; } goto Lz98V; gyIGT: if (self::mapBorderStyle($this->_style->getBorders()->getTop()->getBorderStyle()) == 0) { $this->topBorderColor = 0; } goto FGgI4; KYghQ: $atr_fnt = $this->fontIndex != 0 ? 1 : 0; goto XjqOe; gkuHm: $diagonalDirection = $this->_style->getBorders()->getDiagonalDirection(); goto T956E; EaQpK: $align |= self::mapVAlign($this->_style->getAlignment()->getVertical()) << 4; goto vvywT; fivUS: $border2 |= $this->_diag_color << 14; goto FE5zH; WrjsT: $data = pack("\166\166\x76\103", $ifnt, $ifmt, $style, $align); goto i1LlQ; HAUpm: $border1 |= $diag_tr_to_lb << 31; goto W9D_1; XjqOe: $atr_alc = (int) $this->_style->getAlignment()->getWrapText() ? 1 : 0; goto ggLBp; FE5zH: $border2 |= self::mapBorderStyle($this->_style->getBorders()->getDiagonal()->getBorderStyle()) << 21; goto vcPAS; T956E: $diag_tl_to_rb = $diagonalDirection == PHPExcel_Style_Borders::DIAGONAL_BOTH || $diagonalDirection == PHPExcel_Style_Borders::DIAGONAL_DOWN; goto kHfYa; PkTtd: $icv = $this->foregroundColor; goto Hg24r; uj12O: $border1 |= self::mapBorderStyle($this->_style->getBorders()->getTop()->getBorderStyle()) << 8; goto lz2xd; cWLh5: $used_attrib |= $atr_prot << 7; goto PkTtd; UeQQT: $record = 0xe0; goto E5MqW; i1LlQ: $data .= pack("\x43\103\x43", self::mapTextRotation($this->_style->getAlignment()->getTextRotation()), $biff8_options, $used_attrib); goto FhkYZ; M84kr: $header = pack("\166\x76", $record, $length); goto vAt3_; ggLBp: $atr_bdr = self::mapBorderStyle($this->_style->getBorders()->getBottom()->getBorderStyle()) || self::mapBorderStyle($this->_style->getBorders()->getTop()->getBorderStyle()) || self::mapBorderStyle($this->_style->getBorders()->getLeft()->getBorderStyle()) || self::mapBorderStyle($this->_style->getBorders()->getRight()->getBorderStyle()) ? 1 : 0; goto hml3E; gByqE: $border2 |= $this->bottomBorderColor << 7; goto fivUS; hml3E: $atr_pat = $this->foregroundColor != 0x40 || $this->backgroundColor != 0x41 || self::mapFillType($this->_style->getFill()->getFillType()) ? 1 : 0; goto dhjfW; oLy3l: $border1 |= $this->leftBorderColor << 16; goto XTUF0; vvywT: $align |= $this->textJustLast << 7; goto YEyZx; p7w3O: if (self::mapBorderStyle($this->_style->getBorders()->getBottom()->getBorderStyle()) == 0) { $this->bottomBorderColor = 0; } goto gyIGT; sQcN1: } public function setIsStyleXf($value) { $this->isStyleXf = $value; } public function setBottomColor($colorIndex) { $this->bottomBorderColor = $colorIndex; } public function setTopColor($colorIndex) { $this->topBorderColor = $colorIndex; } public function setLeftColor($colorIndex) { $this->leftBorderColor = $colorIndex; } public function setRightColor($colorIndex) { $this->rightBorderColor = $colorIndex; } public function setDiagColor($colorIndex) { $this->_diag_color = $colorIndex; } public function setFgColor($colorIndex) { $this->foregroundColor = $colorIndex; } public function setBgColor($colorIndex) { $this->backgroundColor = $colorIndex; } public function setNumberFormatIndex($numberFormatIndex) { $this->numberFormatIndex = $numberFormatIndex; } public function setFontIndex($value) { $this->fontIndex = $value; } private static $mapBorderStyles = array(PHPExcel_Style_Border::BORDER_NONE => 0x0, PHPExcel_Style_Border::BORDER_THIN => 0x1, PHPExcel_Style_Border::BORDER_MEDIUM => 0x2, PHPExcel_Style_Border::BORDER_DASHED => 0x3, PHPExcel_Style_Border::BORDER_DOTTED => 0x4, PHPExcel_Style_Border::BORDER_THICK => 0x5, PHPExcel_Style_Border::BORDER_DOUBLE => 0x6, PHPExcel_Style_Border::BORDER_HAIR => 0x7, PHPExcel_Style_Border::BORDER_MEDIUMDASHED => 0x8, PHPExcel_Style_Border::BORDER_DASHDOT => 0x9, PHPExcel_Style_Border::BORDER_MEDIUMDASHDOT => 0xa, PHPExcel_Style_Border::BORDER_DASHDOTDOT => 0xb, PHPExcel_Style_Border::BORDER_MEDIUMDASHDOTDOT => 0xc, PHPExcel_Style_Border::BORDER_SLANTDASHDOT => 0xd); private static function mapBorderStyle($borderStyle) { if (isset(self::$mapBorderStyles[$borderStyle])) { return self::$mapBorderStyles[$borderStyle]; } return 0x0; } private static $mapFillTypes = array(PHPExcel_Style_Fill::FILL_NONE => 0x0, PHPExcel_Style_Fill::FILL_SOLID => 0x1, PHPExcel_Style_Fill::FILL_PATTERN_MEDIUMGRAY => 0x2, PHPExcel_Style_Fill::FILL_PATTERN_DARKGRAY => 0x3, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTGRAY => 0x4, PHPExcel_Style_Fill::FILL_PATTERN_DARKHORIZONTAL => 0x5, PHPExcel_Style_Fill::FILL_PATTERN_DARKVERTICAL => 0x6, PHPExcel_Style_Fill::FILL_PATTERN_DARKDOWN => 0x7, PHPExcel_Style_Fill::FILL_PATTERN_DARKUP => 0x8, PHPExcel_Style_Fill::FILL_PATTERN_DARKGRID => 0x9, PHPExcel_Style_Fill::FILL_PATTERN_DARKTRELLIS => 0xa, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTHORIZONTAL => 0xb, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTVERTICAL => 0xc, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTDOWN => 0xd, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTUP => 0xe, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTGRID => 0xf, PHPExcel_Style_Fill::FILL_PATTERN_LIGHTTRELLIS => 0x10, PHPExcel_Style_Fill::FILL_PATTERN_GRAY125 => 0x11, PHPExcel_Style_Fill::FILL_PATTERN_GRAY0625 => 0x12, PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR => 0x0, PHPExcel_Style_Fill::FILL_GRADIENT_PATH => 0x0); private static function mapFillType($fillType) { if (isset(self::$mapFillTypes[$fillType])) { return self::$mapFillTypes[$fillType]; } return 0x0; } private static $mapHAlignments = array(PHPExcel_Style_Alignment::HORIZONTAL_GENERAL => 0, PHPExcel_Style_Alignment::HORIZONTAL_LEFT => 1, PHPExcel_Style_Alignment::HORIZONTAL_CENTER => 2, PHPExcel_Style_Alignment::HORIZONTAL_RIGHT => 3, PHPExcel_Style_Alignment::HORIZONTAL_FILL => 4, PHPExcel_Style_Alignment::HORIZONTAL_JUSTIFY => 5, PHPExcel_Style_Alignment::HORIZONTAL_CENTER_CONTINUOUS => 6); private function mapHAlign($hAlign) { if (isset(self::$mapHAlignments[$hAlign])) { return self::$mapHAlignments[$hAlign]; } return 0; } private static $mapVAlignments = array(PHPExcel_Style_Alignment::VERTICAL_TOP => 0, PHPExcel_Style_Alignment::VERTICAL_CENTER => 1, PHPExcel_Style_Alignment::VERTICAL_BOTTOM => 2, PHPExcel_Style_Alignment::VERTICAL_JUSTIFY => 3); private static function mapVAlign($vAlign) { if (isset(self::$mapVAlignments[$vAlign])) { return self::$mapVAlignments[$vAlign]; } return 2; } private static function mapTextRotation($textRotation) { if ($textRotation >= 0) { return $textRotation; } elseif ($textRotation == -165) { return 255; } elseif ($textRotation < 0) { return 90 - $textRotation; } } private static function mapLocked($locked) { switch ($locked) { case PHPExcel_Style_Protection::PROTECTION_INHERIT: return 1; case PHPExcel_Style_Protection::PROTECTION_PROTECTED: return 1; case PHPExcel_Style_Protection::PROTECTION_UNPROTECTED: return 0; default: return 1; } } private static function mapHidden($hidden) { switch ($hidden) { case PHPExcel_Style_Protection::PROTECTION_INHERIT: return 0; case PHPExcel_Style_Protection::PROTECTION_PROTECTED: return 1; case PHPExcel_Style_Protection::PROTECTION_UNPROTECTED: return 0; default: return 0; } } }
