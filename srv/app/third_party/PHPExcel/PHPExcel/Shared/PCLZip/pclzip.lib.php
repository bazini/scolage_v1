<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:04              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 goto bJ94k; q_MiD: define("\x50\103\x4c\x5a\111\x50\137\x45\x52\x52\x5f\x52\105\x4e\101\x4d\x45\137\x46\111\x4c\105\137\106\x41\111\114", -12); goto p1iBt; eUm5S: define("\120\103\x4c\x5a\111\120\137\101\x54\124\137\106\111\x4c\105\x5f\103\117\116\124\x45\116\x54", 79005); goto gG6Fj; HQl9C: define("\120\x43\x4c\132\x49\x50\137\105\x52\x52\137\115\111\x53\x53\111\x4e\x47\137\x46\111\114\105", -4); goto cdGXx; PenOa: define("\x50\x43\x4c\x5a\x49\x50\x5f\x45\122\122\137\x44\x49\x52\137\x43\122\105\101\124\105\x5f\106\101\111\x4c", -8); goto Uq0U4; m3FB2: define("\120\103\x4c\x5a\x49\120\137\x41\x54\x54\x5f\106\111\114\x45\x5f\116\101\115\x45", 79001); goto NtbDs; YG10E: define("\x50\x43\114\x5a\111\x50\137\103\x42\137\x50\x52\105\x5f\x45\130\x54\122\x41\103\x54", 78001); goto N4n0v; GJHUR: define("\120\103\x4c\x5a\111\x50\x5f\117\x50\x54\137\101\x44\104\137\124\x45\115\x50\137\106\111\114\105\x5f\x54\110\122\105\x53\x48\x4f\x4c\104", 77020); goto BcLoB; fboUk: define("\120\103\114\132\111\120\x5f\117\x50\124\x5f\x41\104\104\x5f\x54\x45\x4d\x50\x5f\x46\111\x4c\x45\x5f\117\x46\x46", 77022); goto m3FB2; bJ94k: if (!defined("\120\103\114\132\111\x50\x5f\122\105\x41\104\137\102\114\x4f\x43\x4b\137\x53\111\132\x45")) { define("\120\x43\114\132\x49\x50\137\122\x45\101\x44\137\102\114\x4f\x43\113\137\123\x49\x5a\x45", 2048); } goto z32_s; vUrUi: define("\x50\103\114\132\x49\x50\137\x4f\x50\x54\137\x41\x44\104\x5f\120\x41\x54\x48", 77002); goto wmALc; qhAW4: define("\x50\x43\x4c\132\x49\x50\137\105\122\x52\137\111\x4e\x56\101\114\x49\104\137\101\x52\x43\110\x49\x56\x45\x5f\132\111\120", -14); goto cowGs; jp_Af: define("\120\103\x4c\132\x49\x50\x5f\x41\124\124\x5f\106\111\x4c\105\x5f\116\x45\127\137\106\125\114\114\x5f\x4e\101\x4d\105", 79003); goto L3k8A; wmALc: define("\120\x43\114\x5a\111\x50\137\117\120\x54\x5f\x52\x45\115\x4f\126\x45\137\x50\x41\124\x48", 77003); goto V1HxI; EpSOe: define("\120\x43\114\132\x49\x50\137\x45\x52\x52\x5f\x4e\x4f\137\105\x52\x52\x4f\x52", 0); goto pdclD; otvID: define("\x50\103\114\132\x49\120\x5f\105\122\122\x5f\111\x4e\x56\x41\x4c\111\x44\x5f\117\120\124\x49\117\x4e\137\126\101\x4c\125\x45", -16); goto HyUZl; Nssu2: function PclZipUtilOptionText($p_option) { goto NgEO0; AbXHh: $v_result = "\125\x6e\153\156\x6f\x77\156"; goto xlrPG; ZTYtw: for (reset($v_list); $v_key = key($v_list); next($v_list)) { $v_prefix = substr($v_key, 0, 10); if (($v_prefix == "\x50\103\x4c\x5a\x49\120\x5f\x4f\x50\x54" || $v_prefix == "\x50\103\x4c\132\111\x50\x5f\x43\102\x5f" || $v_prefix == "\x50\103\x4c\x5a\111\120\x5f\101\x54\124") && $v_list[$v_key] == $p_option) { return $v_key; } } goto AbXHh; xlrPG: return $v_result; goto ANhlb; NgEO0: $v_list = get_defined_constants(); goto ZTYtw; ANhlb: } goto GGPCc; m1Pvm: if (!defined("\120\103\x4c\x5a\x49\x50\137\124\105\115\120\x4f\x52\101\122\x59\x5f\106\111\114\x45\137\x52\x41\x54\111\x4f")) { define("\120\x43\x4c\132\111\x50\137\x54\105\x4d\x50\x4f\122\101\122\x59\x5f\x46\x49\x4c\x45\x5f\x52\101\x54\x49\117", 0.47); } goto f1ZUv; V1HxI: define("\x50\103\114\x5a\111\x50\x5f\117\x50\x54\x5f\122\105\115\117\126\x45\x5f\x41\x4c\114\x5f\x50\x41\124\110", 77004); goto E_871; p1iBt: define("\x50\x43\x4c\132\x49\x50\137\x45\x52\122\x5f\102\101\104\x5f\x43\110\x45\x43\x4b\x53\x55\x4d", -13); goto qhAW4; hu4Xr: define("\x50\103\114\x5a\x49\120\137\117\120\x54\137\120\122\x45\x50\x45\116\104\137\103\x4f\x4d\x4d\x45\116\x54", 77014); goto Pwz8L; mX_nF: define("\x50\103\x4c\x5a\x49\x50\x5f\x4f\x50\x54\x5f\105\x58\x54\122\101\x43\x54\137\101\x53\137\x53\124\122\x49\116\x47", 77006); goto wEaew; UGJvg: define("\120\103\x4c\132\111\x50\137\x45\122\122\x5f\x55\116\x53\x55\x50\120\x4f\x52\x54\105\104\137\103\117\115\x50\122\105\x53\123\111\x4f\116", -18); goto mlNdA; WNqWf: define("\x50\103\x4c\132\111\120\137\x4f\x50\124\137\x54\x45\x4d\x50\x5f\x46\x49\114\x45\x5f\117\106\106", 77022); goto fboUk; G3J1B: define("\120\x43\x4c\132\x49\x50\x5f\105\x52\122\137\104\111\122\x45\x43\124\117\122\x59\137\x52\105\x53\124\122\111\x43\124\x49\117\x4e", -21); goto nV_Kx; T9nEQ: define("\120\x43\114\132\x49\x50\137\x45\122\x52\137\x42\101\104\137\105\130\x54\x52\x41\x43\124\x45\104\x5f\106\x49\114\105", -7); goto PenOa; OTKrE: define("\120\103\x4c\132\111\x50\x5f\x45\122\x52\137\x42\101\x44\137\106\x4f\x52\x4d\x41\124", -10); goto gBTF9; m3cHZ: define("\120\x43\x4c\132\111\120\x5f\x4f\x50\124\x5f\102\x59\x5f\120\122\105\107", 77011); goto ieD2e; zvxRk: function PclZipUtilCopyBlock($p_src, $p_dest, $p_size, $p_mode = 0) { goto EXTam; EXTam: $v_result = 1; goto F0Dp_; D2R7r: return $v_result; goto X0235; F0Dp_: if ($p_mode == 0) { while ($p_size != 0) { $v_read_size = $p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($p_src, $v_read_size); @fwrite($p_dest, $v_buffer, $v_read_size); $p_size -= $v_read_size; } } elseif ($p_mode == 1) { while ($p_size != 0) { $v_read_size = $p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @gzread($p_src, $v_read_size); @fwrite($p_dest, $v_buffer, $v_read_size); $p_size -= $v_read_size; } } elseif ($p_mode == 2) { while ($p_size != 0) { $v_read_size = $p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($p_src, $v_read_size); @gzwrite($p_dest, $v_buffer, $v_read_size); $p_size -= $v_read_size; } } elseif ($p_mode == 3) { while ($p_size != 0) { $v_read_size = $p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @gzread($p_src, $v_read_size); @gzwrite($p_dest, $v_buffer, $v_read_size); $p_size -= $v_read_size; } } goto D2R7r; X0235: } goto owaEX; NtbDs: define("\120\x43\x4c\x5a\111\x50\137\x41\x54\x54\137\x46\111\x4c\x45\x5f\116\x45\127\137\123\x48\117\122\x54\x5f\116\x41\x4d\105", 79002); goto jp_Af; nV_Kx: define("\120\103\114\x5a\x49\x50\137\x4f\120\x54\137\x50\101\124\x48", 77001); goto vUrUi; owaEX: function PclZipUtilRename($p_src, $p_dest) { goto tY_bS; XL1Ac: return $v_result; goto Fr9Ki; tY_bS: $v_result = 1; goto ZWtdq; ZWtdq: if (!@rename($p_src, $p_dest)) { if (!@copy($p_src, $p_dest)) { $v_result = 0; } elseif (!@unlink($p_src)) { $v_result = 0; } } goto XL1Ac; Fr9Ki: } goto Nssu2; JLuj2: class PclZip { public $zipname = ''; public $zip_fd = 0; public $error_code = 1; public $error_string = ''; public $magic_quotes_status; public function __construct($p_zipname) { goto nc2lL; z_HC0: return; goto hzpF_; IOjwg: $this->magic_quotes_status = -1; goto z_HC0; nc2lL: if (!function_exists("\147\x7a\x6f\x70\145\x6e")) { die("\x41\142\157\162\164\x20" . basename(__FILE__) . "\x20\72\40\115\x69\163\163\151\x6e\147\40\172\154\151\x62\40\145\x78\x74\145\156\163\151\157\x6e\163"); } goto nMeDc; UIbVu: $this->zip_fd = 0; goto IOjwg; nMeDc: $this->zipname = $p_zipname; goto UIbVu; hzpF_: } public function create($p_filelist) { goto QJZPp; csBVn: $v_supported_attributes = array(PCLZIP_ATT_FILE_NAME => "\155\141\x6e\x64\141\x74\157\162\x79", PCLZIP_ATT_FILE_NEW_SHORT_NAME => "\157\160\x74\151\x6f\x6e\141\x6c", PCLZIP_ATT_FILE_NEW_FULL_NAME => "\x6f\x70\x74\x69\157\x6e\141\x6c", PCLZIP_ATT_FILE_MTIME => "\157\x70\164\x69\157\156\x61\154", PCLZIP_ATT_FILE_CONTENT => "\x6f\160\x74\151\157\x6e\x61\x6c", PCLZIP_ATT_FILE_COMMENT => "\x6f\160\164\151\x6f\x6e\x61\x6c"); goto yGcit; CUZA2: $this->privErrorReset(); goto YOspu; FA53p: $v_att_list = array(); goto Y6eaU; bTHd_: $p_result_list = array(); goto oymGd; oymGd: if (is_array($p_filelist)) { if (isset($p_filelist[0]) && is_array($p_filelist[0])) { $v_att_list = $p_filelist; } else { $v_string_list = $p_filelist; } } elseif (is_string($p_filelist)) { $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist); } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\156\166\141\154\x69\144\x20\166\x61\162\x69\141\x62\154\x65\x20\164\x79\160\x65\40\160\x5f\146\x69\x6c\x65\x6c\151\163\164"); return 0; } goto u5cmC; YOspu: $v_options = array(); goto HBjds; OsxAK: $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options); goto Ps0ZJ; OWvO8: return $p_result_list; goto TXh3C; ac4BG: $v_size = func_num_args(); goto xQnN_; HJomq: if ($v_result != 1) { return 0; } goto OWvO8; yGcit: foreach ($v_att_list as $v_entry) { $v_result = $this->privFileDescrParseAtt($v_entry, $v_filedescr_list[], $v_options, $v_supported_attributes); if ($v_result != 1) { return 0; } } goto OsxAK; Ps0ZJ: if ($v_result != 1) { return 0; } goto ri4yv; xQnN_: if ($v_size > 1) { goto Rp_3q; Rp_3q: $v_arg_list = func_get_args(); goto lsDv8; TtxS3: $v_size--; goto P0PGq; P0PGq: if (is_integer($v_arg_list[0]) && $v_arg_list[0] > 77000) { $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options, array(PCLZIP_OPT_REMOVE_PATH => "\x6f\160\164\151\157\x6e\141\x6c", PCLZIP_OPT_REMOVE_ALL_PATH => "\x6f\x70\164\x69\x6f\x6e\x61\x6c", PCLZIP_OPT_ADD_PATH => "\x6f\160\x74\151\x6f\x6e\x61\x6c", PCLZIP_CB_PRE_ADD => "\x6f\x70\x74\x69\157\156\x61\x6c", PCLZIP_CB_POST_ADD => "\x6f\x70\x74\151\157\x6e\141\x6c", PCLZIP_OPT_NO_COMPRESSION => "\x6f\x70\x74\151\157\156\x61\x6c", PCLZIP_OPT_COMMENT => "\157\x70\164\151\157\156\x61\x6c", PCLZIP_OPT_TEMP_FILE_THRESHOLD => "\x6f\x70\x74\x69\157\x6e\141\154", PCLZIP_OPT_TEMP_FILE_ON => "\x6f\160\164\x69\x6f\x6e\x61\154", PCLZIP_OPT_TEMP_FILE_OFF => "\x6f\x70\164\x69\x6f\x6e\x61\x6c")); if ($v_result != 1) { return 0; } } else { $v_options[PCLZIP_OPT_ADD_PATH] = $v_arg_list[0]; if ($v_size == 2) { $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1]; } elseif ($v_size > 2) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\x6e\x76\x61\154\151\144\x20\x6e\165\x6d\x62\145\162\40\57\40\x74\x79\x70\x65\40\157\x66\x20\141\162\x67\x75\155\145\x6e\164\x73"); return 0; } } goto soraQ; lsDv8: array_shift($v_arg_list); goto TtxS3; soraQ: } goto uOP1L; zQJ1B: $v_string_list = array(); goto FA53p; u5cmC: if (sizeof($v_string_list) != 0) { foreach ($v_string_list as $v_string) { if ($v_string != '') { $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string; } else { } } } goto csBVn; HBjds: $v_options[PCLZIP_OPT_NO_COMPRESSION] = false; goto ac4BG; QJZPp: $v_result = 1; goto CUZA2; Y6eaU: $v_filedescr_list = array(); goto bTHd_; uOP1L: $this->privOptionDefaultThreshold($v_options); goto zQJ1B; ri4yv: $v_result = $this->privCreate($v_filedescr_list, $p_result_list, $v_options); goto HJomq; TXh3C: } public function add($p_filelist) { goto lg3nL; remkd: $v_string_list = array(); goto C4hf0; D230n: $v_result = $this->privAdd($v_filedescr_list, $p_result_list, $v_options); goto bcb0S; FiJZM: $p_result_list = array(); goto e2ALK; KpW5u: $v_filedescr_list = array(); goto FiJZM; lg3nL: $v_result = 1; goto CBPxR; I41bI: if ($v_result != 1) { return 0; } goto D230n; bcb0S: if ($v_result != 1) { return 0; } goto nE62T; wukNH: if (sizeof($v_string_list) != 0) { foreach ($v_string_list as $v_string) { $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string; } } goto lNdbC; tkDh9: $v_size = func_num_args(); goto aY_iz; ryv4T: foreach ($v_att_list as $v_entry) { $v_result = $this->privFileDescrParseAtt($v_entry, $v_filedescr_list[], $v_options, $v_supported_attributes); if ($v_result != 1) { return 0; } } goto Hmv3_; e2ALK: if (is_array($p_filelist)) { if (isset($p_filelist[0]) && is_array($p_filelist[0])) { $v_att_list = $p_filelist; } else { $v_string_list = $p_filelist; } } elseif (is_string($p_filelist)) { $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist); } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\111\x6e\166\x61\154\x69\x64\x20\166\x61\162\151\x61\x62\x6c\145\x20\x74\171\160\x65\x20\47" . gettype($p_filelist) . "\x27\40\146\157\162\x20\x70\x5f\x66\x69\154\x65\154\151\x73\164"); return 0; } goto wukNH; wD5bj: $this->privOptionDefaultThreshold($v_options); goto remkd; CBPxR: $this->privErrorReset(); goto j2e15; kodXn: $v_options[PCLZIP_OPT_NO_COMPRESSION] = false; goto tkDh9; lNdbC: $v_supported_attributes = array(PCLZIP_ATT_FILE_NAME => "\155\141\156\x64\x61\164\x6f\x72\171", PCLZIP_ATT_FILE_NEW_SHORT_NAME => "\157\160\164\x69\157\x6e\141\x6c", PCLZIP_ATT_FILE_NEW_FULL_NAME => "\x6f\160\164\151\x6f\156\x61\x6c", PCLZIP_ATT_FILE_MTIME => "\x6f\x70\x74\151\157\156\141\154", PCLZIP_ATT_FILE_CONTENT => "\x6f\x70\164\151\x6f\156\x61\154", PCLZIP_ATT_FILE_COMMENT => "\x6f\160\164\151\x6f\x6e\141\154"); goto ryv4T; Hmv3_: $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options); goto I41bI; j2e15: $v_options = array(); goto kodXn; C4hf0: $v_att_list = array(); goto KpW5u; nE62T: return $p_result_list; goto ENyq0; aY_iz: if ($v_size > 1) { goto wKAkS; pXIcj: array_shift($v_arg_list); goto wMBLZ; wKAkS: $v_arg_list = func_get_args(); goto pXIcj; wMBLZ: $v_size--; goto ZNaUR; ZNaUR: if (is_integer($v_arg_list[0]) && $v_arg_list[0] > 77000) { $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options, array(PCLZIP_OPT_REMOVE_PATH => "\x6f\x70\164\x69\x6f\156\141\154", PCLZIP_OPT_REMOVE_ALL_PATH => "\157\160\164\151\x6f\x6e\x61\x6c", PCLZIP_OPT_ADD_PATH => "\157\x70\164\151\157\x6e\141\154", PCLZIP_CB_PRE_ADD => "\x6f\160\x74\x69\x6f\x6e\141\x6c", PCLZIP_CB_POST_ADD => "\x6f\x70\164\x69\157\156\141\154", PCLZIP_OPT_NO_COMPRESSION => "\x6f\x70\164\151\x6f\x6e\141\x6c", PCLZIP_OPT_COMMENT => "\x6f\x70\x74\151\x6f\156\x61\x6c", PCLZIP_OPT_ADD_COMMENT => "\x6f\160\164\151\x6f\x6e\141\x6c", PCLZIP_OPT_PREPEND_COMMENT => "\157\x70\x74\x69\157\156\141\154", PCLZIP_OPT_TEMP_FILE_THRESHOLD => "\157\x70\164\x69\x6f\156\x61\154", PCLZIP_OPT_TEMP_FILE_ON => "\157\160\164\x69\x6f\x6e\x61\154", PCLZIP_OPT_TEMP_FILE_OFF => "\157\x70\164\x69\157\x6e\x61\x6c")); if ($v_result != 1) { return 0; } } else { $v_options[PCLZIP_OPT_ADD_PATH] = $v_add_path = $v_arg_list[0]; if ($v_size == 2) { $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1]; } elseif ($v_size > 2) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\156\x76\141\x6c\151\144\40\156\165\155\142\x65\162\x20\x2f\40\x74\x79\160\x65\x20\157\x66\x20\x61\x72\147\x75\x6d\x65\x6e\164\x73"); return 0; } } goto bKRgI; bKRgI: } goto wD5bj; ENyq0: } public function listContent() { goto A6g0V; TFHxL: return $p_list; goto Bolmo; Rz_5I: $this->privErrorReset(); goto nUB3V; nUB3V: if (!$this->privCheckFormat()) { return 0; } goto Umr9A; Umr9A: $p_list = array(); goto zJCqb; A6g0V: $v_result = 1; goto Rz_5I; zJCqb: if (($v_result = $this->privList($p_list)) != 1) { unset($p_list); return 0; } goto TFHxL; Bolmo: } public function extract() { goto wXDfg; BOI_g: $v_remove_path = ''; goto Fzi3I; QFhtl: return $p_list; goto rhELH; vq0ps: $v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path, $v_remove_all_path, $v_options); goto oDTUR; Lhqom: $p_list = array(); goto vq0ps; wXDfg: $v_result = 1; goto EmJAd; Iz6tK: if ($v_size > 0) { $v_arg_list = func_get_args(); if (is_integer($v_arg_list[0]) && $v_arg_list[0] > 77000) { goto ioTHp; khJDP: if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) { $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH]; } goto x75QU; tgIHe: if (isset($v_options[PCLZIP_OPT_PATH])) { $v_path = $v_options[PCLZIP_OPT_PATH]; } goto khJDP; u3_me: if (isset($v_options[PCLZIP_OPT_ADD_PATH])) { if (strlen($v_path) > 0 && substr($v_path, -1) != "\x2f") { $v_path .= "\x2f"; } $v_path .= $v_options[PCLZIP_OPT_ADD_PATH]; } goto eO7H2; hNfwA: if ($v_result != 1) { return 0; } goto tgIHe; x75QU: if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) { $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH]; } goto u3_me; ioTHp: $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options, array(PCLZIP_OPT_PATH => "\x6f\160\164\x69\x6f\x6e\141\x6c", PCLZIP_OPT_REMOVE_PATH => "\157\160\x74\x69\x6f\x6e\x61\x6c", PCLZIP_OPT_REMOVE_ALL_PATH => "\x6f\x70\164\151\x6f\x6e\141\154", PCLZIP_OPT_ADD_PATH => "\157\x70\x74\151\157\x6e\141\154", PCLZIP_CB_PRE_EXTRACT => "\157\160\164\151\157\156\x61\154", PCLZIP_CB_POST_EXTRACT => "\157\160\x74\x69\157\x6e\141\154", PCLZIP_OPT_SET_CHMOD => "\x6f\x70\x74\x69\157\x6e\141\154", PCLZIP_OPT_BY_NAME => "\x6f\160\x74\x69\157\156\141\x6c", PCLZIP_OPT_BY_EREG => "\x6f\x70\x74\x69\157\156\x61\x6c", PCLZIP_OPT_BY_PREG => "\157\160\x74\x69\157\x6e\x61\154", PCLZIP_OPT_BY_INDEX => "\x6f\160\x74\x69\x6f\x6e\141\154", PCLZIP_OPT_EXTRACT_AS_STRING => "\157\x70\x74\x69\x6f\156\141\154", PCLZIP_OPT_EXTRACT_IN_OUTPUT => "\x6f\x70\164\x69\x6f\x6e\x61\154", PCLZIP_OPT_REPLACE_NEWER => "\157\160\164\151\157\156\x61\154", PCLZIP_OPT_STOP_ON_ERROR => "\x6f\x70\164\151\157\156\x61\154", PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => "\x6f\160\x74\151\x6f\156\x61\x6c", PCLZIP_OPT_TEMP_FILE_THRESHOLD => "\157\x70\164\x69\157\x6e\141\x6c", PCLZIP_OPT_TEMP_FILE_ON => "\x6f\x70\164\x69\x6f\156\141\x6c", PCLZIP_OPT_TEMP_FILE_OFF => "\x6f\x70\x74\151\x6f\x6e\x61\154")); goto hNfwA; eO7H2: } else { $v_path = $v_arg_list[0]; if ($v_size == 2) { $v_remove_path = $v_arg_list[1]; } elseif ($v_size > 2) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\111\156\x76\141\154\151\x64\x20\x6e\x75\155\142\x65\162\40\x2f\40\x74\171\x70\145\40\x6f\x66\x20\141\162\x67\165\155\145\156\164\x73"); return 0; } } } goto Xv4vx; Xv4vx: $this->privOptionDefaultThreshold($v_options); goto Lhqom; oDTUR: if ($v_result < 1) { unset($p_list); return 0; } goto QFhtl; C1HR_: $v_size = func_num_args(); goto zZVOp; Fzi3I: $v_remove_all_path = false; goto C1HR_; EmJAd: $this->privErrorReset(); goto vJ_F2; WSNpF: $v_path = ''; goto BOI_g; vJ_F2: if (!$this->privCheckFormat()) { return 0; } goto qgsfs; zZVOp: $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = false; goto Iz6tK; qgsfs: $v_options = array(); goto WSNpF; rhELH: } public function extractByIndex($p_index) { goto W57qT; XYXad: $v_remove_all_path = false; goto aMpR8; qb2VR: $this->privErrorReset(); goto xq2bg; rPy1S: $v_remove_path = ''; goto XYXad; KMx0S: if ($v_result != 1) { return 0; } goto FzITe; aMpR8: $v_size = func_num_args(); goto KyMjr; xq2bg: if (!$this->privCheckFormat()) { return 0; } goto rQdM8; FzITe: $v_options[PCLZIP_OPT_BY_INDEX] = $v_options_trick[PCLZIP_OPT_BY_INDEX]; goto yd8fv; d87Mz: $v_result = $this->privParseOptions($v_arg_trick, sizeof($v_arg_trick), $v_options_trick, array(PCLZIP_OPT_BY_INDEX => "\157\x70\164\151\157\156\141\154")); goto KMx0S; KyMjr: $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = false; goto Q9ecV; rQdM8: $v_options = array(); goto FjC7j; Q9ecV: if ($v_size > 1) { goto j65Ne; OCojw: array_shift($v_arg_list); goto N9cAf; j65Ne: $v_arg_list = func_get_args(); goto OCojw; N9cAf: $v_size--; goto zpo6i; zpo6i: if (is_integer($v_arg_list[0]) && $v_arg_list[0] > 77000) { goto fovsn; gPeJ1: if (isset($v_options[PCLZIP_OPT_PATH])) { $v_path = $v_options[PCLZIP_OPT_PATH]; } goto TcSu0; FSsf4: if (isset($v_options[PCLZIP_OPT_ADD_PATH])) { if (strlen($v_path) > 0 && substr($v_path, -1) != "\57") { $v_path .= "\x2f"; } $v_path .= $v_options[PCLZIP_OPT_ADD_PATH]; } goto jDZOl; crOb6: if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) { $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH]; } goto FSsf4; fovsn: $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options, array(PCLZIP_OPT_PATH => "\x6f\x70\x74\x69\x6f\156\x61\154", PCLZIP_OPT_REMOVE_PATH => "\157\160\164\x69\x6f\156\141\x6c", PCLZIP_OPT_REMOVE_ALL_PATH => "\x6f\x70\x74\151\x6f\156\x61\x6c", PCLZIP_OPT_EXTRACT_AS_STRING => "\157\x70\164\151\157\156\141\154", PCLZIP_OPT_ADD_PATH => "\157\x70\164\151\x6f\x6e\x61\x6c", PCLZIP_CB_PRE_EXTRACT => "\157\x70\164\x69\157\x6e\141\154", PCLZIP_CB_POST_EXTRACT => "\x6f\x70\x74\x69\157\156\x61\x6c", PCLZIP_OPT_SET_CHMOD => "\157\x70\x74\151\x6f\156\x61\x6c", PCLZIP_OPT_REPLACE_NEWER => "\x6f\160\x74\x69\157\x6e\x61\154", PCLZIP_OPT_STOP_ON_ERROR => "\x6f\160\x74\151\157\x6e\x61\x6c", PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => "\x6f\x70\164\151\157\x6e\x61\x6c", PCLZIP_OPT_TEMP_FILE_THRESHOLD => "\x6f\x70\x74\x69\157\x6e\x61\154", PCLZIP_OPT_TEMP_FILE_ON => "\x6f\x70\164\151\x6f\156\x61\x6c", PCLZIP_OPT_TEMP_FILE_OFF => "\157\160\x74\x69\x6f\156\x61\x6c")); goto BxPdQ; BxPdQ: if ($v_result != 1) { return 0; } goto gPeJ1; TcSu0: if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) { $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH]; } goto crOb6; jDZOl: if (!isset($v_options[PCLZIP_OPT_EXTRACT_AS_STRING])) { $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = false; } else { } goto tsnJU; tsnJU: } else { $v_path = $v_arg_list[0]; if ($v_size == 2) { $v_remove_path = $v_arg_list[1]; } elseif ($v_size > 2) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\156\x76\141\x6c\151\x64\40\x6e\165\155\x62\145\x72\x20\57\x20\x74\171\160\145\40\157\146\40\x61\x72\147\165\x6d\x65\x6e\164\163"); return 0; } } goto k2bxe; k2bxe: } goto DlV2J; UzU29: $v_options_trick = array(); goto d87Mz; FjC7j: $v_path = ''; goto rPy1S; l_KQz: if (($v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path, $v_remove_all_path, $v_options)) < 1) { return 0; } goto JADT4; W57qT: $v_result = 1; goto qb2VR; yd8fv: $this->privOptionDefaultThreshold($v_options); goto l_KQz; JADT4: return $p_list; goto U6UPO; DlV2J: $v_arg_trick = array(PCLZIP_OPT_BY_INDEX, $p_index); goto UzU29; U6UPO: } public function delete() { goto Zno8C; bA4oq: $this->privErrorReset(); goto wvmnt; kiZKt: if ($v_size > 0) { goto g0NRB; f0tHj: if ($v_result != 1) { return 0; } goto Az7l0; xowKY: $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options, array(PCLZIP_OPT_BY_NAME => "\157\x70\x74\151\157\x6e\x61\x6c", PCLZIP_OPT_BY_EREG => "\x6f\x70\164\x69\x6f\156\x61\154", PCLZIP_OPT_BY_PREG => "\x6f\x70\x74\x69\157\x6e\141\154", PCLZIP_OPT_BY_INDEX => "\157\x70\164\x69\157\156\141\x6c")); goto f0tHj; g0NRB: $v_arg_list = func_get_args(); goto xowKY; Az7l0: } goto VW_eh; yT9Kn: $v_size = func_num_args(); goto kiZKt; wvmnt: if (!$this->privCheckFormat()) { return 0; } goto Viq24; miRtt: $this->privSwapBackMagicQuotes(); goto BPhwt; Vai7D: if (($v_result = $this->privDeleteByRule($v_list, $v_options)) != 1) { goto N0zvz; gZFZC: unset($v_list); goto nJMcB; N0zvz: $this->privSwapBackMagicQuotes(); goto gZFZC; nJMcB: return 0; goto r_Ic9; r_Ic9: } goto miRtt; Zno8C: $v_result = 1; goto bA4oq; Viq24: $v_options = array(); goto yT9Kn; VW_eh: $this->privDisableMagicQuotes(); goto ciURz; ciURz: $v_list = array(); goto Vai7D; BPhwt: return $v_list; goto rZD39; rZD39: } public function deleteByIndex($p_index) { $p_list = $this->delete(PCLZIP_OPT_BY_INDEX, $p_index); return $p_list; } public function properties() { goto iK8CJ; hI0py: if (@is_file($this->zipname)) { goto X7ZUR; X7ZUR: if (($this->zip_fd = @fopen($this->zipname, "\162\142")) == 0) { goto KWpW7; KWpW7: $this->privSwapBackMagicQuotes(); goto WZIdB; WZIdB: PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\156\141\142\x6c\145\x20\x74\157\x20\157\x70\145\156\x20\x61\x72\x63\x68\x69\166\x65\40\47" . $this->zipname . "\47\x20\x69\156\40\x62\151\156\x61\x72\x79\40\x72\145\x61\x64\x20\x6d\x6f\x64\x65"); goto VWyK6; VWyK6: return 0; goto PmZTF; PmZTF: } goto lXMQx; DzIrk: $this->privCloseFd(); goto hJpVG; hJpVG: $v_prop["\143\157\x6d\x6d\145\x6e\164"] = $v_central_dir["\x63\157\155\155\x65\x6e\x74"]; goto RhZFl; h6qNw: $v_prop["\163\164\x61\164\x75\x73"] = "\157\x6b"; goto Ff7co; RhZFl: $v_prop["\x6e\x62"] = $v_central_dir["\145\156\x74\162\151\145\x73"]; goto h6qNw; lXMQx: $v_central_dir = array(); goto T6wRV; T6wRV: if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1) { $this->privSwapBackMagicQuotes(); return 0; } goto DzIrk; Ff7co: } goto OU7pP; GS_q1: $v_prop["\143\157\x6d\155\145\x6e\164"] = ''; goto NVy9Y; AfBbD: if (!$this->privCheckFormat()) { $this->privSwapBackMagicQuotes(); return 0; } goto nPejB; nPejB: $v_prop = array(); goto GS_q1; sb2he: return $v_prop; goto Q68Mv; NVy9Y: $v_prop["\x6e\x62"] = 0; goto zibmU; OU7pP: $this->privSwapBackMagicQuotes(); goto sb2he; nDiYD: $this->privDisableMagicQuotes(); goto AfBbD; iK8CJ: $this->privErrorReset(); goto nDiYD; zibmU: $v_prop["\163\x74\x61\164\165\x73"] = "\x6e\157\x74\x5f\x65\170\x69\x73\x74"; goto hI0py; Q68Mv: } public function duplicate($p_archive) { goto DKKrO; lOEJm: $this->privErrorReset(); goto OxrYW; s77RH: return $v_result; goto vqUaC; DKKrO: $v_result = 1; goto lOEJm; OxrYW: if (is_object($p_archive) && get_class($p_archive) == "\x70\143\x6c\172\151\160") { $v_result = $this->privDuplicate($p_archive->zipname); } elseif (is_string($p_archive)) { if (!is_file($p_archive)) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "\116\157\40\x66\151\x6c\145\40\167\x69\164\150\40\x66\151\154\x65\x6e\141\x6d\145\x20\x27" . $p_archive . "\x27"); $v_result = PCLZIP_ERR_MISSING_FILE; } else { $v_result = $this->privDuplicate($p_archive); } } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\x6e\x76\x61\154\x69\x64\x20\166\141\x72\x69\141\142\x6c\x65\40\164\x79\160\145\x20\160\137\141\x72\x63\150\151\166\x65\x5f\x74\157\x5f\141\x64\x64"); $v_result = PCLZIP_ERR_INVALID_PARAMETER; } goto s77RH; vqUaC: } public function merge($p_archive_to_add) { goto F7amb; kVI9D: return $v_result; goto wLiIl; BPgh1: $this->privErrorReset(); goto WxegE; WxegE: if (!$this->privCheckFormat()) { return 0; } goto LPjwI; F7amb: $v_result = 1; goto BPgh1; LPjwI: if (is_object($p_archive_to_add) && get_class($p_archive_to_add) == "\160\143\x6c\x7a\151\x70") { $v_result = $this->privMerge($p_archive_to_add); } elseif (is_string($p_archive_to_add)) { $v_object_archive = new PclZip($p_archive_to_add); $v_result = $this->privMerge($v_object_archive); } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\111\x6e\166\x61\x6c\151\x64\x20\166\x61\162\x69\x61\142\154\x65\40\164\171\x70\145\x20\x70\137\141\162\x63\150\x69\166\145\x5f\164\157\x5f\141\144\144"); $v_result = PCLZIP_ERR_INVALID_PARAMETER; } goto kVI9D; wLiIl: } public function errorCode() { if (PCLZIP_ERROR_EXTERNAL == 1) { return PclErrorCode(); } else { return $this->error_code; } } public function errorName($p_with_code = false) { goto fqOXd; ZlY84: if ($p_with_code) { return $v_value . "\x20\50" . $this->error_code . "\x29"; } else { return $v_value; } goto hyDMp; fqOXd: $v_name = array(PCLZIP_ERR_NO_ERROR => "\120\x43\114\x5a\111\120\137\x45\x52\x52\x5f\x4e\x4f\x5f\105\x52\122\117\x52", PCLZIP_ERR_WRITE_OPEN_FAIL => "\x50\103\114\132\x49\120\137\105\x52\x52\x5f\127\122\111\124\105\x5f\117\120\x45\116\137\x46\101\111\114", PCLZIP_ERR_READ_OPEN_FAIL => "\120\x43\x4c\x5a\111\x50\137\105\122\122\137\x52\105\x41\104\x5f\117\120\x45\116\137\x46\x41\111\114", PCLZIP_ERR_INVALID_PARAMETER => "\x50\103\114\132\111\x50\137\x45\x52\x52\x5f\x49\116\126\101\x4c\x49\x44\137\120\x41\x52\x41\115\105\124\x45\x52", PCLZIP_ERR_MISSING_FILE => "\120\x43\114\132\x49\120\x5f\105\122\122\137\115\x49\123\123\111\x4e\x47\137\106\111\114\105", PCLZIP_ERR_FILENAME_TOO_LONG => "\x50\103\x4c\x5a\111\x50\137\x45\122\x52\x5f\106\111\114\105\x4e\x41\115\x45\137\x54\x4f\117\137\x4c\117\116\107", PCLZIP_ERR_INVALID_ZIP => "\x50\103\x4c\x5a\111\120\137\x45\122\122\137\111\x4e\126\x41\114\111\104\137\132\x49\120", PCLZIP_ERR_BAD_EXTRACTED_FILE => "\120\x43\114\132\111\x50\x5f\105\x52\x52\x5f\102\x41\x44\x5f\105\x58\124\122\101\103\124\105\104\137\106\x49\114\105", PCLZIP_ERR_DIR_CREATE_FAIL => "\x50\103\114\132\x49\x50\137\105\122\122\x5f\x44\x49\122\137\103\122\105\x41\x54\105\x5f\x46\x41\111\x4c", PCLZIP_ERR_BAD_EXTENSION => "\x50\x43\114\132\x49\x50\137\105\x52\x52\x5f\102\x41\104\x5f\105\130\124\105\x4e\123\x49\117\x4e", PCLZIP_ERR_BAD_FORMAT => "\120\x43\114\x5a\x49\120\137\x45\122\x52\x5f\x42\101\x44\137\106\117\x52\x4d\x41\x54", PCLZIP_ERR_DELETE_FILE_FAIL => "\120\x43\x4c\x5a\x49\x50\x5f\105\x52\x52\x5f\104\105\114\105\x54\105\x5f\x46\111\114\x45\137\x46\101\111\x4c", PCLZIP_ERR_RENAME_FILE_FAIL => "\120\x43\x4c\132\x49\120\137\x45\x52\122\137\122\x45\x4e\101\x4d\105\x5f\106\x49\x4c\x45\x5f\106\x41\x49\x4c", PCLZIP_ERR_BAD_CHECKSUM => "\x50\103\x4c\132\x49\x50\137\x45\x52\x52\137\102\101\104\x5f\103\110\105\x43\113\x53\125\115", PCLZIP_ERR_INVALID_ARCHIVE_ZIP => "\120\x43\x4c\x5a\x49\120\x5f\105\x52\122\137\x49\116\x56\101\114\x49\x44\x5f\101\122\103\x48\111\126\105\x5f\132\x49\x50", PCLZIP_ERR_MISSING_OPTION_VALUE => "\120\103\x4c\x5a\x49\x50\137\105\x52\x52\x5f\115\x49\x53\123\x49\116\x47\137\117\120\x54\x49\x4f\x4e\137\126\x41\x4c\125\105", PCLZIP_ERR_INVALID_OPTION_VALUE => "\x50\103\114\x5a\x49\x50\137\x45\122\122\x5f\x49\116\x56\101\114\111\104\137\x4f\120\124\111\117\116\137\126\x41\x4c\x55\x45", PCLZIP_ERR_UNSUPPORTED_COMPRESSION => "\120\x43\x4c\132\111\120\x5f\105\x52\122\137\x55\116\123\125\120\x50\x4f\122\124\x45\104\x5f\x43\x4f\115\x50\x52\x45\x53\x53\111\117\x4e", PCLZIP_ERR_UNSUPPORTED_ENCRYPTION => "\x50\x43\114\x5a\111\x50\x5f\x45\122\122\137\x55\116\123\x55\120\x50\117\x52\124\x45\x44\137\x45\x4e\103\x52\x59\x50\x54\111\117\x4e", PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE => "\120\103\114\x5a\111\120\x5f\x45\122\122\x5f\111\x4e\126\x41\114\x49\x44\x5f\101\124\124\x52\x49\102\x55\124\x45\137\x56\101\114\x55\105", PCLZIP_ERR_DIRECTORY_RESTRICTION => "\120\x43\114\132\111\120\x5f\x45\x52\x52\137\x44\x49\x52\105\103\x54\117\122\x59\x5f\x52\x45\123\x54\122\111\x43\124\x49\x4f\x4e"); goto l89IF; l89IF: if (isset($v_name[$this->error_code])) { $v_value = $v_name[$this->error_code]; } else { $v_value = "\116\157\116\x61\x6d\145"; } goto ZlY84; hyDMp: } public function errorInfo($p_full = false) { if (PCLZIP_ERROR_EXTERNAL == 1) { return PclErrorString(); } else { if ($p_full) { return $this->errorName(true) . "\40\72\x20" . $this->error_string; } else { return $this->error_string . "\40\133\143\157\x64\x65\40" . $this->error_code . "\135"; } } } public function privCheckFormat($p_level = 0) { goto D68LV; D68LV: $v_result = true; goto SxSx4; W8gOD: $this->privErrorReset(); goto E9aA0; Z2HTA: return $v_result; goto NgoX2; SxSx4: clearstatcache(); goto W8gOD; k6vEd: if (!is_readable($this->zipname)) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\156\x61\142\154\145\x20\164\x6f\40\162\x65\x61\144\40\x61\162\143\150\x69\166\x65\x20\x27" . $this->zipname . "\47"); return false; } goto Z2HTA; E9aA0: if (!is_file($this->zipname)) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "\115\151\x73\163\x69\156\x67\x20\141\x72\x63\150\x69\x76\x65\x20\x66\151\154\x65\40\x27" . $this->zipname . "\x27"); return false; } goto k6vEd; NgoX2: } public function privParseOptions(&$p_options_list, $p_size, &$v_result_list, $v_requested_options = false) { goto t3A3D; i31la: if ($v_requested_options !== false) { for ($key = reset($v_requested_options); $key = key($v_requested_options); $key = next($v_requested_options)) { if ($v_requested_options[$key] == "\x6d\x61\x6e\x64\141\164\157\x72\x79") { if (!isset($v_result_list[$key])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\115\151\x73\163\151\x6e\x67\40\x6d\141\x6e\144\141\164\157\162\x79\x20\160\141\x72\x61\155\x65\x74\145\x72\x20" . PclZipUtilOptionText($key) . "\50" . $key . "\51"); return PclZip::errorCode(); } } } } goto BeUwr; BeUwr: if (!isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) { } goto F_bWx; F_bWx: return $v_result; goto ybGRY; vzmUt: $i = 0; goto msOfq; msOfq: while ($i < $p_size) { if (!isset($v_requested_options[$p_options_list[$i]])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\x6e\x76\x61\x6c\x69\x64\x20\157\x70\x74\151\157\156\x61\x6c\x20\160\x61\162\141\x6d\145\x74\145\x72\x20\47" . $p_options_list[$i] . "\x27\40\146\157\x72\x20\x74\150\151\163\40\x6d\145\x74\150\157\144"); return PclZip::errorCode(); } switch ($p_options_list[$i]) { case PCLZIP_OPT_PATH: case PCLZIP_OPT_REMOVE_PATH: case PCLZIP_OPT_ADD_PATH: goto Q4VZf; FxZde: $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i + 1], false); goto HWGC8; kukHh: break; goto wgzDW; Q4VZf: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\x4d\151\x73\163\151\156\147\x20\x70\141\162\141\x6d\x65\x74\x65\162\40\166\141\x6c\165\x65\x20\146\157\162\40\x6f\x70\164\151\157\156\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto FxZde; HWGC8: $i++; goto kukHh; wgzDW: case PCLZIP_OPT_TEMP_FILE_THRESHOLD: goto m3KOE; dOq82: $v_value = $p_options_list[$i + 1]; goto M9zeY; m3KOE: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\115\x69\163\x73\x69\x6e\x67\40\160\141\x72\141\155\145\x74\x65\162\x20\x76\x61\x6c\165\x65\x20\146\x6f\162\40\x6f\x70\164\x69\x6f\156\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto gAkHZ; M9zeY: if (!is_integer($v_value) || $v_value < 0) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\x49\156\164\x65\x67\x65\x72\x20\145\170\x70\x65\x63\x74\x65\x64\x20\x66\x6f\162\40\157\160\164\x69\x6f\156\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto TbucJ; ACURk: break; goto OEoht; flDns: $i++; goto ACURk; TbucJ: $v_result_list[$p_options_list[$i]] = $v_value * 1048576; goto flDns; gAkHZ: if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x4f\x70\x74\151\157\156\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27\40\143\x61\156\x20\x6e\x6f\164\x20\x62\145\40\165\163\x65\x64\x20\167\x69\x74\150\x20\157\160\x74\x69\157\x6e\x20\47\x50\x43\114\132\x49\120\137\117\120\x54\x5f\x54\105\115\120\137\x46\x49\114\105\137\117\106\x46\47"); return PclZip::errorCode(); } goto dOq82; OEoht: case PCLZIP_OPT_TEMP_FILE_ON: goto SbcmR; vhQ84: $v_result_list[$p_options_list[$i]] = true; goto Sg2KC; Sg2KC: break; goto LyS7d; SbcmR: if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\117\x70\164\x69\x6f\x6e\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27\40\x63\141\x6e\x20\x6e\157\164\x20\142\145\x20\165\163\x65\x64\40\x77\x69\x74\150\x20\157\160\164\x69\157\156\40\x27\120\x43\114\132\x49\120\137\x4f\120\124\137\124\x45\x4d\120\137\x46\x49\x4c\x45\137\117\106\106\47"); return PclZip::errorCode(); } goto vhQ84; LyS7d: case PCLZIP_OPT_TEMP_FILE_OFF: goto FBaPU; FBaPU: if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_ON])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\117\x70\x74\151\157\156\x20\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27\x20\143\x61\156\40\156\157\164\x20\x62\x65\40\x75\x73\145\x64\40\167\x69\164\x68\x20\x6f\x70\164\x69\x6f\156\x20\x27\120\x43\114\132\111\x50\137\117\x50\x54\x5f\x54\x45\x4d\x50\137\106\111\114\105\x5f\117\116\47"); return PclZip::errorCode(); } goto pqzQu; GOPlT: break; goto wPPAk; pqzQu: if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\117\160\x74\151\x6f\x6e\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\47\x20\143\x61\x6e\x20\156\x6f\164\40\x62\145\40\165\163\145\144\x20\167\151\164\150\x20\x6f\x70\x74\151\157\156\x20\47\120\103\x4c\132\x49\120\137\x4f\120\124\137\124\105\115\120\x5f\106\x49\114\105\137\124\x48\122\x45\123\x48\x4f\x4c\104\47"); return PclZip::errorCode(); } goto uzwul; uzwul: $v_result_list[$p_options_list[$i]] = true; goto GOPlT; wPPAk: case PCLZIP_OPT_EXTRACT_DIR_RESTRICTION: goto c64j_; c64j_: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\x4d\151\163\163\x69\x6e\147\40\x70\141\x72\141\155\145\164\x65\x72\x20\166\x61\154\165\x65\40\146\157\x72\40\157\x70\x74\151\x6f\x6e\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto HGKB2; IhSZl: break; goto CUbYM; HGKB2: if (is_string($p_options_list[$i + 1]) && $p_options_list[$i + 1] != '') { $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i + 1], false); $i++; } else { } goto IhSZl; CUbYM: case PCLZIP_OPT_BY_NAME: goto RzZ2D; Zidx7: break; goto MSVtf; RzZ2D: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\x4d\x69\x73\163\x69\156\147\40\160\141\x72\x61\155\x65\164\x65\162\x20\166\141\154\165\145\x20\x66\x6f\x72\40\157\160\x74\151\157\156\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto M0XKW; H0z2_: $i++; goto Zidx7; M0XKW: if (is_string($p_options_list[$i + 1])) { $v_result_list[$p_options_list[$i]][0] = $p_options_list[$i + 1]; } elseif (is_array($p_options_list[$i + 1])) { $v_result_list[$p_options_list[$i]] = $p_options_list[$i + 1]; } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\x57\x72\x6f\156\x67\40\160\x61\x72\x61\155\x65\164\145\162\x20\166\141\x6c\165\x65\40\146\157\x72\40\x6f\160\164\x69\157\156\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto H0z2_; MSVtf: case PCLZIP_OPT_BY_EREG: $p_options_list[$i] = PCLZIP_OPT_BY_PREG; case PCLZIP_OPT_BY_PREG: goto Y6WZF; vhZVt: break; goto z15Np; Y6WZF: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\x4d\151\x73\x73\151\x6e\147\40\160\141\x72\141\155\145\x74\x65\162\40\166\141\154\165\145\40\x66\x6f\162\x20\x6f\160\164\x69\x6f\156\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto fBow3; GHZRa: $i++; goto vhZVt; fBow3: if (is_string($p_options_list[$i + 1])) { $v_result_list[$p_options_list[$i]] = $p_options_list[$i + 1]; } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\x57\162\x6f\x6e\147\40\160\x61\x72\141\155\145\x74\145\x72\40\x76\x61\x6c\165\145\x20\146\x6f\162\40\157\160\x74\151\157\x6e\x20\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto GHZRa; z15Np: case PCLZIP_OPT_COMMENT: case PCLZIP_OPT_ADD_COMMENT: case PCLZIP_OPT_PREPEND_COMMENT: goto SvjdX; nfs1F: break; goto n710R; C7EaC: if (is_string($p_options_list[$i + 1])) { $v_result_list[$p_options_list[$i]] = $p_options_list[$i + 1]; } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\x57\162\x6f\x6e\147\40\x70\141\x72\x61\x6d\145\164\x65\162\40\166\x61\154\165\x65\x20\x66\157\x72\x20\x6f\160\164\151\x6f\156\x20\47" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto Vjlec; SvjdX: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\115\151\x73\x73\x69\156\x67\x20\160\x61\162\x61\x6d\145\x74\x65\162\x20\x76\x61\154\x75\x65\40\x66\x6f\162\x20\x6f\x70\164\151\157\156\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto C7EaC; Vjlec: $i++; goto nfs1F; n710R: case PCLZIP_OPT_BY_INDEX: goto kGGoh; Bx0KV: break; goto cSL7H; BZ3Lc: $v_sort_flag = false; goto RYc6H; kgpQC: $i++; goto Bx0KV; bZBmF: $v_work_list = array(); goto Xfohx; RYc6H: $v_sort_value = 0; goto lp4XH; Xfohx: if (is_string($p_options_list[$i + 1])) { $p_options_list[$i + 1] = strtr($p_options_list[$i + 1], "\x20", ''); $v_work_list = explode("\54", $p_options_list[$i + 1]); } elseif (is_integer($p_options_list[$i + 1])) { $v_work_list[0] = $p_options_list[$i + 1] . "\55" . $p_options_list[$i + 1]; } elseif (is_array($p_options_list[$i + 1])) { $v_work_list = $p_options_list[$i + 1]; } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\126\141\154\x75\x65\40\x6d\165\x73\164\40\x62\145\40\151\x6e\x74\145\x67\145\x72\54\40\163\x74\x72\151\x6e\x67\40\157\162\40\x61\x72\162\x61\x79\x20\146\x6f\x72\40\157\160\x74\151\x6f\x6e\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto BZ3Lc; Bla3z: if ($v_sort_flag) { } goto kgpQC; lp4XH: for ($j = 0; $j < sizeof($v_work_list); $j++) { $v_item_list = explode("\x2d", $v_work_list[$j]); $v_size_item_list = sizeof($v_item_list); if ($v_size_item_list == 1) { $v_result_list[$p_options_list[$i]][$j]["\163\x74\x61\162\164"] = $v_item_list[0]; $v_result_list[$p_options_list[$i]][$j]["\145\x6e\144"] = $v_item_list[0]; } elseif ($v_size_item_list == 2) { $v_result_list[$p_options_list[$i]][$j]["\x73\x74\141\162\x74"] = $v_item_list[0]; $v_result_list[$p_options_list[$i]][$j]["\145\156\144"] = $v_item_list[1]; } else { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\124\157\157\x20\x6d\x61\x6e\171\x20\x76\141\x6c\x75\x65\163\x20\151\156\x20\x69\156\x64\145\x78\40\x72\x61\x6e\147\x65\40\146\157\x72\x20\x6f\x70\164\x69\157\156\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } if ($v_result_list[$p_options_list[$i]][$j]["\x73\x74\x61\162\164"] < $v_sort_value) { goto OjK9k; ET6fa: return PclZip::errorCode(); goto OwWlc; OjK9k: $v_sort_flag = true; goto wv5cy; wv5cy: PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\x49\156\166\141\x6c\x69\144\40\157\x72\144\145\x72\40\x6f\146\40\x69\156\x64\x65\x78\x20\x72\141\156\x67\145\x20\146\157\162\x20\157\160\x74\x69\157\156\x20\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); goto ET6fa; OwWlc: } $v_sort_value = $v_result_list[$p_options_list[$i]][$j]["\x73\164\x61\x72\164"]; } goto Bla3z; kGGoh: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\115\x69\x73\x73\151\156\147\x20\160\141\x72\141\155\145\x74\x65\x72\40\x76\141\154\x75\145\x20\146\x6f\x72\40\157\160\164\x69\x6f\156\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto bZBmF; cSL7H: case PCLZIP_OPT_REMOVE_ALL_PATH: case PCLZIP_OPT_EXTRACT_AS_STRING: case PCLZIP_OPT_NO_COMPRESSION: case PCLZIP_OPT_EXTRACT_IN_OUTPUT: case PCLZIP_OPT_REPLACE_NEWER: case PCLZIP_OPT_STOP_ON_ERROR: $v_result_list[$p_options_list[$i]] = true; break; case PCLZIP_OPT_SET_CHMOD: goto Iymtc; j3GzR: $v_result_list[$p_options_list[$i]] = $p_options_list[$i + 1]; goto PfhcS; Iymtc: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\115\151\x73\x73\151\156\x67\40\160\141\162\141\x6d\x65\x74\x65\x72\x20\166\141\154\x75\x65\40\146\157\x72\40\x6f\160\x74\151\157\x6e\40\x27" . PclZipUtilOptionText($p_options_list[$i]) . "\x27"); return PclZip::errorCode(); } goto j3GzR; PfhcS: $i++; goto xQR_G; xQR_G: break; goto eUCyU; eUCyU: case PCLZIP_CB_PRE_EXTRACT: case PCLZIP_CB_POST_EXTRACT: case PCLZIP_CB_PRE_ADD: case PCLZIP_CB_POST_ADD: goto d0Ji1; jjX6H: $v_function_name = $p_options_list[$i + 1]; goto bBsmY; Wo1aw: $v_result_list[$p_options_list[$i]] = $v_function_name; goto cjQCs; RnLpR: break; goto J8pMY; bBsmY: if (!function_exists($v_function_name)) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "\106\165\x6e\x63\x74\151\157\x6e\40\x27" . $v_function_name . "\x28\x29\x27\x20\x69\163\40\156\x6f\164\x20\141\156\x20\145\170\x69\x73\164\151\x6e\147\40\x66\x75\156\x63\164\x69\x6f\x6e\x20\146\157\x72\40\157\160\164\151\x6f\156\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto Wo1aw; d0Ji1: if ($i + 1 >= $p_size) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "\x4d\x69\163\x73\151\x6e\147\x20\x70\141\162\141\x6d\x65\164\x65\162\40\x76\141\154\165\145\40\146\x6f\x72\40\x6f\160\164\151\157\x6e\40\47" . PclZipUtilOptionText($p_options_list[$i]) . "\47"); return PclZip::errorCode(); } goto jjX6H; cjQCs: $i++; goto RnLpR; J8pMY: default: PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\125\x6e\x6b\x6e\157\x77\156\x20\160\x61\162\141\155\145\x74\145\x72\x20\x27" . $p_options_list[$i] . "\47"); return PclZip::errorCode(); } $i++; } goto i31la; t3A3D: $v_result = 1; goto vzmUt; ybGRY: } public function privOptionDefaultThreshold(&$p_options) { goto F3Fmk; HJtvc: if ($last == "\153") { $v_memory_limit = $v_memory_limit * 1024; } goto y_ojm; UAQ35: $last = strtolower(substr($v_memory_limit, -1)); goto eUqXJ; BfXMc: if ($last == "\155") { $v_memory_limit = $v_memory_limit * 1048576; } goto HJtvc; Gk98Z: if (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]) || isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) { return $v_result; } goto wHZx9; y_ojm: $p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] = floor($v_memory_limit * PCLZIP_TEMPORARY_FILE_RATIO); goto UM_t4; wHZx9: $v_memory_limit = ini_get("\155\145\155\157\162\x79\x5f\x6c\151\155\151\x74"); goto IE891; eUqXJ: if ($last == "\x67") { $v_memory_limit = $v_memory_limit * 1073741824; } goto BfXMc; F3Fmk: $v_result = 1; goto Gk98Z; IE891: $v_memory_limit = trim($v_memory_limit); goto UAQ35; UM_t4: if ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] < 1048576) { unset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]); } goto JfQgm; JfQgm: return $v_result; goto EX7ai; EX7ai: } public function privFileDescrParseAtt(&$p_file_list, &$p_filedescr, $v_options, $v_requested_options = false) { goto YXw1y; R0YjX: foreach ($p_file_list as $v_key => $v_value) { goto JTSjr; ULk64: if ($v_requested_options !== false) { for ($key = reset($v_requested_options); $key = key($v_requested_options); $key = next($v_requested_options)) { if ($v_requested_options[$key] == "\155\x61\156\144\141\x74\x6f\162\x79") { if (!isset($p_file_list[$key])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\115\151\163\163\151\156\x67\40\155\141\x6e\x64\141\164\157\162\171\x20\x70\x61\162\141\x6d\x65\x74\145\x72\x20" . PclZipUtilOptionText($key) . "\x28" . $key . "\51"); return PclZip::errorCode(); } } } } goto lLrZU; Y8U5G: switch ($v_key) { case PCLZIP_ATT_FILE_NAME: goto UzqCe; eDCWU: break; goto Wd8Kq; cPQ4W: $p_filedescr["\146\151\154\145\156\x61\x6d\145"] = PclZipUtilPathReduction($v_value); goto wuRh4; wuRh4: if ($p_filedescr["\146\151\154\145\x6e\x61\x6d\x65"] == '') { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\111\156\x76\x61\x6c\151\144\40\145\x6d\160\164\x79\40\146\151\154\145\x6e\141\x6d\x65\x20\x66\157\x72\40\x61\x74\164\x72\x69\142\165\x74\145\40\47" . PclZipUtilOptionText($v_key) . "\x27"); return PclZip::errorCode(); } goto eDCWU; UzqCe: if (!is_string($v_value)) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\x49\x6e\166\141\154\x69\144\x20\x74\171\x70\145\x20" . gettype($v_value) . "\x2e\x20\123\x74\162\x69\156\x67\40\x65\170\x70\145\143\164\x65\x64\40\146\157\x72\40\x61\x74\164\162\151\x62\x75\164\145\x20\x27" . PclZipUtilOptionText($v_key) . "\47"); return PclZip::errorCode(); } goto cPQ4W; Wd8Kq: case PCLZIP_ATT_FILE_NEW_SHORT_NAME: goto jm_k8; ZBuol: break; goto zezmw; k3Xil: $p_filedescr["\x6e\145\x77\137\163\150\x6f\x72\164\137\x6e\x61\155\145"] = PclZipUtilPathReduction($v_value); goto DXrVt; DXrVt: if ($p_filedescr["\x6e\x65\167\137\x73\150\x6f\x72\164\137\156\x61\155\x65"] == '') { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\111\156\166\x61\154\x69\144\40\145\155\x70\164\x79\40\163\150\x6f\x72\164\x20\x66\151\154\145\156\141\x6d\x65\x20\146\x6f\162\40\141\164\164\162\151\142\165\x74\x65\x20\47" . PclZipUtilOptionText($v_key) . "\47"); return PclZip::errorCode(); } goto ZBuol; jm_k8: if (!is_string($v_value)) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\111\156\x76\141\x6c\x69\144\40\x74\x79\x70\x65\x20" . gettype($v_value) . "\56\x20\x53\164\162\151\156\x67\40\x65\x78\x70\145\143\164\145\144\x20\146\157\162\40\x61\164\x74\162\151\142\x75\164\145\40\47" . PclZipUtilOptionText($v_key) . "\47"); return PclZip::errorCode(); } goto k3Xil; zezmw: case PCLZIP_ATT_FILE_NEW_FULL_NAME: goto hzjpO; FW90g: $p_filedescr["\x6e\145\x77\137\146\165\154\x6c\x5f\156\x61\x6d\145"] = PclZipUtilPathReduction($v_value); goto JfJ2E; JfJ2E: if ($p_filedescr["\x6e\145\x77\137\x66\x75\x6c\154\137\156\x61\x6d\145"] == '') { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\x49\156\x76\141\154\x69\x64\40\x65\x6d\x70\x74\x79\40\146\165\154\x6c\40\x66\151\154\145\156\141\155\145\40\146\157\x72\x20\x61\x74\164\x72\151\142\x75\164\145\40\47" . PclZipUtilOptionText($v_key) . "\x27"); return PclZip::errorCode(); } goto vlKp6; vlKp6: break; goto lMeLV; hzjpO: if (!is_string($v_value)) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\111\x6e\166\x61\154\151\144\x20\164\x79\x70\x65\40" . gettype($v_value) . "\x2e\40\x53\164\x72\x69\x6e\x67\40\145\x78\160\145\143\x74\145\x64\x20\x66\157\162\x20\x61\164\x74\x72\151\x62\x75\164\x65\x20\47" . PclZipUtilOptionText($v_key) . "\x27"); return PclZip::errorCode(); } goto FW90g; lMeLV: case PCLZIP_ATT_FILE_COMMENT: goto WfhfL; XsCSA: break; goto TW7B9; WfhfL: if (!is_string($v_value)) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\111\x6e\x76\x61\154\151\144\40\164\171\x70\x65\x20" . gettype($v_value) . "\56\x20\x53\x74\162\x69\x6e\147\x20\145\x78\160\x65\x63\x74\x65\144\x20\146\157\x72\x20\x61\164\164\x72\151\142\x75\x74\x65\x20\47" . PclZipUtilOptionText($v_key) . "\47"); return PclZip::errorCode(); } goto TcFP2; TcFP2: $p_filedescr["\x63\157\x6d\x6d\x65\x6e\164"] = $v_value; goto XsCSA; TW7B9: case PCLZIP_ATT_FILE_MTIME: goto NUu5C; NUu5C: if (!is_integer($v_value)) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "\x49\x6e\x76\x61\x6c\151\144\40\x74\x79\x70\x65\x20" . gettype($v_value) . "\56\x20\x49\156\164\x65\147\145\162\40\x65\170\160\145\x63\164\145\x64\40\146\157\162\40\x61\x74\164\162\x69\142\165\164\x65\40\47" . PclZipUtilOptionText($v_key) . "\x27"); return PclZip::errorCode(); } goto v3Vy5; v3Vy5: $p_filedescr["\x6d\x74\151\x6d\x65"] = $v_value; goto CLlyN; CLlyN: break; goto lkDVt; lkDVt: case PCLZIP_ATT_FILE_CONTENT: $p_filedescr["\143\x6f\x6e\x74\145\x6e\x74"] = $v_value; break; default: PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x55\156\153\x6e\157\167\156\40\x70\x61\x72\x61\x6d\x65\x74\x65\x72\40\47" . $v_key . "\x27"); return PclZip::errorCode(); } goto ULk64; JTSjr: if (!isset($v_requested_options[$v_key])) { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\x6e\166\x61\154\x69\x64\40\x66\x69\154\145\x20\x61\164\164\162\151\x62\x75\x74\145\x20\x27" . $v_key . "\47\x20\x66\x6f\162\40\x74\150\x69\x73\40\146\151\x6c\145"); return PclZip::errorCode(); } goto Y8U5G; lLrZU: } goto vRVim; vRVim: return $v_result; goto GOXPR; YXw1y: $v_result = 1; goto R0YjX; GOXPR: } public function privFileDescrExpand(&$p_filedescr_list, &$p_options) { goto C4hMs; eXhPG: $v_result_list = array(); goto fMU8G; RT2os: $p_filedescr_list = $v_result_list; goto llLo_; fMU8G: for ($i = 0; $i < sizeof($p_filedescr_list); $i++) { $v_descr = $p_filedescr_list[$i]; $v_descr["\x66\151\154\145\156\x61\x6d\145"] = PclZipUtilTranslateWinPath($v_descr["\x66\151\154\x65\156\x61\155\145"], false); $v_descr["\146\151\x6c\x65\x6e\x61\155\145"] = PclZipUtilPathReduction($v_descr["\x66\151\154\145\x6e\141\155\x65"]); if (file_exists($v_descr["\x66\x69\154\x65\156\141\x6d\145"])) { if (@is_file($v_descr["\x66\x69\x6c\145\x6e\x61\155\145"])) { $v_descr["\164\171\160\145"] = "\146\x69\154\x65"; } elseif (@is_dir($v_descr["\146\151\154\x65\x6e\141\x6d\145"])) { $v_descr["\x74\171\x70\x65"] = "\146\x6f\154\x64\x65\x72"; } elseif (@is_link($v_descr["\x66\x69\154\145\156\x61\155\145"])) { continue; } else { continue; } } elseif (isset($v_descr["\x63\157\156\x74\145\156\164"])) { $v_descr["\164\x79\160\145"] = "\x76\151\162\x74\x75\141\154\x5f\x66\151\154\x65"; } else { PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "\106\x69\154\x65\40\x27" . $v_descr["\x66\x69\x6c\145\x6e\x61\155\145"] . "\x27\40\x64\x6f\145\x73\40\x6e\x6f\x74\x20\x65\x78\151\163\164"); return PclZip::errorCode(); } $this->privCalculateStoredFilename($v_descr, $p_options); $v_result_list[sizeof($v_result_list)] = $v_descr; if ($v_descr["\164\x79\x70\x65"] == "\x66\157\154\x64\145\x72") { goto kNrGb; i7Y0A: if ($v_folder_handler = @opendir($v_descr["\146\151\x6c\x65\x6e\141\155\x65"])) { while (($v_item_handler = @readdir($v_folder_handler)) !== false) { if ($v_item_handler == "\x2e" || $v_item_handler == "\x2e\x2e") { continue; } $v_dirlist_descr[$v_dirlist_nb]["\146\151\154\x65\x6e\141\155\145"] = $v_descr["\146\x69\154\145\x6e\x61\155\145"] . "\x2f" . $v_item_handler; if ($v_descr["\163\x74\x6f\x72\145\x64\137\146\151\x6c\x65\x6e\x61\155\145"] != $v_descr["\146\151\154\145\156\141\155\145"] && !isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])) { if ($v_descr["\163\164\157\x72\x65\x64\137\x66\151\154\x65\x6e\x61\x6d\x65"] != '') { $v_dirlist_descr[$v_dirlist_nb]["\156\145\167\x5f\146\165\154\x6c\137\156\x61\x6d\145"] = $v_descr["\163\x74\x6f\x72\145\x64\x5f\x66\151\154\145\156\x61\155\x65"] . "\x2f" . $v_item_handler; } else { $v_dirlist_descr[$v_dirlist_nb]["\x6e\x65\x77\137\146\165\154\x6c\x5f\x6e\x61\x6d\x65"] = $v_item_handler; } } $v_dirlist_nb++; } @closedir($v_folder_handler); } else { } goto nT30U; GzvOw: $v_dirlist_nb = 0; goto i7Y0A; kNrGb: $v_dirlist_descr = array(); goto GzvOw; nT30U: if ($v_dirlist_nb != 0) { if (($v_result = $this->privFileDescrExpand($v_dirlist_descr, $p_options)) != 1) { return $v_result; } $v_result_list = array_merge($v_result_list, $v_dirlist_descr); } goto qvhL0; qvhL0: unset($v_dirlist_descr); goto YlGPl; YlGPl: } } goto RT2os; llLo_: return $v_result; goto j0ZMS; C4hMs: $v_result = 1; goto eXhPG; j0ZMS: } public function privCreate($p_filedescr_list, &$p_result_list, &$p_options) { goto qCnh4; e4OVv: $this->privSwapBackMagicQuotes(); goto WqYCg; cguPP: $v_result = $this->privAddList($p_filedescr_list, $p_result_list, $p_options); goto wBEqu; qCnh4: $v_result = 1; goto dsd0Y; WqYCg: return $v_result; goto rfwOx; dsd0Y: $v_list_detail = array(); goto fJMjJ; wBEqu: $this->privCloseFd(); goto e4OVv; fJMjJ: $this->privDisableMagicQuotes(); goto DqNUJ; DqNUJ: if (($v_result = $this->privOpenFd("\x77\142")) != 1) { return $v_result; } goto cguPP; rfwOx: } public function privAdd($p_filedescr_list, &$p_result_list, &$p_options) { goto NPKj8; lDvhd: $v_size = @ftell($this->zip_fd) - $v_offset; goto qQXua; p3TuA: $this->privCloseFd(); goto g0W6c; FdrAk: $v_size = $v_central_dir["\163\151\172\x65"]; goto ggO6n; g0W6c: @fclose($v_zip_temp_fd); goto wxn03; wWCtb: if (($v_zip_temp_fd = @fopen($v_zip_temp_name, "\x77\142")) == 0) { goto l_rZI; OmaOz: $this->privSwapBackMagicQuotes(); goto hsBBO; l_rZI: $this->privCloseFd(); goto OmaOz; hsBBO: PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\125\156\141\x62\154\x65\x20\164\157\40\x6f\160\145\156\40\164\x65\x6d\x70\157\162\x61\162\x79\x20\146\151\x6c\x65\x20\47" . $v_zip_temp_name . "\47\x20\151\156\40\142\151\156\x61\162\x79\x20\x77\162\x69\164\145\40\x6d\157\144\145"); goto UgoW0; UgoW0: return PclZip::errorCode(); goto qaxcV; qaxcV: } goto tNnY9; MYNvF: if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1) { goto jIA6o; jIA6o: $this->privCloseFd(); goto sMvJf; IRGpw: return $v_result; goto cMTcS; sMvJf: $this->privSwapBackMagicQuotes(); goto IRGpw; cMTcS: } goto ZKQ_2; Nu_kb: $v_zip_temp_fd = $v_swap; goto BaMnU; qRS9C: @unlink($this->zipname); goto sUaXN; JxUBG: $v_comment = $v_central_dir["\143\157\x6d\155\x65\x6e\x74"]; goto UahZA; wxn03: $this->privSwapBackMagicQuotes(); goto qRS9C; ggO6n: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($v_zip_temp_fd, $v_read_size); @fwrite($this->zip_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto luByl; UahZA: if (isset($p_options[PCLZIP_OPT_COMMENT])) { $v_comment = $p_options[PCLZIP_OPT_COMMENT]; } goto dk7WI; UDhas: if (isset($p_options[PCLZIP_OPT_PREPEND_COMMENT])) { $v_comment = $p_options[PCLZIP_OPT_PREPEND_COMMENT] . $v_comment; } goto lDvhd; P3LCq: $v_offset = @ftell($this->zip_fd); goto FdrAk; BaMnU: $v_header_list = array(); goto xhftl; xhftl: if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1) { goto tYwT4; hQj9m: $this->privSwapBackMagicQuotes(); goto of29H; mWzlv: @unlink($v_zip_temp_name); goto hQj9m; of29H: return $v_result; goto sV1c3; tYwT4: fclose($v_zip_temp_fd); goto wRrru; wRrru: $this->privCloseFd(); goto mWzlv; sV1c3: } goto P3LCq; Mf1cU: $this->privDisableMagicQuotes(); goto IBy9D; dk7WI: if (isset($p_options[PCLZIP_OPT_ADD_COMMENT])) { $v_comment = $v_comment . $p_options[PCLZIP_OPT_ADD_COMMENT]; } goto UDhas; qQXua: if (($v_result = $this->privWriteCentralHeader($v_count + $v_central_dir["\x65\x6e\x74\162\151\x65\163"], $v_size, $v_offset, $v_comment)) != 1) { goto AGZH_; OnlgE: $this->privSwapBackMagicQuotes(); goto b91Ue; AGZH_: unset($v_header_list); goto OnlgE; b91Ue: return $v_result; goto No2P6; No2P6: } goto tvTWR; luByl: for ($i = 0, $v_count = 0; $i < sizeof($v_header_list); $i++) { if ($v_header_list[$i]["\163\164\x61\x74\x75\x73"] == "\157\153") { if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) { goto dXGSi; X6QrV: @unlink($v_zip_temp_name); goto wgknV; dXGSi: fclose($v_zip_temp_fd); goto GEsdL; UZyYa: return $v_result; goto NWn4p; wgknV: $this->privSwapBackMagicQuotes(); goto UZyYa; GEsdL: $this->privCloseFd(); goto X6QrV; NWn4p: } $v_count++; } $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]); } goto JxUBG; p4ylh: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = fread($this->zip_fd, $v_read_size); @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto l45fN; l45fN: $v_swap = $this->zip_fd; goto bGiMo; NPKj8: $v_result = 1; goto T8FGU; WS432: return $v_result; goto EQ395; NQDD0: $v_zip_temp_fd = $v_swap; goto p3TuA; SObHi: if (!is_file($this->zipname) || filesize($this->zipname) == 0) { $v_result = $this->privCreate($p_filedescr_list, $p_result_list, $p_options); return $v_result; } goto Mf1cU; D5Wdz: $this->zip_fd = $v_zip_temp_fd; goto NQDD0; bGiMo: $this->zip_fd = $v_zip_temp_fd; goto Nu_kb; tvTWR: $v_swap = $this->zip_fd; goto D5Wdz; ZKQ_2: @rewind($this->zip_fd); goto H5Wpe; IBy9D: if (($v_result = $this->privOpenFd("\162\x62")) != 1) { $this->privSwapBackMagicQuotes(); return $v_result; } goto bjO1v; tNnY9: $v_size = $v_central_dir["\x6f\x66\146\x73\x65\x74"]; goto p4ylh; sUaXN: PclZipUtilRename($v_zip_temp_name, $this->zipname); goto WS432; H5Wpe: $v_zip_temp_name = PCLZIP_TEMPORARY_DIR . uniqid("\x70\x63\x6c\x7a\151\160\x2d") . "\56\x74\155\x70"; goto wWCtb; T8FGU: $v_list_detail = array(); goto SObHi; bjO1v: $v_central_dir = array(); goto MYNvF; EQ395: } public function privOpenFd($p_mode) { goto uO_iZ; uO_iZ: $v_result = 1; goto I958c; C5GZT: if (($this->zip_fd = @fopen($this->zipname, $p_mode)) == 0) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\125\x6e\x61\142\154\145\x20\164\x6f\40\157\160\145\x6e\40\x61\162\143\150\x69\x76\145\x20\x27" . $this->zipname . "\47\x20\x69\156\40" . $p_mode . "\40\x6d\x6f\144\x65"); return PclZip::errorCode(); } goto FH8Rr; FH8Rr: return $v_result; goto IslJ6; I958c: if ($this->zip_fd != 0) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\132\x69\x70\40\x66\151\x6c\x65\40\47" . $this->zipname . "\x27\x20\x61\154\162\145\141\144\171\x20\157\x70\x65\x6e"); return PclZip::errorCode(); } goto C5GZT; IslJ6: } public function privCloseFd() { goto c_0md; qGPGi: if ($this->zip_fd != 0) { @fclose($this->zip_fd); } goto Px19n; PU7ys: return $v_result; goto lO53a; Px19n: $this->zip_fd = 0; goto PU7ys; c_0md: $v_result = 1; goto qGPGi; lO53a: } public function privAddList($p_filedescr_list, &$p_result_list, &$p_options) { goto nz0wp; n6QO5: for ($i = 0, $v_count = 0; $i < sizeof($v_header_list); $i++) { if ($v_header_list[$i]["\163\164\x61\164\x75\x73"] == "\x6f\153") { if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) { return $v_result; } $v_count++; } $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]); } goto AqKIm; Iiw3w: $v_size = @ftell($this->zip_fd) - $v_offset; goto gtstq; AqKIm: $v_comment = ''; goto LdHZb; m12ZC: $v_header_list = array(); goto Jv7F8; Jv7F8: if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1) { return $v_result; } goto zDWVF; zDWVF: $v_offset = @ftell($this->zip_fd); goto n6QO5; gtstq: if (($v_result = $this->privWriteCentralHeader($v_count, $v_size, $v_offset, $v_comment)) != 1) { unset($v_header_list); return $v_result; } goto JAWkp; LdHZb: if (isset($p_options[PCLZIP_OPT_COMMENT])) { $v_comment = $p_options[PCLZIP_OPT_COMMENT]; } goto Iiw3w; nz0wp: $v_result = 1; goto m12ZC; JAWkp: return $v_result; goto p3VOg; p3VOg: } public function privAddFileList($p_filedescr_list, &$p_result_list, &$p_options) { goto Pse5e; hXO8U: $v_nb = sizeof($p_result_list); goto WPxsy; WPxsy: for ($j = 0; $j < sizeof($p_filedescr_list) && $v_result == 1; $j++) { $p_filedescr_list[$j]["\x66\x69\x6c\x65\x6e\141\155\145"] = PclZipUtilTranslateWinPath($p_filedescr_list[$j]["\x66\151\x6c\x65\156\x61\155\x65"], false); if ($p_filedescr_list[$j]["\146\x69\x6c\x65\156\141\155\x65"] == '') { continue; } if ($p_filedescr_list[$j]["\164\171\160\x65"] != "\x76\x69\x72\164\x75\x61\x6c\x5f\x66\151\154\145" && !file_exists($p_filedescr_list[$j]["\x66\151\x6c\x65\156\x61\x6d\x65"])) { PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "\x46\x69\154\145\40\47" . $p_filedescr_list[$j]["\x66\151\x6c\145\156\x61\x6d\145"] . "\47\x20\144\157\x65\163\40\x6e\157\x74\x20\x65\170\151\x73\x74"); return PclZip::errorCode(); } if ($p_filedescr_list[$j]["\x74\171\x70\x65"] == "\x66\x69\154\145" || $p_filedescr_list[$j]["\164\171\x70\145"] == "\x76\151\162\x74\165\141\x6c\137\146\151\154\145" || $p_filedescr_list[$j]["\164\x79\160\145"] == "\x66\x6f\154\x64\145\162" && (!isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH]) || !$p_options[PCLZIP_OPT_REMOVE_ALL_PATH])) { goto lDEnI; xDPc6: $p_result_list[$v_nb++] = $v_header; goto WyCF8; rIYpT: if ($v_result != 1) { return $v_result; } goto xDPc6; lDEnI: $v_result = $this->privAddFile($p_filedescr_list[$j], $v_header, $p_options); goto rIYpT; WyCF8: } } goto nal9n; VvkXu: $v_header = array(); goto hXO8U; Pse5e: $v_result = 1; goto VvkXu; nal9n: return $v_result; goto G8qbX; G8qbX: } public function privAddFile($p_filedescr, &$p_header, &$p_options) { goto qp6z6; CXwBg: if ($p_header["\x73\164\x6f\162\x65\144\x5f\146\x69\x6c\x65\x6e\x61\x6d\x65"] == '') { $p_header["\x73\x74\x61\x74\165\x73"] = "\x66\x69\x6c\x74\145\162\145\x64"; } goto zgjpx; NAL97: $p_header["\x63\157\x6d\x70\162\x65\163\x73\151\x6f\x6e"] = 0; goto trIyt; zgjpx: if (strlen($p_header["\163\164\x6f\x72\145\144\137\x66\x69\154\x65\x6e\141\155\x65"]) > 0xff) { $p_header["\x73\164\x61\x74\165\x73"] = "\146\151\x6c\x65\x6e\141\x6d\x65\x5f\164\157\157\x5f\x6c\x6f\156\147"; } goto swyKJ; b_szb: $p_header["\x73\164\x61\164\165\x73"] = "\x6f\x6b"; goto I3GzJ; swyKJ: if ($p_header["\x73\164\141\164\x75\x73"] == "\x6f\x6b") { if ($p_filedescr["\x74\171\160\x65"] == "\x66\151\154\x65") { if (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF]) && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON]) || isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]) && $p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_header["\x73\x69\x7a\145"])) { $v_result = $this->privAddFileUsingTempFile($p_filedescr, $p_header, $p_options); if ($v_result < PCLZIP_ERR_NO_ERROR) { return $v_result; } } else { goto SZ23f; ffwMl: $p_header["\143\x72\x63"] = @crc32($v_content); goto j1QBU; j1QBU: if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) { $p_header["\143\157\155\x70\x72\x65\x73\163\145\x64\137\163\151\x7a\x65"] = $p_header["\163\x69\x7a\x65"]; $p_header["\x63\157\155\x70\x72\x65\x73\x73\x69\x6f\x6e"] = 0; } else { goto pUUdx; pUUdx: $v_content = @gzdeflate($v_content); goto WelDP; zpugq: $p_header["\143\157\155\x70\162\x65\x73\x73\151\157\x6e"] = 8; goto h0yrB; WelDP: $p_header["\x63\x6f\x6d\160\162\145\163\163\145\144\x5f\163\151\172\145"] = strlen($v_content); goto zpugq; h0yrB: } goto H8owp; zCti2: @fwrite($this->zip_fd, $v_content, $p_header["\x63\x6f\155\160\162\145\163\163\145\x64\137\x73\x69\172\145"]); goto Qb9tX; qDpJy: $v_content = @fread($v_file, $p_header["\x73\151\172\x65"]); goto EKeRx; EKeRx: @fclose($v_file); goto ffwMl; SZ23f: if (($v_file = @fopen($p_filename, "\162\x62")) == 0) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\x6e\x61\142\x6c\x65\x20\x74\x6f\x20\157\x70\145\156\40\146\151\x6c\145\x20\47{$p_filename}\47\40\151\156\x20\x62\x69\156\141\162\171\x20\x72\x65\x61\x64\x20\155\x6f\x64\145"); return PclZip::errorCode(); } goto qDpJy; H8owp: if (($v_result = $this->privWriteFileHeader($p_header)) != 1) { @fclose($v_file); return $v_result; } goto zCti2; Qb9tX: } } elseif ($p_filedescr["\164\x79\160\145"] == "\x76\151\x72\164\165\x61\154\137\146\x69\154\145") { goto iiWlt; iiWlt: $v_content = $p_filedescr["\x63\x6f\x6e\164\145\156\164"]; goto KtRkl; mX2U_: @fwrite($this->zip_fd, $v_content, $p_header["\x63\x6f\155\x70\162\145\163\163\145\144\137\163\x69\x7a\x65"]); goto zry2k; KtRkl: $p_header["\143\x72\143"] = @crc32($v_content); goto ZQYMI; ZQYMI: if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) { $p_header["\x63\x6f\155\x70\x72\145\163\x73\x65\x64\x5f\x73\x69\172\145"] = $p_header["\163\151\x7a\145"]; $p_header["\x63\157\x6d\x70\162\x65\163\x73\151\157\x6e"] = 0; } else { goto stJoU; HkV35: $p_header["\x63\157\x6d\160\x72\145\x73\163\151\157\156"] = 8; goto yr6nN; stJoU: $v_content = @gzdeflate($v_content); goto oOn3X; oOn3X: $p_header["\x63\x6f\x6d\160\162\x65\x73\x73\145\144\x5f\163\x69\x7a\145"] = strlen($v_content); goto HkV35; yr6nN: } goto U5UEk; U5UEk: if (($v_result = $this->privWriteFileHeader($p_header)) != 1) { @fclose($v_file); return $v_result; } goto mX2U_; zry2k: } elseif ($p_filedescr["\164\x79\x70\x65"] == "\146\157\x6c\x64\x65\x72") { goto mXv_w; rYi_i: $p_header["\145\170\x74\x65\x72\156\141\x6c"] = 0x10; goto k_y2N; k_y2N: if (($v_result = $this->privWriteFileHeader($p_header)) != 1) { return $v_result; } goto Gg3aU; mXv_w: if (@substr($p_header["\x73\164\157\x72\x65\144\x5f\146\151\154\x65\x6e\x61\x6d\x65"], -1) != "\x2f") { $p_header["\163\164\157\x72\x65\x64\x5f\x66\x69\154\x65\x6e\141\155\145"] .= "\x2f"; } goto yynit; yynit: $p_header["\x73\151\172\145"] = 0; goto rYi_i; Gg3aU: } } goto IAIye; XEy92: if ($p_filename == '') { PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "\x49\x6e\166\141\154\x69\x64\40\x66\x69\x6c\x65\40\154\151\x73\164\40\x70\141\x72\141\155\x65\164\x65\162\x20\50\151\156\166\x61\154\x69\144\40\x6f\x72\x20\x65\155\x70\164\171\x20\x6c\x69\x73\x74\51"); return PclZip::errorCode(); } goto qv6Oq; g6ETG: if (isset($p_filedescr["\x6d\x74\151\x6d\x65"])) { $p_header["\x6d\x74\x69\155\x65"] = $p_filedescr["\155\x74\x69\x6d\145"]; } elseif ($p_filedescr["\164\x79\x70\145"] == "\x76\151\x72\x74\165\141\154\x5f\x66\x69\154\x65") { $p_header["\155\164\x69\x6d\x65"] = time(); } else { $p_header["\x6d\164\x69\155\x65"] = filemtime($p_filename); } goto dPkiu; Buplm: if ($p_filedescr["\x74\171\x70\x65"] == "\146\x69\154\145") { $p_header["\x65\170\x74\145\x72\156\141\x6c"] = 0x0; $p_header["\163\x69\x7a\x65"] = filesize($p_filename); } elseif ($p_filedescr["\164\171\x70\145"] == "\x66\x6f\154\144\145\x72") { goto e2i6A; e2i6A: $p_header["\x65\170\x74\145\162\156\x61\x6c"] = 0x10; goto wpAFi; wpAFi: $p_header["\x6d\164\151\x6d\145"] = filemtime($p_filename); goto lTFKc; lTFKc: $p_header["\163\151\x7a\x65"] = filesize($p_filename); goto jg8ID; jg8ID: } elseif ($p_filedescr["\164\x79\x70\x65"] == "\x76\151\162\164\x75\141\154\137\x66\151\154\x65") { $p_header["\x65\x78\x74\145\x72\156\141\154"] = 0x0; $p_header["\163\x69\172\x65"] = strlen($p_filedescr["\x63\x6f\156\164\145\156\164"]); } goto g6ETG; tqiTS: $p_header["\146\154\x61\147"] = 0; goto NAL97; T1M38: $p_header["\x66\151\x6c\145\156\x61\155\x65"] = $p_filename; goto y4kGc; IT6lv: $p_header["\145\170\x74\162\x61"] = ''; goto b_szb; easdD: $p_header["\x65\x78\164\x72\x61\x5f\x6c\x65\x6e"] = 0; goto LQr4f; qv6Oq: clearstatcache(); goto tpJtL; xjb8T: $p_header["\151\156\x74\145\162\156\141\x6c"] = 0; goto q_f_W; trIyt: $p_header["\143\162\143"] = 0; goto k3hGD; dPkiu: if (isset($p_filedescr["\143\x6f\x6d\x6d\x65\x6e\164"])) { $p_header["\143\157\155\155\x65\x6e\x74\x5f\x6c\145\x6e"] = strlen($p_filedescr["\x63\157\155\x6d\145\156\164"]); $p_header["\x63\x6f\155\155\x65\156\164"] = $p_filedescr["\143\x6f\155\155\x65\156\x74"]; } else { $p_header["\143\x6f\155\155\x65\156\164\x5f\154\145\156"] = 0; $p_header["\x63\x6f\x6d\155\x65\156\x74"] = ''; } goto a8kf2; IAIye: if (isset($p_options[PCLZIP_CB_POST_ADD])) { goto Q8bl5; rHCdq: $this->privConvertHeader2FileInfo($p_header, $v_local_header); goto NpUoN; NpUoN: $v_result = $p_options[PCLZIP_CB_POST_ADD](PCLZIP_CB_POST_ADD, $v_local_header); goto fcs4c; Q8bl5: $v_local_header = array(); goto rHCdq; fcs4c: if ($v_result == 0) { $v_result = 1; } goto h3ymn; h3ymn: } goto R9Tsq; tpJtL: $p_header["\166\x65\x72\163\x69\157\x6e"] = 20; goto b6DpM; I3GzJ: $p_header["\x69\x6e\x64\x65\170"] = -1; goto Buplm; qp6z6: $v_result = 1; goto VfUUS; q9sOk: $p_header["\x66\x69\154\145\x6e\x61\x6d\x65\137\154\x65\x6e"] = strlen($p_filename); goto easdD; k3hGD: $p_header["\x63\x6f\155\x70\x72\x65\163\163\145\x64\137\163\151\172\145"] = 0; goto q9sOk; b6DpM: $p_header["\x76\145\x72\163\x69\x6f\x6e\137\145\x78\x74\162\141\143\x74\145\144"] = 10; goto tqiTS; y4kGc: $p_header["\163\164\157\162\x65\144\137\146\151\x6c\x65\x6e\x61\x6d\145"] = $p_filedescr["\x73\164\x6f\162\x65\144\137\x66\x69\154\145\x6e\141\x6d\145"]; goto IT6lv; a8kf2: if (isset($p_options[PCLZIP_CB_PRE_ADD])) { goto a3vw6; iWXhb: if ($v_result == 0) { $p_header["\x73\164\141\164\x75\163"] = "\x73\x6b\x69\160\x70\x65\144"; $v_result = 1; } goto kKdzy; kKdzy: if ($p_header["\163\164\157\162\145\x64\137\146\x69\154\x65\156\x61\155\x65"] != $v_local_header["\x73\164\157\162\145\144\137\x66\x69\154\145\x6e\141\155\145"]) { $p_header["\x73\x74\x6f\162\x65\144\137\146\151\x6c\x65\x6e\x61\x6d\145"] = PclZipUtilPathReduction($v_local_header["\163\x74\157\x72\145\x64\x5f\146\x69\x6c\x65\x6e\x61\x6d\x65"]); } goto UXGmn; eFN1x: $this->privConvertHeader2FileInfo($p_header, $v_local_header); goto K7daD; K7daD: $v_result = $p_options[PCLZIP_CB_PRE_ADD](PCLZIP_CB_PRE_ADD, $v_local_header); goto iWXhb; a3vw6: $v_local_header = array(); goto eFN1x; UXGmn: } goto CXwBg; R9Tsq: return $v_result; goto Wc15h; q_f_W: $p_header["\x6f\x66\x66\163\145\x74"] = 0; goto T1M38; LQr4f: $p_header["\144\151\163\153"] = 0; goto xjb8T; VfUUS: $p_filename = $p_filedescr["\146\151\154\145\x6e\x61\x6d\145"]; goto XEy92; Wc15h: } public function privAddFileUsingTempFile($p_filedescr, &$p_header, &$p_options) { goto lp8nN; vgycY: @fclose($v_file_compressed); goto m50JR; OuoKF: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($v_file, $v_read_size); @gzputs($v_file_compressed, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto lCy35; vvG81: if (($v_file_compressed = @fopen($v_gzip_temp_name, "\162\142")) == 0) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\125\156\141\142\154\145\40\164\x6f\40\157\x70\x65\156\40\164\145\x6d\x70\x6f\x72\x61\x72\x79\x20\146\151\154\x65\40\x27" . $v_gzip_temp_name . "\x27\x20\x69\156\x20\142\x69\x6e\141\162\171\40\162\x65\141\x64\x20\x6d\x6f\x64\145"); return PclZip::errorCode(); } goto qCeeT; SccHr: $p_header["\x63\162\143"] = $v_data_footer["\x63\162\143"]; goto sDTGq; cEUfs: if (($v_file = @fopen($p_filename, "\162\142")) == 0) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\156\141\142\154\145\x20\x74\157\40\x6f\160\x65\156\40\x66\x69\154\x65\x20\x27{$p_filename}\47\x20\x69\156\40\x62\151\x6e\141\x72\171\x20\x72\145\141\144\x20\155\157\x64\x65"); return PclZip::errorCode(); } goto xOxC7; lp8nN: $v_result = PCLZIP_ERR_NO_ERROR; goto DAiWA; m50JR: @unlink($v_gzip_temp_name); goto FwqL1; FwqL1: return $v_result; goto DFEqx; OBi03: if (($v_result = $this->privWriteFileHeader($p_header)) != 1) { return $v_result; } goto vvG81; v_GJm: if (($v_file_compressed = @fopen($v_gzip_temp_name, "\x72\x62")) == 0) { PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\x6e\x61\x62\154\x65\x20\164\157\40\157\x70\145\156\x20\164\145\x6d\160\157\x72\141\x72\171\40\146\151\x6c\145\x20\x27" . $v_gzip_temp_name . "\x27\40\151\x6e\40\x62\151\156\141\x72\171\x20\x72\x65\141\144\40\155\157\144\x65"); return PclZip::errorCode(); } goto esePr; DAiWA: $p_filename = $p_filedescr["\146\151\154\145\x6e\141\x6d\x65"]; goto cEUfs; yJDMd: $v_binary_data = @fread($v_file_compressed, 8); goto A5nlN; lCy35: @fclose($v_file); goto q2rHm; xOxC7: $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR . uniqid("\x70\143\154\x7a\x69\x70\x2d") . "\x2e\147\x7a"; goto vja99; vja99: if (($v_file_compressed = @gzopen($v_gzip_temp_name, "\167\142")) == 0) { goto SC40s; SC40s: fclose($v_file); goto ONaNm; ONaNm: PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, "\x55\x6e\x61\142\154\145\40\164\x6f\40\x6f\160\x65\156\40\x74\145\x6d\x70\x6f\x72\x61\x72\x79\x20\146\151\154\145\40\x27" . $v_gzip_temp_name . "\47\x20\151\156\40\x62\151\156\x61\162\171\x20\x77\x72\151\x74\x65\x20\155\x6f\x64\145"); goto Ykvq_; Ykvq_: return PclZip::errorCode(); goto cZbEl; cZbEl: } goto yZFMa; esePr: $v_binary_data = @fread($v_file_compressed, 10); goto t1osC; dbZGy: if (filesize($v_gzip_temp_name) < 18) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\x67\172\x69\x70\40\164\x65\x6d\x70\x6f\162\141\x72\x79\40\x66\151\x6c\145\40\x27" . $v_gzip_temp_name . "\47\x20\150\141\163\40\x69\156\x76\141\x6c\x69\x64\40\146\151\154\x65\x73\151\172\145\40\55\x20\163\150\x6f\165\x6c\x64\40\x62\x65\40\155\151\156\x69\x6d\x75\x6d\40\x31\70\x20\x62\171\x74\x65\x73"); return PclZip::errorCode(); } goto v_GJm; qCeeT: fseek($v_file_compressed, 10); goto BvmYP; BvmYP: $v_size = $p_header["\x63\157\x6d\160\162\145\x73\x73\145\144\137\163\x69\x7a\x65"]; goto tOmGL; cKgb0: @fseek($v_file_compressed, filesize($v_gzip_temp_name) - 8); goto yJDMd; q2rHm: @gzclose($v_file_compressed); goto dbZGy; t1osC: $v_data_header = unpack("\x61\61\x69\144\61\x2f\x61\x31\151\x64\x32\x2f\141\x31\x63\x6d\57\x61\x31\146\154\x61\x67\57\x56\x6d\164\151\155\145\57\x61\x31\x78\x66\154\x2f\x61\x31\x6f\163", $v_binary_data); goto wd7ah; LmKs4: $p_header["\x63\157\155\x70\x72\x65\x73\163\151\x6f\x6e"] = ord($v_data_header["\x63\155"]); goto SccHr; LoRUp: @fclose($v_file_compressed); goto OBi03; tOmGL: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($v_file_compressed, $v_read_size); @fwrite($this->zip_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto vgycY; A5nlN: $v_data_footer = unpack("\126\x63\162\x63\x2f\126\143\157\x6d\x70\162\145\x73\163\145\x64\137\163\151\172\145", $v_binary_data); goto LmKs4; yZFMa: $v_size = filesize($p_filename); goto OuoKF; wd7ah: $v_data_header["\157\x73"] = bin2hex($v_data_header["\157\163"]); goto cKgb0; sDTGq: $p_header["\143\157\x6d\x70\162\145\163\163\145\x64\x5f\163\x69\172\145"] = filesize($v_gzip_temp_name) - 18; goto LoRUp; DFEqx: } public function privCalculateStoredFilename(&$p_filedescr, &$p_options) { goto ulNST; anE0h: if (isset($p_options[PCLZIP_OPT_ADD_PATH])) { $p_add_dir = $p_options[PCLZIP_OPT_ADD_PATH]; } else { $p_add_dir = ''; } goto p4jjc; ecDEL: $v_stored_filename = PclZipUtilPathReduction($v_stored_filename); goto nKQHM; ZR5cQ: return $v_result; goto D31o7; JZMd3: if (isset($p_filedescr["\156\x65\167\x5f\x66\165\154\154\137\156\141\155\x65"])) { $v_stored_filename = PclZipUtilTranslateWinPath($p_filedescr["\156\x65\x77\x5f\x66\x75\154\154\137\x6e\x61\x6d\x65"]); } else { goto a2BlD; LeNAY: $v_stored_filename = PclZipUtilTranslateWinPath($v_stored_filename); goto j2MGC; j2MGC: if ($p_add_dir != '') { if (substr($p_add_dir, -1) == "\x2f") { $v_stored_filename = $p_add_dir . $v_stored_filename; } else { $v_stored_filename = $p_add_dir . "\x2f" . $v_stored_filename; } } goto zufot; V71Y4: if ($p_remove_all_dir) { $v_stored_filename = basename($p_filename); } elseif ($p_remove_dir != '') { goto LjAPm; goVxF: if ($v_compare > 0) { if ($v_compare == 2) { $v_stored_filename = ''; } else { $v_stored_filename = substr($v_stored_filename, strlen($p_remove_dir)); } } goto zlhUn; LjAPm: if (substr($p_remove_dir, -1) != "\57") { $p_remove_dir .= "\57"; } goto DoGt5; DoGt5: if (substr($p_filename, 0, 2) == "\56\x2f" || substr($p_remove_dir, 0, 2) == "\56\57") { if (substr($p_filename, 0, 2) == "\x2e\57" && substr($p_remove_dir, 0, 2) != "\56\x2f") { $p_remove_dir = "\56\57" . $p_remove_dir; } if (substr($p_filename, 0, 2) != "\56\x2f" && substr($p_remove_dir, 0, 2) == "\56\57") { $p_remove_dir = substr($p_remove_dir, 2); } } goto uqNeg; uqNeg: $v_compare = PclZipUtilPathInclusion($p_remove_dir, $v_stored_filename); goto goVxF; zlhUn: } goto LeNAY; a2BlD: if (isset($p_filedescr["\x6e\x65\167\x5f\x73\150\157\x72\x74\x5f\156\141\155\145"])) { goto wswVX; wswVX: $v_path_info = pathinfo($p_filename); goto r3I6O; Xqhjr: if ($v_path_info["\x64\x69\x72\156\x61\155\145"] != '') { $v_dir = $v_path_info["\144\x69\x72\x6e\x61\155\145"] . "\57"; } goto yz_F2; r3I6O: $v_dir = ''; goto Xqhjr; yz_F2: $v_stored_filename = $v_dir . $p_filedescr["\x6e\x65\167\x5f\163\150\157\x72\x74\x5f\x6e\x61\x6d\145"]; goto mvSP3; mvSP3: } else { $v_stored_filename = $p_filename; } goto V71Y4; zufot: } goto ecDEL; Vkbr6: if (isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])) { $p_remove_all_dir = $p_options[PCLZIP_OPT_REMOVE_ALL_PATH]; } else { $p_remove_all_dir = 0; } goto JZMd3; p4jjc: if (isset($p_options[PCLZIP_OPT_REMOVE_PATH])) { $p_remove_dir = $p_options[PCLZIP_OPT_REMOVE_PATH]; } else { $p_remove_dir = ''; } goto Vkbr6; HkJk_: $p_filename = $p_filedescr["\x66\151\x6c\145\156\x61\155\145"]; goto anE0h; ulNST: $v_result = 1; goto HkJk_; nKQHM: $p_filedescr["\x73\164\x6f\162\145\144\137\x66\151\154\145\x6e\x61\155\x65"] = $v_stored_filename; goto ZR5cQ; D31o7: } public function privWriteFileHeader(&$p_header) { goto OBdBo; rP7Xk: $v_binary_data = pack("\126\x76\166\166\166\x76\x56\x56\x56\166\x76", 0x4034b50, $p_header["\x76\145\x72\163\151\157\156\x5f\145\170\164\x72\x61\x63\x74\145\x64"], $p_header["\146\154\141\x67"], $p_header["\x63\x6f\x6d\x70\x72\x65\163\163\x69\x6f\156"], $v_mtime, $v_mdate, $p_header["\x63\162\x63"], $p_header["\x63\x6f\155\x70\162\145\x73\163\x65\144\137\163\151\x7a\x65"], $p_header["\x73\x69\172\145"], strlen($p_header["\x73\164\157\x72\145\144\x5f\x66\151\x6c\x65\x6e\141\x6d\145"]), $p_header["\145\x78\164\x72\141\x5f\x6c\x65\x6e"]); goto AUVc8; zVDcf: $v_mtime = ($v_date["\150\157\165\x72\163"] << 11) + ($v_date["\155\151\x6e\x75\x74\145\x73"] << 5) + $v_date["\x73\x65\x63\x6f\x6e\144\x73"] / 2; goto kENb3; RT2TF: if (strlen($p_header["\x73\164\157\x72\145\x64\137\x66\x69\x6c\x65\x6e\141\155\145"]) != 0) { fputs($this->zip_fd, $p_header["\163\x74\x6f\162\145\x64\x5f\146\x69\154\145\156\x61\x6d\x65"], strlen($p_header["\163\164\157\162\145\144\x5f\x66\x69\x6c\x65\x6e\x61\x6d\x65"])); } goto PoDXs; NPQwZ: $v_date = getdate($p_header["\155\x74\x69\x6d\x65"]); goto zVDcf; OBdBo: $v_result = 1; goto ySYzn; ySYzn: $p_header["\x6f\x66\x66\x73\x65\x74"] = ftell($this->zip_fd); goto NPQwZ; AUVc8: fputs($this->zip_fd, $v_binary_data, 30); goto RT2TF; porsf: return $v_result; goto SsiIJ; kENb3: $v_mdate = ($v_date["\171\145\x61\x72"] - 1980 << 9) + ($v_date["\x6d\x6f\x6e"] << 5) + $v_date["\155\x64\141\171"]; goto rP7Xk; PoDXs: if ($p_header["\x65\x78\164\162\x61\x5f\154\145\x6e"] != 0) { fputs($this->zip_fd, $p_header["\145\x78\x74\162\x61"], $p_header["\145\170\164\162\141\137\x6c\145\156"]); } goto porsf; SsiIJ: } public function privWriteCentralFileHeader(&$p_header) { goto J1069; IQZXN: if (strlen($p_header["\163\164\157\162\x65\144\137\146\151\x6c\x65\x6e\141\155\x65"]) != 0) { fputs($this->zip_fd, $p_header["\163\x74\x6f\x72\145\144\x5f\146\151\x6c\145\156\x61\x6d\145"], strlen($p_header["\x73\164\157\x72\145\x64\137\146\151\154\x65\156\x61\155\145"])); } goto eoe6L; SzR24: fputs($this->zip_fd, $v_binary_data, 46); goto IQZXN; NcPbT: $v_date = getdate($p_header["\x6d\x74\151\x6d\x65"]); goto gYsGu; gYsGu: $v_mtime = ($v_date["\x68\x6f\165\x72\163"] << 11) + ($v_date["\x6d\151\x6e\165\x74\145\x73"] << 5) + $v_date["\x73\145\x63\x6f\156\144\x73"] / 2; goto ibt3g; J1069: $v_result = 1; goto NcPbT; UEkqh: $v_binary_data = pack("\x56\x76\166\x76\166\166\x76\126\x56\126\166\166\x76\166\166\x56\126", 0x2014b50, $p_header["\x76\145\162\163\x69\x6f\x6e"], $p_header["\x76\x65\x72\163\x69\x6f\x6e\137\145\x78\164\x72\x61\143\x74\145\144"], $p_header["\146\x6c\141\147"], $p_header["\x63\157\x6d\x70\162\145\x73\163\151\x6f\156"], $v_mtime, $v_mdate, $p_header["\143\162\143"], $p_header["\x63\157\155\x70\x72\x65\x73\x73\145\x64\137\163\x69\x7a\x65"], $p_header["\163\x69\x7a\x65"], strlen($p_header["\163\x74\x6f\x72\x65\144\x5f\x66\x69\154\x65\x6e\141\155\145"]), $p_header["\145\170\164\162\141\x5f\154\x65\156"], $p_header["\143\157\x6d\155\x65\x6e\x74\x5f\154\x65\x6e"], $p_header["\x64\151\x73\153"], $p_header["\151\156\x74\145\162\156\141\x6c"], $p_header["\145\x78\x74\x65\x72\156\141\x6c"], $p_header["\x6f\x66\x66\x73\x65\x74"]); goto SzR24; pCaDj: if ($p_header["\143\157\x6d\x6d\x65\x6e\x74\x5f\x6c\x65\x6e"] != 0) { fputs($this->zip_fd, $p_header["\143\157\x6d\155\145\x6e\x74"], $p_header["\x63\x6f\155\x6d\145\156\164\x5f\154\145\x6e"]); } goto T9uPF; ibt3g: $v_mdate = ($v_date["\171\145\x61\x72"] - 1980 << 9) + ($v_date["\155\157\156"] << 5) + $v_date["\155\x64\x61\x79"]; goto UEkqh; T9uPF: return $v_result; goto Wj9nL; eoe6L: if ($p_header["\x65\170\x74\162\x61\137\154\145\x6e"] != 0) { fputs($this->zip_fd, $p_header["\x65\x78\164\x72\141"], $p_header["\x65\170\164\162\x61\x5f\x6c\145\156"]); } goto pCaDj; Wj9nL: } public function privWriteCentralHeader($p_nb_entries, $p_size, $p_offset, $p_comment) { goto F4JcW; B85_W: $v_binary_data = pack("\x56\x76\x76\x76\166\126\x56\166", 0x6054b50, 0, 0, $p_nb_entries, $p_nb_entries, $p_size, $p_offset, strlen($p_comment)); goto eB8PC; eB8PC: fputs($this->zip_fd, $v_binary_data, 22); goto fN47E; fN47E: if (strlen($p_comment) != 0) { fputs($this->zip_fd, $p_comment, strlen($p_comment)); } goto Va0kp; Va0kp: return $v_result; goto f_n51; F4JcW: $v_result = 1; goto B85_W; f_n51: } public function privList(&$p_list) { goto dEq8i; MAh0q: @rewind($this->zip_fd); goto PJ99J; CcUPR: $this->privSwapBackMagicQuotes(); goto lMvY4; NyIZ9: if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1) { $this->privSwapBackMagicQuotes(); return $v_result; } goto MAh0q; eJSua: $v_central_dir = array(); goto NyIZ9; wutiS: $this->privDisableMagicQuotes(); goto XCYA0; XCYA0: if (($this->zip_fd = @fopen($this->zipname, "\x72\142")) == 0) { goto hkfjI; hkfjI: $this->privSwapBackMagicQuotes(); goto JhI7H; IeLT0: return PclZip::errorCode(); goto gtUzj; JhI7H: PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\125\156\141\142\154\145\40\x74\x6f\x20\x6f\160\x65\x6e\x20\141\x72\143\x68\x69\166\x65\x20\47" . $this->zipname . "\47\40\x69\x6e\x20\x62\x69\x6e\x61\162\x79\x20\162\x65\141\144\x20\155\157\144\x65"); goto IeLT0; gtUzj: } goto eJSua; lMvY4: return $v_result; goto mFFTm; dEq8i: $v_result = 1; goto wutiS; PJ99J: if (@fseek($this->zip_fd, $v_central_dir["\157\x66\x66\163\x65\x74"])) { goto r6R_j; r6R_j: $this->privSwapBackMagicQuotes(); goto tvx8T; ABB2n: return PclZip::errorCode(); goto pN99h; tvx8T: PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, "\x49\x6e\x76\x61\x6c\151\144\x20\x61\162\x63\150\x69\166\x65\x20\x73\151\172\145"); goto ABB2n; pN99h: } goto bbk21; u4HXt: $this->privCloseFd(); goto CcUPR; bbk21: for ($i = 0; $i < $v_central_dir["\x65\156\x74\162\x69\x65\163"]; $i++) { if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1) { $this->privSwapBackMagicQuotes(); return $v_result; } $v_header["\x69\156\x64\x65\170"] = $i; $this->privConvertHeader2FileInfo($v_header, $p_list[$i]); unset($v_header); } goto u4HXt; mFFTm: } public function privConvertHeader2FileInfo($p_header, &$p_info) { goto kaH8O; yL7r7: $p_info["\x73\164\157\x72\145\144\137\x66\151\x6c\x65\156\141\x6d\x65"] = $v_temp_path; goto uO146; kaH8O: $v_result = 1; goto pvtWq; pvtWq: $v_temp_path = PclZipUtilPathReduction($p_header["\146\x69\154\x65\156\x61\x6d\x65"]); goto HCqT9; G3I7g: $p_info["\x66\x6f\154\x64\x65\162"] = ($p_header["\x65\x78\164\145\x72\x6e\141\154"] & 0x10) == 0x10; goto EC4Ye; uhpB7: return $v_result; goto W9tE1; LPT1J: $p_info["\x63\x72\143"] = $p_header["\x63\162\143"]; goto uhpB7; ndd3g: $v_temp_path = PclZipUtilPathReduction($p_header["\163\164\x6f\162\145\144\x5f\146\151\154\145\x6e\x61\x6d\145"]); goto yL7r7; HCqT9: $p_info["\146\x69\x6c\145\x6e\141\x6d\x65"] = $v_temp_path; goto ndd3g; EC4Ye: $p_info["\151\x6e\x64\x65\x78"] = $p_header["\151\x6e\144\145\x78"]; goto rduZu; W3t_O: $p_info["\x6d\164\x69\155\145"] = $p_header["\x6d\164\151\155\145"]; goto zi4H8; zi4H8: $p_info["\x63\157\x6d\x6d\145\156\x74"] = $p_header["\143\x6f\x6d\155\145\x6e\x74"]; goto G3I7g; uO146: $p_info["\163\151\x7a\x65"] = $p_header["\x73\x69\x7a\x65"]; goto xcOp6; xcOp6: $p_info["\x63\157\155\x70\162\145\x73\163\x65\144\137\163\151\x7a\145"] = $p_header["\x63\157\x6d\x70\162\145\163\163\145\144\137\163\x69\x7a\145"]; goto W3t_O; rduZu: $p_info["\163\x74\x61\164\x75\163"] = $p_header["\x73\164\x61\x74\x75\163"]; goto LPT1J; W9tE1: } public function privExtractByRule(&$p_file_list, $p_path, $p_remove_path, $p_remove_all_path, &$p_options) { goto MfFC0; TdtmG: $j_start = 0; goto wVWyh; MfFC0: $v_result = 1; goto Z3aQn; l8ISH: $p_remove_path_size = strlen($p_remove_path); goto fXaHG; fXaHG: if (($v_result = $this->privOpenFd("\162\142")) != 1) { $this->privSwapBackMagicQuotes(); return $v_result; } goto vzxK6; nEfr4: $this->privSwapBackMagicQuotes(); goto BB47W; Z3aQn: $this->privDisableMagicQuotes(); goto OlQ77; a4ThA: if ($p_path != "\x2e\x2f" && $p_path != "\57") { while (substr($p_path, -1) == "\x2f") { $p_path = substr($p_path, 0, strlen($p_path) - 1); } } goto x2IOH; I2kTc: if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1) { goto WPHG9; sLU5K: return $v_result; goto c9dB1; WPHG9: $this->privCloseFd(); goto qGCEm; qGCEm: $this->privSwapBackMagicQuotes(); goto sLU5K; c9dB1: } goto W0j8F; OlQ77: if ($p_path == '' || substr($p_path, 0, 1) != "\57" && substr($p_path, 0, 3) != "\x2e\56\x2f" && substr($p_path, 1, 2) != "\72\x2f") { $p_path = "\x2e\57" . $p_path; } goto a4ThA; nSd21: $this->privCloseFd(); goto nEfr4; vzxK6: $v_central_dir = array(); goto I2kTc; BB47W: return $v_result; goto HMZDH; W0j8F: $v_pos_entry = $v_central_dir["\157\x66\146\163\x65\x74"]; goto TdtmG; wVWyh: for ($i = 0, $v_nb_extracted = 0; $i < $v_central_dir["\145\156\164\x72\x69\x65\163"]; $i++) { @rewind($this->zip_fd); if (@fseek($this->zip_fd, $v_pos_entry)) { goto XHf2I; SxSTb: return PclZip::errorCode(); goto eXotY; m5PEn: $this->privSwapBackMagicQuotes(); goto SQ268; SQ268: PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, "\111\156\166\x61\154\151\144\40\141\x72\143\150\x69\x76\145\40\x73\x69\x7a\145"); goto SxSTb; XHf2I: $this->privCloseFd(); goto m5PEn; eXotY: } $v_header = array(); if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1) { goto wD9R4; JCf5i: return $v_result; goto MxJgw; dU2G2: $this->privSwapBackMagicQuotes(); goto JCf5i; wD9R4: $this->privCloseFd(); goto dU2G2; MxJgw: } $v_header["\151\x6e\144\x65\x78"] = $i; $v_pos_entry = ftell($this->zip_fd); $v_extract = false; if (isset($p_options[PCLZIP_OPT_BY_NAME]) && $p_options[PCLZIP_OPT_BY_NAME] != 0) { for ($j = 0; $j < sizeof($p_options[PCLZIP_OPT_BY_NAME]) && !$v_extract; $j++) { if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "\57") { if (strlen($v_header["\x73\x74\157\162\x65\x64\137\146\151\154\145\x6e\141\x6d\x65"]) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]) && substr($v_header["\x73\x74\157\162\145\x64\x5f\146\x69\154\145\156\x61\155\x65"], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j]) { $v_extract = true; } } elseif ($v_header["\x73\164\157\x72\x65\144\137\x66\151\154\145\156\x61\x6d\145"] == $p_options[PCLZIP_OPT_BY_NAME][$j]) { $v_extract = true; } } } elseif (isset($p_options[PCLZIP_OPT_BY_PREG]) && $p_options[PCLZIP_OPT_BY_PREG] != '') { if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header["\163\164\x6f\162\145\x64\137\x66\151\154\x65\156\x61\x6d\145"])) { $v_extract = true; } } elseif (isset($p_options[PCLZIP_OPT_BY_INDEX]) && $p_options[PCLZIP_OPT_BY_INDEX] != 0) { for ($j = $j_start; $j < sizeof($p_options[PCLZIP_OPT_BY_INDEX]) && !$v_extract; $j++) { if ($i >= $p_options[PCLZIP_OPT_BY_INDEX][$j]["\x73\x74\x61\162\x74"] && $i <= $p_options[PCLZIP_OPT_BY_INDEX][$j]["\145\156\144"]) { $v_extract = true; } if ($i >= $p_options[PCLZIP_OPT_BY_INDEX][$j]["\x65\x6e\144"]) { $j_start = $j + 1; } if ($p_options[PCLZIP_OPT_BY_INDEX][$j]["\163\164\x61\162\164"] > $i) { break; } } } else { $v_extract = true; } if ($v_extract && ($v_header["\x63\157\155\x70\162\x65\x73\163\151\x6f\x6e"] != 8 && $v_header["\143\x6f\x6d\160\x72\145\163\163\151\157\156"] != 0)) { $v_header["\163\164\x61\164\x75\x73"] = "\x75\x6e\163\x75\160\160\x6f\x72\164\145\144\x5f\143\x6f\x6d\160\x72\145\x73\x73\151\157\x6e"; if (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]) && $p_options[PCLZIP_OPT_STOP_ON_ERROR] === true) { goto iO3C2; cCNBR: PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_COMPRESSION, "\106\151\154\x65\156\x61\155\x65\40\47" . $v_header["\163\x74\157\162\145\144\137\x66\x69\x6c\145\156\141\x6d\145"] . "\47\40\x69\163\x20\143\157\155\x70\162\x65\163\163\145\144\x20\x62\171\40\x61\x6e\40\165\x6e\x73\165\160\160\157\162\164\x65\144\x20\x63\x6f\155\x70\162\x65\163\x73\x69\x6f\156\40\x6d\145\164\150\157\x64\x20\x28" . $v_header["\143\x6f\155\x70\x72\x65\x73\x73\x69\157\156"] . "\51\x20"); goto DnkNj; iO3C2: $this->privSwapBackMagicQuotes(); goto cCNBR; DnkNj: return PclZip::errorCode(); goto wBx_u; wBx_u: } } if ($v_extract && ($v_header["\146\154\x61\147"] & 1) == 1) { $v_header["\163\164\x61\164\x75\163"] = "\x75\156\x73\165\160\x70\157\x72\164\145\x64\x5f\x65\x6e\x63\162\x79\x70\164\x69\157\156"; if (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]) && $p_options[PCLZIP_OPT_STOP_ON_ERROR] === true) { goto RfF7z; bf03Q: return PclZip::errorCode(); goto P0qo7; dVODg: PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION, "\x55\156\163\x75\x70\160\157\x72\164\x65\144\40\145\x6e\x63\x72\171\x70\x74\x69\x6f\156\x20\x66\x6f\162\40\40\x66\151\x6c\x65\156\x61\x6d\145\x20\47" . $v_header["\163\164\157\162\x65\x64\x5f\146\x69\154\x65\156\x61\155\x65"] . "\47"); goto bf03Q; RfF7z: $this->privSwapBackMagicQuotes(); goto dVODg; P0qo7: } } if ($v_extract && $v_header["\163\x74\141\164\165\163"] != "\x6f\153") { goto H40VW; pPdn6: if ($v_result != 1) { goto ERrSU; f9Y2d: $this->privSwapBackMagicQuotes(); goto wcW17; wcW17: return $v_result; goto OwF9A; ERrSU: $this->privCloseFd(); goto f9Y2d; OwF9A: } goto PWKYh; H40VW: $v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++]); goto pPdn6; PWKYh: $v_extract = false; goto ygaIl; ygaIl: } if ($v_extract) { goto gY25p; bINOm: if (@fseek($this->zip_fd, $v_header["\x6f\x66\x66\x73\145\x74"])) { goto jS81J; r7V21: $this->privSwapBackMagicQuotes(); goto dhxvx; jS81J: $this->privCloseFd(); goto r7V21; scRqb: return PclZip::errorCode(); goto ujwSm; dhxvx: PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, "\111\x6e\166\x61\x6c\151\144\40\141\x72\143\150\151\x76\145\x20\x73\151\172\145"); goto scRqb; ujwSm: } goto S3M_C; gY25p: @rewind($this->zip_fd); goto bINOm; S3M_C: if ($p_options[PCLZIP_OPT_EXTRACT_AS_STRING]) { goto q8k8w; wpGzJ: $v_result1 = $this->privExtractFileAsString($v_header, $v_string, $p_options); goto WjKyP; POQVl: $p_file_list[$v_nb_extracted]["\143\157\156\164\145\156\164"] = $v_string; goto p4UeA; RK8fZ: if ($v_result1 == 2) { break; } goto ayl4O; rt8z_: if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted])) != 1) { goto S1bB1; LC0KF: $this->privSwapBackMagicQuotes(); goto ny4ql; ny4ql: return $v_result; goto FNOFb; S1bB1: $this->privCloseFd(); goto LC0KF; FNOFb: } goto POQVl; q8k8w: $v_string = ''; goto wpGzJ; p4UeA: $v_nb_extracted++; goto RK8fZ; WjKyP: if ($v_result1 < 1) { goto yDHPR; ECbAv: $this->privSwapBackMagicQuotes(); goto yCvPS; yCvPS: return $v_result1; goto J1Zuz; yDHPR: $this->privCloseFd(); goto ECbAv; J1Zuz: } goto rt8z_; ayl4O: } elseif (isset($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT]) && $p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT]) { goto jo9xS; jo9xS: $v_result1 = $this->privExtractFileInOutput($v_header, $p_options); goto Y8lQc; merKS: if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1) { goto cNYtG; gN2d3: return $v_result; goto ugbs_; NfCcX: $this->privSwapBackMagicQuotes(); goto gN2d3; cNYtG: $this->privCloseFd(); goto NfCcX; ugbs_: } goto ewCL7; Y8lQc: if ($v_result1 < 1) { goto KeKw1; KeKw1: $this->privCloseFd(); goto Cb91R; VmNdq: return $v_result1; goto QpUFF; Cb91R: $this->privSwapBackMagicQuotes(); goto VmNdq; QpUFF: } goto merKS; ewCL7: if ($v_result1 == 2) { break; } goto ZfshY; ZfshY: } else { goto jqv9M; oV4p0: if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1) { goto nxFOp; StrFW: return $v_result; goto sbZs9; TYrIX: $this->privSwapBackMagicQuotes(); goto StrFW; nxFOp: $this->privCloseFd(); goto TYrIX; sbZs9: } goto yojXg; jqv9M: $v_result1 = $this->privExtractFile($v_header, $p_path, $p_remove_path, $p_remove_all_path, $p_options); goto yf59_; yf59_: if ($v_result1 < 1) { goto nmLsK; nmLsK: $this->privCloseFd(); goto y_mEv; tpEsI: return $v_result1; goto DX0a5; y_mEv: $this->privSwapBackMagicQuotes(); goto tpEsI; DX0a5: } goto oV4p0; yojXg: if ($v_result1 == 2) { break; } goto Y3B3Q; Y3B3Q: } goto fTKg8; fTKg8: } } goto nSd21; x2IOH: if ($p_remove_path != '' && substr($p_remove_path, -1) != "\x2f") { $p_remove_path .= "\x2f"; } goto l8ISH; HMZDH: } public function privExtractFile(&$p_entry, $p_path, $p_remove_path, $p_remove_all_path, &$p_options) { goto rbdBE; TB2YC: if ($p_remove_all_path == true) { if (($p_entry["\x65\170\x74\145\162\156\x61\x6c"] & 0x10) == 0x10) { $p_entry["\163\164\141\x74\165\x73"] = "\x66\x69\154\164\x65\162\x65\144"; return $v_result; } $p_entry["\146\151\154\145\156\141\155\x65"] = basename($p_entry["\x66\151\154\x65\x6e\141\155\x65"]); } elseif ($p_remove_path != '') { goto BiMxp; BiMxp: if (PclZipUtilPathInclusion($p_remove_path, $p_entry["\x66\151\x6c\x65\x6e\x61\155\145"]) == 2) { $p_entry["\163\164\x61\164\x75\163"] = "\x66\151\x6c\x74\145\x72\x65\144"; return $v_result; } goto VcQL7; oS4mN: if (substr($p_entry["\x66\x69\x6c\145\156\141\155\x65"], 0, $p_remove_path_size) == $p_remove_path) { $p_entry["\x66\151\x6c\145\x6e\141\155\x65"] = substr($p_entry["\146\x69\154\145\x6e\x61\x6d\x65"], $p_remove_path_size); } goto HT8PD; VcQL7: $p_remove_path_size = strlen($p_remove_path); goto oS4mN; HT8PD: } goto hDXAB; iTGtc: if ($p_entry["\163\164\141\x74\x75\x73"] == "\157\153") { if (!(($p_entry["\145\170\164\145\162\x6e\x61\x6c"] & 0x10) == 0x10)) { if ($p_entry["\x63\157\155\160\x72\145\163\163\x69\x6f\x6e"] == 0) { goto y094c; ZVpEQ: fclose($v_dest_file); goto f6PO_; y094c: if (($v_dest_file = @fopen($p_entry["\x66\x69\154\145\156\141\155\x65"], "\x77\x62")) == 0) { $p_entry["\x73\x74\141\x74\165\x73"] = "\x77\162\x69\x74\x65\x5f\x65\x72\x72\157\162"; return $v_result; } goto JjIZE; f6PO_: touch($p_entry["\x66\151\x6c\x65\x6e\141\155\x65"], $p_entry["\x6d\164\x69\x6d\x65"]); goto Eeivp; ha673: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($this->zip_fd, $v_read_size); @fwrite($v_dest_file, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto ZVpEQ; JjIZE: $v_size = $p_entry["\x63\157\x6d\x70\162\145\163\163\145\x64\x5f\163\x69\x7a\x65"]; goto ha673; Eeivp: } else { goto hTpRI; Awzg9: if (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF]) && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON]) || isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]) && $p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_entry["\x73\151\172\145"])) { $v_result = $this->privExtractFileUsingTempFile($p_entry, $p_options); if ($v_result < PCLZIP_ERR_NO_ERROR) { return $v_result; } } else { goto KIZqQ; wEQBD: unset($v_buffer); goto g5I_O; z7SF3: if (($v_dest_file = @fopen($p_entry["\146\x69\154\145\x6e\141\155\145"], "\167\x62")) == 0) { $p_entry["\x73\164\x61\x74\165\163"] = "\x77\162\x69\x74\x65\137\x65\162\x72\157\162"; return $v_result; } goto JK35K; aVAMc: $v_file_content = @gzinflate($v_buffer); goto wEQBD; Ti0wf: @fclose($v_dest_file); goto d3d4J; JK35K: @fwrite($v_dest_file, $v_file_content, $p_entry["\x73\151\x7a\145"]); goto mJvqN; mJvqN: unset($v_file_content); goto Ti0wf; g5I_O: if ($v_file_content === false) { $p_entry["\x73\164\x61\x74\165\163"] = "\x65\162\162\157\x72"; return $v_result; } goto z7SF3; KIZqQ: $v_buffer = @fread($this->zip_fd, $p_entry["\143\157\155\160\x72\145\163\163\x65\x64\x5f\163\151\x7a\x65"]); goto aVAMc; d3d4J: } goto kkuWh; kkuWh: @touch($p_entry["\146\x69\154\145\156\141\x6d\145"], $p_entry["\x6d\x74\151\155\145"]); goto jD0tF; hTpRI: if (($p_entry["\x66\154\141\147"] & 1) == 1) { PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION, "\x46\151\x6c\145\x20\x27" . $p_entry["\x66\151\154\x65\156\x61\155\x65"] . "\x27\x20\x69\x73\x20\145\156\143\x72\x79\x70\164\x65\x64\x2e\40\105\x6e\x63\x72\171\160\x74\x65\x64\x20\146\x69\x6c\145\x73\x20\x61\162\x65\x20\156\157\164\x20\163\x75\x70\x70\157\162\164\x65\x64\56"); return PclZip::errorCode(); } goto Awzg9; jD0tF: } if (isset($p_options[PCLZIP_OPT_SET_CHMOD])) { @chmod($p_entry["\146\x69\x6c\x65\x6e\x61\155\145"], $p_options[PCLZIP_OPT_SET_CHMOD]); } } } goto gEjU4; Ow8W8: if ($p_entry["\163\x74\141\x74\165\x73"] == "\157\x6b") { if (file_exists($p_entry["\146\x69\154\145\156\x61\x6d\x65"])) { if (is_dir($p_entry["\x66\x69\x6c\x65\156\141\x6d\145"])) { $p_entry["\x73\x74\141\x74\165\163"] = "\141\x6c\x72\145\141\144\x79\137\x61\x5f\x64\151\x72\x65\x63\x74\157\162\x79"; if (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]) && $p_options[PCLZIP_OPT_STOP_ON_ERROR] === true) { PclZip::privErrorLog(PCLZIP_ERR_ALREADY_A_DIRECTORY, "\106\x69\154\145\156\141\155\145\x20\47" . $p_entry["\146\x69\x6c\145\x6e\141\x6d\x65"] . "\47\40\x69\x73\x20\141\x6c\162\x65\141\144\x79\x20\x75\x73\145\144\x20\x62\171\x20\x61\156\x20\x65\170\151\x73\x74\x69\156\x67\40\x64\151\162\145\143\x74\157\x72\x79"); return PclZip::errorCode(); } } elseif (!is_writeable($p_entry["\146\x69\x6c\x65\156\141\x6d\145"])) { $p_entry["\x73\x74\x61\x74\x75\163"] = "\167\x72\x69\164\x65\137\x70\x72\x6f\x74\x65\x63\164\x65\x64"; if (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]) && $p_options[PCLZIP_OPT_STOP_ON_ERROR] === true) { PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, "\x46\151\154\145\156\141\155\x65\x20\x27" . $p_entry["\x66\x69\x6c\x65\x6e\141\x6d\145"] . "\x27\40\x65\x78\x69\163\x74\x73\40\141\156\144\x20\151\163\x20\x77\162\151\x74\145\40\160\162\x6f\164\145\143\164\145\x64"); return PclZip::errorCode(); } } elseif (filemtime($p_entry["\x66\x69\x6c\145\x6e\x61\155\x65"]) > $p_entry["\155\164\x69\x6d\145"]) { if (isset($p_options[PCLZIP_OPT_REPLACE_NEWER]) && $p_options[PCLZIP_OPT_REPLACE_NEWER] === true) { } else { $p_entry["\163\x74\x61\164\x75\163"] = "\x6e\145\x77\x65\162\137\145\170\151\x73\164"; if (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]) && $p_options[PCLZIP_OPT_STOP_ON_ERROR] === true) { PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, "\x4e\145\x77\x65\162\x20\x76\145\x72\x73\x69\157\156\x20\x6f\x66\40\x27" . $p_entry["\146\151\x6c\145\x6e\x61\x6d\x65"] . "\x27\x20\145\170\x69\163\x74\x73\40\x61\156\144\40\157\x70\164\x69\157\156\x20\120\103\x4c\132\111\120\137\x4f\x50\x54\137\x52\105\x50\114\x41\x43\x45\x5f\116\105\127\105\x52\40\151\163\40\x6e\x6f\164\x20\x73\145\x6c\145\143\x74\145\144"); return PclZip::errorCode(); } } } else { } } else { if (($p_entry["\145\x78\x74\145\162\156\x61\154"] & 0x10) == 0x10 || substr($p_entry["\x66\x69\154\x65\156\x61\155\145"], -1) == "\x2f") { $v_dir_to_check = $p_entry["\x66\151\x6c\x65\x6e\x61\x6d\x65"]; } elseif (!strstr($p_entry["\146\x69\x6c\x65\x6e\x61\x6d\145"], "\57")) { $v_dir_to_check = ''; } else { $v_dir_to_check = dirname($p_entry["\x66\x69\154\145\x6e\x61\155\x65"]); } if (($v_result = $this->privDirCheck($v_dir_to_check, ($p_entry["\145\x78\164\x65\162\x6e\141\154"] & 0x10) == 0x10)) != 1) { $p_entry["\x73\x74\141\x74\x75\x73"] = "\160\141\x74\x68\137\143\x72\x65\x61\164\151\157\156\x5f\x66\x61\151\154"; $v_result = 1; } } } goto iTGtc; V_3Qn: if (($v_result = $this->privReadFileHeader($v_header)) != 1) { return $v_result; } goto SSzAT; gEjU4: if ($p_entry["\163\164\141\164\165\163"] == "\x61\x62\157\162\x74\145\144") { $p_entry["\x73\164\141\x74\x75\163"] = "\163\153\x69\160\x70\145\x64"; } elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) { goto TVp5G; TVp5G: $v_local_header = array(); goto kxruf; kxruf: $this->privConvertHeader2FileInfo($p_entry, $v_local_header); goto MWnmU; MWnmU: $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header); goto NnZAM; NnZAM: if ($v_result == 2) { $v_result = PCLZIP_ERR_USER_ABORTED; } goto h6NUJ; h6NUJ: } goto VH_jr; J2xRZ: if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) { goto SXD31; nX4sP: if ($v_result == 0) { $p_entry["\x73\x74\x61\x74\165\x73"] = "\x73\x6b\x69\160\x70\145\x64"; $v_result = 1; } goto GYjMU; SXD31: $v_local_header = array(); goto JY666; rVUsa: $p_entry["\x66\151\x6c\x65\x6e\x61\155\x65"] = $v_local_header["\146\151\x6c\145\x6e\x61\155\x65"]; goto zPADk; JY666: $this->privConvertHeader2FileInfo($p_entry, $v_local_header); goto hW_XC; hW_XC: $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header); goto nX4sP; GYjMU: if ($v_result == 2) { $p_entry["\x73\164\141\x74\x75\x73"] = "\x61\142\x6f\162\164\145\x64"; $v_result = PCLZIP_ERR_USER_ABORTED; } goto rVUsa; zPADk: } goto Ow8W8; hDXAB: if ($p_path != '') { $p_entry["\146\x69\154\145\x6e\141\155\x65"] = $p_path . "\x2f" . $p_entry["\x66\x69\154\x65\156\x61\155\145"]; } goto OvxYw; VH_jr: return $v_result; goto Bp45m; SSzAT: if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) { } goto TB2YC; OvxYw: if (isset($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION])) { $v_inclusion = PclZipUtilPathInclusion($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION], $p_entry["\146\151\x6c\x65\156\x61\x6d\x65"]); if ($v_inclusion == 0) { PclZip::privErrorLog(PCLZIP_ERR_DIRECTORY_RESTRICTION, "\x46\151\x6c\x65\156\141\155\145\40\x27" . $p_entry["\146\151\x6c\x65\156\141\x6d\x65"] . "\47\x20\151\x73\x20\x6f\x75\164\x73\x69\144\145\x20\120\x43\114\x5a\111\120\x5f\117\x50\x54\x5f\x45\x58\x54\122\x41\x43\x54\x5f\x44\x49\122\x5f\122\x45\x53\124\x52\111\103\124\111\x4f\116"); return PclZip::errorCode(); } } goto J2xRZ; rbdBE: $v_result = 1; goto V_3Qn; Bp45m: } public function privExtractFileUsingTempFile(&$p_entry, &$p_options) { goto ga5Vy; bVybQ: @fwrite($v_dest_file, $v_binary_data, 10); goto a78XV; SrX9g: $v_size = $p_entry["\x73\x69\172\x65"]; goto Qsica; Y1FOZ: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($this->zip_fd, $v_read_size); @fwrite($v_dest_file, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto XJr1R; UkJ5e: @unlink($v_gzip_temp_name); goto iDq3_; iDq3_: return $v_result; goto URcG6; c0iXw: @fclose($v_dest_file); goto bjnda; a78XV: $v_size = $p_entry["\143\157\155\x70\162\145\x73\163\145\x64\x5f\x73\151\x7a\145"]; goto Y1FOZ; bjnda: @gzclose($v_src_file); goto UkJ5e; Qsica: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @gzread($v_src_file, $v_read_size); @fwrite($v_dest_file, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto c0iXw; KOvdf: if (($v_dest_file = @fopen($v_gzip_temp_name, "\x77\142")) == 0) { goto XyX4W; rRsYD: PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, "\x55\x6e\x61\142\x6c\x65\x20\x74\x6f\x20\157\160\145\156\40\164\145\155\x70\x6f\x72\x61\162\171\40\x66\151\x6c\145\40\47" . $v_gzip_temp_name . "\47\40\151\156\x20\142\151\x6e\141\x72\171\x20\x77\x72\151\164\x65\40\x6d\157\x64\x65"); goto Kb6UM; XyX4W: fclose($v_file); goto rRsYD; Kb6UM: return PclZip::errorCode(); goto mCWs4; mCWs4: } goto Adsq2; ga5Vy: $v_result = 1; goto u12zf; lIeuc: if (($v_src_file = @gzopen($v_gzip_temp_name, "\x72\142")) == 0) { goto TDZ_w; TDZ_w: @fclose($v_dest_file); goto BD70M; BD70M: $p_entry["\163\164\141\x74\x75\x73"] = "\162\145\141\x64\137\145\x72\162\157\162"; goto moL3S; moL3S: PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\156\141\x62\154\145\x20\164\x6f\x20\x6f\160\x65\x6e\40\x74\x65\x6d\x70\x6f\x72\x61\x72\171\40\146\151\154\145\40\47" . $v_gzip_temp_name . "\47\40\151\156\x20\x62\x69\x6e\141\x72\x79\40\162\x65\141\144\x20\155\157\144\145"); goto wk04u; wk04u: return PclZip::errorCode(); goto rWqK7; rWqK7: } goto SrX9g; Adsq2: $v_binary_data = pack("\166\141\x31\141\61\126\x61\x31\141\x31", 0x8b1f, Chr($p_entry["\143\x6f\155\x70\162\x65\x73\163\151\x6f\x6e"]), Chr(0x0), time(), Chr(0x0), Chr(3)); goto bVybQ; u12zf: $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR . uniqid("\x70\x63\154\x7a\151\x70\55") . "\56\147\172"; goto KOvdf; obc3o: if (($v_dest_file = @fopen($p_entry["\146\151\154\x65\x6e\141\155\145"], "\167\x62")) == 0) { $p_entry["\163\164\141\164\165\x73"] = "\167\x72\x69\164\145\x5f\145\x72\162\x6f\x72"; return $v_result; } goto lIeuc; XJr1R: $v_binary_data = pack("\126\x56", $p_entry["\x63\162\x63"], $p_entry["\163\x69\172\145"]); goto rUTQ9; rUTQ9: @fwrite($v_dest_file, $v_binary_data, 8); goto zXLqz; zXLqz: @fclose($v_dest_file); goto obc3o; URcG6: } public function privExtractFileInOutput(&$p_entry, &$p_options) { goto xojff; r1CFM: if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) { } goto CBHP7; xojff: $v_result = 1; goto zBvdw; zBvdw: if (($v_result = $this->privReadFileHeader($v_header)) != 1) { return $v_result; } goto r1CFM; LkbgV: return $v_result; goto c8RBG; CBHP7: if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) { goto F4yz0; InO1H: $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header); goto BrLx8; BrLx8: if ($v_result == 0) { $p_entry["\x73\x74\x61\164\x75\x73"] = "\163\153\151\160\160\x65\x64"; $v_result = 1; } goto JF0qS; SQiYf: $p_entry["\146\151\x6c\x65\x6e\141\155\x65"] = $v_local_header["\x66\151\x6c\145\156\141\155\145"]; goto GO7rS; JF0qS: if ($v_result == 2) { $p_entry["\163\x74\141\x74\x75\x73"] = "\141\142\x6f\x72\164\145\x64"; $v_result = PCLZIP_ERR_USER_ABORTED; } goto SQiYf; GmUJ1: $this->privConvertHeader2FileInfo($p_entry, $v_local_header); goto InO1H; F4yz0: $v_local_header = array(); goto GmUJ1; GO7rS: } goto xCSgj; xBy6_: if ($p_entry["\163\x74\141\164\165\x73"] == "\x61\142\157\x72\164\x65\x64") { $p_entry["\163\164\x61\164\x75\x73"] = "\163\153\x69\160\160\x65\x64"; } elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) { goto z0Bgb; hs5Ht: $this->privConvertHeader2FileInfo($p_entry, $v_local_header); goto u6wnP; K1Z2v: if ($v_result == 2) { $v_result = PCLZIP_ERR_USER_ABORTED; } goto M35dV; z0Bgb: $v_local_header = array(); goto hs5Ht; u6wnP: $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header); goto K1Z2v; M35dV: } goto LkbgV; xCSgj: if ($p_entry["\x73\164\141\x74\x75\163"] == "\157\153") { if (!(($p_entry["\145\x78\164\145\x72\x6e\x61\154"] & 0x10) == 0x10)) { if ($p_entry["\x63\x6f\x6d\160\x72\x65\x73\x73\x65\144\x5f\163\151\172\145"] == $p_entry["\163\151\172\x65"]) { goto blLfM; kpN9O: unset($v_buffer); goto qFPx2; gLTDT: echo $v_buffer; goto kpN9O; blLfM: $v_buffer = @fread($this->zip_fd, $p_entry["\143\157\x6d\x70\x72\145\x73\163\x65\x64\x5f\163\x69\172\145"]); goto gLTDT; qFPx2: } else { goto FAnpG; zM0bu: echo $v_file_content; goto HZ3v6; HZ3v6: unset($v_file_content); goto BBCKH; NOJPc: unset($v_buffer); goto zM0bu; tLfdc: $v_file_content = gzinflate($v_buffer); goto NOJPc; FAnpG: $v_buffer = @fread($this->zip_fd, $p_entry["\x63\157\155\160\162\145\x73\163\145\x64\137\163\151\172\x65"]); goto tLfdc; BBCKH: } } } goto xBy6_; c8RBG: } public function privExtractFileAsString(&$p_entry, &$p_string, &$p_options) { goto GSc82; GSc82: $v_result = 1; goto qE3jn; k7ipA: if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) { goto Vq94D; ovyHZ: if ($v_result == 0) { $p_entry["\x73\164\141\164\165\x73"] = "\163\153\x69\x70\160\x65\x64"; $v_result = 1; } goto jdWSF; i0CsN: $this->privConvertHeader2FileInfo($p_entry, $v_local_header); goto XDSnQ; Vq94D: $v_local_header = array(); goto i0CsN; oPOe2: $p_entry["\x66\151\154\x65\156\141\155\145"] = $v_local_header["\x66\x69\154\x65\156\x61\155\145"]; goto e15eZ; jdWSF: if ($v_result == 2) { $p_entry["\163\164\x61\164\165\x73"] = "\x61\x62\157\x72\164\x65\144"; $v_result = PCLZIP_ERR_USER_ABORTED; } goto oPOe2; XDSnQ: $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header); goto ovyHZ; e15eZ: } goto Tsjov; ZLeV0: if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) { } goto k7ipA; dy5Zd: if (($v_result = $this->privReadFileHeader($v_header)) != 1) { return $v_result; } goto ZLeV0; Tsjov: if ($p_entry["\163\x74\141\164\165\x73"] == "\157\153") { if (!(($p_entry["\x65\170\x74\145\162\x6e\141\154"] & 0x10) == 0x10)) { if ($p_entry["\x63\157\155\x70\x72\145\163\163\x69\x6f\156"] == 0) { $p_string = @fread($this->zip_fd, $p_entry["\x63\x6f\155\x70\162\x65\163\163\x65\x64\137\163\151\x7a\x65"]); } else { $v_data = @fread($this->zip_fd, $p_entry["\x63\x6f\x6d\160\162\145\163\x73\145\x64\x5f\163\151\x7a\x65"]); if (($p_string = @gzinflate($v_data)) === false) { } } } else { } } goto PPZdj; qE3jn: $v_header = array(); goto dy5Zd; BFbBM: return $v_result; goto ipnTh; PPZdj: if ($p_entry["\x73\x74\141\164\x75\163"] == "\141\x62\x6f\162\x74\145\x64") { $p_entry["\163\x74\x61\x74\165\163"] = "\x73\153\x69\x70\x70\x65\144"; } elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) { goto fNElg; QRzmL: $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header); goto SFXX4; RDUc7: $v_local_header["\143\157\x6e\x74\145\x6e\164"] = $p_string; goto i8l1_; SFXX4: $p_string = $v_local_header["\x63\157\x6e\x74\145\156\x74"]; goto TRiaV; DphqE: if ($v_result == 2) { $v_result = PCLZIP_ERR_USER_ABORTED; } goto xJVNe; i8l1_: $p_string = ''; goto QRzmL; akgxR: $this->privConvertHeader2FileInfo($p_entry, $v_local_header); goto RDUc7; TRiaV: unset($v_local_header["\143\157\x6e\x74\x65\x6e\164"]); goto DphqE; fNElg: $v_local_header = array(); goto akgxR; xJVNe: } goto BFbBM; ipnTh: } public function privReadFileHeader(&$p_header) { goto bh3Pt; yL3TL: if (strlen($v_binary_data) != 26) { goto KQIYn; RVdhQ: return PclZip::errorCode(); goto pL0bB; KQIYn: $p_header["\x66\151\154\x65\156\x61\x6d\145"] = ''; goto CztDD; CztDD: $p_header["\x73\164\x61\x74\165\x73"] = "\151\156\166\x61\154\151\x64\x5f\150\145\141\x64\x65\162"; goto H7oll; H7oll: PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\111\x6e\166\x61\x6c\x69\144\x20\x62\154\157\x63\x6b\40\x73\151\x7a\x65\40\x3a\x20" . strlen($v_binary_data)); goto RVdhQ; pL0bB: } goto KM1cS; o1myE: $p_header["\163\x69\x7a\x65"] = $v_data["\x73\x69\x7a\145"]; goto xVSv_; B6s0O: $p_header["\x66\151\x6c\x65\156\141\x6d\x65"] = fread($this->zip_fd, $v_data["\146\151\x6c\145\x6e\x61\x6d\145\x5f\x6c\145\x6e"]); goto EnVCQ; TC2q4: $p_header["\146\151\x6c\145\156\x61\x6d\x65\x5f\154\145\x6e"] = $v_data["\x66\151\154\x65\x6e\141\x6d\145\137\154\x65\156"]; goto PEzFM; PEzFM: $p_header["\155\x64\141\x74\145"] = $v_data["\x6d\144\141\164\x65"]; goto PPL62; NvqCU: $p_header["\163\164\141\x74\x75\x73"] = "\157\x6b"; goto qLSL0; I7Oy6: $p_header["\143\x6f\155\x70\162\145\163\x73\x69\157\156"] = $v_data["\x63\x6f\155\160\162\145\x73\x73\151\157\x6e"]; goto o1myE; EnVCQ: if ($v_data["\145\x78\x74\162\141\137\154\x65\x6e"] != 0) { $p_header["\x65\x78\164\x72\141"] = fread($this->zip_fd, $v_data["\x65\x78\164\162\x61\137\154\145\156"]); } else { $p_header["\145\x78\164\x72\141"] = ''; } goto RyrGv; KM1cS: $v_data = unpack("\166\x76\x65\162\163\151\157\x6e\57\166\x66\x6c\x61\x67\x2f\x76\143\x6f\155\160\x72\145\x73\163\151\x6f\x6e\x2f\x76\155\164\x69\155\x65\57\x76\155\x64\141\x74\145\57\x56\x63\162\143\x2f\x56\143\157\155\160\162\x65\x73\x73\x65\144\137\x73\x69\x7a\x65\x2f\x56\163\151\172\145\x2f\x76\146\x69\154\145\156\141\x6d\x65\x5f\x6c\145\156\x2f\x76\x65\x78\164\162\x61\137\154\x65\x6e", $v_binary_data); goto B6s0O; n5Km8: $v_binary_data = @fread($this->zip_fd, 4); goto mf0E4; Z3bVQ: $p_header["\163\164\157\x72\x65\144\137\x66\151\x6c\145\x6e\141\x6d\x65"] = $p_header["\x66\151\x6c\x65\x6e\x61\155\145"]; goto NvqCU; xVSv_: $p_header["\143\157\155\160\162\x65\x73\163\x65\x64\x5f\163\x69\172\145"] = $v_data["\143\157\155\160\x72\145\x73\163\145\x64\x5f\x73\x69\x7a\145"]; goto lyQHy; mf0E4: $v_data = unpack("\x56\x69\x64", $v_binary_data); goto A90NK; RyrGv: $p_header["\166\x65\162\x73\x69\x6f\156\137\x65\170\x74\x72\141\x63\x74\x65\144"] = $v_data["\166\145\162\163\151\157\x6e"]; goto I7Oy6; Jl9Zc: $p_header["\x66\x6c\141\x67"] = $v_data["\x66\x6c\x61\x67"]; goto TC2q4; kcxkk: $v_binary_data = fread($this->zip_fd, 26); goto yL3TL; PPL62: $p_header["\155\164\x69\x6d\145"] = $v_data["\x6d\x74\x69\155\x65"]; goto Sw6_b; bh3Pt: $v_result = 1; goto n5Km8; lyQHy: $p_header["\143\x72\143"] = $v_data["\143\x72\143"]; goto Jl9Zc; qLSL0: return $v_result; goto rK4Ql; A90NK: if ($v_data["\x69\x64"] != 0x4034b50) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\111\x6e\x76\141\x6c\x69\x64\x20\x61\162\x63\x68\x69\166\145\40\163\164\162\x75\143\164\x75\162\x65"); return PclZip::errorCode(); } goto kcxkk; Sw6_b: if ($p_header["\155\144\x61\164\145"] && $p_header["\x6d\x74\x69\x6d\x65"]) { goto JPmDq; Sx9aY: $v_day = $p_header["\x6d\x64\x61\164\145"] & 0x1f; goto JzbOx; JzbOx: $p_header["\155\x74\x69\x6d\145"] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year); goto uvABE; JPmDq: $v_hour = ($p_header["\155\164\x69\155\145"] & 0xf800) >> 11; goto ffRVl; mbPq0: $v_month = ($p_header["\x6d\x64\x61\x74\145"] & 0x1e0) >> 5; goto Sx9aY; ffRVl: $v_minute = ($p_header["\x6d\164\151\155\145"] & 0x7e0) >> 5; goto atCBN; wyEP2: $v_year = (($p_header["\x6d\x64\x61\x74\145"] & 0xfe00) >> 9) + 1980; goto mbPq0; atCBN: $v_seconde = ($p_header["\155\164\151\x6d\145"] & 0x1f) * 2; goto wyEP2; uvABE: } else { $p_header["\x6d\164\x69\155\x65"] = time(); } goto Z3bVQ; rK4Ql: } public function privReadCentralFileHeader(&$p_header) { goto gtV4N; Is0zv: $v_binary_data = fread($this->zip_fd, 42); goto UxStT; C53Vk: if ($p_header["\x65\x78\x74\162\x61\137\154\145\x6e"] != 0) { $p_header["\x65\x78\164\162\x61"] = fread($this->zip_fd, $p_header["\x65\x78\x74\x72\141\x5f\x6c\x65\x6e"]); } else { $p_header["\145\x78\x74\x72\x61"] = ''; } goto D5fH7; x0b8e: $p_header["\163\164\141\164\x75\163"] = "\x6f\153"; goto GxEJk; gSbY7: $v_binary_data = @fread($this->zip_fd, 4); goto tdS3W; QyHbo: $p_header = unpack("\x76\x76\145\x72\163\151\157\156\x2f\x76\166\x65\162\163\151\157\x6e\x5f\145\x78\x74\x72\x61\x63\164\145\144\57\x76\x66\154\141\147\57\166\143\x6f\155\x70\x72\x65\x73\x73\x69\157\x6e\x2f\166\155\x74\151\x6d\145\57\x76\155\x64\x61\164\x65\x2f\x56\x63\162\143\57\x56\x63\x6f\x6d\x70\162\x65\x73\x73\145\144\x5f\163\x69\172\145\x2f\126\163\x69\172\145\57\166\x66\x69\x6c\x65\156\x61\x6d\145\137\x6c\x65\156\x2f\x76\145\x78\164\162\141\137\154\145\x6e\x2f\166\x63\157\x6d\x6d\x65\156\164\x5f\x6c\x65\156\57\166\x64\151\163\x6b\x2f\x76\151\156\164\x65\162\x6e\141\x6c\57\x56\x65\170\164\x65\x72\156\141\154\57\126\157\x66\x66\x73\x65\x74", $v_binary_data); goto ZXG20; GxEJk: if (substr($p_header["\x66\x69\154\x65\156\141\155\x65"], -1) == "\57") { $p_header["\145\170\164\145\162\x6e\141\x6c"] = 0x10; } goto MfDP3; MfDP3: return $v_result; goto jrmEl; UxStT: if (strlen($v_binary_data) != 42) { goto pYjOk; kTEp9: $p_header["\x73\164\x61\x74\165\163"] = "\151\x6e\166\x61\154\x69\x64\x5f\x68\145\141\x64\x65\x72"; goto QfOvo; APg4z: return PclZip::errorCode(); goto fyOu_; pYjOk: $p_header["\x66\151\x6c\x65\156\x61\x6d\145"] = ''; goto kTEp9; QfOvo: PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\x49\156\x76\x61\154\x69\144\40\142\154\x6f\x63\153\40\163\x69\x7a\145\40\x3a\40" . strlen($v_binary_data)); goto APg4z; fyOu_: } goto QyHbo; D5fH7: if ($p_header["\143\157\155\x6d\145\x6e\164\137\x6c\x65\x6e"] != 0) { $p_header["\143\x6f\x6d\155\x65\156\164"] = fread($this->zip_fd, $p_header["\143\x6f\x6d\155\145\156\164\x5f\154\x65\x6e"]); } else { $p_header["\143\x6f\x6d\155\x65\156\x74"] = ''; } goto xyop6; tdS3W: $v_data = unpack("\x56\151\144", $v_binary_data); goto ilfM9; xyop6: if (1) { goto kEssg; kEssg: $v_hour = ($p_header["\x6d\164\151\155\x65"] & 0xf800) >> 11; goto Y36TG; jTO3h: $v_month = ($p_header["\x6d\144\141\x74\x65"] & 0x1e0) >> 5; goto dmKrk; f7z3X: $p_header["\x6d\164\x69\155\145"] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year); goto KFUGY; XLo0f: $v_seconde = ($p_header["\x6d\164\151\155\145"] & 0x1f) * 2; goto GSZLF; dmKrk: $v_day = $p_header["\155\x64\141\164\x65"] & 0x1f; goto f7z3X; Y36TG: $v_minute = ($p_header["\x6d\164\x69\x6d\145"] & 0x7e0) >> 5; goto XLo0f; GSZLF: $v_year = (($p_header["\155\x64\x61\x74\x65"] & 0xfe00) >> 9) + 1980; goto jTO3h; KFUGY: } else { $p_header["\x6d\164\151\x6d\145"] = time(); } goto Uw10d; ZXG20: if ($p_header["\146\x69\x6c\145\156\x61\x6d\145\x5f\x6c\x65\x6e"] != 0) { $p_header["\146\x69\154\x65\156\141\x6d\145"] = fread($this->zip_fd, $p_header["\146\x69\x6c\145\156\x61\155\145\137\154\145\156"]); } else { $p_header["\146\151\x6c\145\x6e\x61\155\x65"] = ''; } goto C53Vk; Uw10d: $p_header["\163\164\x6f\x72\x65\x64\137\146\151\x6c\x65\x6e\141\155\145"] = $p_header["\x66\x69\x6c\145\x6e\x61\155\x65"]; goto x0b8e; gtV4N: $v_result = 1; goto gSbY7; ilfM9: if ($v_data["\151\144"] != 0x2014b50) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\x49\156\x76\x61\154\151\x64\x20\x61\162\143\x68\151\166\x65\40\163\164\162\x75\x63\x74\165\162\x65"); return PclZip::errorCode(); } goto Is0zv; jrmEl: } public function privCheckFileHeaders(&$p_local_header, &$p_central_header) { goto obUdV; Ff7do: if ($p_local_header["\x63\x6f\155\x70\162\145\163\x73\x69\157\x6e"] != $p_central_header["\143\157\x6d\x70\162\x65\163\163\x69\157\x6e"]) { } goto YSg6F; bdpJr: if ($p_local_header["\x76\x65\162\x73\151\x6f\x6e\x5f\145\170\164\x72\x61\143\164\x65\144"] != $p_central_header["\166\x65\162\163\151\157\x6e\137\145\170\x74\x72\x61\143\x74\x65\x64"]) { } goto SjpiW; YSg6F: if ($p_local_header["\x6d\x74\151\155\x65"] != $p_central_header["\155\164\x69\x6d\145"]) { } goto Gg45X; SjpiW: if ($p_local_header["\x66\x6c\141\147"] != $p_central_header["\x66\154\x61\x67"]) { } goto Ff7do; obUdV: $v_result = 1; goto pZTP4; If4dw: return $v_result; goto lUiRz; Gg45X: if ($p_local_header["\x66\x69\x6c\x65\x6e\141\x6d\x65\137\154\x65\156"] != $p_central_header["\x66\151\154\x65\156\141\155\x65\137\x6c\145\x6e"]) { } goto HaX8e; HaX8e: if (($p_local_header["\x66\x6c\x61\x67"] & 8) == 8) { goto Vjgi1; ANcs8: $p_local_header["\x63\157\x6d\160\162\x65\x73\163\145\x64\x5f\163\151\172\x65"] = $p_central_header["\x63\157\x6d\x70\162\x65\x73\x73\x65\x64\x5f\x73\x69\172\145"]; goto DKX0Q; Vjgi1: $p_local_header["\x73\x69\172\145"] = $p_central_header["\163\x69\x7a\145"]; goto ANcs8; DKX0Q: $p_local_header["\143\162\x63"] = $p_central_header["\143\x72\x63"]; goto dJofj; dJofj: } goto If4dw; pZTP4: if ($p_local_header["\x66\151\x6c\145\156\x61\x6d\x65"] != $p_central_header["\x66\151\154\145\156\x61\x6d\x65"]) { } goto bdpJr; lUiRz: } public function privReadEndCentralDir(&$p_central_dir) { goto BlWKx; tKdjh: if (@ftell($this->zip_fd) != $v_size) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\x55\156\x61\x62\154\145\40\x74\x6f\x20\147\157\40\x74\157\40\x74\150\145\x20\x65\x6e\x64\x20\157\146\x20\x74\150\145\x20\x61\162\x63\150\151\x76\x65\40\x27" . $this->zipname . "\47"); return PclZip::errorCode(); } goto FElMF; M88Py: $p_central_dir["\145\x6e\164\x72\151\145\x73"] = $v_data["\145\x6e\164\x72\151\x65\163"]; goto Ucu5j; Ucu5j: $p_central_dir["\x64\x69\x73\x6b\137\x65\x6e\164\162\x69\x65\x73"] = $v_data["\x64\151\x73\153\137\x65\x6e\x74\162\x69\x65\x73"]; goto dlLiZ; dlLiZ: $p_central_dir["\157\x66\x66\x73\145\164"] = $v_data["\x6f\146\146\x73\x65\164"]; goto j_iSL; hMtMa: $p_central_dir["\x64\151\x73\x6b"] = $v_data["\144\151\163\153"]; goto OzmrL; UN1MM: $v_binary_data = fread($this->zip_fd, 18); goto ekxpM; LpM8e: return $v_result; goto fWFfQ; dg0oB: if ($v_pos + $v_data["\143\157\x6d\155\145\x6e\x74\137\x73\x69\x7a\x65"] + 18 != $v_size) { if (0) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\124\150\145\x20\x63\145\x6e\x74\162\141\154\x20\144\151\x72\40\151\163\x20\156\x6f\164\x20\x61\x74\40\164\x68\x65\40\x65\156\x64\40\x6f\x66\x20\164\x68\x65\40\x61\x72\143\150\x69\x76\x65\x2e\40\x53\157\155\145\40\x74\x72\x61\151\x6c\151\x6e\147\40\142\x79\x74\x65\x73\x20\x65\170\x69\163\164\x73\40\x61\146\164\x65\x72\x20\x74\x68\x65\40\141\x72\x63\150\151\x76\145\x2e"); return PclZip::errorCode(); } } goto pDVt8; DmlaP: $v_size = filesize($this->zipname); goto biKjT; pDVt8: if ($v_data["\143\x6f\155\x6d\x65\x6e\x74\x5f\x73\151\x7a\145"] != 0) { $p_central_dir["\x63\157\155\155\x65\156\x74"] = fread($this->zip_fd, $v_data["\x63\x6f\x6d\155\x65\x6e\164\137\x73\x69\x7a\x65"]); } else { $p_central_dir["\x63\157\155\155\x65\156\x74"] = ''; } goto M88Py; biKjT: @fseek($this->zip_fd, $v_size); goto tKdjh; BlWKx: $v_result = 1; goto DmlaP; j_iSL: $p_central_dir["\163\151\172\x65"] = $v_data["\163\151\x7a\145"]; goto hMtMa; FElMF: $v_found = 0; goto IYLpb; y6VFe: $v_data = unpack("\x76\x64\x69\x73\153\x2f\x76\144\151\163\x6b\x5f\x73\x74\x61\162\x74\x2f\x76\144\x69\163\153\x5f\145\156\x74\x72\151\x65\x73\57\x76\x65\156\x74\x72\x69\x65\163\57\126\163\x69\x7a\x65\57\x56\157\146\x66\x73\x65\x74\x2f\x76\143\157\155\x6d\x65\x6e\x74\137\x73\x69\172\145", $v_binary_data); goto dg0oB; Zafgg: if (!$v_found) { goto EctOy; mZ7sp: if (@ftell($this->zip_fd) != $v_size - $v_maximum_size) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\125\x6e\x61\x62\x6c\x65\40\x74\157\x20\x73\145\x65\x6b\x20\142\141\143\153\x20\164\157\40\164\150\145\x20\x6d\x69\x64\x64\154\145\40\x6f\x66\x20\164\x68\x65\40\x61\x72\143\x68\x69\x76\x65\x20\x27" . $this->zipname . "\x27"); return PclZip::errorCode(); } goto ZY3gP; CUTif: if ($v_pos == $v_size) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\125\156\x61\x62\154\145\40\x74\157\40\146\151\156\144\40\105\156\144\x20\157\x66\40\x43\145\x6e\x74\x72\141\154\40\104\151\162\40\x52\145\143\157\x72\x64\x20\x73\151\147\156\x61\x74\165\x72\x65"); return PclZip::errorCode(); } goto InvTx; zORMw: if ($v_maximum_size > $v_size) { $v_maximum_size = $v_size; } goto OvErH; OvErH: @fseek($this->zip_fd, $v_size - $v_maximum_size); goto mZ7sp; ZY3gP: $v_pos = ftell($this->zip_fd); goto QT3z8; QT3z8: $v_bytes = 0x0; goto jpwqA; jpwqA: while ($v_pos < $v_size) { $v_byte = @fread($this->zip_fd, 1); $v_bytes = ($v_bytes & 0xffffff) << 8 | Ord($v_byte); if ($v_bytes == 0x504b0506) { $v_pos++; break; } $v_pos++; } goto CUTif; EctOy: $v_maximum_size = 65557; goto zORMw; InvTx: } goto UN1MM; ekxpM: if (strlen($v_binary_data) != 18) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\111\x6e\166\141\x6c\151\x64\x20\x45\156\x64\40\157\146\x20\103\145\156\164\x72\141\x6c\x20\x44\151\162\x20\122\x65\143\157\x72\144\x20\x73\x69\x7a\145\x20\72\40" . strlen($v_binary_data)); return PclZip::errorCode(); } goto y6VFe; OzmrL: $p_central_dir["\x64\x69\163\153\137\x73\164\141\162\164"] = $v_data["\x64\x69\163\153\x5f\163\x74\x61\162\164"]; goto LpM8e; IYLpb: if ($v_size > 26) { goto xZSuG; kVcb1: if ($v_data["\151\144"] == 0x6054b50) { $v_found = 1; } goto gpqYk; xZSuG: @fseek($this->zip_fd, $v_size - 22); goto b8fe3; b8fe3: if (($v_pos = @ftell($this->zip_fd)) != $v_size - 22) { PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "\125\x6e\x61\142\x6c\x65\x20\164\x6f\40\x73\145\145\x6b\x20\x62\x61\143\x6b\x20\164\157\x20\164\x68\145\40\x6d\x69\x64\x64\x6c\x65\x20\157\146\40\x74\150\x65\40\141\x72\143\150\151\166\145\x20\x27" . $this->zipname . "\47"); return PclZip::errorCode(); } goto NCaDB; gpqYk: $v_pos = ftell($this->zip_fd); goto EYbkL; NCaDB: $v_binary_data = @fread($this->zip_fd, 4); goto G0yf0; G0yf0: $v_data = @unpack("\126\151\x64", $v_binary_data); goto kVcb1; EYbkL: } goto Zafgg; fWFfQ: } public function privDeleteByRule(&$p_result_list, &$p_options) { goto EUDs5; p7nLm: @rewind($this->zip_fd); goto LDRM0; JKl1Q: if ($v_nb_extracted > 0) { goto afwfx; cXfU0: unset($v_temp_zip); goto r2UlM; S7E7I: for ($i = 0; $i < sizeof($v_header_list); $i++) { @rewind($this->zip_fd); if (@fseek($this->zip_fd, $v_header_list[$i]["\157\146\146\163\145\x74"])) { goto iR3ES; ygo3L: return PclZip::errorCode(); goto l9NGj; mBM7u: @unlink($v_zip_temp_name); goto wqnw5; iR3ES: $this->privCloseFd(); goto gEpaW; wqnw5: PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, "\x49\156\x76\141\x6c\x69\144\x20\x61\162\x63\x68\151\166\x65\x20\163\x69\x7a\145"); goto ygo3L; gEpaW: $v_temp_zip->privCloseFd(); goto mBM7u; l9NGj: } $v_local_header = array(); if (($v_result = $this->privReadFileHeader($v_local_header)) != 1) { goto TSx46; oOGOU: $v_temp_zip->privCloseFd(); goto bHPJP; bHPJP: @unlink($v_zip_temp_name); goto CzLDl; TSx46: $this->privCloseFd(); goto oOGOU; CzLDl: return $v_result; goto TY6jJ; TY6jJ: } if ($this->privCheckFileHeaders($v_local_header, $v_header_list[$i]) != 1) { } unset($v_local_header); if (($v_result = $v_temp_zip->privWriteFileHeader($v_header_list[$i])) != 1) { goto kEQ4Q; aNTrH: return $v_result; goto Ag4sp; ANObm: $v_temp_zip->privCloseFd(); goto EMrbO; kEQ4Q: $this->privCloseFd(); goto ANObm; EMrbO: @unlink($v_zip_temp_name); goto aNTrH; Ag4sp: } if (($v_result = PclZipUtilCopyBlock($this->zip_fd, $v_temp_zip->zip_fd, $v_header_list[$i]["\143\157\x6d\x70\162\145\x73\163\x65\x64\137\x73\x69\x7a\145"])) != 1) { goto KDtwW; ph973: return $v_result; goto FVUoF; M27TE: @unlink($v_zip_temp_name); goto ph973; hoHNK: $v_temp_zip->privCloseFd(); goto M27TE; KDtwW: $this->privCloseFd(); goto hoHNK; FVUoF: } } goto Se1tZ; vdn1_: $v_comment = ''; goto Vzq69; hl5XO: @unlink($this->zipname); goto To9ZG; MnPJ9: $v_size = @ftell($v_temp_zip->zip_fd) - $v_offset; goto gaxqs; gaxqs: if (($v_result = $v_temp_zip->privWriteCentralHeader(sizeof($v_header_list), $v_size, $v_offset, $v_comment)) != 1) { goto Mk15W; KSH64: $v_temp_zip->privCloseFd(); goto Ufjoc; Mk15W: unset($v_header_list); goto KSH64; Ufjoc: $this->privCloseFd(); goto J9qG_; Y1aMq: return $v_result; goto KpxIz; J9qG_: @unlink($v_zip_temp_name); goto Y1aMq; KpxIz: } goto rLZjc; Vzq69: if (isset($p_options[PCLZIP_OPT_COMMENT])) { $v_comment = $p_options[PCLZIP_OPT_COMMENT]; } goto MnPJ9; X01SE: for ($i = 0; $i < sizeof($v_header_list); $i++) { if (($v_result = $v_temp_zip->privWriteCentralFileHeader($v_header_list[$i])) != 1) { goto eu5pC; QAIHg: $this->privCloseFd(); goto C_cPx; C_cPx: @unlink($v_zip_temp_name); goto QYpwg; eu5pC: $v_temp_zip->privCloseFd(); goto QAIHg; QYpwg: return $v_result; goto SJ1Bk; SJ1Bk: } $v_temp_zip->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]); } goto vdn1_; dYJsq: $this->privCloseFd(); goto hl5XO; G2qO4: $v_temp_zip = new PclZip($v_zip_temp_name); goto ZVaUo; afwfx: $v_zip_temp_name = PCLZIP_TEMPORARY_DIR . uniqid("\x70\x63\x6c\172\x69\160\55") . "\56\x74\x6d\x70"; goto G2qO4; rLZjc: $v_temp_zip->privCloseFd(); goto dYJsq; Se1tZ: $v_offset = @ftell($v_temp_zip->zip_fd); goto X01SE; ZVaUo: if (($v_result = $v_temp_zip->privOpenFd("\x77\142")) != 1) { $this->privCloseFd(); return $v_result; } goto S7E7I; To9ZG: PclZipUtilRename($v_zip_temp_name, $this->zipname); goto cXfU0; r2UlM: } elseif ($v_central_dir["\x65\x6e\164\162\x69\145\163"] != 0) { goto WO4Sn; KLkk5: $this->privCloseFd(); goto sDcek; WO4Sn: $this->privCloseFd(); goto CIWdn; J__Rk: if (($v_result = $this->privWriteCentralHeader(0, 0, 0, '')) != 1) { return $v_result; } goto KLkk5; CIWdn: if (($v_result = $this->privOpenFd("\x77\x62")) != 1) { return $v_result; } goto J__Rk; sDcek: } goto xYAIf; xYAIf: return $v_result; goto Aup03; uiA_u: if (($v_result = $this->privOpenFd("\x72\x62")) != 1) { return $v_result; } goto BABNN; maqmZ: @rewind($this->zip_fd); goto i5yLJ; q8T9e: $j_start = 0; goto vuPKU; QpkYR: if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1) { $this->privCloseFd(); return $v_result; } goto p7nLm; LDRM0: $v_pos_entry = $v_central_dir["\x6f\146\146\x73\145\164"]; goto maqmZ; i5yLJ: if (@fseek($this->zip_fd, $v_pos_entry)) { goto HmRhO; HmRhO: $this->privCloseFd(); goto bjdOv; dxXSN: return PclZip::errorCode(); goto vuNmY; bjdOv: PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, "\111\x6e\x76\141\154\151\x64\x20\x61\x72\x63\x68\151\166\x65\x20\163\151\172\145"); goto dxXSN; vuNmY: } goto QFdbM; yYGI9: $v_list_detail = array(); goto uiA_u; vuPKU: for ($i = 0, $v_nb_extracted = 0; $i < $v_central_dir["\145\x6e\x74\x72\x69\145\163"]; $i++) { $v_header_list[$v_nb_extracted] = array(); if (($v_result = $this->privReadCentralFileHeader($v_header_list[$v_nb_extracted])) != 1) { $this->privCloseFd(); return $v_result; } $v_header_list[$v_nb_extracted]["\x69\x6e\x64\x65\170"] = $i; $v_found = false; if (isset($p_options[PCLZIP_OPT_BY_NAME]) && $p_options[PCLZIP_OPT_BY_NAME] != 0) { for ($j = 0; $j < sizeof($p_options[PCLZIP_OPT_BY_NAME]) && !$v_found; $j++) { if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "\57") { if (strlen($v_header_list[$v_nb_extracted]["\x73\x74\157\x72\x65\144\137\146\x69\x6c\145\156\x61\155\145"]) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]) && substr($v_header_list[$v_nb_extracted]["\163\x74\157\162\x65\x64\137\146\151\154\x65\x6e\x61\155\x65"], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j]) { $v_found = true; } elseif (($v_header_list[$v_nb_extracted]["\145\x78\164\x65\162\x6e\141\154"] & 0x10) == 0x10 && $v_header_list[$v_nb_extracted]["\x73\x74\x6f\x72\x65\x64\x5f\x66\x69\x6c\145\156\x61\155\145"] . "\x2f" == $p_options[PCLZIP_OPT_BY_NAME][$j]) { $v_found = true; } } elseif ($v_header_list[$v_nb_extracted]["\x73\x74\x6f\x72\x65\x64\x5f\x66\151\x6c\145\x6e\141\155\x65"] == $p_options[PCLZIP_OPT_BY_NAME][$j]) { $v_found = true; } } } elseif (isset($p_options[PCLZIP_OPT_BY_PREG]) && $p_options[PCLZIP_OPT_BY_PREG] != '') { if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header_list[$v_nb_extracted]["\163\164\157\x72\145\x64\x5f\146\151\x6c\145\156\x61\155\x65"])) { $v_found = true; } } elseif (isset($p_options[PCLZIP_OPT_BY_INDEX]) && $p_options[PCLZIP_OPT_BY_INDEX] != 0) { for ($j = $j_start; $j < sizeof($p_options[PCLZIP_OPT_BY_INDEX]) && !$v_found; $j++) { if ($i >= $p_options[PCLZIP_OPT_BY_INDEX][$j]["\x73\164\141\162\164"] && $i <= $p_options[PCLZIP_OPT_BY_INDEX][$j]["\x65\x6e\144"]) { $v_found = true; } if ($i >= $p_options[PCLZIP_OPT_BY_INDEX][$j]["\x65\x6e\144"]) { $j_start = $j + 1; } if ($p_options[PCLZIP_OPT_BY_INDEX][$j]["\163\164\141\x72\x74"] > $i) { break; } } } else { $v_found = true; } if ($v_found) { unset($v_header_list[$v_nb_extracted]); } else { $v_nb_extracted++; } } goto JKl1Q; EUDs5: $v_result = 1; goto yYGI9; QFdbM: $v_header_list = array(); goto q8T9e; BABNN: $v_central_dir = array(); goto QpkYR; Aup03: } public function privDirCheck($p_dir, $p_is_dir = false) { goto HR03S; HR03S: $v_result = 1; goto cYM4y; P1DRA: if (is_dir($p_dir) || $p_dir == '') { return 1; } goto DbkMb; kjfkq: if (!@mkdir($p_dir, 0777)) { PclZip::privErrorLog(PCLZIP_ERR_DIR_CREATE_FAIL, "\125\x6e\141\x62\154\145\40\x74\157\x20\143\162\145\141\x74\145\x20\x64\151\x72\x65\143\x74\157\162\171\40\x27{$p_dir}\x27"); return PclZip::errorCode(); } goto mwNNO; mwNNO: return $v_result; goto Gr2Ec; Eu5QA: if ($p_parent_dir != $p_dir) { if ($p_parent_dir != '') { if (($v_result = $this->privDirCheck($p_parent_dir)) != 1) { return $v_result; } } } goto kjfkq; DbkMb: $p_parent_dir = dirname($p_dir); goto Eu5QA; cYM4y: if ($p_is_dir && substr($p_dir, -1) == "\x2f") { $p_dir = substr($p_dir, 0, strlen($p_dir) - 1); } goto P1DRA; Gr2Ec: } public function privMerge(&$p_archive_to_add) { goto Flf3R; eZ6VW: $v_size = $v_central_dir_to_add["\163\x69\x7a\145"]; goto H03K2; PW4j3: $v_zip_temp_fd = $v_swap; goto HS0nQ; B7fpN: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($this->zip_fd, $v_read_size); @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto eZ6VW; ILgkf: if (!is_file($this->zipname)) { $v_result = $this->privDuplicate($p_archive_to_add->zipname); return $v_result; } goto K0ZSf; cYey9: $v_zip_temp_name = PCLZIP_TEMPORARY_DIR . uniqid("\x70\x63\x6c\x7a\x69\x70\x2d") . "\56\x74\x6d\160"; goto hpbgD; HS0nQ: if (($v_result = $this->privWriteCentralHeader($v_central_dir["\145\x6e\x74\162\x69\145\163"] + $v_central_dir_to_add["\x65\x6e\x74\162\151\x65\163"], $v_size, $v_offset, $v_comment)) != 1) { goto HqK8P; fMWG0: return $v_result; goto dY9bK; PU2OT: @fclose($v_zip_temp_fd); goto glneB; glneB: $this->zip_fd = null; goto zzBsf; HoR5p: $p_archive_to_add->privCloseFd(); goto PU2OT; zzBsf: unset($v_header_list); goto fMWG0; HqK8P: $this->privCloseFd(); goto HoR5p; dY9bK: } goto zzcc_; NI3L5: $v_comment = $v_central_dir["\143\x6f\155\155\x65\x6e\x74"] . "\x20" . $v_central_dir_to_add["\x63\157\x6d\x6d\x65\x6e\x74"]; goto V3AoX; WYDi7: if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1) { $this->privCloseFd(); return $v_result; } goto plQtf; gPh_E: @fclose($v_zip_temp_fd); goto HiC_1; XAiS4: $v_size = $v_central_dir_to_add["\x6f\x66\146\x73\x65\x74"]; goto r3uKd; W1lC7: $p_archive_to_add->privCloseFd(); goto gPh_E; V3AoX: $v_size = @ftell($v_zip_temp_fd) - $v_offset; goto sSXRk; sliBL: PclZipUtilRename($v_zip_temp_name, $this->zipname); goto zOqJk; fhYrQ: $v_central_dir = array(); goto WYDi7; q1uAq: $this->zip_fd = $v_zip_temp_fd; goto Bpxo9; GVFL6: $v_size = $v_central_dir["\157\146\146\163\x65\164"]; goto EtS_H; p_Bq3: $this->privCloseFd(); goto W1lC7; K0ZSf: if (($v_result = $this->privOpenFd("\x72\142")) != 1) { return $v_result; } goto fhYrQ; sSXRk: $v_swap = $this->zip_fd; goto XZ2LU; Flf3R: $v_result = 1; goto jOGdE; HiC_1: @unlink($this->zipname); goto sliBL; r3uKd: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = fread($p_archive_to_add->zip_fd, $v_read_size); @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto gvXM8; yHbq4: if (($v_result = $p_archive_to_add->privOpenFd("\x72\142")) != 1) { $this->privCloseFd(); return $v_result; } goto FcQwp; FcQwp: $v_central_dir_to_add = array(); goto rWjnV; XZ2LU: $this->zip_fd = $v_zip_temp_fd; goto PW4j3; Bpxo9: $v_zip_temp_fd = $v_swap; goto p_Bq3; rWjnV: if (($v_result = $p_archive_to_add->privReadEndCentralDir($v_central_dir_to_add)) != 1) { goto ysnrZ; A36mQ: return $v_result; goto Ww34G; ysnrZ: $this->privCloseFd(); goto so337; so337: $p_archive_to_add->privCloseFd(); goto A36mQ; Ww34G: } goto X_e1L; gvXM8: $v_offset = @ftell($v_zip_temp_fd); goto gtaBL; jOGdE: if (!is_file($p_archive_to_add->zipname)) { $v_result = 1; return $v_result; } goto ILgkf; X_e1L: @rewind($p_archive_to_add->zip_fd); goto cYey9; plQtf: @rewind($this->zip_fd); goto yHbq4; H03K2: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = @fread($p_archive_to_add->zip_fd, $v_read_size); @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto NI3L5; gtaBL: $v_size = $v_central_dir["\163\151\x7a\145"]; goto B7fpN; hpbgD: if (($v_zip_temp_fd = @fopen($v_zip_temp_name, "\167\142")) == 0) { goto VPQzF; ydScY: return PclZip::errorCode(); goto yw6P6; VPQzF: $this->privCloseFd(); goto xdGPk; gxIx1: PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\x55\156\x61\142\x6c\145\40\x74\x6f\x20\157\160\145\x6e\40\x74\145\155\x70\x6f\162\x61\x72\x79\40\x66\151\154\145\x20\47" . $v_zip_temp_name . "\47\40\x69\x6e\40\142\151\x6e\x61\x72\171\x20\167\x72\x69\x74\x65\40\x6d\x6f\144\145"); goto ydScY; xdGPk: $p_archive_to_add->privCloseFd(); goto gxIx1; yw6P6: } goto GVFL6; zzcc_: $v_swap = $this->zip_fd; goto q1uAq; zOqJk: return $v_result; goto F_cQp; EtS_H: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = fread($this->zip_fd, $v_read_size); @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto XAiS4; F_cQp: } public function privDuplicate($p_archive_filename) { goto uJhjU; rH9_P: while ($v_size != 0) { $v_read_size = $v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE; $v_buffer = fread($v_zip_temp_fd, $v_read_size); @fwrite($this->zip_fd, $v_buffer, $v_read_size); $v_size -= $v_read_size; } goto yU0tJ; voaKf: $v_size = filesize($p_archive_filename); goto rH9_P; fbNKD: return $v_result; goto JqHn2; uJhjU: $v_result = 1; goto RWAUW; gzGDw: if (($v_result = $this->privOpenFd("\x77\x62")) != 1) { return $v_result; } goto sAimL; sAimL: if (($v_zip_temp_fd = @fopen($p_archive_filename, "\x72\142")) == 0) { goto GSEtY; YorbR: return PclZip::errorCode(); goto ErBSL; PfvJX: PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "\125\x6e\x61\x62\x6c\x65\40\x74\157\40\157\160\145\156\40\141\x72\x63\150\x69\x76\145\40\x66\151\154\x65\40\x27" . $p_archive_filename . "\x27\40\x69\156\40\142\x69\x6e\141\162\171\x20\167\x72\151\164\x65\x20\x6d\157\x64\x65"); goto YorbR; GSEtY: $this->privCloseFd(); goto PfvJX; ErBSL: } goto voaKf; RWAUW: if (!is_file($p_archive_filename)) { $v_result = 1; return $v_result; } goto gzGDw; uQS2x: @fclose($v_zip_temp_fd); goto fbNKD; yU0tJ: $this->privCloseFd(); goto uQS2x; JqHn2: } public function privErrorLog($p_error_code = 0, $p_error_string = '') { if (PCLZIP_ERROR_EXTERNAL == 1) { PclError($p_error_code, $p_error_string); } else { $this->error_code = $p_error_code; $this->error_string = $p_error_string; } } public function privErrorReset() { if (PCLZIP_ERROR_EXTERNAL == 1) { PclErrorReset(); } else { $this->error_code = 0; $this->error_string = ''; } } public function privDisableMagicQuotes() { goto vODGp; wp823: if ($this->magic_quotes_status == 1) { @set_magic_quotes_runtime(0); } goto u0W1o; gV1Z2: $this->magic_quotes_status = @get_magic_quotes_runtime(); goto wp823; C4uW8: if (!function_exists("\147\x65\x74\x5f\155\x61\147\x69\143\137\x71\165\157\164\x65\163\137\162\x75\156\x74\151\x6d\145") || !function_exists("\x73\145\x74\x5f\155\x61\x67\x69\x63\137\x71\x75\157\x74\x65\x73\x5f\162\x75\156\164\x69\155\x65")) { return $v_result; } goto uvlkp; u0W1o: return $v_result; goto GTinx; uvlkp: if ($this->magic_quotes_status != -1) { return $v_result; } goto gV1Z2; vODGp: $v_result = 1; goto C4uW8; GTinx: } public function privSwapBackMagicQuotes() { goto pmSiD; EnV3D: if (!function_exists("\x67\145\164\137\155\141\147\x69\143\x5f\161\x75\x6f\x74\x65\163\137\162\165\156\x74\151\x6d\145") || !function_exists("\163\x65\x74\x5f\x6d\141\147\151\143\137\x71\165\x6f\164\x65\163\137\x72\165\156\164\151\x6d\x65")) { return $v_result; } goto dnrhV; F3l2i: return $v_result; goto AD_pM; pmSiD: $v_result = 1; goto EnV3D; dnrhV: if ($this->magic_quotes_status != -1) { return $v_result; } goto jUMeK; jUMeK: if ($this->magic_quotes_status == 1) { @set_magic_quotes_runtime($this->magic_quotes_status); } goto F3l2i; AD_pM: } } goto L7Tqm; z32_s: if (!defined("\x50\103\114\132\111\x50\x5f\x53\105\x50\x41\122\x41\124\x4f\x52")) { define("\x50\103\x4c\132\x49\x50\137\123\105\120\x41\122\101\124\117\122", "\x2c"); } goto qb3SE; BtZ_P: define("\x50\103\x4c\x5a\111\x50\137\x4f\x50\124\137\101\x44\104\137\103\117\115\115\x45\x4e\x54", 77013); goto hu4Xr; nYB3F: define("\x50\103\114\x5a\111\x50\x5f\x45\x52\x52\137\x49\x4e\x56\x41\x4c\x49\x44\x5f\101\x54\x54\122\x49\102\125\124\x45\137\126\101\114\x55\105", -20); goto G3J1B; pdclD: define("\x50\103\114\x5a\111\120\137\105\122\122\137\x57\x52\x49\124\x45\x5f\117\x50\105\116\137\106\101\x49\x4c", -1); goto HmHMs; a85Gx: define("\x50\x43\x4c\x5a\111\120\x5f\x45\122\122\137\x49\x4e\126\101\x4c\x49\104\137\120\101\x52\x41\115\105\x54\105\x52", -3); goto HQl9C; xdudH: define("\120\x43\114\132\x49\120\x5f\105\x52\122\137\x49\x4e\x56\101\x4c\111\104\x5f\x5a\x49\120", -6); goto T9nEQ; f_yK5: function PclZipUtilPathInclusion($p_dir, $p_path) { goto vR7UC; xwmHJ: $v_list_dir = explode("\57", $p_dir); goto KTW_j; d82dj: if ($p_path == "\x2e" || strlen($p_path) >= 2 && substr($p_path, 0, 2) == "\56\57") { $p_path = PclZipUtilTranslateWinPath(getcwd(), false) . "\x2f" . substr($p_path, 1); } goto xwmHJ; wJbbO: if ($p_dir == "\x2e" || strlen($p_dir) >= 2 && substr($p_dir, 0, 2) == "\x2e\57") { $p_dir = PclZipUtilTranslateWinPath(getcwd(), false) . "\57" . substr($p_dir, 1); } goto d82dj; awV9O: $i = 0; goto efVFF; vR7UC: $v_result = 1; goto wJbbO; efVFF: $j = 0; goto Pnj2_; mK39W: $v_list_path = explode("\57", $p_path); goto RHg0Z; Pnj2_: while ($i < $v_list_dir_size && $j < $v_list_path_size && $v_result) { if ($v_list_dir[$i] == '') { $i++; continue; } if ($v_list_path[$j] == '') { $j++; continue; } if ($v_list_dir[$i] != $v_list_path[$j] && $v_list_dir[$i] != '' && $v_list_path[$j] != '') { $v_result = 0; } $i++; $j++; } goto VbiIe; KTW_j: $v_list_dir_size = sizeof($v_list_dir); goto mK39W; rZWfY: return $v_result; goto ZTwh0; VbiIe: if ($v_result) { goto MMXIe; CMD2I: if ($i >= $v_list_dir_size && $j >= $v_list_path_size) { $v_result = 2; } elseif ($i < $v_list_dir_size) { $v_result = 0; } goto B_iwx; MMXIe: while ($j < $v_list_path_size && $v_list_path[$j] == '') { $j++; } goto sz7GJ; sz7GJ: while ($i < $v_list_dir_size && $v_list_dir[$i] == '') { $i++; } goto CMD2I; B_iwx: } goto rZWfY; RHg0Z: $v_list_path_size = sizeof($v_list_path); goto awV9O; ZTwh0: } goto zvxRk; sikiB: define("\120\103\x4c\132\x49\x50\x5f\x4f\120\124\x5f\x42\131\x5f\111\116\104\105\130", 77009); goto Is84O; Uq0U4: define("\x50\103\x4c\132\x49\x50\x5f\x45\x52\122\137\102\101\104\x5f\105\x58\x54\105\x4e\123\x49\x4f\x4e", -9); goto OTKrE; f1ZUv: $g_pclzip_version = "\62\x2e\70\56\x32"; goto b2B9j; xUZe1: define("\x50\x43\114\132\x49\120\x5f\103\x42\137\120\122\105\x5f\x41\104\x44", 78003); goto e04f6; LtJls: define("\120\103\114\x5a\111\120\137\117\120\124\137\122\x45\120\x4c\x41\x43\x45\137\116\105\x57\x45\122", 77016); goto PHZM9; R6rjf: define("\x50\103\114\132\x49\120\137\x4f\120\x54\137\124\105\x4d\x50\x5f\x46\111\x4c\105\137\124\110\122\x45\123\110\x4f\114\x44", 77020); goto GJHUR; j6eIo: define("\120\x43\x4c\x5a\x49\120\137\x4f\120\124\x5f\102\131\x5f\116\x41\x4d\105", 77008); goto sikiB; HmHMs: define("\120\x43\x4c\x5a\111\120\137\105\122\122\137\x52\x45\x41\104\x5f\117\120\x45\116\x5f\106\x41\111\x4c", -2); goto a85Gx; L3k8A: define("\120\x43\x4c\x5a\x49\x50\137\x41\x54\124\137\106\x49\x4c\105\x5f\x4d\124\x49\x4d\x45", 79004); goto eUm5S; HyUZl: define("\x50\103\114\x5a\x49\x50\137\x45\122\122\x5f\101\114\x52\x45\101\x44\x59\137\101\x5f\x44\x49\122\105\103\124\117\122\131", -17); goto UGJvg; gG6Fj: define("\120\103\114\132\111\x50\x5f\x41\124\x54\137\x46\x49\x4c\x45\x5f\103\x4f\115\115\105\116\x54", 79006); goto YG10E; cowGs: define("\x50\x43\114\132\111\x50\137\x45\x52\x52\x5f\115\111\123\123\111\x4e\x47\x5f\117\x50\x54\111\117\116\137\126\x41\114\x55\x45", -15); goto otvID; cdGXx: define("\120\103\x4c\x5a\111\x50\x5f\x45\122\122\137\x46\x49\x4c\x45\116\101\115\x45\x5f\124\117\117\137\114\117\116\107", -5); goto xdudH; Pwz8L: define("\x50\103\x4c\132\111\120\x5f\117\x50\124\137\105\130\124\x52\101\x43\x54\x5f\111\x4e\x5f\117\x55\x54\120\125\124", 77015); goto LtJls; qb3SE: if (!defined("\120\103\114\x5a\111\x50\137\105\122\x52\x4f\122\137\105\x58\x54\105\122\116\101\x4c")) { define("\120\103\114\132\x49\120\x5f\x45\122\x52\117\122\137\105\x58\124\x45\x52\x4e\101\114", 0); } goto MZVDn; b2B9j: define("\x50\x43\x4c\x5a\x49\x50\137\x45\122\122\137\x55\123\x45\x52\x5f\101\x42\117\x52\124\105\x44", 2); goto EpSOe; MZVDn: if (!defined("\x50\103\114\132\x49\x50\137\124\x45\x4d\120\x4f\122\101\122\131\x5f\x44\x49\122")) { define("\120\103\114\132\x49\120\x5f\x54\105\115\120\117\122\x41\x52\x59\x5f\x44\111\x52", ''); } goto m1Pvm; e04f6: define("\x50\103\114\132\111\x50\x5f\103\x42\x5f\120\x4f\x53\x54\x5f\x41\104\x44", 78004); goto JLuj2; E_871: define("\x50\x43\x4c\x5a\x49\x50\x5f\x4f\x50\124\137\123\x45\124\137\103\x48\x4d\117\104", 77005); goto mX_nF; wEaew: define("\x50\103\x4c\x5a\x49\120\137\117\120\x54\137\116\x4f\x5f\x43\117\x4d\x50\122\x45\123\x53\111\x4f\116", 77007); goto j6eIo; BcLoB: define("\x50\x43\x4c\x5a\111\120\137\117\120\x54\137\124\105\x4d\120\x5f\106\x49\x4c\105\x5f\117\x4e", 77021); goto ohkWz; ohkWz: define("\120\x43\x4c\132\111\x50\137\x4f\120\124\x5f\101\104\104\137\x54\105\x4d\x50\137\x46\111\x4c\x45\x5f\x4f\116", 77021); goto WNqWf; ieD2e: define("\120\103\114\132\111\x50\137\x4f\120\x54\137\x43\117\115\115\105\116\x54", 77012); goto BtZ_P; PHZM9: define("\x50\103\x4c\x5a\111\x50\x5f\117\x50\124\137\123\x54\117\x50\137\117\x4e\x5f\x45\x52\122\117\x52", 77017); goto K15aP; gBTF9: define("\120\x43\x4c\x5a\x49\x50\137\105\122\122\x5f\x44\105\x4c\105\x54\105\137\106\x49\114\x45\x5f\x46\101\x49\x4c", -11); goto q_MiD; N4n0v: define("\120\103\114\x5a\111\120\x5f\x43\102\137\120\117\x53\x54\x5f\105\130\x54\x52\x41\x43\x54", 78002); goto xUZe1; K15aP: define("\x50\x43\x4c\x5a\x49\120\137\x4f\x50\x54\137\105\130\x54\122\x41\x43\x54\137\x44\x49\122\x5f\122\x45\x53\x54\122\x49\x43\124\111\117\x4e", 77019); goto R6rjf; L7Tqm: function PclZipUtilPathReduction($p_dir) { goto O8aH3; O8aH3: $v_result = ''; goto qh6vn; qh6vn: if ($p_dir != '') { goto GrcNk; EZ6Dw: if ($v_skip > 0) { while ($v_skip > 0) { $v_result = "\56\x2e\57" . $v_result; $v_skip--; } } goto HlbnH; RMZUD: for ($i = sizeof($v_list) - 1; $i >= 0; $i--) { if ($v_list[$i] == "\56") { } elseif ($v_list[$i] == "\x2e\x2e") { $v_skip++; } elseif ($v_list[$i] == '') { if ($i == 0) { $v_result = "\57" . $v_result; if ($v_skip > 0) { $v_result = $p_dir; $v_skip = 0; } } elseif ($i == sizeof($v_list) - 1) { $v_result = $v_list[$i]; } else { } } else { if ($v_skip > 0) { $v_skip--; } else { $v_result = $v_list[$i] . ($i != sizeof($v_list) - 1 ? "\57" . $v_result : ''); } } } goto EZ6Dw; rE1Fz: $v_skip = 0; goto RMZUD; GrcNk: $v_list = explode("\x2f", $p_dir); goto rE1Fz; HlbnH: } goto N7TCW; N7TCW: return $v_result; goto ZlCU8; ZlCU8: } goto f_yK5; mlNdA: define("\120\x43\x4c\x5a\x49\120\x5f\x45\122\x52\x5f\x55\116\123\x55\x50\x50\x4f\122\124\x45\104\x5f\105\x4e\x43\x52\131\120\124\111\x4f\x4e", -19); goto nYB3F; Is84O: define("\120\x43\x4c\132\111\120\x5f\x4f\120\124\x5f\x42\x59\x5f\105\x52\x45\x47", 77010); goto m3cHZ; GGPCc: function PclZipUtilTranslateWinPath($p_path, $p_remove_disk_letter = true) { if (stristr(php_uname(), "\x77\151\x6e\x64\x6f\167\x73")) { if ($p_remove_disk_letter && ($v_position = strpos($p_path, "\72")) != false) { $p_path = substr($p_path, $v_position + 1); } if (strpos($p_path, "\134") > 0 || substr($p_path, 0, 1) == "\134") { $p_path = strtr($p_path, "\134", "\57"); } } return $p_path; }
