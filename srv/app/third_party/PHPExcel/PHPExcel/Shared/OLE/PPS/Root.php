<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:03              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Shared_OLE_PPS_Root extends PHPExcel_Shared_OLE_PPS { protected $tempDirectory = null; public function __construct($time_1st, $time_2nd, $raChild) { $this->_tempDir = PHPExcel_Shared_File::sys_get_temp_dir(); parent::__construct(null, PHPExcel_Shared_OLE::Asc2Ucs("\122\157\157\x74\x20\105\x6e\x74\x72\171"), PHPExcel_Shared_OLE::OLE_PPS_TYPE_ROOT, null, null, null, $time_1st, $time_2nd, null, $raChild); } public function save($filename) { goto uuDOu; o5L6q: $this->_saveBbd($iSBDcnt, $iBBcnt, $iPPScnt); goto qHsbd; ZX14D: $this->_saveBigData($iSBDcnt, $aList); goto Ig0uR; yLoMy: $this->_SMALL_BLOCK_SIZE = pow(2, isset($this->_SMALL_BLOCK_SIZE) ? self::adjust2($this->_SMALL_BLOCK_SIZE) : 6); goto hB1kv; yFOdv: return true; goto JWxzq; Ig0uR: $this->_savePps($aList); goto o5L6q; uuDOu: $this->_BIG_BLOCK_SIZE = pow(2, isset($this->_BIG_BLOCK_SIZE) ? self::adjust2($this->_BIG_BLOCK_SIZE) : 9); goto yLoMy; K7QKu: $aList = array(); goto bCEF_; aFG0b: $this->_data = $this->_makeSmallData($aList); goto ZX14D; qHsbd: if (!is_resource($filename)) { fclose($this->_FILEH_); } goto yFOdv; fGXjT: $this->_saveHeader($iSBDcnt, $iBBcnt, $iPPScnt); goto aFG0b; hBTCr: list($iSBDcnt, $iBBcnt, $iPPScnt) = $this->_calcSize($aList); goto fGXjT; lvIt2: if ($this->_FILEH_ == false) { throw new PHPExcel_Writer_Exception("\103\141\156\x27\164\x20\157\160\145\156\x20{$filename}\x2e\40\x49\x74\40\x6d\x61\171\x20\142\145\40\x69\156\x20\165\x73\145\x20\x6f\162\x20\x70\x72\157\x74\145\143\x74\x65\144\x2e"); } goto K7QKu; bCEF_: PHPExcel_Shared_OLE_PPS::_savePpsSetPnt($aList, array($this)); goto hBTCr; hB1kv: if (is_resource($filename)) { $this->_FILEH_ = $filename; } elseif ($filename == "\55" || $filename == '') { goto iooi5; N6JxZ: $this->_FILEH_ = fopen($this->_tmp_filename, "\167\53\x62"); goto hucQX; hucQX: if ($this->_FILEH_ == false) { throw new PHPExcel_Writer_Exception("\x43\141\156\47\x74\x20\x63\162\x65\x61\x74\x65\40\164\x65\x6d\160\157\162\x61\x72\x79\x20\x66\x69\x6c\x65\x2e"); } goto fMcyy; mFkno: $this->_tmp_filename = tempnam($this->tempDirectory, "\x4f\114\105\137\x50\120\x53\137\x52\157\157\164"); goto N6JxZ; iooi5: if ($this->tempDirectory === null) { $this->tempDirectory = PHPExcel_Shared_File::sys_get_temp_dir(); } goto mFkno; fMcyy: } else { $this->_FILEH_ = fopen($filename, "\x77\x62"); } goto lvIt2; JWxzq: } public function _calcSize(&$raList) { goto IXiRp; XCl86: return array($iSBDcnt, $iBBcnt, $iPPScnt); goto pa7Vt; UFDXz: $iSBcnt = 0; goto JxTim; IXiRp: list($iSBDcnt, $iBBcnt, $iPPScnt) = array(0, 0, 0); goto XvSAN; mFF61: $iSBDcnt = floor($iSBcnt / $iSlCnt) + ($iSBcnt % $iSlCnt ? 1 : 0); goto H5JzB; mEZNx: for ($i = 0; $i < $iCount; ++$i) { if ($raList[$i]->Type == PHPExcel_Shared_OLE::OLE_PPS_TYPE_FILE) { $raList[$i]->Size = $raList[$i]->_DataLen(); if ($raList[$i]->Size < PHPExcel_Shared_OLE::OLE_DATA_SIZE_SMALL) { $iSBcnt += floor($raList[$i]->Size / $this->_SMALL_BLOCK_SIZE) + ($raList[$i]->Size % $this->_SMALL_BLOCK_SIZE ? 1 : 0); } else { $iBBcnt += floor($raList[$i]->Size / $this->_BIG_BLOCK_SIZE) + ($raList[$i]->Size % $this->_BIG_BLOCK_SIZE ? 1 : 0); } } } goto Wm6k6; U7mmF: $iCnt = count($raList); goto rQow1; Wm6k6: $iSmallLen = $iSBcnt * $this->_SMALL_BLOCK_SIZE; goto JyuCY; XvSAN: $iSmallLen = 0; goto UFDXz; rQow1: $iBdCnt = $this->_BIG_BLOCK_SIZE / PHPExcel_Shared_OLE::OLE_PPS_SIZE; goto g9Gzo; JxTim: $iCount = count($raList); goto mEZNx; JyuCY: $iSlCnt = floor($this->_BIG_BLOCK_SIZE / PHPExcel_Shared_OLE::OLE_LONG_INT_SIZE); goto mFF61; H5JzB: $iBBcnt += floor($iSmallLen / $this->_BIG_BLOCK_SIZE) + ($iSmallLen % $this->_BIG_BLOCK_SIZE ? 1 : 0); goto U7mmF; g9Gzo: $iPPScnt = floor($iCnt / $iBdCnt) + ($iCnt % $iBdCnt ? 1 : 0); goto XCl86; pa7Vt: } private static function adjust2($i2) { $iWk = log($i2) / log(2); return $iWk > floor($iWk) ? floor($iWk) + 1 : $iWk; } public function _saveHeader($iSBDcnt, $iBBcnt, $iPPScnt) { goto n8vI7; J3FB4: $iBlCnt = $this->_BIG_BLOCK_SIZE / PHPExcel_Shared_OLE::OLE_LONG_INT_SIZE; goto idCB5; zORrz: if ($i < $i1stBdL) { $jB = $i1stBdL - $i; for ($j = 0; $j < $jB; ++$j) { fwrite($FILE, pack("\126", -1)); } } goto PuhKA; RUKyz: $iBdCntW = floor($iAllW / $iBlCnt) + ($iAllW % $iBlCnt ? 1 : 0); goto rAQpc; snHxx: $iAllW = $iAll; goto RUKyz; n8vI7: $FILE = $this->_FILEH_; goto J3FB4; HOm7N: if ($iBdCnt < $i1stBdL) { fwrite($FILE, pack("\126", -2) . pack("\126", 0)); } else { fwrite($FILE, pack("\x56", $iAll + $iBdCnt) . pack("\x56", $iBdExL)); } goto BswCB; LIIZ5: $iBdExL = 0; goto a93Et; BswCB: for ($i = 0; $i < $i1stBdL && $i < $iBdCnt; ++$i) { fwrite($FILE, pack("\x56", $iAll + $i)); } goto zORrz; lp39A: fwrite($FILE, "\xd0\xcf\21\xe0\xa1\261\32\xe1" . "\0\x0\0\x0" . "\0\x0\0\x0" . "\x0\0\0\x0" . "\0\x0\0\x0" . pack("\166", 0x3b) . pack("\166", 0x3) . pack("\166", -2) . pack("\x76", 9) . pack("\x76", 6) . pack("\x76", 0) . "\0\x0\x0\x0" . "\x0\0\0\x0" . pack("\x56", $iBdCnt) . pack("\x56", $iBBcnt + $iSBDcnt) . pack("\126", 0) . pack("\x56", 0x1000) . pack("\x56", $iSBDcnt ? 0 : -2) . pack("\126", $iSBDcnt)); goto HOm7N; rAQpc: $iBdCnt = floor(($iAll + $iBdCntW) / $iBlCnt) + (($iAllW + $iBdCntW) % $iBlCnt ? 1 : 0); goto DihQf; DihQf: if ($iBdCnt > $i1stBdL) { while (1) { ++$iBdExL; ++$iAllW; $iBdCntW = floor($iAllW / $iBlCnt) + ($iAllW % $iBlCnt ? 1 : 0); $iBdCnt = floor(($iAllW + $iBdCntW) / $iBlCnt) + (($iAllW + $iBdCntW) % $iBlCnt ? 1 : 0); if ($iBdCnt <= $iBdExL * $iBlCnt + $i1stBdL) { break; } } } goto lp39A; a93Et: $iAll = $iBBcnt + $iPPScnt + $iSBDcnt; goto snHxx; idCB5: $i1stBdL = ($this->_BIG_BLOCK_SIZE - 0x4c) / PHPExcel_Shared_OLE::OLE_LONG_INT_SIZE; goto LIIZ5; PuhKA: } public function _saveBigData($iStBlk, &$raList) { goto W5TLr; A6Kde: $iCount = count($raList); goto A5y7U; W5TLr: $FILE = $this->_FILEH_; goto A6Kde; A5y7U: for ($i = 0; $i < $iCount; ++$i) { if ($raList[$i]->Type != PHPExcel_Shared_OLE::OLE_PPS_TYPE_DIR) { $raList[$i]->Size = $raList[$i]->_DataLen(); if ($raList[$i]->Size >= PHPExcel_Shared_OLE::OLE_DATA_SIZE_SMALL || $raList[$i]->Type == PHPExcel_Shared_OLE::OLE_PPS_TYPE_ROOT && isset($raList[$i]->_data)) { goto UP1BF; J6Twn: $raList[$i]->_StartBlock = $iStBlk; goto LqvFx; uHp0H: if ($raList[$i]->Size % $this->_BIG_BLOCK_SIZE) { fwrite($FILE, str_repeat("\0", $this->_BIG_BLOCK_SIZE - $raList[$i]->Size % $this->_BIG_BLOCK_SIZE)); } goto J6Twn; LqvFx: $iStBlk += floor($raList[$i]->Size / $this->_BIG_BLOCK_SIZE) + ($raList[$i]->Size % $this->_BIG_BLOCK_SIZE ? 1 : 0); goto WMvwO; UP1BF: fwrite($FILE, $raList[$i]->_data); goto uHp0H; WMvwO: } } } goto AD20C; AD20C: } public function _makeSmallData(&$raList) { goto Rac2j; Xq7T2: $iSmBlk = 0; goto lASMh; NTAim: for ($i = 0; $i < $iCount; ++$i) { if ($raList[$i]->Type == PHPExcel_Shared_OLE::OLE_PPS_TYPE_FILE) { if ($raList[$i]->Size <= 0) { continue; } if ($raList[$i]->Size < PHPExcel_Shared_OLE::OLE_DATA_SIZE_SMALL) { goto Y70bc; nyYZv: fwrite($FILE, pack("\x56", -2)); goto cE95T; vg9kC: for ($j = 0; $j < $jB; ++$j) { fwrite($FILE, pack("\x56", $j + $iSmBlk + 1)); } goto nyYZv; Y70bc: $iSmbCnt = floor($raList[$i]->Size / $this->_SMALL_BLOCK_SIZE) + ($raList[$i]->Size % $this->_SMALL_BLOCK_SIZE ? 1 : 0); goto PzuGF; cE95T: $sRes .= $raList[$i]->_data; goto tmgQv; tmgQv: if ($raList[$i]->Size % $this->_SMALL_BLOCK_SIZE) { $sRes .= str_repeat("\x0", $this->_SMALL_BLOCK_SIZE - $raList[$i]->Size % $this->_SMALL_BLOCK_SIZE); } goto j5VbB; PzuGF: $jB = $iSmbCnt - 1; goto vg9kC; bScB0: $iSmBlk += $iSmbCnt; goto QUdUk; j5VbB: $raList[$i]->_StartBlock = $iSmBlk; goto bScB0; QUdUk: } } } goto nCek_; lASMh: $iCount = count($raList); goto NTAim; N5Eng: $FILE = $this->_FILEH_; goto Xq7T2; Rac2j: $sRes = ''; goto N5Eng; BpOOO: if ($iSmBlk % $iSbCnt) { $iB = $iSbCnt - $iSmBlk % $iSbCnt; for ($i = 0; $i < $iB; ++$i) { fwrite($FILE, pack("\126", -1)); } } goto ulH49; ulH49: return $sRes; goto pm1rl; nCek_: $iSbCnt = floor($this->_BIG_BLOCK_SIZE / PHPExcel_Shared_OLE::OLE_LONG_INT_SIZE); goto BpOOO; pm1rl: } public function _savePps(&$raList) { goto s_zcc; s_zcc: $iC = count($raList); goto GLU3X; xXP4g: $iBCnt = $this->_BIG_BLOCK_SIZE / PHPExcel_Shared_OLE::OLE_PPS_SIZE; goto lYhWY; lYhWY: if ($iCnt % $iBCnt) { fwrite($this->_FILEH_, str_repeat("\0", ($iBCnt - $iCnt % $iBCnt) * PHPExcel_Shared_OLE::OLE_PPS_SIZE)); } goto hQ_eQ; iQVt3: $iCnt = count($raList); goto xXP4g; GLU3X: for ($i = 0; $i < $iC; ++$i) { fwrite($this->_FILEH_, $raList[$i]->_getPpsWk()); } goto iQVt3; hQ_eQ: } public function _saveBbd($iSbdSize, $iBsize, $iPpsCnt) { goto oiGcM; wi_DO: for ($i = 0; $i < $iPpsCnt - 1; ++$i) { fwrite($FILE, pack("\126", $i + $iSbdSize + $iBsize + 1)); } goto bgVYq; bAZ1i: $iBdCntW = floor($iAllW / $iBbCnt) + ($iAllW % $iBbCnt ? 1 : 0); goto cIPbe; SD_9d: fwrite($FILE, pack("\x56", -2)); goto wi_DO; bgVYq: fwrite($FILE, pack("\126", -2)); goto zzPaP; tddMg: $i1stBdL = ($this->_BIG_BLOCK_SIZE - 0x4c) / PHPExcel_Shared_OLE::OLE_LONG_INT_SIZE; goto TGBsK; LR004: if ($iBdCnt > $i1stBdL) { while (1) { ++$iBdExL; ++$iAllW; $iBdCntW = floor($iAllW / $iBbCnt) + ($iAllW % $iBbCnt ? 1 : 0); $iBdCnt = floor(($iAllW + $iBdCntW) / $iBbCnt) + (($iAllW + $iBdCntW) % $iBbCnt ? 1 : 0); if ($iBdCnt <= $iBdExL * $iBbCnt + $i1stBdL) { break; } } } goto kRxCI; HCAoa: $iAllW = $iAll; goto bAZ1i; cupKI: for ($i = 0; $i < $iBdExL; ++$i) { fwrite($FILE, pack("\x56", 0xfffffffc)); } goto HkipS; WyB7k: for ($i = 0; $i < $iBsize - 1; ++$i) { fwrite($FILE, pack("\126", $i + $iSbdSize + 1)); } goto SD_9d; zzPaP: for ($i = 0; $i < $iBdCnt; ++$i) { fwrite($FILE, pack("\126", 0xfffffffd)); } goto cupKI; cIPbe: $iBdCnt = floor(($iAll + $iBdCntW) / $iBbCnt) + (($iAllW + $iBdCntW) % $iBbCnt ? 1 : 0); goto LR004; aMz0f: if ($iBdCnt > $i1stBdL) { goto euegN; euegN: $iN = 0; goto RC9LI; OWTMK: for ($i = $i1stBdL; $i < $iBdCnt; $i++, ++$iN) { if ($iN >= $iBbCnt - 1) { goto APQhg; APQhg: $iN = 0; goto HO89_; acHV9: fwrite($FILE, pack("\x56", $iAll + $iBdCnt + $iNb)); goto w6KSU; HO89_: ++$iNb; goto acHV9; w6KSU: } fwrite($FILE, pack("\126", $iBsize + $iSbdSize + $iPpsCnt + $i)); } goto oD6eH; sy7sh: fwrite($FILE, pack("\126", -2)); goto rRD_W; RC9LI: $iNb = 0; goto OWTMK; oD6eH: if (($iBdCnt - $i1stBdL) % ($iBbCnt - 1)) { $iB = $iBbCnt - 1 - ($iBdCnt - $i1stBdL) % ($iBbCnt - 1); for ($i = 0; $i < $iB; ++$i) { fwrite($FILE, pack("\x56", -1)); } } goto sy7sh; rRD_W: } goto KpEgy; TGBsK: $iBdExL = 0; goto LgmbZ; kRxCI: if ($iSbdSize > 0) { for ($i = 0; $i < $iSbdSize - 1; ++$i) { fwrite($FILE, pack("\126", $i + 1)); } fwrite($FILE, pack("\126", -2)); } goto WyB7k; YIyjx: $iBbCnt = $this->_BIG_BLOCK_SIZE / PHPExcel_Shared_OLE::OLE_LONG_INT_SIZE; goto tddMg; oiGcM: $FILE = $this->_FILEH_; goto YIyjx; HkipS: if (($iAllW + $iBdCnt) % $iBbCnt) { $iBlock = $iBbCnt - ($iAllW + $iBdCnt) % $iBbCnt; for ($i = 0; $i < $iBlock; ++$i) { fwrite($FILE, pack("\x56", -1)); } } goto aMz0f; LgmbZ: $iAll = $iBsize + $iPpsCnt + $iSbdSize; goto HCAoa; KpEgy: } }
