<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:05              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 if (!defined("\120\x48\120\105\x58\103\105\114\137\x52\x4f\117\x54")) { define("\120\110\x50\105\130\x43\105\114\137\122\117\x4f\124", dirname(__FILE__) . "\x2f\56\56\57\x2e\x2e\x2f"); require PHPEXCEL_ROOT . "\x50\110\120\105\x78\143\145\154\57\x41\x75\x74\157\x6c\x6f\141\144\145\x72\x2e\x70\x68\x70"; } class PHPExcel_Reader_Excel2007 extends PHPExcel_Reader_Abstract implements PHPExcel_Reader_IReader { private $referenceHelper = null; private static $theme = null; public function __construct() { $this->readFilter = new PHPExcel_Reader_DefaultReadFilter(); $this->referenceHelper = PHPExcel_ReferenceHelper::getInstance(); } public function canRead($pFilename) { goto Ry7jv; grl9J: if ($zip->open($pFilename) === true) { goto BB0le; BB0le: $rels = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\x5f\162\145\x6c\163\57\x2e\x72\145\154\x73")), "\123\x69\155\x70\154\145\x58\x4d\114\x45\x6c\145\155\145\x6e\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto Nj43T; Nj43T: if ($rels !== false) { foreach ($rels->Relationship as $rel) { switch ($rel["\x54\x79\x70\145"]) { case "\x68\x74\164\160\x3a\57\x2f\163\143\150\x65\155\141\x73\x2e\157\x70\145\156\x78\155\154\x66\157\x72\x6d\141\164\x73\56\157\162\147\x2f\x6f\x66\146\151\x63\x65\x44\x6f\143\x75\155\145\156\x74\x2f\62\x30\60\66\57\162\x65\x6c\141\x74\x69\x6f\156\x73\150\151\x70\x73\57\157\146\146\x69\143\x65\x44\157\143\165\155\145\156\x74": if (basename($rel["\x54\x61\x72\x67\145\164"]) == "\x77\x6f\162\x6b\142\157\157\x6b\x2e\x78\155\154") { $xl = true; } break; } } } goto EkAze; EkAze: $zip->close(); goto jGiyk; jGiyk: } goto bA2i8; Ry7jv: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\103\x6f\165\154\144\x20\156\157\x74\40\x6f\160\145\156\x20" . $pFilename . "\x20\146\x6f\162\x20\162\145\141\144\x69\x6e\147\x21\40\106\151\154\145\40\x64\x6f\145\163\40\x6e\x6f\x74\x20\145\x78\151\163\164\56"); } goto oCtfT; Y8KJk: $zip = new $zipClass(); goto grl9J; SBeE2: $xl = false; goto Y8KJk; oCtfT: $zipClass = PHPExcel_Settings::getZipClass(); goto SBeE2; bA2i8: return $xl; goto xiY3w; xiY3w: } public function listWorksheetNames($pFilename) { goto jakUo; ZlHWl: $zip->close(); goto sn9Ku; gsQfZ: $zipClass = PHPExcel_Settings::getZipClass(); goto yQuzc; jakUo: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\x43\x6f\x75\154\144\40\156\157\x74\40\x6f\x70\145\156\40" . $pFilename . "\x20\146\157\x72\40\x72\145\141\x64\151\156\147\x21\x20\x46\x69\x6c\145\40\x64\157\x65\x73\40\156\x6f\164\40\145\170\151\x73\164\x2e"); } goto Yki8m; Yki8m: $worksheetNames = array(); goto gsQfZ; BvHp2: $zip->open($pFilename); goto q6qma; yQuzc: $zip = new $zipClass(); goto BvHp2; q6qma: $rels = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\137\162\145\154\x73\57\56\x72\145\154\163"), "\x53\x69\x6d\160\x6c\145\130\115\x4c\x45\x6c\145\x6d\145\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions())); goto Ra6Jk; Ra6Jk: foreach ($rels->Relationship as $rel) { switch ($rel["\124\x79\160\145"]) { case "\x68\164\164\160\x3a\57\57\163\143\150\145\x6d\141\x73\x2e\157\x70\145\x6e\170\155\154\146\157\x72\155\x61\164\163\56\x6f\162\147\57\157\146\146\151\143\145\x44\x6f\x63\165\155\145\x6e\164\x2f\x32\x30\60\x36\x2f\x72\x65\154\141\164\x69\x6f\156\163\x68\151\x70\x73\x2f\157\x66\146\x69\x63\x65\104\157\143\x75\x6d\145\156\164": $xmlWorkbook = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$rel["\124\x61\162\147\145\x74"]}"), "\x53\151\x6d\160\x6c\x65\130\115\114\x45\154\145\x6d\x65\x6e\164", PHPExcel_Settings::getLibXmlLoaderOptions())); if ($xmlWorkbook->sheets) { foreach ($xmlWorkbook->sheets->sheet as $eleSheet) { $worksheetNames[] = (string) $eleSheet["\x6e\x61\x6d\145"]; } } } } goto ZlHWl; sn9Ku: return $worksheetNames; goto H4RC4; H4RC4: } public function listWorksheetInfo($pFilename) { goto nY7yO; NN16C: $zipClass = PHPExcel_Settings::getZipClass(); goto uFGhY; KrZl3: $worksheetInfo = array(); goto NN16C; uR7ey: $zip->close(); goto JdCvV; xziNO: $rels = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\137\x72\145\154\x73\x2f\x2e\162\145\154\x73")), "\123\151\x6d\x70\x6c\145\x58\115\x4c\105\x6c\145\x6d\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto oSTSb; JdCvV: return $worksheetInfo; goto Ng1_3; uFGhY: $zip = new $zipClass(); goto VkeR6; nY7yO: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\103\157\165\154\x64\40\x6e\157\164\x20\x6f\160\145\156\x20" . $pFilename . "\40\146\157\162\x20\x72\x65\141\x64\x69\x6e\x67\41\40\106\x69\154\145\x20\144\157\145\163\x20\156\157\x74\40\145\170\x69\x73\164\56"); } goto KrZl3; oSTSb: foreach ($rels->Relationship as $rel) { if ($rel["\x54\x79\160\145"] == "\150\164\164\x70\72\x2f\x2f\x73\x63\150\145\x6d\x61\x73\56\157\160\x65\x6e\170\x6d\154\x66\157\162\x6d\141\x74\x73\x2e\x6f\x72\x67\57\x6f\x66\146\151\x63\x65\104\x6f\143\165\x6d\145\x6e\x74\x2f\x32\60\60\66\57\x72\145\x6c\x61\x74\x69\x6f\156\163\150\151\160\x73\57\157\146\x66\151\x63\145\104\x6f\x63\165\155\145\x6e\x74") { goto pKYf4; SOgEF: if ($xmlWorkbook->sheets) { $dir = dirname($rel["\x54\141\x72\147\145\x74"]); foreach ($xmlWorkbook->sheets->sheet as $eleSheet) { goto ji1_e; cV7S5: $xml = new XMLReader(); goto jlzO4; ji1_e: $tmpInfo = array("\167\157\x72\153\x73\150\x65\145\x74\x4e\x61\155\x65" => (string) $eleSheet["\x6e\x61\155\x65"], "\154\141\x73\164\103\157\154\165\x6d\156\x4c\x65\164\x74\145\162" => "\101", "\154\141\x73\164\x43\x6f\154\165\x6d\x6e\x49\x6e\x64\145\x78" => 0, "\164\157\164\141\154\x52\157\167\x73" => 0, "\164\x6f\164\x61\x6c\x43\x6f\154\x75\x6d\x6e\x73" => 0); goto EyjDg; R4iui: $xml->setParserProperty(2, true); goto fWbQ3; dk_y3: $xml->close(); goto jVatt; jlzO4: $res = $xml->xml($this->securityScanFile("\x7a\x69\x70\x3a\57\x2f" . PHPExcel_Shared_File::realpath($pFilename) . "\43" . "{$dir}\57{$fileWorksheet}"), null, PHPExcel_Settings::getLibXmlLoaderOptions()); goto R4iui; jVatt: $tmpInfo["\x6c\x61\163\x74\103\157\154\x75\155\156\x49\x6e\144\145\x78"] = $tmpInfo["\164\x6f\164\x61\154\103\157\154\x75\x6d\156\163"] - 1; goto UiBU9; gstry: while ($xml->read()) { if ($xml->name == "\162\157\167" && $xml->nodeType == XMLReader::ELEMENT) { goto eU5JQ; eU5JQ: $row = $xml->getAttribute("\162"); goto aJgTl; a4IM8: $tmpInfo["\164\157\164\141\154\x43\x6f\154\165\x6d\x6e\163"] = max($tmpInfo["\x74\x6f\164\141\154\x43\157\154\165\155\x6e\163"], $currCells); goto Pu7tv; aJgTl: $tmpInfo["\x74\157\x74\x61\x6c\x52\x6f\x77\163"] = $row; goto a4IM8; Pu7tv: $currCells = 0; goto S_xgD; S_xgD: } elseif ($xml->name == "\143" && $xml->nodeType == XMLReader::ELEMENT) { $currCells++; } } goto MBe8o; MBe8o: $tmpInfo["\164\x6f\x74\x61\154\103\157\154\x75\x6d\x6e\x73"] = max($tmpInfo["\x74\157\x74\x61\x6c\x43\x6f\x6c\x75\x6d\x6e\x73"], $currCells); goto dk_y3; QZW8Q: $worksheetInfo[] = $tmpInfo; goto AXyTb; fWbQ3: $currCells = 0; goto gstry; UiBU9: $tmpInfo["\x6c\141\163\164\103\157\154\x75\155\156\114\145\x74\x74\x65\162"] = PHPExcel_Cell::stringFromColumnIndex($tmpInfo["\154\141\x73\x74\x43\x6f\x6c\165\155\156\111\x6e\144\145\x78"]); goto QZW8Q; EyjDg: $fileWorksheet = $worksheets[(string) self::getArrayItem($eleSheet->attributes("\150\164\164\160\x3a\x2f\57\163\x63\x68\145\155\x61\163\56\x6f\160\145\x6e\x78\155\154\x66\157\x72\155\141\164\163\56\157\162\147\x2f\x6f\x66\146\151\143\x65\104\157\143\165\x6d\x65\x6e\x74\x2f\x32\60\x30\66\x2f\x72\x65\x6c\x61\x74\x69\x6f\x6e\x73\150\x69\x70\x73"), "\x69\x64")]; goto cV7S5; AXyTb: } } goto VFrpg; nAHGI: foreach ($relsWorkbook->Relationship as $ele) { if ($ele["\x54\171\160\145"] == "\x68\164\164\x70\x3a\57\x2f\163\143\x68\x65\155\x61\163\x2e\x6f\x70\x65\x6e\170\155\x6c\146\x6f\162\155\141\x74\x73\56\157\x72\x67\57\x6f\146\146\151\143\145\104\x6f\x63\x75\x6d\x65\x6e\x74\x2f\62\x30\x30\66\x2f\x72\x65\154\141\164\151\157\156\163\x68\151\160\163\x2f\x77\157\162\x6b\x73\150\145\x65\164") { $worksheets[(string) $ele["\111\x64"]] = $ele["\124\x61\x72\147\145\x74"]; } } goto lg5T_; CLY7L: $relsWorkbook->registerXPathNamespace("\x72\x65\154", "\x68\x74\164\x70\72\57\57\163\143\150\x65\x6d\x61\163\56\157\x70\x65\156\170\x6d\154\146\157\x72\x6d\141\x74\163\56\x6f\x72\147\x2f\x70\x61\x63\x6b\x61\147\145\57\62\60\x30\x36\57\162\x65\154\141\164\x69\157\x6e\163\x68\x69\x70\163"); goto sNEWv; lg5T_: $xmlWorkbook = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$rel["\124\141\162\147\145\x74"]}")), "\x53\x69\x6d\160\154\x65\130\x4d\x4c\x45\x6c\145\155\145\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto SOgEF; dZUJy: $relsWorkbook = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$dir}\x2f\x5f\x72\145\x6c\x73\x2f" . basename($rel["\124\x61\162\147\x65\x74"]) . "\56\x72\x65\154\x73")), "\x53\x69\x6d\x70\x6c\145\x58\115\x4c\x45\154\x65\155\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto CLY7L; sNEWv: $worksheets = array(); goto nAHGI; pKYf4: $dir = dirname($rel["\x54\x61\162\x67\145\164"]); goto dZUJy; VFrpg: } } goto uR7ey; VkeR6: $zip->open($pFilename); goto xziNO; Ng1_3: } private static function castToBoolean($c) { goto xRKpP; N12eV: return $value; goto axE2i; xRKpP: $value = isset($c->v) ? (string) $c->v : null; goto nEHGh; nEHGh: if ($value == "\60") { return false; } elseif ($value == "\x31") { return true; } else { return (bool) $c->v; } goto N12eV; axE2i: } private static function castToError($c) { return isset($c->v) ? (string) $c->v : null; } private static function castToString($c) { return isset($c->v) ? (string) $c->v : null; } private function castToFormula($c, $r, &$cellDataType, &$value, &$calculatedValue, &$sharedFormulas, $castBaseType) { goto ZZbeh; Q031R: if (isset($c->f["\x74"]) && strtolower((string) $c->f["\x74"]) == "\x73\x68\x61\162\x65\144") { $instance = (string) $c->f["\x73\x69"]; if (!isset($sharedFormulas[(string) $c->f["\x73\x69"]])) { $sharedFormulas[$instance] = array("\x6d\141\x73\164\x65\162" => $r, "\146\157\x72\x6d\x75\154\x61" => $value); } else { goto JdmbQ; dDekF: $difference = array(0, 0); goto rI9zt; jRYu3: $value = $this->referenceHelper->updateFormulaReferences($sharedFormulas[$instance]["\x66\157\162\x6d\x75\x6c\x61"], "\101\61", $difference[0], $difference[1]); goto u5wby; JdmbQ: $master = PHPExcel_Cell::coordinateFromString($sharedFormulas[$instance]["\x6d\141\x73\164\145\162"]); goto Ek3Wy; Ek3Wy: $current = PHPExcel_Cell::coordinateFromString($r); goto dDekF; rI9zt: $difference[0] = PHPExcel_Cell::columnIndexFromString($current[0]) - PHPExcel_Cell::columnIndexFromString($master[0]); goto fMEpc; fMEpc: $difference[1] = $current[1] - $master[1]; goto jRYu3; u5wby: } } goto WJ6MC; ZZbeh: $cellDataType = "\x66"; goto rIUus; YBTGC: $calculatedValue = self::$castBaseType($c); goto Q031R; rIUus: $value = "\75{$c->f}"; goto YBTGC; WJ6MC: } private function getFromZipArchive($archive, $fileName = '') { goto o7Djw; GW2SK: return $contents; goto ceScx; spd00: $contents = $archive->getFromIndex($archive->locateName($fileName, ZIPARCHIVE::FL_NOCASE)); goto JraXl; JraXl: if ($contents === false) { $contents = $archive->getFromIndex($archive->locateName(substr($fileName, 1), ZIPARCHIVE::FL_NOCASE)); } goto GW2SK; yYFoe: $fileName = PHPExcel_Shared_File::realpath($fileName); goto spd00; o7Djw: if (strpos($fileName, "\57\x2f") !== false) { $fileName = substr($fileName, strpos($fileName, "\57\x2f") + 1); } goto yYFoe; ceScx: } public function load($pFilename) { goto wpvaN; wpvaN: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\x43\157\x75\154\x64\40\x6e\x6f\164\40\x6f\x70\145\156\x20" . $pFilename . "\40\x66\157\162\40\x72\145\x61\x64\151\156\147\x21\40\106\151\154\145\x20\144\x6f\x65\x73\x20\156\x6f\164\x20\x65\170\x69\x73\164\x2e"); } goto NnS8s; nFLFF: foreach ($rels->Relationship as $rel) { switch ($rel["\x54\171\x70\145"]) { case "\150\164\x74\160\x3a\x2f\57\163\x63\x68\x65\155\x61\163\x2e\157\x70\x65\x6e\x78\x6d\154\x66\157\162\155\141\x74\x73\x2e\157\162\x67\57\160\x61\143\x6b\141\x67\x65\x2f\62\x30\x30\x36\x2f\x72\x65\154\x61\164\x69\x6f\x6e\163\150\x69\x70\163\x2f\x6d\145\x74\x61\144\x61\x74\141\x2f\143\157\x72\x65\x2d\160\x72\157\x70\x65\x72\x74\x69\x65\163": goto VHRc6; S9Rlt: break; goto k_Gd2; B5T0f: if (is_object($xmlCore)) { goto lhnx1; ki18O: $xmlCore->registerXPathNamespace("\x63\160", "\150\164\x74\160\x3a\57\57\x73\143\150\145\155\141\x73\56\x6f\x70\145\156\170\x6d\154\146\157\162\x6d\x61\164\x73\56\x6f\x72\147\x2f\x70\141\143\x6b\141\147\145\57\62\60\x30\66\57\155\x65\x74\x61\x64\x61\x74\x61\x2f\x63\157\x72\145\55\x70\162\x6f\160\145\162\x74\x69\145\x73"); goto Nw4hp; xS1BE: $docProps->setModified(strtotime(self::getArrayItem($xmlCore->xpath("\144\143\164\145\x72\155\x73\x3a\155\x6f\x64\x69\x66\x69\145\x64")))); goto OL1Z2; HdrZc: $xmlCore->registerXPathNamespace("\x64\x63\164\145\x72\155\163", "\x68\164\x74\160\x3a\57\57\x70\165\162\x6c\x2e\x6f\162\x67\57\144\143\x2f\x74\145\162\155\x73\x2f"); goto ki18O; Xy9y5: $docProps->setLastModifiedBy((string) self::getArrayItem($xmlCore->xpath("\x63\x70\72\154\141\x73\164\115\157\x64\151\146\x69\x65\x64\x42\171"))); goto SQWZl; FLWVi: $docProps->setDescription((string) self::getArrayItem($xmlCore->xpath("\144\x63\x3a\144\145\x73\143\162\151\x70\x74\151\157\x6e"))); goto OGmBz; OL1Z2: $docProps->setTitle((string) self::getArrayItem($xmlCore->xpath("\x64\x63\x3a\x74\151\x74\x6c\x65"))); goto FLWVi; OGmBz: $docProps->setSubject((string) self::getArrayItem($xmlCore->xpath("\x64\143\72\x73\165\142\152\145\x63\164"))); goto mm4pI; mm4pI: $docProps->setKeywords((string) self::getArrayItem($xmlCore->xpath("\x63\160\72\153\x65\171\167\x6f\x72\x64\163"))); goto WfE53; WfE53: $docProps->setCategory((string) self::getArrayItem($xmlCore->xpath("\x63\160\72\143\x61\x74\x65\x67\157\162\171"))); goto WE3ak; SQWZl: $docProps->setCreated(strtotime(self::getArrayItem($xmlCore->xpath("\x64\143\164\x65\x72\x6d\163\x3a\x63\162\x65\141\164\145\144")))); goto xS1BE; rabau: $docProps->setCreator((string) self::getArrayItem($xmlCore->xpath("\x64\x63\72\143\162\x65\141\x74\157\162"))); goto Xy9y5; Nw4hp: $docProps = $excel->getProperties(); goto rabau; lhnx1: $xmlCore->registerXPathNamespace("\x64\143", "\150\x74\x74\x70\x3a\57\57\160\165\x72\x6c\x2e\x6f\162\147\x2f\x64\x63\57\145\x6c\145\155\145\x6e\x74\x73\57\61\56\x31\57"); goto HdrZc; WE3ak: } goto S9Rlt; VHRc6: $xmlCore = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$rel["\124\x61\162\x67\145\x74"]}")), "\123\x69\155\160\154\145\x58\115\x4c\x45\154\145\155\145\x6e\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto B5T0f; k_Gd2: case "\x68\164\x74\x70\72\x2f\x2f\x73\x63\x68\145\155\141\163\x2e\x6f\160\x65\156\170\155\x6c\146\x6f\x72\155\x61\164\x73\56\x6f\x72\x67\57\157\x66\146\x69\x63\x65\104\157\x63\165\x6d\x65\x6e\x74\57\x32\60\60\x36\x2f\162\x65\x6c\x61\164\x69\x6f\156\x73\150\x69\x70\x73\x2f\145\170\164\x65\x6e\x64\x65\x64\x2d\160\x72\157\x70\145\162\x74\151\x65\163": goto rgkGH; pYwQK: break; goto vzmah; rgkGH: $xmlCore = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$rel["\x54\141\x72\x67\x65\x74"]}")), "\x53\151\x6d\x70\154\145\x58\115\114\x45\154\145\155\145\x6e\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto Qns34; Qns34: if (is_object($xmlCore)) { goto BPAbC; BPAbC: $docProps = $excel->getProperties(); goto iGcyu; b2BLB: if (isset($xmlCore->Manager)) { $docProps->setManager((string) $xmlCore->Manager); } goto kx2vH; iGcyu: if (isset($xmlCore->Company)) { $docProps->setCompany((string) $xmlCore->Company); } goto b2BLB; kx2vH: } goto pYwQK; vzmah: case "\150\164\164\160\72\57\57\163\x63\150\x65\155\141\x73\56\157\160\145\156\x78\155\154\146\157\x72\155\x61\164\x73\56\x6f\162\147\x2f\157\146\146\x69\x63\145\x44\157\x63\x75\x6d\145\156\164\57\x32\x30\x30\x36\x2f\162\145\154\x61\x74\x69\157\156\x73\150\x69\160\163\x2f\143\x75\x73\x74\157\155\55\160\162\157\x70\145\x72\x74\151\x65\x73": goto Li09Z; Li09Z: $xmlCore = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$rel["\x54\141\x72\147\145\x74"]}")), "\123\x69\x6d\160\x6c\145\x58\115\114\x45\154\x65\x6d\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto PiqO9; JXXwA: break; goto xZysW; PiqO9: if (is_object($xmlCore)) { $docProps = $excel->getProperties(); foreach ($xmlCore as $xmlProperty) { $cellDataOfficeAttributes = $xmlProperty->attributes(); if (isset($cellDataOfficeAttributes["\x6e\x61\155\145"])) { goto pZ4r1; Lcb5l: $attributeType = PHPExcel_DocumentProperties::convertPropertyType($attributeType); goto xQ0Cw; xQ0Cw: $docProps->setCustomProperty($propertyName, $attributeValue, $attributeType); goto bpwvk; ds1cN: $attributeType = $cellDataOfficeChildren->getName(); goto CWArD; pZ4r1: $propertyName = (string) $cellDataOfficeAttributes["\156\x61\x6d\145"]; goto anvql; anvql: $cellDataOfficeChildren = $xmlProperty->children("\150\x74\164\x70\72\x2f\57\163\143\x68\145\155\x61\x73\56\157\160\x65\x6e\x78\155\x6c\x66\157\162\x6d\x61\x74\x73\56\157\162\147\57\x6f\146\146\x69\143\x65\x44\157\143\x75\155\145\x6e\x74\x2f\x32\x30\60\x36\57\x64\x6f\143\x50\162\157\x70\163\x56\124\171\160\145\163"); goto ds1cN; Uls3m: $attributeValue = PHPExcel_DocumentProperties::convertProperty($attributeValue, $attributeType); goto Lcb5l; CWArD: $attributeValue = (string) $cellDataOfficeChildren->{$attributeType}; goto Uls3m; bpwvk: } } } goto JXXwA; xZysW: case "\150\164\164\160\72\57\x2f\163\x63\150\x65\x6d\141\x73\56\x6d\151\x63\162\157\x73\157\x66\164\x2e\x63\x6f\155\x2f\x6f\x66\146\x69\x63\145\57\62\60\60\66\x2f\162\x65\154\x61\164\x69\x6f\x6e\x73\150\151\x70\x73\57\165\151\x2f\x65\170\x74\145\156\163\x69\142\151\154\151\x74\171": goto r9S81; ukvNh: if (!is_null($customUI)) { $this->readRibbon($excel, $customUI, $zip); } goto VMzJg; r9S81: $customUI = $rel["\x54\141\x72\x67\x65\164"]; goto ukvNh; VMzJg: break; goto cPY9v; cPY9v: case "\150\164\164\x70\x3a\57\57\163\143\x68\x65\x6d\141\163\x2e\157\160\x65\156\x78\155\154\x66\157\x72\155\141\164\163\x2e\x6f\x72\147\x2f\x6f\x66\x66\151\143\x65\x44\157\143\x75\x6d\x65\156\164\x2f\62\60\60\x36\57\162\x65\154\141\164\151\157\x6e\163\150\x69\160\163\57\157\x66\146\151\x63\x65\x44\x6f\x63\x75\155\x65\x6e\164": goto fdhIp; CB5ks: if ($xmlWorkbook->sheets) { foreach ($xmlWorkbook->sheets->sheet as $eleSheet) { goto VtiF_; PUUw3: if ($xmlSheet && $xmlSheet->rowBreaks && $xmlSheet->rowBreaks->brk && !$this->readDataOnly) { foreach ($xmlSheet->rowBreaks->brk as $brk) { if ($brk["\x6d\141\x6e"]) { $docSheet->setBreak("\101{$brk["\151\x64"]}", PHPExcel_Worksheet::BREAK_ROW); } } } goto qvsMq; z6oKF: if (!$this->readDataOnly) { goto i3Ckh; e0mEt: foreach ($vmlComments as $relName => $relPath) { goto beLR1; J1S_7: $vmlCommentsFile->registerXPathNamespace("\x76", "\x75\x72\156\x3a\163\143\150\x65\155\x61\x73\x2d\x6d\151\x63\162\x6f\163\x6f\x66\x74\55\143\x6f\x6d\x3a\166\155\x6c"); goto XrdCl; XrdCl: $shapes = $vmlCommentsFile->xpath("\x2f\57\166\x3a\163\x68\141\x70\145"); goto YZakK; beLR1: $relPath = PHPExcel_Shared_File::realpath(dirname("{$dir}\x2f{$fileWorksheet}") . "\x2f" . $relPath); goto xQ9EO; YZakK: foreach ($shapes as $shape) { $shape->registerXPathNamespace("\166", "\x75\x72\x6e\x3a\163\x63\x68\145\155\x61\163\x2d\155\151\x63\162\157\163\157\146\164\x2d\143\x6f\155\72\166\x6d\x6c"); if (isset($shape["\x73\164\171\154\x65"])) { goto KKC1b; KKC1b: $style = (string) $shape["\x73\x74\171\154\145"]; goto xUmS0; vhBOU: if ($column !== null && $row !== null) { goto NAIZt; dOaEY: $comment->getFillColor()->setRGB($fillColor); goto gOSym; gOSym: $styleArray = explode("\73", str_replace("\x20", '', $style)); goto KKZKJ; KKZKJ: foreach ($styleArray as $stylePair) { goto MlPUm; Fy_8U: if ($stylePair[0] == "\x6d\x61\x72\147\x69\156\55\164\157\x70") { $comment->setMarginTop($stylePair[1]); } goto eq6OT; CgVx6: if ($stylePair[0] == "\x6d\x61\162\x67\151\x6e\x2d\x6c\x65\x66\x74") { $comment->setMarginLeft($stylePair[1]); } goto Fy_8U; MlPUm: $stylePair = explode("\x3a", $stylePair); goto CgVx6; JMdQh: if ($stylePair[0] == "\x68\x65\x69\147\150\x74") { $comment->setHeight($stylePair[1]); } goto NGEGa; eq6OT: if ($stylePair[0] == "\167\151\x64\164\150") { $comment->setWidth($stylePair[1]); } goto JMdQh; NGEGa: if ($stylePair[0] == "\x76\x69\163\x69\142\151\154\151\164\x79") { $comment->setVisible($stylePair[1] == "\x76\x69\x73\151\x62\154\x65"); } goto ZN2GF; ZN2GF: } goto R0UtI; NAIZt: $comment = $docSheet->getCommentByColumnAndRow((string) $column, $row + 1); goto dOaEY; R0UtI: } goto q_Vdy; Q3adk: $column = null; goto bq7Tg; xUmS0: $fillColor = strtoupper(substr((string) $shape["\x66\151\x6c\x6c\x63\x6f\154\157\x72"], 1)); goto Q3adk; k50U4: if (is_array($clientData) && !empty($clientData)) { $clientData = $clientData[0]; if (isset($clientData["\x4f\142\x6a\145\x63\164\124\x79\160\145"]) && (string) $clientData["\x4f\x62\152\145\143\164\124\171\x70\145"] == "\116\x6f\164\145") { goto J6VeQ; m6Cps: $temp = $clientData->xpath("\56\57\57\x78\72\103\x6f\x6c\165\155\x6e"); goto ZVVFi; ZVVFi: if (is_array($temp)) { $column = $temp[0]; } goto gJZX1; J6VeQ: $temp = $clientData->xpath("\56\57\x2f\x78\72\122\x6f\x77"); goto N4opv; N4opv: if (is_array($temp)) { $row = $temp[0]; } goto m6Cps; gJZX1: } } goto vhBOU; bq7Tg: $row = null; goto l41jL; l41jL: $clientData = $shape->xpath("\x2e\x2f\57\170\72\x43\x6c\151\145\x6e\164\104\141\164\141"); goto k50U4; q_Vdy: } } goto TT4sN; xQ9EO: $vmlCommentsFile = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, $relPath)), "\x53\x69\155\x70\x6c\145\130\x4d\114\105\x6c\145\x6d\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto J1S_7; TT4sN: } goto QU8U4; i3Ckh: if ($zip->locateName(dirname("{$dir}\57{$fileWorksheet}") . "\x2f\137\162\x65\x6c\x73\57" . basename($fileWorksheet) . "\x2e\x72\x65\x6c\163")) { $relsWorksheet = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, dirname("{$dir}\x2f{$fileWorksheet}") . "\x2f\x5f\x72\145\x6c\163\x2f" . basename($fileWorksheet) . "\x2e\x72\145\154\163")), "\x53\x69\155\x70\x6c\145\x58\115\x4c\x45\154\x65\155\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); foreach ($relsWorksheet->Relationship as $ele) { if ($ele["\x54\x79\x70\145"] == "\x68\x74\x74\160\72\x2f\57\x73\x63\x68\x65\155\141\163\56\157\160\145\x6e\x78\155\x6c\x66\157\x72\155\141\x74\x73\56\157\x72\147\x2f\x6f\x66\x66\151\x63\x65\104\157\x63\x75\155\x65\156\164\x2f\x32\x30\x30\66\x2f\162\145\154\141\164\151\x6f\156\163\x68\151\x70\x73\57\143\157\x6d\155\145\x6e\x74\x73") { $comments[(string) $ele["\111\144"]] = (string) $ele["\124\141\162\x67\x65\x74"]; } if ($ele["\124\x79\x70\x65"] == "\x68\164\x74\x70\x3a\x2f\57\163\143\x68\145\155\x61\x73\56\x6f\160\145\156\x78\155\154\146\x6f\x72\x6d\141\164\x73\x2e\x6f\162\147\x2f\x6f\x66\x66\151\x63\x65\x44\157\x63\165\155\145\x6e\x74\57\62\60\x30\x36\x2f\x72\145\x6c\x61\164\x69\157\x6e\x73\x68\151\160\163\x2f\166\x6d\x6c\104\x72\141\167\151\x6e\x67") { $vmlComments[(string) $ele["\x49\144"]] = (string) $ele["\124\141\x72\147\x65\x74"]; } } } goto E0VWH; E0VWH: foreach ($comments as $relName => $relPath) { goto l2ZKb; Kzav6: $authors = array(); goto MVsD_; EqCxC: $commentsFile = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, $relPath)), "\123\151\x6d\x70\x6c\x65\130\115\114\105\154\x65\155\x65\x6e\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto Kzav6; l2ZKb: $relPath = PHPExcel_Shared_File::realpath(dirname("{$dir}\x2f{$fileWorksheet}") . "\57" . $relPath); goto EqCxC; MVsD_: foreach ($commentsFile->authors->author as $author) { $authors[] = (string) $author; } goto jkUVv; jkUVv: foreach ($commentsFile->commentList->comment as $comment) { if (!empty($comment["\x61\x75\164\x68\x6f\162\111\144"])) { $docSheet->getComment((string) $comment["\x72\145\x66"])->setAuthor($authors[(string) $comment["\x61\x75\x74\150\157\x72\x49\144"]]); } $docSheet->getComment((string) $comment["\162\x65\146"])->setText($this->parseRichText($comment->text)); } goto rS_5v; rS_5v: } goto e0mEt; QU8U4: if ($xmlSheet && $xmlSheet->legacyDrawingHF && !$this->readDataOnly) { if ($zip->locateName(dirname("{$dir}\57{$fileWorksheet}") . "\x2f\137\x72\x65\x6c\x73\x2f" . basename($fileWorksheet) . "\x2e\162\145\154\163")) { goto NnHDB; vmAQl: if ($vmlRelationship != '') { goto oyOCt; oyOCt: $relsVML = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, dirname($vmlRelationship) . "\x2f\137\x72\x65\x6c\x73\x2f" . basename($vmlRelationship) . "\x2e\162\145\154\163")), "\123\x69\155\x70\154\x65\x58\115\114\105\x6c\x65\155\145\x6e\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto vsO2F; AoHn9: $vmlDrawing = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, $vmlRelationship)), "\x53\151\x6d\160\x6c\x65\130\x4d\114\x45\x6c\x65\x6d\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto Oxrqd; vdJh6: foreach ($relsVML->Relationship as $ele) { if ($ele["\x54\171\x70\145"] == "\x68\x74\x74\x70\72\57\x2f\x73\143\x68\x65\x6d\141\163\x2e\x6f\x70\145\156\x78\x6d\x6c\146\157\162\x6d\141\164\163\56\x6f\162\x67\x2f\x6f\x66\x66\151\x63\145\104\157\143\x75\155\x65\156\164\x2f\x32\x30\60\x36\x2f\162\145\x6c\x61\x74\151\x6f\156\x73\x68\x69\160\x73\x2f\151\x6d\x61\x67\145") { $drawings[(string) $ele["\111\x64"]] = self::dirAdd($vmlRelationship, $ele["\x54\x61\162\147\145\x74"]); } } goto AoHn9; okUuw: $hfImages = array(); goto vkLcB; bJynU: $docSheet->getHeaderFooter()->setImages($hfImages); goto d7YbL; gfCJn: foreach ($shapes as $idx => $shape) { goto By33W; h20RS: $style = self::toCSSArray((string) $shape["\x73\164\171\154\145"]); goto xKsGv; By33W: $shape->registerXPathNamespace("\166", "\165\x72\156\72\163\x63\150\x65\x6d\x61\163\55\155\151\143\162\x6f\x73\x6f\146\x74\x2d\143\157\x6d\x3a\x76\x6d\154"); goto oiPn8; fruoq: $hfImages[(string) $shape["\x69\x64"]]->setOffsetY($style["\x6d\x61\x72\147\151\156\x2d\x74\x6f\160"]); goto lEgmu; Ydk35: $imageData = $imageData[$idx]; goto RNMCo; lEgmu: $hfImages[(string) $shape["\x69\x64"]]->setResizeProportional(true); goto MPLM4; Qva0D: $hfImages[(string) $shape["\151\x64"]]->setHeight($style["\x68\145\151\x67\150\x74"]); goto CSTEd; xKsGv: $hfImages[(string) $shape["\151\144"]] = new PHPExcel_Worksheet_HeaderFooterDrawing(); goto EHJEE; K0CCF: $hfImages[(string) $shape["\151\x64"]]->setPath("\x7a\x69\160\x3a\x2f\x2f" . PHPExcel_Shared_File::realpath($pFilename) . "\x23" . $drawings[(string) $imageData["\162\145\x6c\x69\144"]], false); goto R0_zv; oiPn8: $imageData = $shape->xpath("\x2f\57\x76\72\151\x6d\x61\x67\145\x64\141\x74\141"); goto Ydk35; R0_zv: $hfImages[(string) $shape["\151\x64"]]->setResizeProportional(false); goto fuz4i; EHJEE: if (isset($imageData["\x74\151\164\154\145"])) { $hfImages[(string) $shape["\151\144"]]->setName((string) $imageData["\x74\151\164\x6c\x65"]); } goto K0CCF; fuz4i: $hfImages[(string) $shape["\x69\144"]]->setWidth($style["\167\x69\x64\164\x68"]); goto Qva0D; CSTEd: if (isset($style["\x6d\141\162\147\151\x6e\x2d\154\145\x66\164"])) { $hfImages[(string) $shape["\x69\144"]]->setOffsetX($style["\155\141\x72\x67\151\156\x2d\154\x65\x66\164"]); } goto fruoq; RNMCo: $imageData = $imageData->attributes("\x75\162\x6e\72\x73\143\150\145\155\141\x73\x2d\155\151\143\162\157\163\x6f\146\164\55\143\157\x6d\72\x6f\x66\146\x69\143\145\72\x6f\146\x66\151\143\145"); goto h20RS; MPLM4: } goto bJynU; Oxrqd: $vmlDrawing->registerXPathNamespace("\166", "\x75\162\x6e\72\x73\x63\x68\145\x6d\141\x73\55\155\151\143\x72\x6f\163\157\146\164\x2d\143\x6f\x6d\72\x76\x6d\154"); goto okUuw; vkLcB: $shapes = $vmlDrawing->xpath("\x2f\x2f\166\x3a\163\150\141\x70\x65"); goto gfCJn; vsO2F: $drawings = array(); goto vdJh6; d7YbL: } goto XewZI; Yje3Y: foreach ($relsWorksheet->Relationship as $ele) { if ($ele["\x54\171\x70\x65"] == "\150\164\164\x70\72\57\x2f\x73\x63\x68\145\155\141\163\56\157\160\145\x6e\170\155\x6c\146\x6f\162\155\141\164\x73\x2e\157\x72\x67\x2f\157\146\x66\151\x63\145\104\x6f\143\165\x6d\x65\x6e\164\57\x32\60\60\x36\57\162\x65\x6c\x61\x74\x69\x6f\x6e\163\150\x69\x70\x73\57\x76\155\154\x44\x72\141\167\151\156\147") { $vmlRelationship = self::dirAdd("{$dir}\57{$fileWorksheet}", $ele["\124\141\x72\x67\x65\x74"]); } } goto vmAQl; tlMO5: $vmlRelationship = ''; goto Yje3Y; NnHDB: $relsWorksheet = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, dirname("{$dir}\x2f{$fileWorksheet}") . "\x2f\137\162\145\x6c\x73\57" . basename($fileWorksheet) . "\56\162\145\154\163")), "\123\151\x6d\x70\154\145\x58\x4d\114\105\154\145\x6d\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto tlMO5; XewZI: } } goto ajBU7; ajBU7: } goto t1ycy; cBQLk: if (isset($xmlSheet->cols) && !$this->readDataOnly) { foreach ($xmlSheet->cols->col as $col) { for ($i = intval($col["\155\151\156"]) - 1; $i < intval($col["\x6d\141\170"]); ++$i) { if ($col["\x73\164\171\154\x65"] && !$this->readDataOnly) { $docSheet->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($i))->setXfIndex(intval($col["\x73\164\171\x6c\145"])); } if (self::boolean($col["\142\145\163\164\x46\x69\164"])) { } if (self::boolean($col["\150\151\144\144\145\156"])) { $docSheet->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($i))->setVisible(false); } if (self::boolean($col["\x63\x6f\x6c\154\x61\160\x73\x65\x64"])) { $docSheet->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($i))->setCollapsed(true); } if ($col["\157\165\164\154\151\156\145\114\x65\166\145\154"] > 0) { $docSheet->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($i))->setOutlineLevel(intval($col["\157\165\164\154\x69\x6e\x65\114\145\166\x65\x6c"])); } $docSheet->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($i))->setWidth(floatval($col["\x77\151\x64\164\150"])); if (intval($col["\155\x61\x78"]) == 16384) { break; } } } } goto jk0r8; DTM8T: $aKeys = array("\x73\x68\x65\145\164", "\157\142\152\145\x63\x74\x73", "\x73\x63\x65\156\141\x72\151\157\x73", "\146\x6f\162\155\x61\x74\x43\145\x6c\x6c\x73", "\x66\157\x72\155\141\164\103\157\154\165\155\156\x73", "\146\x6f\x72\x6d\x61\x74\x52\157\x77\163", "\151\x6e\163\145\162\164\x43\157\x6c\x75\x6d\156\x73", "\x69\x6e\x73\x65\162\164\122\x6f\x77\163", "\151\156\x73\145\x72\164\110\x79\x70\145\162\154\x69\x6e\x6b\x73", "\144\x65\x6c\x65\x74\145\x43\x6f\154\165\155\156\163", "\144\145\154\x65\164\x65\x52\x6f\167\163", "\163\x65\154\145\143\164\114\157\143\153\x65\x64\103\145\154\x6c\163", "\163\x6f\162\x74", "\x61\165\164\157\x46\x69\154\x74\145\162", "\160\x69\x76\x6f\x74\x54\141\x62\x6c\145\x73", "\163\145\154\x65\x63\164\x55\x6e\x6c\x6f\143\153\145\144\x43\145\x6c\x6c\x73"); goto UkJZK; wC9VP: $vmlComments = array(); goto z6oKF; T_RB3: if (!$this->readDataOnly) { if ($zip->locateName(dirname("{$dir}\x2f{$fileWorksheet}") . "\57\x5f\x72\x65\154\x73\57" . basename($fileWorksheet) . "\x2e\162\x65\x6c\163")) { $relsWorksheet = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, dirname("{$dir}\x2f{$fileWorksheet}") . "\57\x5f\162\x65\x6c\x73\57" . basename($fileWorksheet) . "\x2e\162\145\x6c\163")), "\123\151\155\160\154\145\130\x4d\x4c\x45\154\x65\x6d\145\x6e\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); foreach ($relsWorksheet->Relationship as $ele) { if ($ele["\124\x79\x70\x65"] == "\150\164\164\160\x3a\57\x2f\163\x63\x68\x65\155\141\163\56\157\x70\145\x6e\170\x6d\154\x66\157\162\155\x61\164\163\x2e\157\162\x67\57\157\x66\x66\x69\143\145\x44\x6f\143\x75\x6d\x65\156\164\57\x32\x30\60\x36\57\162\145\154\141\x74\x69\157\x6e\x73\x68\151\160\163\57\x68\x79\160\x65\x72\x6c\x69\x6e\153") { $hyperlinks[(string) $ele["\x49\x64"]] = (string) $ele["\x54\141\x72\147\x65\x74"]; } } } if ($xmlSheet && $xmlSheet->hyperlinks) { foreach ($xmlSheet->hyperlinks->hyperlink as $hyperlink) { $linkRel = $hyperlink->attributes("\x68\x74\x74\x70\72\57\x2f\163\143\x68\145\155\141\163\56\157\x70\x65\x6e\170\x6d\154\146\x6f\162\x6d\141\164\163\x2e\x6f\162\147\x2f\x6f\x66\x66\x69\x63\x65\104\157\143\x75\x6d\x65\x6e\x74\57\62\x30\60\x36\57\162\145\x6c\141\164\x69\157\156\x73\150\x69\160\x73"); foreach (PHPExcel_Cell::extractAllCellReferencesInRange($hyperlink["\x72\x65\146"]) as $cellReference) { goto Fy4AF; m6yDo: if (isset($linkRel["\151\x64"])) { goto f0rey; vZEYd: if (isset($hyperlink["\154\x6f\143\141\164\151\x6f\x6e"])) { $hyperlinkUrl .= "\x23" . (string) $hyperlink["\154\157\143\x61\164\x69\x6f\156"]; } goto a_2tU; f0rey: $hyperlinkUrl = $hyperlinks[(string) $linkRel["\x69\144"]]; goto vZEYd; a_2tU: $cell->getHyperlink()->setUrl($hyperlinkUrl); goto dlUNb; dlUNb: } elseif (isset($hyperlink["\154\157\143\141\164\151\157\x6e"])) { $cell->getHyperlink()->setUrl("\163\x68\x65\145\x74\x3a\x2f\x2f" . (string) $hyperlink["\x6c\x6f\x63\x61\x74\151\x6f\156"]); } goto xmEkA; xmEkA: if (isset($hyperlink["\164\x6f\157\x6c\164\151\x70"])) { $cell->getHyperlink()->setTooltip((string) $hyperlink["\164\x6f\157\154\164\151\x70"]); } goto o_rgk; Fy4AF: $cell = $docSheet->getCell($cellReference); goto m6yDo; o_rgk: } } } } goto WIC4N; WIC4N: $comments = array(); goto wC9VP; uQ7cr: $mapSheetId[$oldSheetId] = $oldSheetId - $countSkippedSheets; goto zJ8EZ; TaaPX: if (isset($xmlSheet->sheetPr) && isset($xmlSheet->sheetPr->outlinePr)) { if (isset($xmlSheet->sheetPr->outlinePr["\163\x75\x6d\155\141\162\171\122\x69\x67\150\164"]) && !self::boolean((string) $xmlSheet->sheetPr->outlinePr["\x73\x75\155\155\141\162\x79\x52\151\147\150\x74"])) { $docSheet->setShowSummaryRight(false); } else { $docSheet->setShowSummaryRight(true); } if (isset($xmlSheet->sheetPr->outlinePr["\163\165\x6d\x6d\x61\162\171\x42\145\154\157\x77"]) && !self::boolean((string) $xmlSheet->sheetPr->outlinePr["\x73\x75\155\155\141\162\x79\x42\145\x6c\157\x77"])) { $docSheet->setShowSummaryBelow(false); } else { $docSheet->setShowSummaryBelow(true); } } goto HTxmZ; VrT7a: $fileWorksheet = $worksheets[(string) self::getArrayItem($eleSheet->attributes("\150\x74\x74\x70\x3a\x2f\57\163\143\150\145\x6d\141\x73\56\157\160\x65\156\170\x6d\x6c\x66\x6f\162\155\141\x74\x73\x2e\x6f\x72\147\57\157\x66\x66\x69\x63\x65\104\157\x63\165\155\145\x6e\164\x2f\x32\60\x30\66\57\x72\x65\154\x61\x74\151\x6f\156\163\150\x69\x70\x73"), "\151\144")]; goto tzGrQ; qGGzj: if (isset($this->loadSheetsOnly) && !in_array((string) $eleSheet["\x6e\141\x6d\x65"], $this->loadSheetsOnly)) { goto DrVpy; YjrYl: $mapSheetId[$oldSheetId] = null; goto bcZ1K; DrVpy: ++$countSkippedSheets; goto YjrYl; bcZ1K: continue; goto hqhcO; hqhcO: } goto uQ7cr; qvsMq: if ($xmlSheet && $xmlSheet->colBreaks && $xmlSheet->colBreaks->brk && !$this->readDataOnly) { foreach ($xmlSheet->colBreaks->brk as $brk) { if ($brk["\x6d\141\156"]) { $docSheet->setBreak(PHPExcel_Cell::stringFromColumnIndex((string) $brk["\151\144"]) . "\61", PHPExcel_Worksheet::BREAK_COLUMN); } } } goto xz1QV; X2bua: if ($xmlSheet && $xmlSheet->pageMargins && !$this->readDataOnly) { goto lnuFE; lnuFE: $docPageMargins = $docSheet->getPageMargins(); goto aDnpe; hiyO9: $docPageMargins->setBottom(floatval($xmlSheet->pageMargins["\142\x6f\x74\x74\157\x6d"])); goto NXPtw; yEbdk: $docPageMargins->setTop(floatval($xmlSheet->pageMargins["\x74\157\160"])); goto hiyO9; oIMBS: $docPageMargins->setRight(floatval($xmlSheet->pageMargins["\162\x69\147\150\164"])); goto yEbdk; sK1Dk: $docPageMargins->setFooter(floatval($xmlSheet->pageMargins["\146\157\x6f\x74\145\162"])); goto abDlM; aDnpe: $docPageMargins->setLeft(floatval($xmlSheet->pageMargins["\x6c\145\x66\x74"])); goto oIMBS; NXPtw: $docPageMargins->setHeader(floatval($xmlSheet->pageMargins["\150\x65\141\x64\x65\162"])); goto sK1Dk; abDlM: } goto EfJjb; VtiF_: ++$oldSheetId; goto qGGzj; nplhJ: if ($xmlSheet && $xmlSheet->mergeCells && $xmlSheet->mergeCells->mergeCell && !$this->readDataOnly) { foreach ($xmlSheet->mergeCells->mergeCell as $mergeCell) { $mergeRef = (string) $mergeCell["\x72\145\146"]; if (strpos($mergeRef, "\x3a") !== false) { $docSheet->mergeCells((string) $mergeCell["\x72\145\x66"]); } } } goto X2bua; xz1QV: if ($xmlSheet && $xmlSheet->dataValidations && !$this->readDataOnly) { foreach ($xmlSheet->dataValidations->dataValidation as $dataValidation) { goto DlXmG; vYdap: $rangeSet = explode("\40", $range); goto oWjHp; oWjHp: foreach ($rangeSet as $range) { $stRange = $docSheet->shrinkRangeToFit($range); foreach (PHPExcel_Cell::extractAllCellReferencesInRange($stRange) as $reference) { goto clnLZ; km8YX: $docValidation->setFormula1((string) $dataValidation->formula1); goto kvCCd; kvCCd: $docValidation->setFormula2((string) $dataValidation->formula2); goto lkK5t; RcIsT: $docValidation->setShowInputMessage($dataValidation["\163\x68\x6f\167\111\156\x70\165\x74\x4d\145\x73\163\141\x67\x65"] != 0); goto KukJg; F6qlq: $docValidation->setPromptTitle((string) $dataValidation["\160\162\x6f\155\x70\x74\124\151\164\154\x65"]); goto tzQe4; q9oTZ: $docValidation->setError((string) $dataValidation["\x65\x72\x72\x6f\x72"]); goto F6qlq; jSnbg: $docValidation->setAllowBlank($dataValidation["\x61\154\x6c\x6f\167\x42\x6c\x61\x6e\153"] != 0); goto GLcw7; KukJg: $docValidation->setShowErrorMessage($dataValidation["\x73\x68\157\167\x45\162\162\157\162\115\x65\163\163\x61\147\x65"] != 0); goto WN1vz; aPWXJ: $docValidation->setOperator((string) $dataValidation["\157\160\x65\x72\141\x74\x6f\162"]); goto jSnbg; WN1vz: $docValidation->setErrorTitle((string) $dataValidation["\x65\162\x72\x6f\x72\124\151\x74\x6c\145"]); goto q9oTZ; l00i4: $docValidation->setType((string) $dataValidation["\x74\171\160\145"]); goto YLztl; GLcw7: $docValidation->setShowDropDown($dataValidation["\163\x68\157\167\x44\x72\x6f\x70\x44\x6f\x77\156"] == 0); goto RcIsT; YLztl: $docValidation->setErrorStyle((string) $dataValidation["\x65\162\162\157\162\x53\x74\171\x6c\145"]); goto aPWXJ; clnLZ: $docValidation = $docSheet->getCell($reference)->getDataValidation(); goto l00i4; tzQe4: $docValidation->setPrompt((string) $dataValidation["\x70\x72\157\x6d\160\x74"]); goto km8YX; lkK5t: } } goto EsoP9; DlXmG: $range = strtoupper($dataValidation["\x73\161\162\145\146"]); goto vYdap; EsoP9: } } goto TqRZh; X3bvn: $conditionals = array(); goto SYelz; CuQDt: if (isset($xmlSheet->sheetPr) && isset($xmlSheet->sheetPr["\x63\157\144\x65\x4e\141\155\145"])) { $docSheet->setCodeName((string) $xmlSheet->sheetPr["\x63\157\144\x65\x4e\141\x6d\x65"]); } goto TaaPX; HTxmZ: if (isset($xmlSheet->sheetPr) && isset($xmlSheet->sheetPr->pageSetUpPr)) { if (isset($xmlSheet->sheetPr->pageSetUpPr["\x66\x69\x74\124\157\120\x61\147\x65"]) && !self::boolean((string) $xmlSheet->sheetPr->pageSetUpPr["\x66\x69\x74\x54\x6f\x50\141\147\145"])) { $docSheet->getPageSetup()->setFitToPage(false); } else { $docSheet->getPageSetup()->setFitToPage(true); } } goto ltmd3; vBLip: if ($xmlSheet && $xmlSheet->autoFilter && !$this->readDataOnly) { $autoFilterRange = (string) $xmlSheet->autoFilter["\x72\x65\x66"]; if (strpos($autoFilterRange, "\72") !== false) { goto PzPHm; yQrY5: $autoFilter->setRange($autoFilterRange); goto HAD1E; HAD1E: foreach ($xmlSheet->autoFilter->filterColumn as $filterColumn) { goto cytiB; cytiB: $column = $autoFilter->getColumnByOffset((int) $filterColumn["\143\x6f\x6c\x49\x64"]); goto dIOr0; d2JRT: if ($filterColumn->top10) { $column->setFilterType(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_TOPTENFILTER); foreach ($filterColumn->top10 as $filterRule) { $column->createRule()->setRule(isset($filterRule["\160\x65\x72\143\145\156\164"]) && $filterRule["\x70\145\x72\x63\145\x6e\x74"] == 1 ? PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_PERCENT : PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_BY_VALUE, (string) $filterRule["\x76\141\x6c"], isset($filterRule["\x74\x6f\160"]) && $filterRule["\x74\x6f\160"] == 1 ? PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_TOP : PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_COLUMN_RULE_TOPTEN_BOTTOM)->setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_TOPTENFILTER); } } goto WxSwK; dIOr0: if ($filterColumn->filters) { goto VVsgf; rWa9f: foreach ($filters->dateGroupItem as $dateGroupItem) { $column->createRule()->setRule(null, array("\171\x65\141\x72" => (string) $dateGroupItem["\171\x65\141\x72"], "\x6d\157\156\x74\150" => (string) $dateGroupItem["\155\x6f\x6e\x74\150"], "\x64\x61\x79" => (string) $dateGroupItem["\x64\x61\x79"], "\150\157\x75\162" => (string) $dateGroupItem["\x68\x6f\x75\x72"], "\x6d\151\156\165\x74\145" => (string) $dateGroupItem["\x6d\151\x6e\x75\x74\145"], "\163\145\x63\157\156\144" => (string) $dateGroupItem["\163\145\x63\x6f\x6e\x64"]), (string) $dateGroupItem["\144\141\164\145\124\151\155\145\107\162\157\x75\x70\151\156\147"])->setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_DATEGROUP); } goto at9Vm; vPGJj: $filters = $filterColumn->filters; goto cxxie; VVsgf: $column->setFilterType(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_FILTER); goto vPGJj; cxxie: if (isset($filters["\x62\x6c\141\156\153"]) && $filters["\142\154\141\156\x6b"] == 1) { $column->createRule()->setRule(null, '')->setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_FILTER); } goto yGjRJ; yGjRJ: foreach ($filters->filter as $filterRule) { $column->createRule()->setRule(null, (string) $filterRule["\166\141\x6c"])->setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_FILTER); } goto rWa9f; at9Vm: } goto nXtEb; nXtEb: if ($filterColumn->customFilters) { goto YiptI; T1jLx: if (isset($customFilters["\141\156\x64"]) && $customFilters["\141\156\144"] == 1) { $column->setJoin(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_COLUMN_JOIN_AND); } goto O1Xr_; em5j2: $customFilters = $filterColumn->customFilters; goto T1jLx; O1Xr_: foreach ($customFilters->customFilter as $filterRule) { $column->createRule()->setRule((string) $filterRule["\157\x70\x65\x72\141\164\x6f\162"], (string) $filterRule["\x76\x61\x6c"])->setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_CUSTOMFILTER); } goto F74SO; YiptI: $column->setFilterType(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_CUSTOMFILTER); goto em5j2; F74SO: } goto unhfV; unhfV: if ($filterColumn->dynamicFilter) { $column->setFilterType(PHPExcel_Worksheet_AutoFilter_Column::AUTOFILTER_FILTERTYPE_DYNAMICFILTER); foreach ($filterColumn->dynamicFilter as $filterRule) { goto QvKUJ; QvKUJ: $column->createRule()->setRule(null, (string) $filterRule["\166\x61\154"], (string) $filterRule["\x74\x79\160\x65"])->setRuleType(PHPExcel_Worksheet_AutoFilter_Column_Rule::AUTOFILTER_RULETYPE_DYNAMICFILTER); goto wPdGo; wPdGo: if (isset($filterRule["\166\x61\154"])) { $column->setAttribute("\x76\x61\154", (string) $filterRule["\x76\x61\x6c"]); } goto zJHYF; zJHYF: if (isset($filterRule["\x6d\x61\170\126\x61\x6c"])) { $column->setAttribute("\x6d\x61\170\x56\141\154", (string) $filterRule["\155\x61\170\126\141\x6c"]); } goto temGh; temGh: } } goto d2JRT; WxSwK: } goto QY7PG; PzPHm: $autoFilter = $docSheet->getAutoFilter(); goto yQrY5; QY7PG: } } goto nplhJ; UsH05: if (isset($eleSheet["\163\164\141\x74\x65"]) && (string) $eleSheet["\163\164\141\x74\x65"] != '') { $docSheet->setSheetState((string) $eleSheet["\163\164\141\164\145"]); } goto ETaJX; k78Nj: if ($xmlWorkbook->definedNames) { foreach ($xmlWorkbook->definedNames->definedName as $definedName) { goto zDex3; SWlLy: $extractedRange = preg_replace("\x2f\47\x28\x5c\167\x2b\51\47\134\x21\x2f", '', $extractedRange); goto IFjr1; HDAp4: if ((string) $definedName["\154\157\x63\x61\x6c\x53\150\145\145\164\x49\144"] != '' && (string) $definedName["\x6c\157\x63\x61\154\123\150\145\145\164\111\x64"] == $sheetId) { switch ((string) $definedName["\x6e\x61\x6d\145"]) { case "\137\170\154\156\x6d\56\137\106\x69\154\164\145\162\104\x61\x74\141\x62\x61\x73\145": if ((string) $definedName["\150\x69\x64\144\145\x6e"] !== "\x31") { $extractedRange = explode("\x2c", $extractedRange); foreach ($extractedRange as $range) { $autoFilterRange = $range; if (strpos($autoFilterRange, "\x3a") !== false) { $docSheet->getAutoFilter()->setRange($autoFilterRange); } } } break; case "\x5f\170\x6c\x6e\155\56\x50\x72\x69\156\x74\137\124\x69\164\154\x65\x73": goto Yj1ff; WUyTk: break; goto NHUfp; Yj1ff: $extractedRange = explode("\54", $extractedRange); goto xGRon; xGRon: foreach ($extractedRange as $range) { goto NaLcG; GOQBg: $range = str_replace("\x24", '', $range); goto z_q5L; z_q5L: if (preg_match("\57\x21\x3f\x28\x5b\x41\55\132\x5d\53\x29\x5c\72\50\133\x41\x2d\x5a\x5d\53\x29\x24\57", $range, $matches)) { $docSheet->getPageSetup()->setColumnsToRepeatAtLeft(array($matches[1], $matches[2])); } elseif (preg_match("\x2f\x21\77\x28\134\x64\x2b\x29\134\72\x28\x5c\144\53\51\44\57", $range, $matches)) { $docSheet->getPageSetup()->setRowsToRepeatAtTop(array($matches[1], $matches[2])); } goto UagIt; NaLcG: $matches = array(); goto GOQBg; UagIt: } goto WUyTk; NHUfp: case "\137\170\x6c\156\155\x2e\x50\162\151\x6e\x74\137\101\162\145\141": goto pTzp7; E1F14: foreach ($rangeSets as $rangeSet) { goto LwoMG; dyuoU: $newRangeSets[] = str_replace("\x24", '', $rangeSet); goto ay5_o; LwoMG: $range = explode("\41", $rangeSet); goto FXF9n; FXF9n: $rangeSet = isset($range[1]) ? $range[1] : $range[0]; goto OiXXk; OiXXk: if (strpos($rangeSet, "\x3a") === false) { $rangeSet = $rangeSet . "\72" . $rangeSet; } goto dyuoU; ay5_o: } goto FI7qI; AVwjj: $newRangeSets = array(); goto E1F14; pTzp7: $rangeSets = explode("\54", $extractedRange); goto AVwjj; FI7qI: $docSheet->getPageSetup()->setPrintArea(implode("\54", $newRangeSets)); goto AWIx7; AWIx7: break; goto BIbMZ; BIbMZ: default: break; } } goto pT290; zDex3: $extractedRange = (string) $definedName; goto SWlLy; wEw_e: if (stripos((string) $definedName, "\x23\x52\105\x46\41") !== false || $extractedRange == '') { continue; } goto HDAp4; IFjr1: if (($spos = strpos($extractedRange, "\x21")) !== false) { $extractedRange = substr($extractedRange, 0, $spos) . str_replace("\44", '', substr($extractedRange, $spos)); } else { $extractedRange = str_replace("\44", '', $extractedRange); } goto wEw_e; pT290: } } goto zpZWF; ltmd3: if (isset($xmlSheet->sheetFormatPr)) { goto B4MP7; B4MP7: if (isset($xmlSheet->sheetFormatPr["\143\x75\x73\x74\x6f\x6d\x48\x65\x69\x67\x68\x74"]) && self::boolean((string) $xmlSheet->sheetFormatPr["\143\x75\163\164\157\x6d\x48\145\x69\147\x68\x74"]) && isset($xmlSheet->sheetFormatPr["\x64\145\x66\x61\165\x6c\164\122\x6f\167\110\x65\x69\147\150\164"])) { $docSheet->getDefaultRowDimension()->setRowHeight((float) $xmlSheet->sheetFormatPr["\x64\x65\146\x61\165\x6c\164\x52\x6f\167\x48\145\x69\x67\150\164"]); } goto NMV1j; NMV1j: if (isset($xmlSheet->sheetFormatPr["\x64\x65\x66\141\165\154\x74\x43\x6f\x6c\x57\x69\144\164\x68"])) { $docSheet->getDefaultColumnDimension()->setWidth((float) $xmlSheet->sheetFormatPr["\x64\145\x66\141\x75\154\164\x43\x6f\x6c\127\151\144\164\150"]); } goto o8PIC; o8PIC: if (isset($xmlSheet->sheetFormatPr["\x7a\x65\162\x6f\110\x65\151\x67\150\x74"]) && (string) $xmlSheet->sheetFormatPr["\x7a\145\x72\x6f\x48\145\151\147\x68\164"] == "\61") { $docSheet->getDefaultRowDimension()->setZeroHeight(true); } goto sjhwg; sjhwg: } goto cBQLk; j2OlF: if ($xmlSheet && $xmlSheet->headerFooter && !$this->readDataOnly) { goto ZaxK7; gleON: if (isset($xmlSheet->headerFooter["\163\143\141\x6c\145\x57\151\x74\150\104\x6f\143"]) && !self::boolean((string) $xmlSheet->headerFooter["\x73\x63\x61\x6c\145\x57\151\164\150\104\157\143"])) { $docHeaderFooter->setScaleWithDocument(false); } else { $docHeaderFooter->setScaleWithDocument(true); } goto N8fd2; LfE1U: $docHeaderFooter->setOddHeader((string) $xmlSheet->headerFooter->oddHeader); goto Avhp9; xLENt: $docHeaderFooter->setEvenFooter((string) $xmlSheet->headerFooter->evenFooter); goto wkbIY; e8juS: $docHeaderFooter->setEvenHeader((string) $xmlSheet->headerFooter->evenHeader); goto xLENt; wkbIY: $docHeaderFooter->setFirstHeader((string) $xmlSheet->headerFooter->firstHeader); goto HwQSl; N8fd2: if (isset($xmlSheet->headerFooter["\x61\154\x69\x67\156\127\x69\x74\x68\115\x61\162\x67\x69\x6e\163"]) && !self::boolean((string) $xmlSheet->headerFooter["\141\x6c\151\147\156\x57\151\x74\150\115\141\162\147\151\156\163"])) { $docHeaderFooter->setAlignWithMargins(false); } else { $docHeaderFooter->setAlignWithMargins(true); } goto LfE1U; oi1Z4: if (isset($xmlSheet->headerFooter["\144\x69\x66\146\x65\x72\x65\x6e\x74\106\x69\x72\163\x74"]) && self::boolean((string) $xmlSheet->headerFooter["\144\151\x66\146\x65\x72\145\156\x74\x46\151\162\163\164"])) { $docHeaderFooter->setDifferentFirst(true); } else { $docHeaderFooter->setDifferentFirst(false); } goto gleON; HwQSl: $docHeaderFooter->setFirstFooter((string) $xmlSheet->headerFooter->firstFooter); goto m39e6; N8D_n: if (isset($xmlSheet->headerFooter["\x64\151\x66\146\145\x72\145\x6e\x74\117\144\x64\x45\166\145\x6e"]) && self::boolean((string) $xmlSheet->headerFooter["\x64\151\146\x66\145\162\145\156\164\117\144\144\105\166\145\x6e"])) { $docHeaderFooter->setDifferentOddEven(true); } else { $docHeaderFooter->setDifferentOddEven(false); } goto oi1Z4; Avhp9: $docHeaderFooter->setOddFooter((string) $xmlSheet->headerFooter->oddFooter); goto e8juS; ZaxK7: $docHeaderFooter = $docSheet->getHeaderFooter(); goto N8D_n; m39e6: } goto PUUw3; t1ycy: if ($zip->locateName(dirname("{$dir}\x2f{$fileWorksheet}") . "\x2f\x5f\x72\145\154\163\x2f" . basename($fileWorksheet) . "\x2e\x72\145\154\x73")) { goto oPb0v; ADoa9: $drawings = array(); goto L0VuO; e8sE0: if ($xmlSheet->drawing && !$this->readDataOnly) { foreach ($xmlSheet->drawing as $drawing) { goto Qy9vL; VZaHY: if ($relsDrawing && $relsDrawing->Relationship) { foreach ($relsDrawing->Relationship as $ele) { if ($ele["\x54\171\x70\x65"] == "\150\164\164\x70\x3a\x2f\x2f\x73\143\150\x65\155\x61\163\x2e\x6f\160\x65\x6e\170\x6d\154\146\x6f\162\x6d\141\164\x73\56\x6f\162\x67\x2f\157\146\146\x69\143\x65\x44\x6f\x63\165\155\145\156\164\57\x32\x30\60\x36\x2f\162\x65\154\141\164\151\157\156\163\x68\151\x70\x73\57\151\x6d\x61\x67\x65") { $images[(string) $ele["\111\144"]] = self::dirAdd($fileDrawing, $ele["\x54\x61\x72\147\145\x74"]); } elseif ($ele["\x54\171\160\145"] == "\x68\164\164\x70\x3a\57\x2f\x73\143\x68\x65\x6d\141\163\x2e\157\160\145\x6e\170\155\154\x66\x6f\162\x6d\141\164\x73\56\157\x72\x67\x2f\x6f\146\x66\x69\143\x65\x44\x6f\143\165\x6d\145\156\x74\x2f\x32\60\x30\66\57\x72\145\154\141\x74\151\157\156\163\x68\x69\x70\x73\x2f\x63\x68\x61\162\x74") { if ($this->includeCharts) { $charts[self::dirAdd($fileDrawing, $ele["\x54\x61\162\147\x65\164"])] = array("\151\144" => (string) $ele["\x49\x64"], "\163\150\145\x65\164" => $docSheet->getTitle()); } } } } goto AB_Us; ibQAX: if ($xmlDrawing->oneCellAnchor) { foreach ($xmlDrawing->oneCellAnchor as $oneCellAnchor) { if ($oneCellAnchor->pic->blipFill) { goto Kl2D1; oTjti: $objDrawing->setName((string) self::getArrayItem($oneCellAnchor->pic->nvPicPr->cNvPr->attributes(), "\x6e\141\155\x65")); goto ILUTE; urVGK: if ($xfrm) { $objDrawing->setRotation(PHPExcel_Shared_Drawing::angleToDegrees(self::getArrayItem($xfrm->attributes(), "\162\x6f\164"))); } goto rDrg4; ILUTE: $objDrawing->setDescription((string) self::getArrayItem($oneCellAnchor->pic->nvPicPr->cNvPr->attributes(), "\x64\145\x73\143\162")); goto BHisJ; PN1Hc: $objDrawing->setOffsetY(PHPExcel_Shared_Drawing::EMUToPixels($oneCellAnchor->from->rowOff)); goto OBJ1k; DX6nH: $objDrawing->setCoordinates(PHPExcel_Cell::stringFromColumnIndex((string) $oneCellAnchor->from->col) . ($oneCellAnchor->from->row + 1)); goto vgDkh; unTg2: $objDrawing = new PHPExcel_Worksheet_Drawing(); goto oTjti; nunRC: $objDrawing->setHeight(PHPExcel_Shared_Drawing::EMUToPixels(self::getArrayItem($oneCellAnchor->ext->attributes(), "\x63\x79"))); goto urVGK; Kl2D1: $blip = $oneCellAnchor->pic->blipFill->children("\x68\x74\x74\x70\72\x2f\57\163\x63\150\x65\x6d\141\163\56\157\x70\x65\156\170\155\154\x66\x6f\x72\x6d\141\x74\x73\56\x6f\x72\x67\57\144\162\x61\x77\x69\x6e\147\x6d\154\57\x32\60\x30\x36\x2f\x6d\x61\151\x6e")->blip; goto BSSg6; BSSg6: $xfrm = $oneCellAnchor->pic->spPr->children("\150\164\164\160\72\57\x2f\163\143\150\145\155\x61\x73\x2e\x6f\160\145\x6e\x78\x6d\154\146\157\x72\155\x61\x74\163\x2e\x6f\x72\147\57\x64\x72\x61\167\x69\x6e\x67\x6d\x6c\57\x32\60\x30\x36\x2f\155\x61\151\x6e")->xfrm; goto d_3eE; BHisJ: $objDrawing->setPath("\172\x69\x70\72\57\57" . PHPExcel_Shared_File::realpath($pFilename) . "\x23" . $images[(string) self::getArrayItem($blip->attributes("\150\x74\x74\x70\72\57\57\x73\x63\x68\145\x6d\x61\x73\56\x6f\x70\145\x6e\x78\x6d\x6c\146\x6f\162\x6d\x61\x74\163\56\x6f\162\147\57\x6f\x66\146\x69\x63\x65\104\x6f\x63\165\155\145\x6e\x74\x2f\62\60\x30\x36\57\162\x65\x6c\x61\x74\x69\157\156\163\150\x69\160\163"), "\x65\x6d\x62\x65\144")], false); goto DX6nH; d_3eE: $outerShdw = $oneCellAnchor->pic->spPr->children("\150\164\x74\160\x3a\x2f\x2f\163\x63\150\x65\155\x61\x73\x2e\x6f\x70\x65\156\170\155\x6c\146\157\x72\155\x61\164\163\x2e\157\162\x67\57\144\162\141\167\x69\156\x67\155\x6c\57\x32\x30\x30\x36\57\x6d\x61\x69\x6e")->effectLst->outerShdw; goto unTg2; rDrg4: if ($outerShdw) { goto Ltj_y; dIvti: $shadow->setDirection(PHPExcel_Shared_Drawing::angleToDegrees(self::getArrayItem($outerShdw->attributes(), "\x64\151\x72"))); goto L4yv7; L4yv7: $shadow->setAlignment((string) self::getArrayItem($outerShdw->attributes(), "\141\x6c\147\156")); goto MKubu; v1CO0: $shadow->setBlurRadius(PHPExcel_Shared_Drawing::EMUTopixels(self::getArrayItem($outerShdw->attributes(), "\142\x6c\x75\x72\122\x61\144"))); goto ZoMaR; ZoMaR: $shadow->setDistance(PHPExcel_Shared_Drawing::EMUTopixels(self::getArrayItem($outerShdw->attributes(), "\x64\x69\x73\164"))); goto dIvti; Ltj_y: $shadow = $objDrawing->getShadow(); goto EhuPY; EhuPY: $shadow->setVisible(true); goto v1CO0; i7BwC: $shadow->setAlpha(self::getArrayItem($outerShdw->srgbClr->alpha->attributes(), "\x76\x61\154") / 1000); goto lYLej; MKubu: $shadow->getColor()->setRGB(self::getArrayItem($outerShdw->srgbClr->attributes(), "\166\141\x6c")); goto i7BwC; lYLej: } goto fUX0m; vgDkh: $objDrawing->setOffsetX(PHPExcel_Shared_Drawing::EMUToPixels($oneCellAnchor->from->colOff)); goto PN1Hc; fUX0m: $objDrawing->setWorksheet($docSheet); goto mAzvH; OBJ1k: $objDrawing->setResizeProportional(false); goto DP2W3; DP2W3: $objDrawing->setWidth(PHPExcel_Shared_Drawing::EMUToPixels(self::getArrayItem($oneCellAnchor->ext->attributes(), "\143\170"))); goto nunRC; mAzvH: } else { goto MBoHQ; bzAyu: $offsetX = PHPExcel_Shared_Drawing::EMUToPixels($oneCellAnchor->from->colOff); goto la2gd; la2gd: $offsetY = PHPExcel_Shared_Drawing::EMUToPixels($oneCellAnchor->from->rowOff); goto HKT1c; aJk53: $height = PHPExcel_Shared_Drawing::EMUToPixels(self::getArrayItem($oneCellAnchor->ext->attributes(), "\x63\x79")); goto tpqE4; MBoHQ: $coordinates = PHPExcel_Cell::stringFromColumnIndex((string) $oneCellAnchor->from->col) . ($oneCellAnchor->from->row + 1); goto bzAyu; HKT1c: $width = PHPExcel_Shared_Drawing::EMUToPixels(self::getArrayItem($oneCellAnchor->ext->attributes(), "\143\170")); goto aJk53; tpqE4: } } } goto jxxrz; jxxrz: if ($xmlDrawing->twoCellAnchor) { foreach ($xmlDrawing->twoCellAnchor as $twoCellAnchor) { if ($twoCellAnchor->pic->blipFill) { goto O38lH; eRaHd: $objDrawing->setName((string) self::getArrayItem($twoCellAnchor->pic->nvPicPr->cNvPr->attributes(), "\x6e\x61\155\x65")); goto x_nKX; kyt6y: $objDrawing->setOffsetY(PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor->from->rowOff)); goto xRWBD; my0x_: $objDrawing->setOffsetX(PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor->from->colOff)); goto kyt6y; xRWBD: $objDrawing->setResizeProportional(false); goto URgmL; YgEUy: $objDrawing->setWorksheet($docSheet); goto BsH3R; nXo0L: $objDrawing->setCoordinates(PHPExcel_Cell::stringFromColumnIndex((string) $twoCellAnchor->from->col) . ($twoCellAnchor->from->row + 1)); goto my0x_; tKot2: $xfrm = $twoCellAnchor->pic->spPr->children("\150\x74\x74\x70\72\x2f\57\x73\x63\150\x65\155\141\x73\56\x6f\160\x65\x6e\170\x6d\x6c\146\157\162\155\141\164\x73\56\x6f\162\x67\57\x64\162\141\x77\151\156\147\x6d\154\57\62\60\60\x36\57\x6d\141\151\156")->xfrm; goto fwV4W; Vd8Hp: $objDrawing = new PHPExcel_Worksheet_Drawing(); goto eRaHd; URgmL: if ($xfrm) { goto vxm0b; xzdBA: $objDrawing->setRotation(PHPExcel_Shared_Drawing::angleToDegrees(self::getArrayItem($xfrm->attributes(), "\162\x6f\164"))); goto wJrxw; Iz2HK: $objDrawing->setHeight(PHPExcel_Shared_Drawing::EMUToPixels(self::getArrayItem($xfrm->ext->attributes(), "\x63\x79"))); goto xzdBA; vxm0b: $objDrawing->setWidth(PHPExcel_Shared_Drawing::EMUToPixels(self::getArrayItem($xfrm->ext->attributes(), "\143\170"))); goto Iz2HK; wJrxw: } goto FWARf; x_nKX: $objDrawing->setDescription((string) self::getArrayItem($twoCellAnchor->pic->nvPicPr->cNvPr->attributes(), "\144\x65\163\143\162")); goto Sc94i; fwV4W: $outerShdw = $twoCellAnchor->pic->spPr->children("\150\x74\164\160\72\57\x2f\163\x63\150\145\x6d\x61\x73\56\157\160\x65\x6e\x78\x6d\x6c\146\157\x72\x6d\141\x74\x73\56\x6f\x72\x67\x2f\x64\162\x61\x77\x69\156\x67\155\154\x2f\x32\x30\60\x36\x2f\155\141\151\x6e")->effectLst->outerShdw; goto Vd8Hp; O38lH: $blip = $twoCellAnchor->pic->blipFill->children("\150\x74\x74\160\72\x2f\57\163\x63\150\x65\x6d\x61\x73\x2e\157\x70\145\x6e\x78\155\154\146\x6f\162\155\141\164\163\56\157\x72\x67\x2f\144\162\x61\x77\x69\x6e\x67\155\x6c\57\62\60\60\x36\57\x6d\141\x69\156")->blip; goto tKot2; FWARf: if ($outerShdw) { goto SP67S; IlEib: $shadow->setDistance(PHPExcel_Shared_Drawing::EMUTopixels(self::getArrayItem($outerShdw->attributes(), "\x64\151\x73\x74"))); goto zHpSj; MkcGL: $shadow->setAlignment((string) self::getArrayItem($outerShdw->attributes(), "\x61\154\147\156")); goto OpX5L; zHpSj: $shadow->setDirection(PHPExcel_Shared_Drawing::angleToDegrees(self::getArrayItem($outerShdw->attributes(), "\144\x69\162"))); goto MkcGL; qN0NJ: $shadow->setBlurRadius(PHPExcel_Shared_Drawing::EMUTopixels(self::getArrayItem($outerShdw->attributes(), "\x62\x6c\165\162\x52\141\144"))); goto IlEib; zEySd: $shadow->setVisible(true); goto qN0NJ; OpX5L: $shadow->getColor()->setRGB(self::getArrayItem($outerShdw->srgbClr->attributes(), "\x76\141\154")); goto h6GOq; SP67S: $shadow = $objDrawing->getShadow(); goto zEySd; h6GOq: $shadow->setAlpha(self::getArrayItem($outerShdw->srgbClr->alpha->attributes(), "\x76\x61\154") / 1000); goto uKN4K; uKN4K: } goto YgEUy; Sc94i: $objDrawing->setPath("\172\151\160\72\x2f\x2f" . PHPExcel_Shared_File::realpath($pFilename) . "\x23" . $images[(string) self::getArrayItem($blip->attributes("\150\164\x74\160\72\x2f\57\163\x63\150\145\x6d\x61\x73\x2e\157\160\145\156\x78\x6d\154\146\157\162\x6d\x61\164\x73\x2e\157\x72\x67\57\157\146\x66\x69\x63\145\x44\157\x63\165\x6d\x65\x6e\164\57\62\x30\60\66\57\162\x65\x6c\141\164\151\x6f\156\x73\150\x69\x70\x73"), "\145\155\142\x65\x64")], false); goto nXo0L; BsH3R: } elseif ($this->includeCharts && $twoCellAnchor->graphicFrame) { goto PfrMv; Jdctd: $chartRef = $graphic->graphicData->children("\150\164\164\160\x3a\57\x2f\x73\143\150\x65\155\x61\163\56\x6f\x70\145\x6e\x78\155\154\x66\157\162\155\x61\164\x73\x2e\x6f\x72\x67\57\x64\x72\141\167\151\156\147\x6d\154\x2f\x32\60\x30\x36\x2f\143\x68\x61\162\164")->chart; goto YLXRF; GMnXa: $fromOffsetY = PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor->from->rowOff); goto RrxdW; geBim: $graphic = $twoCellAnchor->graphicFrame->children("\150\164\x74\x70\x3a\x2f\x2f\x73\x63\150\x65\x6d\141\163\56\x6f\160\x65\x6e\x78\x6d\154\x66\157\162\155\141\x74\163\56\157\x72\x67\57\144\x72\141\167\151\x6e\x67\155\154\57\62\60\x30\66\x2f\155\141\151\156")->graphic; goto Jdctd; G2RFo: $toOffsetX = PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor->to->colOff); goto qiHrp; PfrMv: $fromCoordinate = PHPExcel_Cell::stringFromColumnIndex((string) $twoCellAnchor->from->col) . ($twoCellAnchor->from->row + 1); goto meVxU; meVxU: $fromOffsetX = PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor->from->colOff); goto GMnXa; RrxdW: $toCoordinate = PHPExcel_Cell::stringFromColumnIndex((string) $twoCellAnchor->to->col) . ($twoCellAnchor->to->row + 1); goto G2RFo; qiHrp: $toOffsetY = PHPExcel_Shared_Drawing::EMUToPixels($twoCellAnchor->to->rowOff); goto geBim; FnvD1: $chartDetails[$docSheet->getTitle() . "\41" . $thisChart] = array("\x66\162\157\155\103\157\157\162\144\x69\x6e\x61\164\x65" => $fromCoordinate, "\146\162\157\155\x4f\146\x66\163\x65\164\130" => $fromOffsetX, "\x66\x72\x6f\155\x4f\x66\x66\163\x65\x74\131" => $fromOffsetY, "\x74\x6f\103\x6f\x6f\162\x64\x69\x6e\141\x74\145" => $toCoordinate, "\x74\157\117\x66\x66\163\x65\x74\x58" => $toOffsetX, "\164\157\117\x66\x66\163\145\164\x59" => $toOffsetY, "\167\x6f\x72\153\x73\x68\145\x65\x74\x54\x69\x74\154\x65" => $docSheet->getTitle()); goto F3hQl; YLXRF: $thisChart = (string) $chartRef->attributes("\150\164\164\160\72\x2f\x2f\x73\143\x68\x65\155\141\x73\56\x6f\x70\145\156\x78\x6d\x6c\146\x6f\x72\x6d\x61\164\163\x2e\x6f\x72\147\x2f\x6f\x66\146\151\143\145\x44\157\143\165\155\x65\156\x74\x2f\62\x30\60\x36\57\x72\145\154\x61\164\151\157\156\x73\x68\151\x70\x73"); goto FnvD1; F3hQl: } } } goto Ytx5O; ZP3Ov: $images = array(); goto VZaHY; Qy9vL: $fileDrawing = $drawings[(string) self::getArrayItem($drawing->attributes("\x68\164\x74\x70\x3a\57\57\x73\x63\150\145\x6d\x61\163\x2e\157\x70\x65\156\170\155\x6c\146\157\162\155\x61\x74\x73\x2e\157\162\x67\57\x6f\x66\146\151\143\x65\x44\x6f\143\165\x6d\145\156\x74\57\62\60\x30\66\x2f\162\145\154\141\164\x69\157\156\163\x68\151\x70\163"), "\x69\x64")]; goto eDCbH; eDCbH: $relsDrawing = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, dirname($fileDrawing) . "\x2f\x5f\162\145\x6c\163\57" . basename($fileDrawing) . "\56\162\145\x6c\x73")), "\123\x69\155\x70\154\x65\130\x4d\114\x45\154\145\155\x65\x6e\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto ZP3Ov; AB_Us: $xmlDrawing = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, $fileDrawing)), "\x53\151\x6d\160\154\x65\x58\115\x4c\x45\x6c\145\155\145\x6e\164", PHPExcel_Settings::getLibXmlLoaderOptions())->children("\150\164\x74\160\x3a\x2f\x2f\x73\143\x68\145\155\x61\163\56\x6f\160\145\156\x78\x6d\154\146\157\x72\155\x61\164\163\x2e\x6f\x72\x67\57\144\162\141\x77\x69\156\147\x6d\154\57\x32\x30\x30\x36\x2f\163\x70\x72\145\x61\x64\163\150\145\x65\164\x44\162\x61\x77\x69\156\147"); goto ibQAX; Ytx5O: } } goto GRVNq; oPb0v: $relsWorksheet = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, dirname("{$dir}\57{$fileWorksheet}") . "\57\x5f\x72\x65\154\163\x2f" . basename($fileWorksheet) . "\56\x72\x65\x6c\163")), "\123\x69\x6d\160\154\145\x58\115\114\x45\154\145\155\145\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto ADoa9; L0VuO: foreach ($relsWorksheet->Relationship as $ele) { if ($ele["\x54\171\160\145"] == "\150\x74\x74\x70\x3a\57\57\163\143\x68\x65\x6d\141\x73\56\x6f\x70\x65\156\170\x6d\154\x66\157\x72\155\141\x74\x73\56\x6f\162\147\57\x6f\x66\146\151\x63\x65\x44\157\143\165\155\145\156\164\x2f\62\x30\x30\66\x2f\162\145\x6c\141\164\x69\157\156\163\x68\151\160\163\x2f\x64\x72\x61\167\x69\156\147") { $drawings[(string) $ele["\111\144"]] = self::dirAdd("{$dir}\x2f{$fileWorksheet}", $ele["\x54\141\162\x67\x65\x74"]); } } goto e8sE0; GRVNq: } goto k78Nj; UkJZK: if (!$this->readDataOnly && $xmlSheet && $xmlSheet->sheetProtection) { foreach ($aKeys as $key) { $method = "\163\x65\x74" . ucfirst($key); $docSheet->getProtection()->{$method}(self::boolean((string) $xmlSheet->sheetProtection[$key])); } } goto zOPFY; jk0r8: if (isset($xmlSheet->printOptions) && !$this->readDataOnly) { goto JAXha; gWXsG: if (self::boolean((string) $xmlSheet->printOptions["\166\x65\162\x74\151\143\x61\154\103\x65\156\164\145\x72\x65\x64"])) { $docSheet->getPageSetup()->setVerticalCentered(true); } goto s7lXc; qJ071: if (self::boolean((string) $xmlSheet->printOptions["\x68\157\162\x69\x7a\157\x6e\164\x61\154\x43\145\x6e\x74\145\x72\x65\x64"])) { $docSheet->getPageSetup()->setHorizontalCentered(true); } goto gWXsG; JAXha: if (self::boolean((string) $xmlSheet->printOptions["\147\x72\x69\144\x4c\x69\x6e\x65\x73\x53\145\164"])) { $docSheet->setShowGridlines(true); } goto y_8N5; y_8N5: if (self::boolean((string) $xmlSheet->printOptions["\147\162\x69\x64\114\x69\x6e\145\x73"])) { $docSheet->setPrintGridlines(true); } goto qJ071; s7lXc: } goto bkmkc; zJ8EZ: $docSheet = $excel->createSheet(); goto WkfY6; tzGrQ: $xmlSheet = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$dir}\x2f{$fileWorksheet}")), "\x53\151\155\160\x6c\x65\130\115\x4c\105\x6c\145\x6d\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto nXF3b; WkfY6: $docSheet->setTitle((string) $eleSheet["\156\141\x6d\145"], false); goto VrT7a; nXF3b: $sharedFormulas = array(); goto UsH05; EfJjb: if ($xmlSheet && $xmlSheet->pageSetup && !$this->readDataOnly) { goto kP11H; xyYMa: if (isset($xmlSheet->pageSetup["\x70\x61\160\145\x72\123\151\x7a\x65"])) { $docPageSetup->setPaperSize(intval($xmlSheet->pageSetup["\x70\141\160\145\162\x53\x69\172\145"])); } goto XuhFh; kP11H: $docPageSetup = $docSheet->getPageSetup(); goto zfoia; XuhFh: if (isset($xmlSheet->pageSetup["\x73\143\141\154\145"])) { $docPageSetup->setScale(intval($xmlSheet->pageSetup["\x73\143\x61\154\x65"]), false); } goto NYGLl; NYGLl: if (isset($xmlSheet->pageSetup["\x66\x69\x74\x54\157\x48\x65\x69\x67\150\x74"]) && intval($xmlSheet->pageSetup["\146\151\164\x54\x6f\110\145\x69\147\150\164"]) >= 0) { $docPageSetup->setFitToHeight(intval($xmlSheet->pageSetup["\x66\x69\164\x54\x6f\x48\x65\x69\x67\x68\x74"]), false); } goto cZgM5; Ojj2n: if (isset($xmlSheet->pageSetup["\x66\151\162\163\x74\120\141\147\145\x4e\165\x6d\142\145\162"]) && isset($xmlSheet->pageSetup["\165\x73\145\106\x69\162\x73\x74\x50\141\147\x65\x4e\165\x6d\142\x65\x72"]) && self::boolean((string) $xmlSheet->pageSetup["\165\x73\x65\106\x69\x72\163\x74\x50\141\147\x65\x4e\x75\x6d\x62\x65\162"])) { $docPageSetup->setFirstPageNumber(intval($xmlSheet->pageSetup["\x66\x69\162\163\164\120\x61\147\x65\x4e\x75\x6d\x62\x65\162"])); } goto GP3ll; cZgM5: if (isset($xmlSheet->pageSetup["\x66\151\164\x54\157\x57\151\x64\x74\150"]) && intval($xmlSheet->pageSetup["\146\151\x74\124\x6f\127\x69\x64\x74\150"]) >= 0) { $docPageSetup->setFitToWidth(intval($xmlSheet->pageSetup["\146\x69\164\124\157\127\151\x64\x74\x68"]), false); } goto Ojj2n; zfoia: if (isset($xmlSheet->pageSetup["\157\162\151\x65\x6e\x74\141\x74\x69\x6f\156"])) { $docPageSetup->setOrientation((string) $xmlSheet->pageSetup["\x6f\162\151\x65\156\x74\x61\164\x69\x6f\156"]); } goto xyYMa; GP3ll: } goto j2OlF; Zs9td: if (isset($xmlSheet->sheetPr) && isset($xmlSheet->sheetPr->tabColor)) { if (isset($xmlSheet->sheetPr->tabColor["\x72\x67\x62"])) { $docSheet->getTabColor()->setARGB((string) $xmlSheet->sheetPr->tabColor["\162\x67\x62"]); } } goto CuQDt; zOPFY: if (!$this->readDataOnly && $xmlSheet && $xmlSheet->sheetProtection) { $docSheet->getProtection()->setPassword((string) $xmlSheet->sheetProtection["\x70\x61\x73\163\x77\x6f\x72\144"], true); if ($xmlSheet->protectedRanges->protectedRange) { foreach ($xmlSheet->protectedRanges->protectedRange as $protectedRange) { $docSheet->protectCells((string) $protectedRange["\x73\x71\x72\145\146"], (string) $protectedRange["\160\x61\163\163\x77\x6f\162\x64"], true); } } } goto vBLip; SYelz: if (!$this->readDataOnly && $xmlSheet && $xmlSheet->conditionalFormatting) { foreach ($xmlSheet->conditionalFormatting as $conditional) { foreach ($conditional->cfRule as $cfRule) { if (((string) $cfRule["\164\171\160\x65"] == PHPExcel_Style_Conditional::CONDITION_NONE || (string) $cfRule["\164\x79\160\145"] == PHPExcel_Style_Conditional::CONDITION_CELLIS || (string) $cfRule["\164\x79\160\x65"] == PHPExcel_Style_Conditional::CONDITION_CONTAINSTEXT || (string) $cfRule["\x74\171\160\145"] == PHPExcel_Style_Conditional::CONDITION_EXPRESSION) && isset($dxfs[intval($cfRule["\x64\x78\146\111\144"])])) { $conditionals[(string) $conditional["\163\x71\162\145\146"]][intval($cfRule["\160\162\x69\157\x72\151\164\x79"])] = $cfRule; } } } foreach ($conditionals as $ref => $cfRules) { goto UV6nA; ugnRo: foreach ($cfRules as $cfRule) { goto kghvn; DYIaP: if (count($cfRule->formula) > 1) { foreach ($cfRule->formula as $formula) { $objConditional->addCondition((string) $formula); } } else { $objConditional->addCondition((string) $cfRule->formula); } goto jXBcO; kghvn: $objConditional = new PHPExcel_Style_Conditional(); goto pav6U; C6gUS: $conditionalStyles[] = $objConditional; goto LuxUD; UwpYP: if ((string) $cfRule["\164\x65\170\x74"] != '') { $objConditional->setText((string) $cfRule["\164\x65\x78\164"]); } goto DYIaP; pav6U: $objConditional->setConditionType((string) $cfRule["\x74\171\x70\x65"]); goto xIMp_; jXBcO: $objConditional->setStyle(clone $dxfs[intval($cfRule["\x64\x78\x66\111\144"])]); goto C6gUS; xIMp_: $objConditional->setOperatorType((string) $cfRule["\157\160\145\162\x61\164\157\x72"]); goto UwpYP; LuxUD: } goto EGFQJ; UV6nA: ksort($cfRules); goto tKaEB; tKaEB: $conditionalStyles = array(); goto ugnRo; yZ9fJ: foreach ($cellBlocks as $cellBlock) { $docSheet->getStyle($cellBlock)->setConditionalStyles($conditionalStyles); } goto s76z1; EGFQJ: $cellBlocks = explode("\x20", str_replace("\44", '', strtoupper($ref))); goto yZ9fJ; s76z1: } } goto DTM8T; ETaJX: if (isset($xmlSheet->sheetViews) && isset($xmlSheet->sheetViews->sheetView)) { goto zZh0_; zZh0_: if (isset($xmlSheet->sheetViews->sheetView["\172\157\157\x6d\x53\143\141\x6c\x65"])) { $docSheet->getSheetView()->setZoomScale(intval($xmlSheet->sheetViews->sheetView["\172\x6f\x6f\155\x53\x63\x61\x6c\x65"])); } goto N0l3g; UVMVs: if (isset($xmlSheet->sheetViews->sheetView["\x76\x69\x65\x77"])) { $docSheet->getSheetView()->setView((string) $xmlSheet->sheetViews->sheetView["\166\x69\x65\x77"]); } goto Qi56L; N0l3g: if (isset($xmlSheet->sheetViews->sheetView["\x7a\157\x6f\x6d\123\x63\x61\x6c\145\116\x6f\x72\155\x61\x6c"])) { $docSheet->getSheetView()->setZoomScaleNormal(intval($xmlSheet->sheetViews->sheetView["\x7a\157\x6f\x6d\123\143\x61\154\145\116\x6f\x72\x6d\x61\154"])); } goto UVMVs; Qi56L: if (isset($xmlSheet->sheetViews->sheetView["\163\x68\157\167\x47\162\x69\144\114\x69\x6e\145\x73"])) { $docSheet->setShowGridLines(self::boolean((string) $xmlSheet->sheetViews->sheetView["\x73\150\x6f\x77\x47\162\x69\x64\x4c\151\x6e\145\x73"])); } goto jzzTb; WTBfp: if (isset($xmlSheet->sheetViews->sheetView["\162\151\x67\150\164\124\157\x4c\x65\146\164"])) { $docSheet->setRightToLeft(self::boolean((string) $xmlSheet->sheetViews->sheetView["\x72\x69\147\150\x74\124\157\114\x65\x66\x74"])); } goto DMI40; PDO5v: if (isset($xmlSheet->sheetViews->sheetView->selection)) { if (isset($xmlSheet->sheetViews->sheetView->selection["\x73\x71\x72\x65\x66"])) { goto UUI0c; UUI0c: $sqref = (string) $xmlSheet->sheetViews->sheetView->selection["\x73\161\x72\145\x66"]; goto AEi1w; QzNy8: $sqref = $sqref[0]; goto XG1KM; XG1KM: $docSheet->setSelectedCells($sqref); goto gsvXI; AEi1w: $sqref = explode("\x20", $sqref); goto QzNy8; gsvXI: } } goto L8gmk; jzzTb: if (isset($xmlSheet->sheetViews->sheetView["\163\x68\157\167\122\x6f\167\103\x6f\x6c\110\145\141\x64\x65\x72\163"])) { $docSheet->setShowRowColHeaders(self::boolean((string) $xmlSheet->sheetViews->sheetView["\x73\x68\x6f\167\122\x6f\167\x43\x6f\x6c\110\x65\141\x64\x65\x72\x73"])); } goto WTBfp; DMI40: if (isset($xmlSheet->sheetViews->sheetView->pane)) { if (isset($xmlSheet->sheetViews->sheetView->pane["\x74\157\x70\114\x65\146\x74\x43\145\154\154"])) { $docSheet->freezePane((string) $xmlSheet->sheetViews->sheetView->pane["\164\157\x70\x4c\x65\x66\164\103\x65\154\x6c"]); } else { goto ESv88; LkZ0w: $docSheet->freezePaneByColumnAndRow($xSplit, $ySplit); goto qIxDp; EfF2Z: $ySplit = 0; goto BTOOl; ygThL: if (isset($xmlSheet->sheetViews->sheetView->pane["\171\123\x70\x6c\151\x74"])) { $ySplit = 1 + intval($xmlSheet->sheetViews->sheetView->pane["\x79\x53\160\x6c\151\x74"]); } goto LkZ0w; BTOOl: if (isset($xmlSheet->sheetViews->sheetView->pane["\170\x53\160\154\x69\164"])) { $xSplit = 1 + intval($xmlSheet->sheetViews->sheetView->pane["\x78\x53\160\154\151\164"]); } goto ygThL; ESv88: $xSplit = 0; goto EfF2Z; qIxDp: } } goto PDO5v; L8gmk: } goto Zs9td; bkmkc: if ($xmlSheet && $xmlSheet->sheetData && $xmlSheet->sheetData->row) { foreach ($xmlSheet->sheetData->row as $row) { goto SQwDU; u2EiA: if (self::boolean($row["\x68\x69\144\144\x65\x6e"]) && !$this->readDataOnly) { $docSheet->getRowDimension(intval($row["\x72"]))->setVisible(false); } goto TaVuP; rW0s9: foreach ($row->c as $c) { goto FzVCq; F3Gqb: if ($calculatedValue !== null) { $cell->setCalculatedValue($calculatedValue); } goto P1gYV; FzVCq: $r = (string) $c["\x72"]; goto C7pfV; CdMaG: $cell = $docSheet->getCell($r); goto bdcrT; LyTO6: $calculatedValue = null; goto NVwcy; JTM3q: switch ($cellDataType) { case "\x73": if ((string) $c->v != '') { $value = $sharedStrings[intval($c->v)]; if ($value instanceof PHPExcel_RichText) { $value = clone $value; } } else { $value = ''; } break; case "\142": if (!isset($c->f)) { $value = self::castToBoolean($c); } else { $this->castToFormula($c, $r, $cellDataType, $value, $calculatedValue, $sharedFormulas, "\143\x61\x73\164\x54\157\102\x6f\x6f\154\x65\141\x6e"); if (isset($c->f["\x74"])) { goto NWVN6; NWVN6: $att = array(); goto eb5xI; eb5xI: $att = $c->f; goto ZW7U2; ZW7U2: $docSheet->getCell($r)->setFormulaAttributes($att); goto SAyVf; SAyVf: } } break; case "\x69\x6e\154\151\x6e\x65\123\x74\162": if (isset($c->f)) { $this->castToFormula($c, $r, $cellDataType, $value, $calculatedValue, $sharedFormulas, "\x63\x61\x73\x74\124\157\105\x72\162\157\162"); } else { $value = $this->parseRichText($c->is); } break; case "\x65": if (!isset($c->f)) { $value = self::castToError($c); } else { $this->castToFormula($c, $r, $cellDataType, $value, $calculatedValue, $sharedFormulas, "\143\141\x73\x74\x54\157\105\162\162\x6f\x72"); } break; default: if (!isset($c->f)) { $value = self::castToString($c); } else { $this->castToFormula($c, $r, $cellDataType, $value, $calculatedValue, $sharedFormulas, "\x63\x61\163\164\x54\x6f\x53\x74\x72\151\156\x67"); } break; } goto jQksW; C7pfV: $cellDataType = (string) $c["\x74"]; goto tG1Fn; tG1Fn: $value = null; goto LyTO6; P1gYV: if ($c["\163"] && !$this->readDataOnly) { $cell->setXfIndex(isset($styles[intval($c["\163"])]) ? intval($c["\x73"]) : 0); } goto xZafR; jQksW: if (is_numeric($value) && $cellDataType != "\x73") { if ($value == (int) $value) { $value = (int) $value; } elseif ($value == (float) $value) { $value = (float) $value; } elseif ($value == (double) $value) { $value = (double) $value; } } goto oQ6dP; bdcrT: if ($cellDataType != '') { $cell->setValueExplicit($value, $cellDataType); } else { $cell->setValue($value); } goto F3Gqb; NVwcy: if ($this->getReadFilter() !== null) { $coordinates = PHPExcel_Cell::coordinateFromString($r); if (!$this->getReadFilter()->readCell($coordinates[0], $coordinates[1], $docSheet->getTitle())) { continue; } } goto JTM3q; oQ6dP: if ($value instanceof PHPExcel_RichText && $this->readDataOnly) { $value = $value->getPlainText(); } goto CdMaG; xZafR: } goto RW4yv; uAfeP: if ($row["\x73"] && !$this->readDataOnly) { $docSheet->getRowDimension(intval($row["\162"]))->setXfIndex(intval($row["\x73"])); } goto rW0s9; TaVuP: if (self::boolean($row["\x63\157\x6c\154\141\x70\x73\x65\144"])) { $docSheet->getRowDimension(intval($row["\162"]))->setCollapsed(true); } goto xicCD; SQwDU: if ($row["\150\x74"] && !$this->readDataOnly) { $docSheet->getRowDimension(intval($row["\x72"]))->setRowHeight(floatval($row["\x68\x74"])); } goto u2EiA; xicCD: if ($row["\157\165\x74\x6c\x69\156\x65\x4c\x65\166\x65\154"] > 0) { $docSheet->getRowDimension(intval($row["\162"]))->setOutlineLevel(intval($row["\157\x75\x74\x6c\x69\x6e\x65\x4c\x65\166\145\x6c"])); } goto uAfeP; RW4yv: } } goto X3bvn; TqRZh: $hyperlinks = array(); goto T_RB3; zpZWF: ++$sheetId; goto uIJtW; uIJtW: } if ($xmlWorkbook->definedNames) { foreach ($xmlWorkbook->definedNames->definedName as $definedName) { goto r061Z; IKpxU: if ((string) $definedName["\x6c\x6f\143\141\154\123\150\x65\145\164\x49\144"] != '') { switch ((string) $definedName["\x6e\x61\x6d\145"]) { case "\137\x78\x6c\x6e\155\56\137\106\x69\154\164\x65\x72\104\x61\x74\141\142\x61\163\145": case "\x5f\x78\x6c\x6e\x6d\56\x50\162\151\x6e\x74\137\124\151\x74\154\x65\163": case "\x5f\x78\x6c\x6e\x6d\56\120\x72\151\156\164\x5f\101\162\145\x61": break; default: if ($mapSheetId[(int) $definedName["\154\x6f\143\141\154\123\x68\145\x65\x74\x49\x64"]] !== null) { $range = explode("\x21", (string) $definedName); if (count($range) == 2) { goto vQ4zv; rOXKr: $range[0] = str_replace("\47", '', $range[0]); goto ACGHr; ACGHr: if ($worksheet = $docSheet->getParent()->getSheetByName($range[0])) { goto dTiHN; dTiHN: $extractedRange = str_replace("\44", '', $range[1]); goto IC3Vg; TGu7Q: $excel->addNamedRange(new PHPExcel_NamedRange((string) $definedName["\156\x61\155\145"], $worksheet, $extractedRange, true, $scope)); goto ldUTn; IC3Vg: $scope = $docSheet->getParent()->getSheet($mapSheetId[(int) $definedName["\x6c\x6f\143\x61\154\x53\150\x65\x65\x74\111\x64"]]); goto TGu7Q; ldUTn: } goto Hay_i; vQ4zv: $range[0] = str_replace("\x27\47", "\x27", $range[0]); goto rOXKr; Hay_i: } } break; } } elseif (!isset($definedName["\x6c\x6f\143\141\x6c\123\150\x65\145\164\111\144"])) { goto UC6vB; UC6vB: $locatedSheet = null; goto ogAPI; ydeGj: if ($locatedSheet !== null) { $excel->addNamedRange(new PHPExcel_NamedRange((string) $definedName["\156\141\155\145"], $locatedSheet, $extractedRange, false)); } goto Y8d1i; ogAPI: $extractedSheetName = ''; goto rQEJU; rQEJU: if (strpos((string) $definedName, "\x21") !== false) { goto nLNX2; nLNX2: $extractedSheetName = PHPExcel_Worksheet::extractSheetTitle((string) $definedName, true); goto cYXYl; d5uKr: $locatedSheet = $excel->getSheetByName($extractedSheetName); goto Nq2hO; gefjU: $extractedRange = isset($range[1]) ? $range[1] : $range[0]; goto i1WDk; Nq2hO: $range = explode("\x21", $extractedRange); goto gefjU; cYXYl: $extractedSheetName = $extractedSheetName[0]; goto d5uKr; i1WDk: } goto ydeGj; Y8d1i: } goto bvtZI; xfHEh: if (($spos = strpos($extractedRange, "\x21")) !== false) { $extractedRange = substr($extractedRange, 0, $spos) . str_replace("\44", '', substr($extractedRange, $spos)); } else { $extractedRange = str_replace("\x24", '', $extractedRange); } goto D0hx7; r061Z: $extractedRange = (string) $definedName; goto aTx46; aTx46: $extractedRange = preg_replace("\57\x27\50\x5c\x77\x2b\x29\47\x5c\41\x2f", '', $extractedRange); goto xfHEh; D0hx7: if (stripos((string) $definedName, "\43\x52\x45\106\x21") !== false || $extractedRange == '') { continue; } goto IKpxU; bvtZI: } } } goto ypJV1; shQni: $xmlWorkbook = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$rel["\124\x61\162\147\x65\164"]}")), "\123\151\x6d\160\x6c\145\x58\x4d\x4c\105\x6c\145\155\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto BkJKZ; fdhIp: $dir = dirname($rel["\x54\141\162\147\x65\x74"]); goto K2Mbn; KqNnx: $styles = array(); goto I2myK; kLc60: $xpath = self::getArrayItem($relsWorkbook->xpath("\162\x65\154\x3a\x52\x65\x6c\141\164\x69\157\156\163\x68\x69\160\x5b\100\124\171\160\145\x3d\x27\x68\x74\x74\160\x3a\x2f\x2f\x73\x63\150\x65\155\x61\x73\56\157\x70\x65\x6e\x78\155\x6c\x66\157\162\155\141\x74\x73\56\157\162\147\57\157\146\x66\151\143\x65\x44\157\143\x75\155\145\156\164\x2f\x32\x30\x30\66\x2f\162\x65\154\141\x74\151\157\156\163\x68\151\160\x73\x2f\163\164\x79\x6c\x65\x73\x27\x5d")); goto uqAqP; fgCX4: $xpath = self::getArrayItem($relsWorkbook->xpath("\x72\145\x6c\x3a\122\x65\x6c\x61\x74\x69\x6f\x6e\x73\150\x69\x70\x5b\100\x54\171\x70\145\x3d\47\150\x74\x74\160\72\57\x2f\163\x63\150\145\155\x61\163\56\157\160\145\156\x78\x6d\x6c\146\x6f\162\x6d\141\164\163\56\157\x72\147\57\x6f\x66\x66\151\143\145\104\x6f\x63\x75\x6d\145\x6e\x74\x2f\62\x30\x30\x36\x2f\162\145\x6c\141\164\x69\157\156\x73\x68\x69\x70\163\57\x73\150\x61\x72\x65\144\123\x74\x72\x69\156\147\x73\x27\x5d")); goto TlSy7; K2Mbn: $relsWorkbook = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$dir}\x2f\137\162\x65\x6c\x73\57" . basename($rel["\x54\x61\162\147\145\x74"]) . "\x2e\x72\145\x6c\163")), "\x53\151\155\160\154\x65\x58\115\114\105\154\x65\155\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto ZgaLZ; cUtfd: $sharedStrings = array(); goto fgCX4; I2myK: $cellStyles = array(); goto kLc60; BmK0S: $dxfs = array(); goto J7MNC; ypJV1: if (!$this->readDataOnly || !empty($this->loadSheetsOnly)) { $activeTab = intval($xmlWorkbook->bookViews->workbookView["\x61\x63\x74\x69\x76\x65\124\x61\x62"]); if (isset($mapSheetId[$activeTab]) && $mapSheetId[$activeTab] !== null) { $excel->setActiveSheetIndex($mapSheetId[$activeTab]); } else { if ($excel->getSheetCount() == 0) { $excel->createSheet(); } $excel->setActiveSheetIndex(0); } } goto DgUu3; fkTDC: $macros = $customUI = null; goto Ou7_E; J7MNC: if (!$this->readDataOnly && $xmlStyles) { if ($xmlStyles->dxfs) { foreach ($xmlStyles->dxfs->dxf as $dxf) { goto EL6QK; e369h: self::readStyle($style, $dxf); goto Mxk0v; EL6QK: $style = new PHPExcel_Style(false, true); goto e369h; Mxk0v: $dxfs[] = $style; goto z_IhT; z_IhT: } } if ($xmlStyles->cellStyles) { foreach ($xmlStyles->cellStyles->cellStyle as $cellStyle) { if (intval($cellStyle["\142\x75\x69\154\164\151\x6e\x49\144"]) == 0) { if (isset($cellStyles[intval($cellStyle["\x78\x66\111\x64"])])) { $style = new PHPExcel_Style(); self::readStyle($style, $cellStyles[intval($cellStyle["\x78\x66\111\x64"])]); } } } } } goto shQni; Zd0BH: $charts = $chartDetails = array(); goto CB5ks; BkJKZ: if ($xmlWorkbook->workbookPr) { PHPExcel_Shared_Date::setExcelCalendar(PHPExcel_Shared_Date::CALENDAR_WINDOWS_1900); if (isset($xmlWorkbook->workbookPr["\144\x61\x74\x65\61\x39\x30\x34"])) { if (self::boolean((string) $xmlWorkbook->workbookPr["\144\x61\x74\x65\61\71\60\64"])) { PHPExcel_Shared_Date::setExcelCalendar(PHPExcel_Shared_Date::CALENDAR_MAC_1904); } } } goto T5AIa; T5AIa: $sheetId = 0; goto acmmN; DgUu3: break; goto I_Nop; YNnQt: if (isset($numFmts) && $numFmts !== null) { $numFmts->registerXPathNamespace("\163\155\x6c", "\150\x74\164\160\x3a\x2f\57\x73\x63\150\145\x6d\x61\163\56\x6f\160\145\x6e\170\155\x6c\x66\x6f\x72\155\x61\164\163\x2e\x6f\x72\x67\57\x73\160\x72\x65\x61\144\163\150\x65\145\164\155\x6c\x2f\x32\60\x30\66\57\155\141\151\x6e"); } goto CWRhn; Ou7_E: foreach ($relsWorkbook->Relationship as $ele) { switch ($ele["\x54\171\x70\145"]) { case "\x68\x74\x74\160\x3a\57\57\163\x63\x68\x65\155\x61\163\56\x6f\160\x65\156\x78\x6d\x6c\146\x6f\162\155\x61\x74\x73\x2e\x6f\x72\x67\x2f\157\146\x66\x69\143\145\x44\x6f\x63\165\x6d\145\x6e\x74\57\62\x30\60\66\57\162\x65\x6c\x61\164\151\157\x6e\163\150\151\160\163\57\x77\x6f\x72\x6b\163\150\145\x65\164": $worksheets[(string) $ele["\x49\x64"]] = $ele["\x54\141\162\147\x65\164"]; break; case "\x68\164\164\160\x3a\x2f\57\x73\143\x68\x65\155\x61\x73\x2e\155\x69\143\162\157\163\157\x66\x74\x2e\143\x6f\x6d\57\x6f\146\x66\x69\x63\145\57\x32\x30\60\x36\x2f\162\145\154\x61\x74\151\x6f\x6e\x73\150\x69\x70\163\x2f\x76\x62\x61\x50\x72\x6f\152\x65\x63\164": $macros = $ele["\x54\x61\162\x67\x65\164"]; break; } } goto NTKRX; ngYaw: $countSkippedSheets = 0; goto uxl2j; sSppr: $numFmts = null; goto Hi2QK; ZgaLZ: $relsWorkbook->registerXPathNamespace("\x72\145\154", "\150\x74\x74\x70\x3a\57\x2f\163\143\x68\145\x6d\x61\x73\x2e\x6f\160\145\156\170\155\x6c\x66\x6f\x72\x6d\141\164\163\56\x6f\162\x67\57\x70\x61\143\x6b\141\147\x65\x2f\x32\60\60\66\x2f\162\145\154\x61\164\x69\157\156\163\150\151\160\163"); goto cUtfd; pDces: if (isset($xmlStrings) && isset($xmlStrings->si)) { foreach ($xmlStrings->si as $val) { if (isset($val->t)) { $sharedStrings[] = PHPExcel_Shared_String::ControlCharacterOOXML2PHP((string) $val->t); } elseif (isset($val->r)) { $sharedStrings[] = $this->parseRichText($val); } } } goto xkk_4; acmmN: $oldSheetId = -1; goto ngYaw; NTKRX: if (!is_null($macros)) { $macrosCode = $this->getFromZipArchive($zip, "\170\x6c\57\x76\x62\141\120\x72\x6f\x6a\x65\143\164\56\142\151\156"); if ($macrosCode !== false) { goto AtA9D; mjRm9: $Certificate = $this->getFromZipArchive($zip, "\x78\154\57\x76\142\x61\x50\x72\x6f\x6a\145\143\x74\x53\x69\x67\156\141\164\x75\x72\145\56\142\151\156"); goto It_Sl; tgmb5: $excel->setHasMacros(true); goto mjRm9; AtA9D: $excel->setMacrosCode($macrosCode); goto tgmb5; It_Sl: if ($Certificate !== false) { $excel->setMacrosCertificate($Certificate); } goto NuKCl; NuKCl: } } goto KqNnx; xkk_4: $worksheets = array(); goto fkTDC; uqAqP: $xmlStyles = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$dir}\x2f{$xpath["\x54\141\x72\147\x65\164"]}")), "\x53\x69\155\x70\154\x65\x58\x4d\x4c\x45\154\x65\155\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto sSppr; TlSy7: $xmlStrings = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "{$dir}\x2f{$xpath["\x54\x61\162\x67\x65\164"]}")), "\x53\x69\x6d\x70\154\x65\130\115\x4c\x45\154\x65\155\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto pDces; CWRhn: if (!$this->readDataOnly && $xmlStyles) { foreach ($xmlStyles->cellXfs->xf as $xf) { goto tv_u2; Yu78i: self::readStyle($objStyle, $style); goto WMsFo; WMsFo: $excel->addCellXf($objStyle); goto rTAwV; tv_u2: $numFmt = PHPExcel_Style_NumberFormat::FORMAT_GENERAL; goto kDkNm; kDkNm: if ($xf["\x6e\165\x6d\106\x6d\164\111\144"]) { if (isset($numFmts)) { $tmpNumFmt = self::getArrayItem($numFmts->xpath("\163\x6d\154\72\x6e\x75\x6d\106\155\x74\133\x40\156\165\x6d\106\x6d\164\x49\144\75{$xf["\156\x75\x6d\106\x6d\x74\x49\144"]}\x5d")); if (isset($tmpNumFmt["\146\x6f\162\x6d\x61\x74\x43\157\144\145"])) { $numFmt = (string) $tmpNumFmt["\146\157\x72\x6d\141\164\103\x6f\144\x65"]; } } if ((int) $xf["\156\x75\x6d\106\x6d\164\111\x64"] < 164 && PHPExcel_Style_NumberFormat::builtInFormatCode((int) $xf["\x6e\165\155\106\x6d\x74\x49\144"]) !== '') { $numFmt = PHPExcel_Style_NumberFormat::builtInFormatCode((int) $xf["\156\165\155\x46\x6d\x74\x49\x64"]); } } goto H4dij; Nr8vQ: $styles[] = $style; goto pEUnW; G4oIk: if (isset($xf["\161\x75\x6f\164\145\x50\x72\145\x66\151\170"])) { $quotePrefix = (bool) $xf["\161\165\157\x74\145\120\162\x65\x66\151\x78"]; } goto FWfxc; pEUnW: $objStyle = new PHPExcel_Style(); goto Yu78i; FWfxc: $style = (object) array("\x6e\x75\x6d\106\155\164" => $numFmt, "\146\157\x6e\164" => $xmlStyles->fonts->font[intval($xf["\x66\x6f\x6e\x74\x49\144"])], "\x66\x69\x6c\x6c" => $xmlStyles->fills->fill[intval($xf["\x66\151\x6c\154\111\144"])], "\x62\x6f\162\x64\145\x72" => $xmlStyles->borders->border[intval($xf["\142\157\x72\144\145\162\x49\144"])], "\141\154\x69\147\x6e\x6d\x65\156\x74" => $xf->alignment, "\160\162\x6f\164\145\143\x74\151\x6f\x6e" => $xf->protection, "\161\165\x6f\x74\x65\120\162\x65\146\151\170" => $quotePrefix); goto Nr8vQ; H4dij: $quotePrefix = false; goto G4oIk; rTAwV: } foreach ($xmlStyles->cellStyleXfs->xf as $xf) { goto zaASE; Kz3zC: if ($numFmts && $xf["\156\165\x6d\106\155\x74\x49\x64"]) { $tmpNumFmt = self::getArrayItem($numFmts->xpath("\163\155\x6c\x3a\x6e\x75\155\106\155\x74\133\x40\x6e\165\x6d\x46\155\x74\111\144\75{$xf["\x6e\x75\x6d\x46\x6d\x74\111\x64"]}\x5d")); if (isset($tmpNumFmt["\x66\x6f\162\x6d\x61\164\103\x6f\144\145"])) { $numFmt = (string) $tmpNumFmt["\146\157\162\155\141\x74\103\x6f\x64\x65"]; } elseif ((int) $xf["\x6e\x75\x6d\106\x6d\x74\111\144"] < 165) { $numFmt = PHPExcel_Style_NumberFormat::builtInFormatCode((int) $xf["\x6e\x75\x6d\x46\155\x74\x49\x64"]); } } goto lN1sJ; IufKa: $objStyle = new PHPExcel_Style(); goto q7KiN; q7KiN: self::readStyle($objStyle, $cellStyle); goto oNb57; lN1sJ: $cellStyle = (object) array("\156\x75\155\x46\x6d\x74" => $numFmt, "\x66\x6f\x6e\164" => $xmlStyles->fonts->font[intval($xf["\146\x6f\156\x74\111\x64"])], "\x66\x69\154\x6c" => $xmlStyles->fills->fill[intval($xf["\x66\x69\x6c\154\x49\x64"])], "\x62\157\162\144\145\x72" => $xmlStyles->borders->border[intval($xf["\142\157\x72\x64\x65\162\111\x64"])], "\141\x6c\x69\147\x6e\x6d\145\x6e\x74" => $xf->alignment, "\160\162\x6f\x74\x65\143\164\x69\157\x6e" => $xf->protection, "\161\165\x6f\x74\x65\120\162\x65\146\x69\x78" => $quotePrefix); goto QYDjW; oNb57: $excel->addCellStyleXf($objStyle); goto Q2j4g; QYDjW: $cellStyles[] = $cellStyle; goto IufKa; zaASE: $numFmt = PHPExcel_Style_NumberFormat::FORMAT_GENERAL; goto Kz3zC; Q2j4g: } } goto BmK0S; Hi2QK: if ($xmlStyles && $xmlStyles->numFmts[0]) { $numFmts = $xmlStyles->numFmts[0]; } goto YNnQt; uxl2j: $mapSheetId = array(); goto Zd0BH; I_Nop: } } goto NA5gC; DmEQS: $zip->close(); goto Wkzs0; eS4ny: foreach ($wbRels->Relationship as $rel) { switch ($rel["\124\x79\x70\145"]) { case "\x68\164\x74\x70\72\x2f\x2f\163\143\150\145\x6d\141\x73\x2e\157\160\145\x6e\x78\155\x6c\x66\x6f\x72\155\141\164\163\56\157\x72\x67\57\x6f\146\x66\151\143\145\104\x6f\x63\x75\155\145\156\x74\x2f\62\x30\60\x36\57\162\145\x6c\x61\164\x69\157\x6e\163\150\x69\x70\x73\57\164\150\x65\x6d\x65": goto Pg3AX; l4ZUw: $themeOrderAdditional = count($themeOrderArray); goto kJq_q; jU2Xt: break; goto U2UZl; Pg3AX: $themeOrderArray = array("\154\x74\61", "\x64\153\61", "\x6c\164\x32", "\x64\153\62"); goto l4ZUw; nr4wK: if (is_object($xmlTheme)) { goto Co5ev; ojXm2: foreach ($colourScheme as $k => $xmlColour) { goto v48t_; v48t_: $themePos = array_search($k, $themeOrderArray); goto WaWyu; WaWyu: if ($themePos === false) { $themePos = $themeOrderAdditional++; } goto Qn6_M; Qn6_M: if (isset($xmlColour->sysClr)) { $xmlColourData = $xmlColour->sysClr->attributes(); $themeColours[$themePos] = $xmlColourData["\154\x61\x73\x74\x43\x6c\x72"]; } elseif (isset($xmlColour->srgbClr)) { $xmlColourData = $xmlColour->srgbClr->attributes(); $themeColours[$themePos] = $xmlColourData["\x76\x61\x6c"]; } goto ZoUPC; ZoUPC: } goto VXlFp; JmSk9: $xmlTheme = $xmlTheme->children("\150\164\x74\x70\72\57\x2f\x73\x63\150\145\x6d\x61\163\56\157\160\x65\x6e\x78\x6d\x6c\146\157\x72\x6d\x61\164\163\56\x6f\162\147\57\x64\162\141\x77\x69\156\147\x6d\154\57\62\60\x30\66\x2f\155\141\x69\x6e"); goto qE5w1; MyiGa: $colourSchemeName = (string) $colourScheme["\156\141\155\x65"]; goto vBB7i; Co5ev: $xmlThemeName = $xmlTheme->attributes(); goto JmSk9; VXlFp: self::$theme = new PHPExcel_Reader_Excel2007_Theme($themeName, $colourSchemeName, $themeColours); goto MArBz; qE5w1: $themeName = (string) $xmlThemeName["\156\x61\x6d\145"]; goto x7inB; vBB7i: $colourScheme = $xmlTheme->themeElements->clrScheme->children("\150\x74\x74\160\72\57\x2f\163\x63\x68\145\155\141\x73\56\x6f\x70\145\156\170\155\x6c\x66\157\162\155\141\x74\x73\56\157\x72\147\x2f\x64\x72\141\x77\151\156\x67\155\x6c\x2f\62\60\x30\66\x2f\x6d\141\x69\x6e"); goto zjdcw; x7inB: $colourScheme = $xmlTheme->themeElements->clrScheme->attributes(); goto MyiGa; zjdcw: $themeColours = array(); goto ojXm2; MArBz: } goto jU2Xt; kJq_q: $xmlTheme = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\170\x6c\57{$rel["\x54\x61\x72\147\145\x74"]}")), "\x53\151\155\x70\154\145\x58\x4d\x4c\105\x6c\x65\x6d\x65\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto nr4wK; U2UZl: } } goto G0_1F; z1QfW: $zipClass = PHPExcel_Settings::getZipClass(); goto HLyMM; MNfbq: $zip->open($pFilename); goto m7yy0; NnS8s: $excel = new PHPExcel(); goto f1EZ6; f1EZ6: $excel->removeSheetByIndex(0); goto Q8e7t; HLyMM: $zip = new $zipClass(); goto MNfbq; NA5gC: if (!$this->readDataOnly) { $contentTypes = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\x5b\103\x6f\x6e\x74\x65\156\x74\137\x54\171\160\x65\x73\135\x2e\170\x6d\x6c")), "\x53\x69\155\x70\154\x65\x58\115\114\x45\154\145\x6d\145\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); foreach ($contentTypes->Override as $contentType) { switch ($contentType["\103\x6f\x6e\164\x65\x6e\164\124\x79\x70\145"]) { case "\x61\x70\x70\154\x69\143\x61\164\x69\x6f\x6e\x2f\166\x6e\144\56\157\160\x65\156\170\155\x6c\146\x6f\162\155\x61\x74\163\55\157\x66\146\151\143\x65\144\x6f\143\165\155\145\x6e\164\x2e\x64\162\x61\x77\x69\156\147\155\154\x2e\x63\x68\141\x72\x74\x2b\170\x6d\154": if ($this->includeCharts) { goto wlBTk; wlBTk: $chartEntryRef = ltrim($contentType["\x50\x61\162\x74\116\x61\155\x65"], "\x2f"); goto wqOVP; wqOVP: $chartElements = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, $chartEntryRef)), "\123\151\x6d\160\154\x65\130\x4d\x4c\105\x6c\145\x6d\145\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto cK23Z; cK23Z: $objChart = PHPExcel_Reader_Excel2007_Chart::readChart($chartElements, basename($chartEntryRef, "\x2e\170\x6d\x6c")); goto Z5A2O; Z5A2O: if (isset($charts[$chartEntryRef])) { $chartPositionRef = $charts[$chartEntryRef]["\x73\150\145\x65\164"] . "\x21" . $charts[$chartEntryRef]["\x69\144"]; if (isset($chartDetails[$chartPositionRef])) { goto ovvsy; ovvsy: $excel->getSheetByName($charts[$chartEntryRef]["\x73\150\145\x65\x74"])->addChart($objChart); goto h3odE; nH3Mb: $objChart->setTopLeftPosition($chartDetails[$chartPositionRef]["\146\x72\157\x6d\x43\157\x6f\162\x64\x69\156\141\164\145"], $chartDetails[$chartPositionRef]["\146\162\x6f\x6d\x4f\146\x66\163\x65\x74\x58"], $chartDetails[$chartPositionRef]["\x66\x72\157\155\x4f\146\146\x73\x65\x74\131"]); goto VvtTL; VvtTL: $objChart->setBottomRightPosition($chartDetails[$chartPositionRef]["\x74\157\x43\x6f\157\162\x64\151\156\x61\x74\145"], $chartDetails[$chartPositionRef]["\164\157\117\x66\146\163\x65\x74\x58"], $chartDetails[$chartPositionRef]["\164\157\x4f\x66\146\x73\x65\x74\x59"]); goto nRAXH; h3odE: $objChart->setWorksheet($excel->getSheetByName($charts[$chartEntryRef]["\x73\150\x65\x65\164"])); goto nH3Mb; nRAXH: } } goto DGSIa; DGSIa: } } } } goto DmEQS; m7yy0: $wbRels = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\x78\154\x2f\x5f\x72\x65\154\x73\x2f\167\157\162\x6b\x62\x6f\157\153\56\170\x6d\154\56\x72\145\154\163")), "\x53\x69\x6d\x70\154\145\x58\115\x4c\105\154\145\155\145\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); goto eS4ny; G0_1F: $rels = simplexml_load_string($this->securityScan($this->getFromZipArchive($zip, "\137\162\145\154\x73\x2f\56\162\x65\x6c\x73")), "\123\x69\155\x70\154\145\130\115\x4c\x45\154\145\155\145\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto nFLFF; Wkzs0: return $excel; goto UF06i; Q8e7t: if (!$this->readDataOnly) { $excel->removeCellStyleXfByIndex(0); $excel->removeCellXfByIndex(0); } goto z1QfW; UF06i: } private static function readColor($color, $background = false) { goto Pqzly; l5_L8: return "\x46\106\x30\x30\60\x30\x30\60"; goto G9ALN; wT_iE: if ($background) { return "\106\106\x46\x46\x46\x46\106\106"; } goto l5_L8; Pqzly: if (isset($color["\x72\x67\142"])) { return (string) $color["\162\x67\142"]; } elseif (isset($color["\x69\156\144\145\x78\145\x64"])) { return PHPExcel_Style_Color::indexedColor($color["\151\x6e\x64\x65\x78\145\144"] - 7, $background)->getARGB(); } elseif (isset($color["\x74\150\x65\x6d\x65"])) { if (self::$theme !== null) { goto Jo5Rp; SjGZk: return "\106\x46" . $returnColour; goto paimI; gt1zn: if (isset($color["\164\x69\156\x74"])) { $tintAdjust = (float) $color["\164\151\x6e\x74"]; $returnColour = PHPExcel_Style_Color::changeBrightness($returnColour, $tintAdjust); } goto SjGZk; Jo5Rp: $returnColour = self::$theme->getColourByIndex((int) $color["\x74\x68\x65\155\145"]); goto gt1zn; paimI: } } goto wT_iE; G9ALN: } private static function readStyle($docStyle, $style) { goto DInLU; ovrw6: if (isset($style->font)) { goto oGXFU; dc6vs: if (isset($style->font->b)) { $docStyle->getFont()->setBold(!isset($style->font->b["\166\141\154"]) || self::boolean((string) $style->font->b["\166\x61\154"])); } goto kulSO; zhSbX: if (isset($style->font->u) && !isset($style->font->u["\166\x61\154"])) { $docStyle->getFont()->setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE); } elseif (isset($style->font->u) && isset($style->font->u["\x76\x61\154"])) { $docStyle->getFont()->setUnderline((string) $style->font->u["\x76\141\154"]); } goto dUoEv; dUoEv: if (isset($style->font->vertAlign) && isset($style->font->vertAlign["\x76\x61\x6c"])) { goto hg183; NR1Dh: if ($vertAlign == "\x73\165\142\163\x63\x72\151\160\x74") { $docStyle->getFont()->setSubScript(true); } goto pyOOa; TdEmk: if ($vertAlign == "\163\165\160\145\162\163\143\162\151\x70\164") { $docStyle->getFont()->setSuperScript(true); } goto NR1Dh; hg183: $vertAlign = strtolower((string) $style->font->vertAlign["\166\141\x6c"]); goto TdEmk; pyOOa: } goto HLUyR; H7mOv: if (isset($style->font->strike)) { $docStyle->getFont()->setStrikethrough(!isset($style->font->strike["\166\141\x6c"]) || self::boolean((string) $style->font->strike["\x76\141\154"])); } goto JOvew; JOvew: $docStyle->getFont()->getColor()->setARGB(self::readColor($style->font->color)); goto zhSbX; u8voE: $docStyle->getFont()->setSize((string) $style->font->sz["\166\x61\154"]); goto dc6vs; oGXFU: $docStyle->getFont()->setName((string) $style->font->name["\x76\141\x6c"]); goto u8voE; kulSO: if (isset($style->font->i)) { $docStyle->getFont()->setItalic(!isset($style->font->i["\x76\141\x6c"]) || self::boolean((string) $style->font->i["\x76\x61\x6c"])); } goto H7mOv; HLUyR: } goto Hhj6Q; VoSIw: if (isset($style->border)) { goto KEbfg; V6fT5: self::readBorder($docStyle->getBorders()->getLeft(), $style->border->left); goto mEtk_; PCRKV: self::readBorder($docStyle->getBorders()->getTop(), $style->border->top); goto mwmRZ; jtKvL: $diagonalDown = self::boolean((string) $style->border["\144\x69\x61\147\x6f\x6e\141\x6c\104\x6f\167\x6e"]); goto gjXRD; mEtk_: self::readBorder($docStyle->getBorders()->getRight(), $style->border->right); goto PCRKV; gjXRD: if (!$diagonalUp && !$diagonalDown) { $docStyle->getBorders()->setDiagonalDirection(PHPExcel_Style_Borders::DIAGONAL_NONE); } elseif ($diagonalUp && !$diagonalDown) { $docStyle->getBorders()->setDiagonalDirection(PHPExcel_Style_Borders::DIAGONAL_UP); } elseif (!$diagonalUp && $diagonalDown) { $docStyle->getBorders()->setDiagonalDirection(PHPExcel_Style_Borders::DIAGONAL_DOWN); } else { $docStyle->getBorders()->setDiagonalDirection(PHPExcel_Style_Borders::DIAGONAL_BOTH); } goto V6fT5; CnxUx: self::readBorder($docStyle->getBorders()->getDiagonal(), $style->border->diagonal); goto nEtjm; KEbfg: $diagonalUp = self::boolean((string) $style->border["\x64\x69\x61\147\157\156\141\154\125\160"]); goto jtKvL; mwmRZ: self::readBorder($docStyle->getBorders()->getBottom(), $style->border->bottom); goto CnxUx; nEtjm: } goto T3ESb; cDgKp: if (isset($style->protection)) { if (isset($style->protection["\154\157\x63\153\x65\x64"])) { if (self::boolean((string) $style->protection["\x6c\157\143\x6b\145\144"])) { $docStyle->getProtection()->setLocked(PHPExcel_Style_Protection::PROTECTION_PROTECTED); } else { $docStyle->getProtection()->setLocked(PHPExcel_Style_Protection::PROTECTION_UNPROTECTED); } } if (isset($style->protection["\x68\151\144\144\x65\156"])) { if (self::boolean((string) $style->protection["\150\151\x64\x64\x65\x6e"])) { $docStyle->getProtection()->setHidden(PHPExcel_Style_Protection::PROTECTION_PROTECTED); } else { $docStyle->getProtection()->setHidden(PHPExcel_Style_Protection::PROTECTION_UNPROTECTED); } } } goto nqR0X; DInLU: $docStyle->getNumberFormat()->setFormatCode($style->numFmt); goto ovrw6; Hhj6Q: if (isset($style->fill)) { if ($style->fill->gradientFill) { goto Wm5jn; sfvMv: $docStyle->getFill()->setRotation(floatval($gradientFill["\144\145\x67\162\145\145"])); goto Lcecv; Wm5jn: $gradientFill = $style->fill->gradientFill[0]; goto JtZbM; H8aDO: $docStyle->getFill()->getEndColor()->setARGB(self::readColor(self::getArrayItem($gradientFill->xpath("\x73\155\x6c\72\163\164\157\160\x5b\x40\x70\157\x73\x69\164\x69\157\x6e\x3d\61\135"))->color)); goto f_KIn; Lcecv: $gradientFill->registerXPathNamespace("\x73\x6d\x6c", "\150\164\x74\160\72\x2f\57\x73\143\x68\145\155\x61\x73\x2e\157\160\145\x6e\x78\155\154\x66\157\x72\155\141\164\163\56\157\x72\x67\57\163\x70\x72\x65\x61\x64\x73\150\145\145\164\155\154\57\x32\60\60\66\57\x6d\x61\151\156"); goto eRFfI; JtZbM: if (!empty($gradientFill["\164\171\x70\x65"])) { $docStyle->getFill()->setFillType((string) $gradientFill["\164\x79\x70\x65"]); } goto sfvMv; eRFfI: $docStyle->getFill()->getStartColor()->setARGB(self::readColor(self::getArrayItem($gradientFill->xpath("\x73\155\154\x3a\x73\164\157\160\x5b\x40\x70\x6f\x73\x69\x74\151\157\156\x3d\60\x5d"))->color)); goto H8aDO; f_KIn: } elseif ($style->fill->patternFill) { goto SZv60; bIbci: if ($style->fill->patternFill->bgColor) { $docStyle->getFill()->getEndColor()->setARGB(self::readColor($style->fill->patternFill->bgColor, true)); } goto NukGw; oBeKm: if ($style->fill->patternFill->fgColor) { $docStyle->getFill()->getStartColor()->setARGB(self::readColor($style->fill->patternFill->fgColor, true)); } else { $docStyle->getFill()->getStartColor()->setARGB("\106\106\60\60\x30\60\60\x30"); } goto bIbci; SZv60: $patternType = (string) $style->fill->patternFill["\x70\141\164\x74\x65\x72\x6e\x54\x79\160\x65"] != '' ? (string) $style->fill->patternFill["\160\x61\x74\x74\x65\162\x6e\x54\x79\160\145"] : "\x73\157\154\151\x64"; goto qKai1; qKai1: $docStyle->getFill()->setFillType($patternType); goto oBeKm; NukGw: } } goto VoSIw; T3ESb: if (isset($style->alignment)) { goto QeknW; PDEuZ: $docStyle->getAlignment()->setTextRotation(intval($textRotation)); goto kGfL3; D6Wdk: if ((int) $style->alignment["\x74\x65\170\x74\x52\x6f\x74\x61\x74\151\157\156"] <= 90) { $textRotation = (int) $style->alignment["\x74\x65\170\164\122\x6f\x74\x61\x74\151\x6f\156"]; } elseif ((int) $style->alignment["\164\x65\170\164\122\157\x74\141\x74\x69\157\x6e"] > 90) { $textRotation = 90 - (int) $style->alignment["\x74\145\x78\164\122\x6f\x74\141\164\151\157\x6e"]; } goto PDEuZ; kGfL3: $docStyle->getAlignment()->setWrapText(self::boolean((string) $style->alignment["\x77\162\x61\x70\124\x65\170\x74"])); goto I6c9Q; oq1cg: $textRotation = 0; goto D6Wdk; JUEeQ: $docStyle->getAlignment()->setReadorder(intval((string) $style->alignment["\162\x65\x61\x64\x69\x6e\147\117\162\x64\x65\162"]) > 0 ? intval((string) $style->alignment["\162\x65\x61\144\151\156\147\x4f\162\x64\145\162"]) : 0); goto LbVbN; I6c9Q: $docStyle->getAlignment()->setShrinkToFit(self::boolean((string) $style->alignment["\163\x68\162\x69\156\153\124\157\106\151\x74"])); goto aaDig; QeknW: $docStyle->getAlignment()->setHorizontal((string) $style->alignment["\150\157\x72\x69\x7a\x6f\x6e\x74\141\x6c"]); goto snFR_; aaDig: $docStyle->getAlignment()->setIndent(intval((string) $style->alignment["\151\x6e\144\145\x6e\x74"]) > 0 ? intval((string) $style->alignment["\x69\x6e\144\145\156\x74"]) : 0); goto JUEeQ; snFR_: $docStyle->getAlignment()->setVertical((string) $style->alignment["\166\x65\x72\164\151\x63\141\154"]); goto oq1cg; LbVbN: } goto cDgKp; nqR0X: if (isset($style->quotePrefix)) { $docStyle->setQuotePrefix($style->quotePrefix); } goto EPv9r; EPv9r: } private static function readBorder($docBorder, $eleBorder) { if (isset($eleBorder["\163\164\171\x6c\145"])) { $docBorder->setBorderStyle((string) $eleBorder["\x73\x74\171\154\x65"]); } if (isset($eleBorder->color)) { $docBorder->getColor()->setARGB(self::readColor($eleBorder->color)); } } private function parseRichText($is = null) { goto InfCV; aM89m: if (isset($is->t)) { $value->createText(PHPExcel_Shared_String::ControlCharacterOOXML2PHP((string) $is->t)); } else { if (is_object($is->r)) { foreach ($is->r as $run) { if (!isset($run->rPr)) { $objText = $value->createText(PHPExcel_Shared_String::ControlCharacterOOXML2PHP((string) $run->t)); } else { goto MxO6W; M7tRw: if (isset($run->rPr->u) && !isset($run->rPr->u["\166\141\154"])) { $objText->getFont()->setUnderline(PHPExcel_Style_Font::UNDERLINE_SINGLE); } elseif (isset($run->rPr->u) && isset($run->rPr->u["\x76\x61\x6c"])) { $objText->getFont()->setUnderline((string) $run->rPr->u["\166\x61\154"]); } goto prGwM; fw0Ok: if (isset($run->rPr->rFont["\x76\x61\x6c"])) { $objText->getFont()->setName((string) $run->rPr->rFont["\x76\141\x6c"]); } goto Rsd0R; sSFMP: if (isset($run->rPr->color)) { $objText->getFont()->setColor(new PHPExcel_Style_Color(self::readColor($run->rPr->color))); } goto B174a; WHj7V: if (isset($run->rPr->vertAlign) && isset($run->rPr->vertAlign["\166\141\x6c"])) { goto eWgfM; eWgfM: $vertAlign = strtolower((string) $run->rPr->vertAlign["\x76\x61\x6c"]); goto dYV_M; NMJKo: if ($vertAlign == "\x73\x75\142\x73\143\162\151\160\164") { $objText->getFont()->setSubScript(true); } goto dyTPB; dYV_M: if ($vertAlign == "\163\x75\160\145\162\163\143\x72\x69\x70\164") { $objText->getFont()->setSuperScript(true); } goto NMJKo; dyTPB: } goto M7tRw; B174a: if (isset($run->rPr->b["\x76\x61\x6c"]) && self::boolean((string) $run->rPr->b["\166\141\154"]) || isset($run->rPr->b) && !isset($run->rPr->b["\x76\x61\x6c"])) { $objText->getFont()->setBold(true); } goto fTqny; MxO6W: $objText = $value->createTextRun(PHPExcel_Shared_String::ControlCharacterOOXML2PHP((string) $run->t)); goto fw0Ok; Rsd0R: if (isset($run->rPr->sz["\166\x61\154"])) { $objText->getFont()->setSize((string) $run->rPr->sz["\x76\x61\x6c"]); } goto sSFMP; prGwM: if (isset($run->rPr->strike["\x76\141\154"]) && self::boolean((string) $run->rPr->strike["\x76\x61\x6c"]) || isset($run->rPr->strike) && !isset($run->rPr->strike["\x76\141\154"])) { $objText->getFont()->setStrikethrough(true); } goto iIzBB; fTqny: if (isset($run->rPr->i["\166\141\154"]) && self::boolean((string) $run->rPr->i["\x76\x61\154"]) || isset($run->rPr->i) && !isset($run->rPr->i["\166\141\x6c"])) { $objText->getFont()->setItalic(true); } goto WHj7V; iIzBB: } } } } goto FDE0J; FDE0J: return $value; goto j0Fw_; InfCV: $value = new PHPExcel_RichText(); goto aM89m; j0Fw_: } private function readRibbon($excel, $customUITarget, $zip) { goto LD9yi; R6Cgm: if ($dataRels) { $UIRels = simplexml_load_string($this->securityScan($dataRels), "\x53\x69\x6d\160\154\x65\x58\x4d\114\105\x6c\x65\x6d\145\156\x74", PHPExcel_Settings::getLibXmlLoaderOptions()); if ($UIRels) { foreach ($UIRels->Relationship as $ele) { if ($ele["\124\x79\x70\x65"] == "\x68\164\x74\x70\72\57\57\x73\x63\x68\145\x6d\x61\x73\56\157\x70\x65\156\170\x6d\x6c\x66\157\162\155\x61\164\x73\x2e\x6f\162\x67\x2f\157\x66\146\151\143\x65\104\157\143\x75\155\145\156\164\57\62\x30\x30\x36\x2f\x72\x65\154\x61\164\151\157\x6e\x73\150\151\x70\163\x2f\151\x6d\x61\x67\x65") { $customUIImagesNames[(string) $ele["\111\144"]] = (string) $ele["\124\x61\x72\147\x65\x74"]; $customUIImagesBinaries[(string) $ele["\124\141\x72\x67\145\164"]] = $this->getFromZipArchive($zip, $baseDir . "\57" . (string) $ele["\124\141\x72\147\x65\164"]); } } } } goto bF5Vp; Uvwpe: $customUIImagesBinaries = array(); goto eGsbi; eQU13: $dataRels = $this->getFromZipArchive($zip, $pathRels); goto R6Cgm; vnt1G: $nameCustomUI = basename($customUITarget); goto f_Pyc; bF5Vp: if ($localRibbon) { $excel->setRibbonXMLData($customUITarget, $localRibbon); if (count($customUIImagesNames) > 0 && count($customUIImagesBinaries) > 0) { $excel->setRibbonBinObjects($customUIImagesNames, $customUIImagesBinaries); } else { $excel->setRibbonBinObjects(null); } } else { $excel->setRibbonXMLData(null); $excel->setRibbonBinObjects(null); } goto uwPRE; LD9yi: $baseDir = dirname($customUITarget); goto vnt1G; f_Pyc: $localRibbon = $this->getFromZipArchive($zip, $customUITarget); goto Dhwe4; eGsbi: $pathRels = $baseDir . "\x2f\x5f\x72\145\x6c\163\x2f" . $nameCustomUI . "\x2e\162\x65\154\163"; goto eQU13; Dhwe4: $customUIImagesNames = array(); goto Uvwpe; uwPRE: } private static function getArrayItem($array, $key = 0) { return isset($array[$key]) ? $array[$key] : null; } private static function dirAdd($base, $add) { return preg_replace("\x7e\x5b\136\x2f\135\x2b\57\x5c\56\134\x2e\57\176", '', dirname($base) . "\x2f{$add}"); } private static function toCSSArray($style) { goto CTyG3; RsnQ5: $style = array(); goto lpiam; CfR9J: return $style; goto O1JjZ; CTyG3: $style = str_replace(array("\15", "\12"), '', $style); goto Gd955; Gd955: $temp = explode("\73", $style); goto RsnQ5; lpiam: foreach ($temp as $item) { goto tasc9; Tqem1: if (strpos($item[1], "\160\x78") !== false) { $item[1] = str_replace("\160\x78", '', $item[1]); } goto CAZLG; o1Gf3: if (strpos($item[1], "\x63\155") !== false) { $item[1] = str_replace("\143\x6d", '', $item[1]); $item[1] = PHPExcel_Shared_Font::centimeterSizeToPixels($item[1]); } goto pSN8E; tasc9: $item = explode("\x3a", $item); goto Tqem1; cCFe8: if (strpos($item[1], "\x69\x6e") !== false) { $item[1] = str_replace("\151\156", '', $item[1]); $item[1] = PHPExcel_Shared_Font::inchSizeToPixels($item[1]); } goto o1Gf3; pSN8E: $style[$item[0]] = $item[1]; goto P3bTJ; CAZLG: if (strpos($item[1], "\x70\x74") !== false) { $item[1] = str_replace("\160\164", '', $item[1]); $item[1] = PHPExcel_Shared_Font::fontSizeToPixels($item[1]); } goto cCFe8; P3bTJ: } goto CfR9J; O1JjZ: } private static function boolean($value = null) { goto T8hRW; uzClf: if (is_numeric($value)) { return (bool) $value; } goto L_hz2; T8hRW: if (is_object($value)) { $value = (string) $value; } goto uzClf; L_hz2: return $value === "\x74\162\x75\x65" || $value === "\x54\x52\x55\x45"; goto A0Ttp; A0Ttp: } }
