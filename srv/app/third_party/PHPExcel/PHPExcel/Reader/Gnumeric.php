<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:06              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 if (!defined("\x50\110\x50\105\x58\103\x45\x4c\x5f\x52\x4f\x4f\124")) { define("\x50\110\120\x45\130\103\105\114\x5f\122\117\x4f\x54", dirname(__FILE__) . "\57\x2e\56\57\x2e\x2e\57"); require PHPEXCEL_ROOT . "\x50\x48\120\105\170\x63\145\154\57\x41\165\164\157\x6c\x6f\x61\x64\145\x72\x2e\x70\150\160"; } class PHPExcel_Reader_Gnumeric extends PHPExcel_Reader_Abstract implements PHPExcel_Reader_IReader { private $styles = array(); private $expressions = array(); private $referenceHelper = null; public function __construct() { $this->readFilter = new PHPExcel_Reader_DefaultReadFilter(); $this->referenceHelper = PHPExcel_ReferenceHelper::getInstance(); } public function canRead($pFilename) { goto tby_7; CcLKN: if ($data != chr(0x1f) . chr(0x8b)) { return false; } goto xCfKm; Ugt7f: $fh = fopen($pFilename, "\162"); goto kEPp8; tby_7: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\103\157\165\x6c\144\x20\x6e\x6f\x74\40\157\160\x65\x6e\x20" . $pFilename . "\x20\x66\157\x72\x20\162\145\141\x64\x69\x6e\147\41\40\106\151\154\x65\40\x64\157\145\163\40\156\x6f\x74\x20\x65\170\151\x73\x74\56"); } goto GbQ67; kEPp8: $data = fread($fh, 2); goto E1lEW; GbQ67: if (!function_exists("\147\x7a\x72\145\x61\x64")) { throw new PHPExcel_Reader_Exception("\147\x7a\x6c\151\x62\40\154\151\x62\162\141\162\x79\40\151\x73\x20\156\157\164\40\145\156\x61\142\154\145\144"); } goto Ugt7f; E1lEW: fclose($fh); goto CcLKN; xCfKm: return true; goto UWnkb; UWnkb: } public function listWorksheetNames($pFilename) { goto xyuD6; xyuD6: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\x43\x6f\165\154\x64\x20\x6e\157\164\40\x6f\x70\x65\156\x20" . $pFilename . "\x20\146\x6f\162\x20\x72\145\x61\x64\151\156\x67\41\40\106\x69\x6c\145\x20\x64\x6f\145\x73\x20\x6e\x6f\164\x20\x65\x78\151\x73\164\x2e"); } goto CNt68; tYZ2D: $xml->setParserProperty(2, true); goto FFwit; uqbVj: while ($xml->read()) { if ($xml->name == "\x67\x6e\x6d\x3a\123\x68\x65\145\164\116\141\155\x65" && $xml->nodeType == XMLReader::ELEMENT) { $xml->read(); $worksheetNames[] = (string) $xml->value; } elseif ($xml->name == "\x67\x6e\155\x3a\123\x68\145\x65\164\x73") { break; } } goto IuzWH; FFwit: $worksheetNames = array(); goto uqbVj; IuzWH: return $worksheetNames; goto qu2up; CNt68: $xml = new XMLReader(); goto NP4C4; NP4C4: $xml->xml($this->securityScanFile("\x63\157\155\x70\x72\145\163\x73\56\x7a\x6c\x69\x62\72\57\x2f" . realpath($pFilename)), null, PHPExcel_Settings::getLibXmlLoaderOptions()); goto tYZ2D; qu2up: } public function listWorksheetInfo($pFilename) { goto R1wyz; SnZQK: $xml->setParserProperty(2, true); goto ZJHNq; R1wyz: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\x43\157\165\154\144\x20\156\157\164\40\157\x70\x65\x6e\x20" . $pFilename . "\40\x66\157\x72\40\x72\x65\x61\x64\151\156\x67\x21\x20\x46\x69\x6c\145\40\144\157\x65\163\40\156\x6f\x74\x20\x65\170\x69\x73\x74\56"); } goto zcmYt; bld2P: $xml->xml($this->securityScanFile("\143\x6f\155\x70\x72\x65\163\163\56\x7a\x6c\x69\x62\x3a\57\x2f" . realpath($pFilename)), null, PHPExcel_Settings::getLibXmlLoaderOptions()); goto SnZQK; zcmYt: $xml = new XMLReader(); goto bld2P; T3d9F: return $worksheetInfo; goto N5Sg3; ZJHNq: $worksheetInfo = array(); goto xgKBF; xgKBF: while ($xml->read()) { if ($xml->name == "\x67\156\x6d\72\x53\x68\x65\145\x74" && $xml->nodeType == XMLReader::ELEMENT) { goto Tbs2r; Tbs2r: $tmpInfo = array("\x77\157\x72\153\x73\x68\145\x65\x74\116\x61\155\145" => '', "\x6c\141\163\164\x43\x6f\154\x75\155\x6e\x4c\145\164\164\145\162" => "\x41", "\154\x61\x73\x74\103\157\154\x75\x6d\156\111\156\x64\145\x78" => 0, "\164\157\x74\x61\154\x52\x6f\x77\x73" => 0, "\164\157\x74\141\154\x43\157\x6c\x75\155\156\163" => 0); goto OB9FT; OB9FT: while ($xml->read()) { if ($xml->name == "\x67\156\155\72\x4e\141\x6d\x65" && $xml->nodeType == XMLReader::ELEMENT) { $xml->read(); $tmpInfo["\167\x6f\x72\x6b\163\x68\145\x65\164\116\x61\x6d\145"] = (string) $xml->value; } elseif ($xml->name == "\x67\x6e\155\72\115\x61\x78\103\x6f\x6c" && $xml->nodeType == XMLReader::ELEMENT) { goto SBadM; yo_Dn: $tmpInfo["\x6c\141\163\164\103\x6f\x6c\x75\155\156\x49\156\144\145\x78"] = (int) $xml->value; goto STKMn; STKMn: $tmpInfo["\x74\157\x74\x61\x6c\x43\x6f\x6c\165\x6d\x6e\x73"] = (int) $xml->value + 1; goto wnliE; SBadM: $xml->read(); goto yo_Dn; wnliE: } elseif ($xml->name == "\147\x6e\x6d\x3a\x4d\141\170\x52\157\167" && $xml->nodeType == XMLReader::ELEMENT) { goto BH6Jo; MkVU8: break; goto prhu8; SwoPs: $tmpInfo["\164\x6f\x74\141\x6c\122\157\167\x73"] = (int) $xml->value + 1; goto MkVU8; BH6Jo: $xml->read(); goto SwoPs; prhu8: } } goto Pq_Xt; Pq_Xt: $tmpInfo["\x6c\141\163\x74\103\x6f\x6c\x75\x6d\x6e\x4c\x65\164\x74\x65\x72"] = PHPExcel_Cell::stringFromColumnIndex($tmpInfo["\154\141\163\x74\x43\x6f\154\165\x6d\156\x49\x6e\x64\x65\170"]); goto zYhMX; zYhMX: $worksheetInfo[] = $tmpInfo; goto QgFuY; QgFuY: } } goto T3d9F; N5Sg3: } private function gzfileGetContents($filename) { goto rrTQ7; mOmqx: return $data; goto Q8S2p; rrTQ7: $file = @gzopen($filename, "\x72\142"); goto dgvnp; dgvnp: if ($file !== false) { goto yBq4O; yBq4O: $data = ''; goto cjlnG; cjlnG: while (!gzeof($file)) { $data .= gzread($file, 1024); } goto YPNxF; YPNxF: gzclose($file); goto TATSE; TATSE: } goto mOmqx; Q8S2p: } public function load($pFilename) { $objPHPExcel = new PHPExcel(); return $this->loadIntoExisting($pFilename, $objPHPExcel); } public function loadIntoExisting($pFilename, PHPExcel $objPHPExcel) { goto AoP7N; rvUiK: $GMT = new DateTimeZone("\x55\124\103"); goto OiS86; Y7diR: return $objPHPExcel; goto P0_SH; WzCmP: $timezoneObj = new DateTimeZone("\x45\165\x72\157\160\x65\x2f\x4c\157\156\x64\157\x6e"); goto rvUiK; AoP7N: if (!file_exists($pFilename)) { throw new PHPExcel_Reader_Exception("\103\x6f\x75\x6c\144\40\x6e\x6f\x74\40\157\x70\145\x6e\x20" . $pFilename . "\x20\146\x6f\162\x20\162\145\x61\x64\x69\156\x67\x21\40\x46\x69\154\x65\x20\144\x6f\x65\163\x20\x6e\157\164\40\x65\x78\x69\x73\164\x2e"); } goto WzCmP; D01_K: if (isset($gnmXML->Names)) { foreach ($gnmXML->Names->Name as $namedRange) { goto kZFGY; Uttsd: $range = (string) $namedRange->value; goto R2SFK; cHYBK: if ($worksheet = $objPHPExcel->getSheetByName($range[0])) { $extractedRange = str_replace("\44", '', $range[1]); $objPHPExcel->addNamedRange(new PHPExcel_NamedRange($name, $worksheet, $extractedRange)); } goto bekNL; l3Yvo: $range[0] = trim($range[0], "\47"); goto cHYBK; R2SFK: if (stripos($range, "\x23\122\x45\x46\x21") !== false) { continue; } goto VN2jf; kZFGY: $name = (string) $namedRange->name; goto Uttsd; VN2jf: $range = explode("\41", $range); goto l3Yvo; bekNL: } } goto Y7diR; id5BO: $docProps = $objPHPExcel->getProperties(); goto DEWh2; OhMx9: $gnmXML = $xml->children($namespacesMeta["\x67\x6e\x6d"]); goto id5BO; rwOqG: $namespacesMeta = $xml->getNamespaces(true); goto OhMx9; DEWh2: if (isset($namespacesMeta["\x6f\x66\x66\151\143\x65"])) { goto mdHT2; e7BS5: $officeDocXML = $officeXML->{"\x64\x6f\143\165\x6d\145\x6e\x74\55\155\x65\x74\x61"}; goto S2r_c; S2r_c: $officeDocMetaXML = $officeDocXML->meta; goto EGcVW; mdHT2: $officeXML = $xml->children($namespacesMeta["\x6f\146\x66\x69\143\145"]); goto e7BS5; EGcVW: foreach ($officeDocMetaXML as $officePropertyData) { goto eHF5k; eHF5k: $officePropertyDC = array(); goto c8DJi; NEYHu: foreach ($officePropertyDC as $propertyName => $propertyValue) { $propertyValue = (string) $propertyValue; switch ($propertyName) { case "\164\151\x74\154\x65": $docProps->setTitle(trim($propertyValue)); break; case "\163\165\x62\152\x65\143\164": $docProps->setSubject(trim($propertyValue)); break; case "\143\x72\x65\141\x74\x6f\x72": goto mbgKS; Th8lf: break; goto JQZVb; LfCA3: $docProps->setLastModifiedBy(trim($propertyValue)); goto Th8lf; mbgKS: $docProps->setCreator(trim($propertyValue)); goto LfCA3; JQZVb: case "\x64\x61\x74\145": goto CmCB_; jnAJh: $docProps->setModified($creationDate); goto zCvSJ; zCvSJ: break; goto abDEm; CmCB_: $creationDate = strtotime(trim($propertyValue)); goto GMmMi; GMmMi: $docProps->setCreated($creationDate); goto jnAJh; abDEm: case "\x64\x65\x73\143\x72\x69\160\164\151\157\x6e": $docProps->setDescription(trim($propertyValue)); break; } } goto vgA5I; imy98: if (isset($namespacesMeta["\x6d\x65\164\141"])) { $officePropertyMeta = $officePropertyData->children($namespacesMeta["\x6d\145\164\x61"]); } goto dgPSq; c8DJi: if (isset($namespacesMeta["\144\143"])) { $officePropertyDC = $officePropertyData->children($namespacesMeta["\144\143"]); } goto NEYHu; vgA5I: $officePropertyMeta = array(); goto imy98; dgPSq: foreach ($officePropertyMeta as $propertyName => $propertyValue) { goto f3OCq; du1mR: switch ($propertyName) { case "\153\x65\x79\x77\157\162\x64": $docProps->setKeywords(trim($propertyValue)); break; case "\151\156\x69\164\151\141\154\x2d\x63\x72\x65\x61\x74\x6f\162": goto c_4LS; c_4LS: $docProps->setCreator(trim($propertyValue)); goto ztfdQ; W5vj7: break; goto BCiK8; ztfdQ: $docProps->setLastModifiedBy(trim($propertyValue)); goto W5vj7; BCiK8: case "\x63\x72\x65\x61\x74\151\157\x6e\55\144\x61\164\x65": goto wla4Y; Hdn_p: break; goto PvgMa; aGPSf: $docProps->setModified($creationDate); goto Hdn_p; adtkn: $docProps->setCreated($creationDate); goto aGPSf; wla4Y: $creationDate = strtotime(trim($propertyValue)); goto adtkn; PvgMa: case "\x75\163\x65\162\55\144\145\146\151\x6e\145\x64": goto NdAhS; I4UJa: switch ($attrName) { case "\x70\x75\x62\x6c\x69\x73\150\145\x72": $docProps->setCompany(trim($propertyValue)); break; case "\x63\141\164\x65\x67\157\x72\171": $docProps->setCategory(trim($propertyValue)); break; case "\x6d\x61\x6e\x61\147\x65\x72": $docProps->setManager(trim($propertyValue)); break; } goto yTtHj; NdAhS: list(, $attrName) = explode("\x3a", $attributes["\x6e\x61\x6d\x65"]); goto I4UJa; yTtHj: break; goto BObTt; BObTt: } goto bxrWi; R8CHE: $propertyValue = (string) $propertyValue; goto du1mR; f3OCq: $attributes = $propertyValue->attributes($namespacesMeta["\x6d\x65\164\141"]); goto R8CHE; bxrWi: } goto PMfiO; PMfiO: } goto pQJdu; pQJdu: } elseif (isset($gnmXML->Summary)) { foreach ($gnmXML->Summary->Item as $summaryItem) { goto kuVkk; EOh1O: $propertyValue = $summaryItem->{"\166\141\x6c\55\x73\x74\162\151\156\147"}; goto IQSs6; IQSs6: switch ($propertyName) { case "\164\151\x74\x6c\145": $docProps->setTitle(trim($propertyValue)); break; case "\143\157\x6d\155\x65\x6e\x74\163": $docProps->setDescription(trim($propertyValue)); break; case "\x6b\145\171\x77\x6f\162\144\163": $docProps->setKeywords(trim($propertyValue)); break; case "\143\141\x74\x65\147\157\x72\171": $docProps->setCategory(trim($propertyValue)); break; case "\x6d\141\x6e\x61\147\x65\x72": $docProps->setManager(trim($propertyValue)); break; case "\141\165\x74\x68\x6f\x72": goto e_xxp; bCEGz: $docProps->setLastModifiedBy(trim($propertyValue)); goto JO6_X; JO6_X: break; goto AUzPz; e_xxp: $docProps->setCreator(trim($propertyValue)); goto bCEGz; AUzPz: case "\143\157\155\160\141\156\171": $docProps->setCompany(trim($propertyValue)); break; } goto Lrvvr; kuVkk: $propertyName = $summaryItem->name; goto EOh1O; Lrvvr: } } goto KW12E; OiS86: $gFileData = $this->gzfileGetContents($pFilename); goto iu8aH; aA37H: foreach ($gnmXML->Sheets->Sheet as $sheet) { goto GFOBS; WBS8b: $objPHPExcel->createSheet(); goto LXTpq; FVRIs: if (!$this->readDataOnly && isset($sheet->Cols)) { goto RE2lJ; WAnq1: foreach ($sheet->Cols->ColInfo as $columnOverride) { goto yhA73; CYDvE: while ($c < $column + $columnCount && $c <= $maxCol) { $objPHPExcel->getActiveSheet()->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($c))->setWidth($columnWidth); if ($hidden) { $objPHPExcel->getActiveSheet()->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($c))->setVisible(false); } ++$c; } goto dlJ9h; EfG7l: while ($c < $column) { $objPHPExcel->getActiveSheet()->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($c))->setWidth($defaultWidth); ++$c; } goto CYDvE; yhA73: $columnAttributes = $columnOverride->attributes(); goto rDiNW; LRPpy: $columnWidth = $columnAttributes["\125\x6e\x69\164"] / 5.4; goto l3cKG; mp33_: $columnCount = isset($columnAttributes["\x43\x6f\165\156\x74"]) ? $columnAttributes["\103\157\165\x6e\x74"] : 1; goto EfG7l; l3cKG: $hidden = isset($columnAttributes["\110\151\x64\144\x65\156"]) && $columnAttributes["\110\x69\x64\144\145\156"] == "\61" ? true : false; goto mp33_; rDiNW: $column = $columnAttributes["\116\x6f"]; goto LRPpy; dlJ9h: } goto vOLni; b9TwW: $c = 0; goto WAnq1; vOLni: while ($c <= $maxCol) { $objPHPExcel->getActiveSheet()->getColumnDimension(PHPExcel_Cell::stringFromColumnIndex($c))->setWidth($defaultWidth); ++$c; } goto nHqYz; RE2lJ: $columnAttributes = $sheet->Cols->attributes(); goto H8Eve; H8Eve: $defaultWidth = $columnAttributes["\x44\x65\x66\x61\x75\154\164\x53\x69\x7a\x65\120\x74\163"] / 5.4; goto b9TwW; nHqYz: } goto HNTtD; FONlC: if (isset($this->loadSheetsOnly) && !in_array($worksheetName, $this->loadSheetsOnly)) { continue; } goto pPTJZ; HNTtD: if (!$this->readDataOnly && isset($sheet->Rows)) { goto kU_EK; Vr1qP: $r = 0; goto bF8i1; bF8i1: foreach ($sheet->Rows->RowInfo as $rowOverride) { goto Ee0i_; KwWAD: $hidden = isset($rowAttributes["\x48\151\x64\x64\145\156"]) && $rowAttributes["\x48\151\x64\144\145\156"] == "\61" ? true : false; goto nfoEA; rcOXP: $rowHeight = $rowAttributes["\x55\x6e\151\x74"]; goto KwWAD; Nu15j: while ($r < $row) { ++$r; $objPHPExcel->getActiveSheet()->getRowDimension($r)->setRowHeight($defaultHeight); } goto WRVP3; nfoEA: $rowCount = isset($rowAttributes["\x43\x6f\165\x6e\164"]) ? $rowAttributes["\103\157\x75\x6e\164"] : 1; goto Nu15j; WRVP3: while ($r < $row + $rowCount && $r < $maxRow) { ++$r; $objPHPExcel->getActiveSheet()->getRowDimension($r)->setRowHeight($rowHeight); if ($hidden) { $objPHPExcel->getActiveSheet()->getRowDimension($r)->setVisible(false); } } goto zeYPz; wRcED: $row = $rowAttributes["\x4e\x6f"]; goto rcOXP; Ee0i_: $rowAttributes = $rowOverride->attributes(); goto wRcED; zeYPz: } goto XQNFM; tBLXf: $defaultHeight = $rowAttributes["\104\x65\x66\141\165\x6c\x74\x53\x69\172\x65\120\x74\163"]; goto Vr1qP; kU_EK: $rowAttributes = $sheet->Rows->attributes(); goto tBLXf; XQNFM: while ($r < $maxRow) { ++$r; $objPHPExcel->getActiveSheet()->getRowDimension($r)->setRowHeight($defaultHeight); } goto xS6q_; xS6q_: } goto kZUkj; PvLGL: foreach ($sheet->Styles->StyleRegion as $styleRegion) { $styleAttributes = $styleRegion->attributes(); if ($styleAttributes["\163\x74\141\x72\x74\x52\x6f\x77"] <= $maxRow && $styleAttributes["\163\x74\141\162\x74\x43\157\154"] <= $maxCol) { goto KpLd0; hP0dI: $endColumn = $styleAttributes["\x65\156\144\103\x6f\x6c"] > $maxCol ? $maxCol : (int) $styleAttributes["\145\156\144\103\x6f\x6c"]; goto Lqa1_; L0TAz: $endRow += 1; goto KYFJ3; Ie_h0: $styleAttributes = $styleRegion->Style->attributes(); goto jncUo; jncUo: if (!$this->readDataOnly || PHPExcel_Shared_Date::isDateTimeFormatCode((string) $styleAttributes["\x46\157\x72\x6d\x61\x74"])) { goto qxCcM; qxCcM: $styleArray = array(); goto PTv8a; Ds5AP: if (!$this->readDataOnly) { goto dJa43; I4HaE: $shade = $styleAttributes["\x53\150\x61\x64\x65"]; goto Td4ht; Rdr5R: if (isset($styleRegion->Style->StyleBorder)) { goto MKgX0; v88u5: if (isset($styleRegion->Style->StyleBorder->Left)) { $styleArray["\142\157\162\144\x65\x72\x73"]["\154\x65\146\x74"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->Left->attributes()); } goto wTqhp; MKgX0: if (isset($styleRegion->Style->StyleBorder->Top)) { $styleArray["\x62\x6f\x72\x64\x65\x72\x73"]["\x74\157\160"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->Top->attributes()); } goto iOWg5; GwNmu: if (isset($styleRegion->Style->StyleBorder->Diagonal) && isset($styleRegion->Style->StyleBorder->{"\x52\x65\166\55\104\x69\141\x67\157\x6e\x61\x6c"})) { $styleArray["\142\157\x72\144\145\162\x73"]["\x64\x69\141\147\x6f\156\141\154"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->Diagonal->attributes()); $styleArray["\x62\157\x72\144\x65\162\x73"]["\x64\151\x61\x67\157\x6e\141\154\x64\151\x72\145\x63\x74\151\x6f\x6e"] = PHPExcel_Style_Borders::DIAGONAL_BOTH; } elseif (isset($styleRegion->Style->StyleBorder->Diagonal)) { $styleArray["\142\157\162\144\x65\162\163"]["\144\151\x61\147\x6f\x6e\141\x6c"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->Diagonal->attributes()); $styleArray["\142\157\162\144\145\162\163"]["\x64\151\x61\x67\x6f\156\x61\154\144\x69\x72\145\143\x74\x69\157\156"] = PHPExcel_Style_Borders::DIAGONAL_UP; } elseif (isset($styleRegion->Style->StyleBorder->{"\x52\x65\166\x2d\x44\x69\141\147\157\156\141\x6c"})) { $styleArray["\142\x6f\162\x64\x65\x72\163"]["\144\151\x61\x67\x6f\x6e\x61\154"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->{"\122\145\x76\x2d\104\x69\141\x67\157\156\x61\154"}->attributes()); $styleArray["\x62\157\162\144\x65\x72\x73"]["\x64\x69\x61\147\x6f\x6e\141\154\144\x69\162\x65\x63\x74\x69\x6f\x6e"] = PHPExcel_Style_Borders::DIAGONAL_DOWN; } goto B2X2P; wTqhp: if (isset($styleRegion->Style->StyleBorder->Right)) { $styleArray["\142\157\162\144\145\x72\163"]["\162\x69\147\x68\x74"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->Right->attributes()); } goto GwNmu; iOWg5: if (isset($styleRegion->Style->StyleBorder->Bottom)) { $styleArray["\x62\x6f\162\144\145\x72\163"]["\142\x6f\164\x74\157\x6d"] = self::parseBorderAttributes($styleRegion->Style->StyleBorder->Bottom->attributes()); } goto v88u5; B2X2P: } goto fC3OC; fOWEU: switch ($fontAttributes["\x53\x63\x72\x69\160\164"]) { case "\x31": $styleArray["\146\157\156\x74"]["\x73\165\160\145\x72\x53\x63\x72\151\x70\x74"] = true; break; case "\55\61": $styleArray["\x66\157\x6e\x74"]["\163\165\x62\123\143\162\x69\160\164"] = true; break; } goto Rdr5R; WEbm3: $RGB = self::parseGnumericColour($styleAttributes["\x42\x61\x63\153"]); goto I4HaE; nU_Tq: $styleArray["\x66\157\156\x74"]["\156\141\x6d\145"] = (string) $styleRegion->Style->Font; goto AF2A3; zzauD: switch ($styleAttributes["\x56\101\x6c\151\147\156"]) { case "\x31": $styleArray["\141\x6c\x69\147\x6e\155\145\156\164"]["\x76\145\x72\164\151\143\x61\154"] = PHPExcel_Style_Alignment::VERTICAL_TOP; break; case "\x32": $styleArray["\141\x6c\x69\147\156\155\x65\156\x74"]["\x76\x65\x72\x74\151\143\141\x6c"] = PHPExcel_Style_Alignment::VERTICAL_BOTTOM; break; case "\x34": $styleArray["\141\154\x69\147\x6e\x6d\145\156\164"]["\166\145\162\164\151\143\x61\154"] = PHPExcel_Style_Alignment::VERTICAL_CENTER; break; case "\70": $styleArray["\x61\154\151\x67\x6e\155\145\x6e\164"]["\x76\145\162\164\x69\x63\x61\154"] = PHPExcel_Style_Alignment::VERTICAL_JUSTIFY; break; } goto Pn3TZ; Pn3TZ: $styleArray["\141\x6c\151\147\x6e\155\145\x6e\164"]["\x77\x72\141\x70"] = $styleAttributes["\127\162\141\160\124\x65\170\164"] == "\x31" ? true : false; goto orVB3; zA5tE: $styleArray["\x66\x6f\x6e\x74"]["\163\164\162\x69\x6b\145"] = $fontAttributes["\x53\x74\162\x69\x6b\145\x54\x68\162\157\165\x67\x68"] == "\x31" ? true : false; goto uTvai; uTvai: switch ($fontAttributes["\x55\x6e\144\x65\x72\x6c\151\156\x65"]) { case "\x31": $styleArray["\x66\157\x6e\164"]["\165\156\x64\145\162\x6c\151\x6e\x65"] = PHPExcel_Style_Font::UNDERLINE_SINGLE; break; case "\62": $styleArray["\146\x6f\156\x74"]["\165\x6e\144\145\x72\154\151\x6e\145"] = PHPExcel_Style_Font::UNDERLINE_DOUBLE; break; case "\63": $styleArray["\x66\x6f\x6e\164"]["\165\156\x64\x65\162\154\151\x6e\145"] = PHPExcel_Style_Font::UNDERLINE_SINGLEACCOUNTING; break; case "\64": $styleArray["\146\157\x6e\x74"]["\165\x6e\x64\x65\162\154\151\156\145"] = PHPExcel_Style_Font::UNDERLINE_DOUBLEACCOUNTING; break; default: $styleArray["\x66\x6f\156\x74"]["\165\156\x64\x65\x72\154\x69\x6e\145"] = PHPExcel_Style_Font::UNDERLINE_NONE; break; } goto fOWEU; n7Ad4: $RGB = self::parseGnumericColour($styleAttributes["\x46\157\x72\x65"]); goto AdR97; Td4ht: if ($RGB != "\60\x30\x30\x30\x30\x30" || $shade != "\60") { goto GtPFo; qfPKl: $styleArray["\x66\151\154\154"]["\x65\x6e\x64\x63\157\154\x6f\162"]["\x72\x67\142"] = $RGB2; goto H2cy1; H2cy1: switch ($shade) { case "\61": $styleArray["\146\151\x6c\x6c"]["\164\x79\x70\x65"] = PHPExcel_Style_Fill::FILL_SOLID; break; case "\62": $styleArray["\146\x69\x6c\154"]["\164\x79\160\145"] = PHPExcel_Style_Fill::FILL_GRADIENT_LINEAR; break; case "\63": $styleArray["\x66\151\154\154"]["\164\x79\160\145"] = PHPExcel_Style_Fill::FILL_GRADIENT_PATH; break; case "\x34": $styleArray["\146\151\x6c\154"]["\x74\171\160\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKDOWN; break; case "\65": $styleArray["\146\x69\x6c\x6c"]["\164\171\x70\145"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKGRAY; break; case "\x36": $styleArray["\146\x69\154\x6c"]["\164\x79\x70\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKGRID; break; case "\67": $styleArray["\x66\x69\x6c\154"]["\x74\x79\160\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKHORIZONTAL; break; case "\x38": $styleArray["\x66\x69\x6c\154"]["\164\x79\160\145"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKTRELLIS; break; case "\x39": $styleArray["\146\151\154\154"]["\x74\171\x70\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKUP; break; case "\x31\x30": $styleArray["\x66\x69\x6c\x6c"]["\x74\x79\160\145"] = PHPExcel_Style_Fill::FILL_PATTERN_DARKVERTICAL; break; case "\x31\x31": $styleArray["\x66\x69\154\154"]["\x74\x79\x70\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_GRAY0625; break; case "\61\x32": $styleArray["\x66\151\154\154"]["\x74\171\x70\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_GRAY125; break; case "\61\x33": $styleArray["\146\151\x6c\x6c"]["\164\x79\160\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTDOWN; break; case "\61\64": $styleArray["\x66\151\x6c\154"]["\x74\x79\160\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTGRAY; break; case "\x31\65": $styleArray["\x66\151\154\154"]["\164\x79\160\145"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTGRID; break; case "\x31\66": $styleArray["\x66\151\x6c\154"]["\x74\x79\x70\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTHORIZONTAL; break; case "\61\x37": $styleArray["\146\151\x6c\154"]["\x74\171\x70\145"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTTRELLIS; break; case "\61\x38": $styleArray["\x66\x69\154\154"]["\164\171\x70\x65"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTUP; break; case "\61\71": $styleArray["\146\x69\154\x6c"]["\x74\x79\x70\145"] = PHPExcel_Style_Fill::FILL_PATTERN_LIGHTVERTICAL; break; case "\62\x30": $styleArray["\x66\x69\154\154"]["\x74\171\x70\145"] = PHPExcel_Style_Fill::FILL_PATTERN_MEDIUMGRAY; break; } goto qkRJx; GtPFo: $styleArray["\146\151\x6c\x6c"]["\x63\157\154\x6f\x72"]["\x72\x67\x62"] = $styleArray["\x66\x69\x6c\x6c"]["\163\x74\141\x72\x74\x63\x6f\154\x6f\162"]["\162\147\x62"] = $RGB; goto cu2rs; cu2rs: $RGB2 = self::parseGnumericColour($styleAttributes["\120\141\164\164\x65\x72\156\103\x6f\x6c\x6f\x72"]); goto qfPKl; qkRJx: } goto KrEDK; orVB3: $styleArray["\x61\x6c\x69\x67\x6e\x6d\145\156\164"]["\163\x68\x72\151\x6e\x6b\124\157\106\x69\164"] = $styleAttributes["\x53\x68\x72\x69\x6e\153\x54\x6f\106\151\164"] == "\x31" ? true : false; goto qMyBD; AF2A3: $styleArray["\x66\x6f\156\164"]["\163\151\172\145"] = intval($fontAttributes["\x55\156\x69\164"]); goto PIc76; KrEDK: $fontAttributes = $styleRegion->Style->Font->attributes(); goto nU_Tq; qMyBD: $styleArray["\141\x6c\x69\x67\x6e\155\x65\156\x74"]["\151\x6e\144\145\x6e\x74"] = intval($styleAttributes["\111\156\144\145\x6e\164"]) > 0 ? $styleAttributes["\x69\x6e\144\145\156\164"] : 0; goto n7Ad4; PIc76: $styleArray["\x66\x6f\156\164"]["\x62\157\154\144"] = $fontAttributes["\102\x6f\x6c\x64"] == "\61" ? true : false; goto uRWxm; AdR97: $styleArray["\x66\x6f\156\164"]["\x63\x6f\154\x6f\162"]["\x72\x67\142"] = $RGB; goto WEbm3; dJa43: switch ($styleAttributes["\x48\x41\x6c\x69\147\156"]) { case "\x31": $styleArray["\x61\x6c\151\x67\156\155\145\x6e\164"]["\x68\x6f\162\151\x7a\x6f\156\164\x61\154"] = PHPExcel_Style_Alignment::HORIZONTAL_GENERAL; break; case "\x32": $styleArray["\x61\154\151\x67\156\155\x65\156\164"]["\150\157\x72\151\x7a\157\156\x74\141\154"] = PHPExcel_Style_Alignment::HORIZONTAL_LEFT; break; case "\64": $styleArray["\x61\x6c\x69\147\156\155\145\x6e\164"]["\150\x6f\x72\x69\x7a\157\x6e\x74\141\154"] = PHPExcel_Style_Alignment::HORIZONTAL_RIGHT; break; case "\x38": $styleArray["\x61\154\151\147\156\x6d\145\x6e\x74"]["\x68\x6f\x72\151\x7a\157\x6e\164\x61\x6c"] = PHPExcel_Style_Alignment::HORIZONTAL_CENTER; break; case "\x31\x36": case "\x36\64": $styleArray["\x61\x6c\x69\x67\x6e\x6d\145\x6e\x74"]["\150\157\x72\151\172\157\x6e\164\x61\154"] = PHPExcel_Style_Alignment::HORIZONTAL_CENTER_CONTINUOUS; break; case "\63\62": $styleArray["\141\x6c\x69\147\156\x6d\145\x6e\x74"]["\x68\x6f\162\151\172\157\x6e\x74\x61\x6c"] = PHPExcel_Style_Alignment::HORIZONTAL_JUSTIFY; break; } goto zzauD; uRWxm: $styleArray["\146\x6f\x6e\164"]["\151\x74\141\x6c\x69\143"] = $fontAttributes["\111\x74\141\x6c\x69\x63"] == "\61" ? true : false; goto zA5tE; fC3OC: if (isset($styleRegion->Style->HyperLink)) { $hyperlink = $styleRegion->Style->HyperLink->attributes(); } goto QSRZu; QSRZu: } goto ulfyb; PTv8a: $styleArray["\156\165\x6d\142\x65\x72\x66\157\162\155\141\164"]["\143\x6f\144\x65"] = (string) $styleAttributes["\x46\157\162\x6d\141\x74"]; goto Ds5AP; ulfyb: $objPHPExcel->getActiveSheet()->getStyle($cellRange)->applyFromArray($styleArray); goto ru0ZW; ru0ZW: } goto lAQhr; PZjou: $endRow = $styleAttributes["\145\x6e\x64\122\x6f\167"] > $maxRow ? $maxRow : $styleAttributes["\145\x6e\144\122\x6f\x77"]; goto L0TAz; Lqa1_: $endColumn = PHPExcel_Cell::stringFromColumnIndex($endColumn); goto PZjou; KpLd0: $startColumn = PHPExcel_Cell::stringFromColumnIndex((int) $styleAttributes["\x73\164\x61\x72\164\103\x6f\x6c"]); goto KH99j; KH99j: $startRow = $styleAttributes["\163\x74\141\x72\x74\x52\x6f\x77"] + 1; goto hP0dI; KYFJ3: $cellRange = $startColumn . $startRow . "\x3a" . $endColumn . $endRow; goto Ie_h0; lAQhr: } } goto FVRIs; QKhqI: foreach ($sheet->Cells->Cell as $cell) { goto jnETZ; fqF47: if ($ExprID > '') { if ((string) $cell > '') { $this->expressions[$ExprID] = array("\143\x6f\x6c\x75\155\156" => $cellAttributes->Col, "\x72\157\x77" => $cellAttributes->Row, "\146\x6f\x72\155\x75\x6c\x61" => (string) $cell); } else { $expression = $this->expressions[$ExprID]; $cell = $this->referenceHelper->updateFormulaReferences($expression["\146\157\162\155\x75\154\x61"], "\101\x31", $cellAttributes->Col - $expression["\143\157\x6c\165\155\x6e"], $cellAttributes->Row - $expression["\162\x6f\x77"], $worksheetName); } $type = PHPExcel_Cell_DataType::TYPE_FORMULA; } else { switch ($ValueType) { case "\61\x30": $type = PHPExcel_Cell_DataType::TYPE_NULL; break; case "\62\x30": goto R8y3A; agUx_: break; goto xUd5z; R8y3A: $type = PHPExcel_Cell_DataType::TYPE_BOOL; goto rc3SV; rc3SV: $cell = $cell == "\x54\x52\x55\105" ? true : false; goto agUx_; xUd5z: case "\x33\x30": $cell = intval($cell); case "\64\x30": $type = PHPExcel_Cell_DataType::TYPE_NUMERIC; break; case "\x35\x30": $type = PHPExcel_Cell_DataType::TYPE_ERROR; break; case "\x36\60": $type = PHPExcel_Cell_DataType::TYPE_STRING; break; case "\x37\x30": case "\70\60": } } goto hLkUu; UDc9A: $ExprID = (string) $cellAttributes->ExprID; goto zucle; DPkLT: if ($this->getReadFilter() !== null) { if (!$this->getReadFilter()->readCell($column, $row, $worksheetName)) { continue; } } goto FRF0J; VGuOQ: $column = (int) $cellAttributes->Col; goto hDzQS; nQtxT: if ($column > $maxCol) { $maxCol = $column; } goto uzIjI; hLkUu: $objPHPExcel->getActiveSheet()->getCell($column . $row)->setValueExplicit($cell, $type); goto S5_OS; A1t07: $row = (int) $cellAttributes->Row + 1; goto VGuOQ; FRF0J: $ValueType = $cellAttributes->ValueType; goto UDc9A; hDzQS: if ($row > $maxRow) { $maxRow = $row; } goto nQtxT; zucle: $type = PHPExcel_Cell_DataType::TYPE_FORMULA; goto fqF47; jnETZ: $cellAttributes = $cell->attributes(); goto A1t07; uzIjI: $column = PHPExcel_Cell::stringFromColumnIndex($column); goto DPkLT; S5_OS: } goto eRYmt; jtYVA: $worksheetID++; goto Toh_x; eRYmt: if (!$this->readDataOnly && isset($sheet->Objects)) { foreach ($sheet->Objects->children("\147\156\155", true) as $key => $comment) { $commentAttributes = $comment->attributes(); if ($commentAttributes->Text) { $objPHPExcel->getActiveSheet()->getComment((string) $commentAttributes->ObjectBound)->setAuthor((string) $commentAttributes->Author)->setText($this->parseRichText((string) $commentAttributes->Text)); } } } goto PvLGL; pPTJZ: $maxRow = $maxCol = 0; goto WBS8b; GFOBS: $worksheetName = (string) $sheet->Name; goto FONlC; ajtGH: if (!$this->readDataOnly && isset($sheet->PrintInformation)) { if (isset($sheet->PrintInformation->Margins)) { foreach ($sheet->PrintInformation->Margins->children("\147\156\155", true) as $key => $margin) { goto Qi9Ob; jCBqN: $marginSize = 72 / 100; goto pooHB; Qi9Ob: $marginAttributes = $margin->attributes(); goto jCBqN; DJ0wG: switch ($key) { case "\x74\157\x70": $objPHPExcel->getActiveSheet()->getPageMargins()->setTop($marginSize); break; case "\x62\x6f\164\164\x6f\155": $objPHPExcel->getActiveSheet()->getPageMargins()->setBottom($marginSize); break; case "\154\x65\146\164": $objPHPExcel->getActiveSheet()->getPageMargins()->setLeft($marginSize); break; case "\x72\x69\x67\x68\x74": $objPHPExcel->getActiveSheet()->getPageMargins()->setRight($marginSize); break; case "\150\x65\x61\144\x65\x72": $objPHPExcel->getActiveSheet()->getPageMargins()->setHeader($marginSize); break; case "\146\x6f\x6f\164\x65\162": $objPHPExcel->getActiveSheet()->getPageMargins()->setFooter($marginSize); break; } goto sBfB2; pooHB: switch ($marginAttributes["\120\162\145\x66\x55\156\x69\164"]) { case "\x6d\x6d": $marginSize = intval($marginAttributes["\x50\157\151\x6e\164\x73"]) / 100; break; } goto DJ0wG; sBfB2: } } } goto QKhqI; CivXW: $objPHPExcel->getActiveSheet()->setTitle($worksheetName, false); goto ajtGH; kZUkj: if (isset($sheet->MergedRegions)) { foreach ($sheet->MergedRegions->Merge as $mergeCells) { if (strpos($mergeCells, "\x3a") !== false) { $objPHPExcel->getActiveSheet()->mergeCells($mergeCells); } } } goto jtYVA; LXTpq: $objPHPExcel->setActiveSheetIndex($worksheetID); goto CivXW; Toh_x: } goto D01_K; KW12E: $worksheetID = 0; goto aA37H; iu8aH: $xml = simplexml_load_string($this->securityScan($gFileData), "\123\x69\155\x70\x6c\x65\130\x4d\114\x45\154\x65\155\x65\156\164", PHPExcel_Settings::getLibXmlLoaderOptions()); goto rwOqG; P0_SH: } private static function parseBorderAttributes($borderAttributes) { goto htpUN; B58MG: return $styleArray; goto KQ1wU; htpUN: $styleArray = array(); goto BSALy; XHdIW: switch ($borderAttributes["\x53\164\x79\x6c\145"]) { case "\x30": $styleArray["\163\x74\171\154\x65"] = PHPExcel_Style_Border::BORDER_NONE; break; case "\x31": $styleArray["\x73\164\171\x6c\145"] = PHPExcel_Style_Border::BORDER_THIN; break; case "\x32": $styleArray["\163\x74\171\x6c\x65"] = PHPExcel_Style_Border::BORDER_MEDIUM; break; case "\63": $styleArray["\163\164\x79\x6c\145"] = PHPExcel_Style_Border::BORDER_SLANTDASHDOT; break; case "\64": $styleArray["\163\x74\x79\154\145"] = PHPExcel_Style_Border::BORDER_DASHED; break; case "\x35": $styleArray["\x73\164\x79\154\x65"] = PHPExcel_Style_Border::BORDER_THICK; break; case "\66": $styleArray["\163\164\171\x6c\x65"] = PHPExcel_Style_Border::BORDER_DOUBLE; break; case "\67": $styleArray["\163\x74\x79\x6c\145"] = PHPExcel_Style_Border::BORDER_DOTTED; break; case "\x38": $styleArray["\x73\x74\x79\x6c\145"] = PHPExcel_Style_Border::BORDER_MEDIUMDASHED; break; case "\x39": $styleArray["\x73\x74\x79\x6c\145"] = PHPExcel_Style_Border::BORDER_DASHDOT; break; case "\61\60": $styleArray["\163\164\171\x6c\x65"] = PHPExcel_Style_Border::BORDER_MEDIUMDASHDOT; break; case "\x31\61": $styleArray["\163\x74\x79\154\145"] = PHPExcel_Style_Border::BORDER_DASHDOTDOT; break; case "\x31\62": $styleArray["\163\164\171\154\x65"] = PHPExcel_Style_Border::BORDER_MEDIUMDASHDOTDOT; break; case "\61\63": $styleArray["\x73\x74\171\x6c\145"] = PHPExcel_Style_Border::BORDER_MEDIUMDASHDOTDOT; break; } goto B58MG; BSALy: if (isset($borderAttributes["\x43\157\154\157\162"])) { $styleArray["\x63\x6f\154\x6f\x72"]["\x72\x67\142"] = self::parseGnumericColour($borderAttributes["\x43\157\x6c\157\162"]); } goto XHdIW; KQ1wU: } private function parseRichText($is = '') { goto fsD2_; RsguY: $value->createText($is); goto bGc0m; fsD2_: $value = new PHPExcel_RichText(); goto RsguY; bGc0m: return $value; goto X2gaa; X2gaa: } private static function parseGnumericColour($gnmColour) { goto LIIP0; LIIP0: list($gnmR, $gnmG, $gnmB) = explode("\72", $gnmColour); goto kV0mL; kV0mL: $gnmR = substr(str_pad($gnmR, 4, "\x30", STR_PAD_RIGHT), 0, 2); goto nAxMf; nAxMf: $gnmG = substr(str_pad($gnmG, 4, "\x30", STR_PAD_RIGHT), 0, 2); goto ly05D; DwKwy: return $gnmR . $gnmG . $gnmB; goto FcxRY; ly05D: $gnmB = substr(str_pad($gnmB, 4, "\60", STR_PAD_RIGHT), 0, 2); goto DwKwy; FcxRY: } }
