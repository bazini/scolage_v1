<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:03              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_CachedObjectStorage_SQLite extends PHPExcel_CachedObjectStorage_CacheBase implements PHPExcel_CachedObjectStorage_ICache { private $TableName = null; private $DBHandle = null; protected function storeData() { if ($this->currentCellIsDirty && !empty($this->currentObjectID)) { goto v6vRB; v6vRB: $this->currentObject->detach(); goto XILZD; YR__n: $this->currentCellIsDirty = false; goto SvDUv; XILZD: if (!$this->DBHandle->queryExec("\x49\x4e\x53\x45\122\x54\x20\x4f\122\40\122\105\x50\114\x41\103\x45\x20\111\x4e\124\x4f\x20\x6b\x76\x70\137" . $this->TableName . "\40\126\x41\114\125\x45\123\50\47" . $this->currentObjectID . "\x27\x2c\x27" . sqlite_escape_string(serialize($this->currentObject)) . "\47\x29")) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } goto YR__n; SvDUv: } $this->currentObjectID = $this->currentObject = null; } public function addCacheData($pCoord, PHPExcel_Cell $cell) { goto zM2_H; wDOAt: return $cell; goto S93fq; iVe1y: $this->currentCellIsDirty = true; goto wDOAt; zM2_H: if ($pCoord !== $this->currentObjectID && $this->currentObjectID !== null) { $this->storeData(); } goto FH6Oq; tbt3C: $this->currentObject = $cell; goto iVe1y; FH6Oq: $this->currentObjectID = $pCoord; goto tbt3C; S93fq: } public function getCacheData($pCoord) { goto SOnLn; Ffaqm: $this->storeData(); goto FAwKq; VNbCw: if ($cellResultSet === false) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } elseif ($cellResultSet->numRows() == 0) { return null; } goto pCwT0; jWrUz: $this->currentObject->attach($this); goto qdZLi; iViXM: $cellResultSet = $this->DBHandle->query($query, SQLITE_ASSOC); goto VNbCw; FAwKq: $query = "\x53\105\x4c\x45\103\124\40\x76\x61\x6c\165\145\x20\106\x52\x4f\115\40\x6b\166\160\x5f" . $this->TableName . "\x20\x57\110\105\122\105\x20\x69\144\x3d\x27" . $pCoord . "\x27"; goto iViXM; o_Q3I: $cellResult = $cellResultSet->fetchSingle(); goto ZDKrC; ZDKrC: $this->currentObject = unserialize($cellResult); goto jWrUz; pCwT0: $this->currentObjectID = $pCoord; goto o_Q3I; qdZLi: return $this->currentObject; goto ZzJt5; SOnLn: if ($pCoord === $this->currentObjectID) { return $this->currentObject; } goto Ffaqm; ZzJt5: } public function isDataSet($pCoord) { goto tmUEO; tmUEO: if ($pCoord === $this->currentObjectID) { return true; } goto d1v2J; d1v2J: $query = "\123\x45\114\105\x43\x54\40\151\x64\x20\x46\x52\x4f\115\40\153\166\x70\x5f" . $this->TableName . "\x20\127\110\105\122\105\40\x69\x64\75\x27" . $pCoord . "\47"; goto ImGj1; xs06X: return true; goto ffecx; ImGj1: $cellResultSet = $this->DBHandle->query($query, SQLITE_ASSOC); goto ivPjs; ivPjs: if ($cellResultSet === false) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } elseif ($cellResultSet->numRows() == 0) { return false; } goto xs06X; ffecx: } public function deleteCacheData($pCoord) { goto c_A2o; W01ig: $this->currentCellIsDirty = false; goto djtxL; WKXGL: $query = "\x44\x45\114\105\x54\105\x20\x46\122\x4f\x4d\x20\x6b\166\x70\137" . $this->TableName . "\x20\x57\110\x45\122\x45\40\151\x64\x3d\47" . $pCoord . "\x27"; goto Bxzza; Bxzza: if (!$this->DBHandle->queryExec($query)) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } goto W01ig; c_A2o: if ($pCoord === $this->currentObjectID) { $this->currentObject->detach(); $this->currentObjectID = $this->currentObject = null; } goto WKXGL; djtxL: } public function moveCell($fromAddress, $toAddress) { goto KXUK6; FyJgp: if ($result === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto ay35p; LWiw4: $query = "\104\105\x4c\105\x54\105\40\106\122\x4f\115\40\153\x76\160\137" . $this->TableName . "\40\127\x48\x45\x52\x45\x20\151\144\x3d\47" . $toAddress . "\47"; goto jwFfd; CU_HF: $query = "\125\120\x44\101\x54\x45\x20\153\166\x70\x5f" . $this->TableName . "\40\123\105\x54\40\151\x64\x3d\47" . $toAddress . "\47\x20\127\110\105\122\105\40\151\x64\x3d\x27" . $fromAddress . "\47"; goto kH2eO; MIuX_: if ($result === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto CU_HF; ay35p: return true; goto g0GZg; kH2eO: $result = $this->DBHandle->exec($query); goto FyJgp; KXUK6: if ($fromAddress === $this->currentObjectID) { $this->currentObjectID = $toAddress; } goto LWiw4; jwFfd: $result = $this->DBHandle->exec($query); goto MIuX_; g0GZg: } public function getCellList() { goto OJ5GO; XN8eq: foreach ($cellIdsResult as $row) { $cellKeys[] = $row["\151\144"]; } goto whLCr; UgdBa: if ($cellIdsResult === false) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } goto d8Vok; R18wP: $query = "\123\105\114\x45\103\124\40\x69\144\x20\106\x52\x4f\115\x20\153\x76\x70\x5f" . $this->TableName; goto qJS54; qJS54: $cellIdsResult = $this->DBHandle->unbufferedQuery($query, SQLITE_ASSOC); goto UgdBa; whLCr: return $cellKeys; goto JP9gM; d8Vok: $cellKeys = array(); goto XN8eq; OJ5GO: if ($this->currentObjectID !== null) { $this->storeData(); } goto R18wP; JP9gM: } public function copyCellCollection(PHPExcel_Worksheet $parent) { goto oA1qk; oUFCq: if (!$this->DBHandle->queryExec("\x43\x52\105\x41\124\x45\x20\124\101\x42\114\105\40\x6b\x76\x70\x5f" . $tableName . "\40\50\x69\144\40\x56\101\122\x43\x48\x41\x52\50\x31\x32\x29\x20\x50\x52\111\x4d\101\x52\131\x20\113\105\x59\x2c\x20\166\141\154\x75\x65\40\102\x4c\x4f\102\x29\xa\40\x20\x20\x20\40\40\x20\40\40\x20\40\40\x41\x53\40\x53\105\x4c\105\x43\x54\40\52\40\x46\x52\x4f\115\x20\x6b\166\160\x5f" . $this->TableName)) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } goto tn7fp; PqdLb: $tableName = str_replace("\56", "\137", $this->getUniqueID()); goto oUFCq; tn7fp: $this->TableName = $tableName; goto S0mH3; oA1qk: $this->currentCellIsDirty; goto jyuRm; jyuRm: $this->storeData(); goto PqdLb; S0mH3: } public function unsetWorksheetCells() { goto bwsxm; bwsxm: if (!is_null($this->currentObject)) { $this->currentObject->detach(); $this->currentObject = $this->currentObjectID = null; } goto pmsCi; JY382: $this->__destruct(); goto c_zhb; pmsCi: $this->parent = null; goto JY382; c_zhb: } public function __construct(PHPExcel_Worksheet $parent) { parent::__construct($parent); if (is_null($this->DBHandle)) { goto CT3tc; HqPec: if ($this->DBHandle === false) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } goto J5WMG; J5WMG: if (!$this->DBHandle->queryExec("\x43\122\105\101\x54\105\40\x54\x41\x42\114\105\x20\153\166\160\137" . $this->TableName . "\x20\50\151\144\x20\126\x41\122\x43\x48\x41\x52\x28\61\62\x29\x20\120\122\x49\x4d\x41\x52\131\x20\x4b\x45\x59\54\40\x76\141\x6c\x75\x65\40\102\x4c\117\102\51")) { throw new PHPExcel_Exception(sqlite_error_string($this->DBHandle->lastError())); } goto OSPs4; CT3tc: $this->TableName = str_replace("\56", "\137", $this->getUniqueID()); goto GOWv3; HySy5: $this->DBHandle = new SQLiteDatabase($_DBName); goto HqPec; GOWv3: $_DBName = "\x3a\x6d\145\155\157\162\x79\72"; goto HySy5; OSPs4: } } public function __destruct() { if (!is_null($this->DBHandle)) { $this->DBHandle->queryExec("\x44\122\x4f\x50\x20\x54\101\x42\x4c\105\40\153\166\160\137" . $this->TableName); } $this->DBHandle = null; } public static function cacheMethodIsAvailable() { if (!function_exists("\163\x71\x6c\151\x74\145\137\x6f\x70\x65\x6e")) { return false; } return true; } }
