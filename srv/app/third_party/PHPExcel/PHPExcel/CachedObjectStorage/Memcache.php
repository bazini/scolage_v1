<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:03              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_CachedObjectStorage_Memcache extends PHPExcel_CachedObjectStorage_CacheBase implements PHPExcel_CachedObjectStorage_ICache { private $cachePrefix = null; private $cacheTime = 600; private $memcache = null; protected function storeData() { if ($this->currentCellIsDirty && !empty($this->currentObjectID)) { goto uEqYf; xTmte: if (!$this->memcache->replace($this->cachePrefix . $this->currentObjectID . "\x2e\143\x61\143\x68\145", $obj, null, $this->cacheTime)) { if (!$this->memcache->add($this->cachePrefix . $this->currentObjectID . "\x2e\x63\141\143\150\145", $obj, null, $this->cacheTime)) { $this->__destruct(); throw new PHPExcel_Exception("\106\x61\151\154\145\x64\x20\x74\157\40\x73\164\157\162\145\x20\x63\x65\x6c\154\40{$this->currentObjectID}\40\x69\156\x20\x4d\x65\155\103\141\x63\x68\145"); } } goto paqQp; paqQp: $this->currentCellIsDirty = false; goto EfRe4; uEqYf: $this->currentObject->detach(); goto wr5V2; wr5V2: $obj = serialize($this->currentObject); goto xTmte; EfRe4: } $this->currentObjectID = $this->currentObject = null; } public function addCacheData($pCoord, PHPExcel_Cell $cell) { goto yOWKx; C7bLg: $this->cellCache[$pCoord] = true; goto YowkH; YowkH: $this->currentObjectID = $pCoord; goto E3UXz; E3UXz: $this->currentObject = $cell; goto sfz0H; ne5YT: return $cell; goto c56O3; yOWKx: if ($pCoord !== $this->currentObjectID && $this->currentObjectID !== null) { $this->storeData(); } goto C7bLg; sfz0H: $this->currentCellIsDirty = true; goto ne5YT; c56O3: } public function isDataSet($pCoord) { if (parent::isDataSet($pCoord)) { goto b5oBU; b5oBU: if ($this->currentObjectID == $pCoord) { return true; } goto i29aj; i29aj: $success = $this->memcache->get($this->cachePrefix . $pCoord . "\56\143\x61\143\150\x65"); goto BUoC7; MQNEW: return true; goto bNuL0; BUoC7: if ($success === false) { parent::deleteCacheData($pCoord); throw new PHPExcel_Exception("\x43\x65\x6c\154\x20\145\x6e\x74\x72\171\x20" . $pCoord . "\40\156\x6f\x20\154\x6f\156\x67\x65\162\x20\x65\170\151\163\164\x73\40\151\x6e\x20\x4d\145\155\103\141\x63\x68\x65"); } goto MQNEW; bNuL0: } return false; } public function getCacheData($pCoord) { goto BbtPV; N_yYd: $this->currentObject->attach($this); goto xS398; BbtPV: if ($pCoord === $this->currentObjectID) { return $this->currentObject; } goto KUXIq; xS398: return $this->currentObject; goto bC9Sh; VRV19: $this->currentObject = unserialize($obj); goto N_yYd; r83nc: $this->currentObjectID = $pCoord; goto VRV19; ebZEu: if (parent::isDataSet($pCoord)) { $obj = $this->memcache->get($this->cachePrefix . $pCoord . "\56\143\141\143\x68\145"); if ($obj === false) { parent::deleteCacheData($pCoord); throw new PHPExcel_Exception("\103\x65\154\x6c\40\x65\x6e\x74\x72\171\40{$pCoord}\40\x6e\x6f\x20\x6c\157\156\x67\x65\162\40\x65\x78\x69\x73\164\163\40\x69\156\x20\115\x65\155\103\x61\143\x68\x65"); } } else { return null; } goto r83nc; KUXIq: $this->storeData(); goto ebZEu; bC9Sh: } public function getCellList() { if ($this->currentObjectID !== null) { $this->storeData(); } return parent::getCellList(); } public function deleteCacheData($pCoord) { $this->memcache->delete($this->cachePrefix . $pCoord . "\56\x63\141\x63\150\x65"); parent::deleteCacheData($pCoord); } public function copyCellCollection(PHPExcel_Worksheet $parent) { goto PgcU0; tATD0: $this->cachePrefix = $newCachePrefix; goto NGzsw; CaaRj: $baseUnique = $this->getUniqueID(); goto YAXNT; yiDqQ: foreach ($cacheList as $cellID) { if ($cellID != $this->currentObjectID) { goto cP8on; azpz5: if ($obj === false) { parent::deleteCacheData($cellID); throw new PHPExcel_Exception("\103\x65\x6c\x6c\x20\145\x6e\x74\162\x79\40{$cellID}\x20\156\x6f\40\154\157\x6e\147\x65\x72\x20\145\170\151\163\164\x73\x20\x69\x6e\x20\115\145\155\x43\141\143\x68\145"); } goto ZtCHU; ZtCHU: if (!$this->memcache->add($newCachePrefix . $cellID . "\56\x63\141\x63\x68\x65", $obj, null, $this->cacheTime)) { $this->__destruct(); throw new PHPExcel_Exception("\106\x61\151\x6c\145\x64\x20\164\157\40\163\x74\x6f\162\x65\x20\x63\145\154\x6c\40{$cellID}\x20\151\x6e\x20\115\x65\155\x43\x61\x63\x68\x65"); } goto cjxaT; cP8on: $obj = $this->memcache->get($this->cachePrefix . $cellID . "\x2e\x63\x61\143\x68\x65"); goto azpz5; cjxaT: } } goto tATD0; PgcU0: parent::copyCellCollection($parent); goto CaaRj; YAXNT: $newCachePrefix = substr(md5($baseUnique), 0, 8) . "\56"; goto xP34K; xP34K: $cacheList = $this->getCellList(); goto yiDqQ; NGzsw: } public function unsetWorksheetCells() { goto TM566; tWXNu: $this->cellCache = array(); goto AIy0M; mUCbq: $this->__destruct(); goto tWXNu; TM566: if (!is_null($this->currentObject)) { $this->currentObject->detach(); $this->currentObject = $this->currentObjectID = null; } goto mUCbq; AIy0M: $this->parent = null; goto m4_TZ; m4_TZ: } public function __construct(PHPExcel_Worksheet $parent, $arguments) { goto kj3Oy; qpQ3f: $cacheTime = isset($arguments["\143\x61\x63\x68\145\x54\151\x6d\145"]) ? $arguments["\x63\x61\143\x68\x65\124\151\155\x65"] : 600; goto SDnZo; klc1R: $memcachePort = isset($arguments["\155\145\x6d\x63\141\x63\x68\145\x50\x6f\x72\164"]) ? $arguments["\155\145\x6d\143\x61\143\150\145\x50\157\x72\164"] : 11211; goto qpQ3f; SDnZo: if (is_null($this->cachePrefix)) { goto d3GK7; B28Fk: parent::__construct($parent); goto GD1ih; UAVMc: if (!$this->memcache->addServer($memcacheServer, $memcachePort, false, 50, 5, 5, true, array($this, "\x66\x61\151\154\x75\x72\145\103\x61\x6c\x6c\142\x61\x63\x6b"))) { throw new PHPExcel_Exception("\x43\x6f\165\154\x64\x20\156\157\x74\x20\x63\x6f\156\x6e\145\x63\x74\40\x74\x6f\40\x4d\145\x6d\x43\141\143\x68\145\40\163\145\162\166\145\162\40\x61\x74\x20{$memcacheServer}\72{$memcachePort}"); } goto zTHBP; eWIEC: $this->memcache = new Memcache(); goto UAVMc; Z8Gr2: $this->cachePrefix = substr(md5($baseUnique), 0, 8) . "\x2e"; goto eWIEC; d3GK7: $baseUnique = $this->getUniqueID(); goto Z8Gr2; zTHBP: $this->cacheTime = $cacheTime; goto B28Fk; GD1ih: } goto Q00jp; kj3Oy: $memcacheServer = isset($arguments["\x6d\x65\155\143\x61\143\150\x65\x53\145\x72\166\145\x72"]) ? $arguments["\x6d\x65\x6d\x63\141\x63\150\145\123\145\162\166\145\162"] : "\x6c\157\x63\141\x6c\x68\x6f\163\x74"; goto klc1R; Q00jp: } public function failureCallback($host, $port) { throw new PHPExcel_Exception("\155\x65\x6d\143\141\x63\150\x65\x20{$host}\x3a{$port}\40\146\141\151\x6c\145\144"); } public function __destruct() { $cacheList = $this->getCellList(); foreach ($cacheList as $cellID) { $this->memcache->delete($this->cachePrefix . $cellID . "\x2e\x63\141\143\x68\145"); } } public static function cacheMethodIsAvailable() { if (!function_exists("\155\145\x6d\x63\141\143\150\145\x5f\x61\144\144")) { return false; } return true; } }
