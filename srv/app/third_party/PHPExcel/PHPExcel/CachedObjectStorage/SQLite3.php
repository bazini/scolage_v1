<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:03              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_CachedObjectStorage_SQLite3 extends PHPExcel_CachedObjectStorage_CacheBase implements PHPExcel_CachedObjectStorage_ICache { private $TableName = null; private $DBHandle = null; private $selectQuery; private $insertQuery; private $updateQuery; private $deleteQuery; protected function storeData() { if ($this->currentCellIsDirty && !empty($this->currentObjectID)) { goto Yi6kY; xKHZS: $this->currentCellIsDirty = false; goto Sj0hW; Yi6kY: $this->currentObject->detach(); goto ATH3U; mWl4P: $this->insertQuery->bindValue("\144\141\x74\x61", serialize($this->currentObject), SQLITE3_BLOB); goto hu159; MU5Nw: if ($result === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto xKHZS; hu159: $result = $this->insertQuery->execute(); goto MU5Nw; ATH3U: $this->insertQuery->bindValue("\x69\144", $this->currentObjectID, SQLITE3_TEXT); goto mWl4P; Sj0hW: } $this->currentObjectID = $this->currentObject = null; } public function addCacheData($pCoord, PHPExcel_Cell $cell) { goto uA4YD; uA4YD: if ($pCoord !== $this->currentObjectID && $this->currentObjectID !== null) { $this->storeData(); } goto aKJEi; pndxQ: $this->currentObject = $cell; goto mm3wi; mm3wi: $this->currentCellIsDirty = true; goto ayTpN; ayTpN: return $cell; goto TqsEy; aKJEi: $this->currentObjectID = $pCoord; goto pndxQ; TqsEy: } public function getCacheData($pCoord) { goto geqCz; qwoct: $this->currentObjectID = $pCoord; goto oO3e_; Ubram: $this->currentObject->attach($this); goto nd7E2; dx2fs: $this->selectQuery->bindValue("\x69\x64", $pCoord, SQLITE3_TEXT); goto Ac4z4; nd7E2: return $this->currentObject; goto ISNpQ; WnOCo: $this->storeData(); goto dx2fs; Ac4z4: $cellResult = $this->selectQuery->execute(); goto XGEUs; oO3e_: $this->currentObject = unserialize($cellData["\x76\141\154\165\145"]); goto Ubram; mBFHB: $cellData = $cellResult->fetchArray(SQLITE3_ASSOC); goto t2dyx; geqCz: if ($pCoord === $this->currentObjectID) { return $this->currentObject; } goto WnOCo; t2dyx: if ($cellData === false) { return null; } goto qwoct; XGEUs: if ($cellResult === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto mBFHB; ISNpQ: } public function isDataSet($pCoord) { goto HQ2Jb; HQ2Jb: if ($pCoord === $this->currentObjectID) { return true; } goto XCoVQ; DPR2W: $cellData = $cellResult->fetchArray(SQLITE3_ASSOC); goto tTvFk; XCoVQ: $this->selectQuery->bindValue("\x69\144", $pCoord, SQLITE3_TEXT); goto FKVqd; tTvFk: return $cellData === false ? false : true; goto oWSdT; NtL1F: if ($cellResult === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto DPR2W; FKVqd: $cellResult = $this->selectQuery->execute(); goto NtL1F; oWSdT: } public function deleteCacheData($pCoord) { goto aWKl6; W6Nu9: if ($result === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto o0Tj3; D5DX_: $this->deleteQuery->bindValue("\151\144", $pCoord, SQLITE3_TEXT); goto a2Ue4; o0Tj3: $this->currentCellIsDirty = false; goto Z5TZl; a2Ue4: $result = $this->deleteQuery->execute(); goto W6Nu9; aWKl6: if ($pCoord === $this->currentObjectID) { $this->currentObject->detach(); $this->currentObjectID = $this->currentObject = null; } goto D5DX_; Z5TZl: } public function moveCell($fromAddress, $toAddress) { goto N4mmh; Ezgkk: $this->updateQuery->bindValue("\x66\162\157\155\x69\144", $fromAddress, SQLITE3_TEXT); goto oh9SP; yQuip: $this->deleteQuery->bindValue("\x69\x64", $toAddress, SQLITE3_TEXT); goto hbpBQ; WVUwr: $this->updateQuery->bindValue("\x74\x6f\151\144", $toAddress, SQLITE3_TEXT); goto Ezgkk; N4mmh: if ($fromAddress === $this->currentObjectID) { $this->currentObjectID = $toAddress; } goto yQuip; lSEz4: if ($result === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto WVUwr; hV0bb: if ($result === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto wqL3C; wqL3C: return true; goto rqR07; oh9SP: $result = $this->updateQuery->execute(); goto hV0bb; hbpBQ: $result = $this->deleteQuery->execute(); goto lSEz4; rqR07: } public function getCellList() { goto W7Wqq; nK3G2: $cellIdsResult = $this->DBHandle->query($query); goto Fw24C; YDqP1: $cellKeys = array(); goto xgkmh; W7Wqq: if ($this->currentObjectID !== null) { $this->storeData(); } goto Byoqv; Fw24C: if ($cellIdsResult === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto YDqP1; xgkmh: while ($row = $cellIdsResult->fetchArray(SQLITE3_ASSOC)) { $cellKeys[] = $row["\151\144"]; } goto HuaFF; HuaFF: return $cellKeys; goto hndzC; Byoqv: $query = "\x53\105\x4c\105\x43\x54\x20\x69\x64\40\106\x52\117\x4d\40\x6b\x76\x70\x5f" . $this->TableName; goto nK3G2; hndzC: } public function copyCellCollection(PHPExcel_Worksheet $parent) { goto j03to; T7jqO: $this->storeData(); goto qmMEd; qmMEd: $tableName = str_replace("\x2e", "\137", $this->getUniqueID()); goto rUU1T; j03to: $this->currentCellIsDirty; goto T7jqO; rUU1T: if (!$this->DBHandle->exec("\x43\122\105\x41\x54\x45\x20\x54\101\102\x4c\105\x20\x6b\x76\160\137" . $tableName . "\40\50\x69\144\x20\126\x41\122\103\110\101\x52\50\x31\x32\51\40\x50\122\x49\115\101\122\131\x20\113\105\131\54\40\166\x61\154\x75\x65\x20\102\114\117\102\51\12\x20\x20\x20\40\40\x20\40\x20\x20\40\40\x20\x41\123\x20\123\105\114\105\x43\124\40\52\x20\106\x52\x4f\x4d\40\x6b\x76\x70\137" . $this->TableName)) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto oddPL; oddPL: $this->TableName = $tableName; goto ef10c; ef10c: } public function unsetWorksheetCells() { goto EyK8S; EyK8S: if (!is_null($this->currentObject)) { $this->currentObject->detach(); $this->currentObject = $this->currentObjectID = null; } goto MHwOF; MHwOF: $this->parent = null; goto eqO7t; eqO7t: $this->__destruct(); goto cmxXJ; cmxXJ: } public function __construct(PHPExcel_Worksheet $parent) { goto uxkgo; XFmmo: $this->selectQuery = $this->DBHandle->prepare("\123\x45\x4c\105\103\124\40\166\x61\x6c\165\x65\40\x46\x52\117\115\x20\x6b\x76\160\137" . $this->TableName . "\40\127\110\x45\122\x45\x20\151\x64\40\x3d\x20\72\x69\144"); goto XjOCR; HsDHc: $this->deleteQuery = $this->DBHandle->prepare("\x44\105\x4c\105\124\105\40\x46\x52\x4f\x4d\x20\153\166\x70\137" . $this->TableName . "\40\x57\110\x45\x52\105\x20\151\144\x20\x3d\x20\72\x69\x64"); goto Z1Ymk; EzCZd: $this->updateQuery = $this->DBHandle->prepare("\x55\x50\104\101\x54\x45\40\x6b\x76\x70\137" . $this->TableName . "\40\x53\105\124\40\x69\x64\75\x3a\x74\x6f\x49\144\x20\x57\x48\x45\x52\x45\40\x69\144\75\x3a\x66\x72\157\155\111\x64"); goto HsDHc; XjOCR: $this->insertQuery = $this->DBHandle->prepare("\x49\x4e\123\x45\122\x54\40\117\122\x20\122\x45\120\x4c\x41\103\x45\40\111\116\x54\x4f\x20\153\166\x70\x5f" . $this->TableName . "\x20\126\101\114\x55\x45\123\50\x3a\151\144\x2c\x3a\144\x61\164\x61\51"); goto EzCZd; uxkgo: parent::__construct($parent); goto K6EXm; K6EXm: if (is_null($this->DBHandle)) { goto wuT09; kHLpJ: $this->DBHandle = new SQLite3($_DBName); goto bpjWu; bpjWu: if ($this->DBHandle === false) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto Nx6S3; r0PpV: $_DBName = "\x3a\155\x65\x6d\157\x72\x79\72"; goto kHLpJ; Nx6S3: if (!$this->DBHandle->exec("\x43\x52\x45\x41\x54\x45\x20\x54\101\102\x4c\x45\x20\153\x76\x70\x5f" . $this->TableName . "\x20\50\x69\144\40\x56\x41\x52\x43\110\x41\x52\x28\x31\x32\51\40\x50\122\111\115\101\122\131\40\113\x45\131\54\40\x76\141\154\x75\145\40\102\x4c\x4f\102\x29")) { throw new PHPExcel_Exception($this->DBHandle->lastErrorMsg()); } goto v0iti; wuT09: $this->TableName = str_replace("\56", "\137", $this->getUniqueID()); goto r0PpV; v0iti: } goto XFmmo; Z1Ymk: } public function __destruct() { if (!is_null($this->DBHandle)) { $this->DBHandle->exec("\104\122\x4f\x50\40\x54\101\x42\114\105\40\153\x76\x70\x5f" . $this->TableName); $this->DBHandle->close(); } $this->DBHandle = null; } public static function cacheMethodIsAvailable() { if (!class_exists("\x53\121\114\151\x74\145\x33", false)) { return false; } return true; } }
