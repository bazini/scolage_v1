<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:12:04              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 class PHPExcel_Calculation_FormulaParser { const QUOTE_DOUBLE = "\42"; const QUOTE_SINGLE = "\47"; const BRACKET_CLOSE = "\135"; const BRACKET_OPEN = "\133"; const BRACE_OPEN = "\173"; const BRACE_CLOSE = "\175"; const PAREN_OPEN = "\x28"; const PAREN_CLOSE = "\51"; const SEMICOLON = "\x3b"; const WHITESPACE = "\x20"; const COMMA = "\54"; const ERROR_START = "\x23"; const OPERATORS_SN = "\x2b\x2d"; const OPERATORS_INFIX = "\x2b\x2d\x2a\x2f\x5e\46\x3d\76\x3c"; const OPERATORS_POSTFIX = "\x25"; private $formula; private $tokens = array(); public function __construct($pFormula = '') { goto lUgCz; b45uB: $this->formula = trim($pFormula); goto XTRxR; XTRxR: $this->parseToTokens(); goto qQBb3; lUgCz: if (is_null($pFormula)) { throw new PHPExcel_Calculation_Exception("\111\x6e\x76\x61\154\151\144\40\160\141\x72\141\x6d\145\164\x65\x72\40\160\141\163\x73\x65\x64\x3a\40\x66\157\x72\155\x75\154\141"); } goto b45uB; qQBb3: } public function getFormula() { return $this->formula; } public function getToken($pId = 0) { if (isset($this->tokens[$pId])) { return $this->tokens[$pId]; } else { throw new PHPExcel_Calculation_Exception("\124\157\153\x65\x6e\x20\x77\151\x74\x68\40\151\x64\x20{$pId}\40\x64\x6f\x65\x73\x20\156\x6f\x74\40\x65\170\151\163\x74\x2e"); } } public function getTokenCount() { return count($this->tokens); } public function getTokens() { return $this->tokens; } private function parseToTokens() { goto OJS_v; HxmFe: $inString = $inPath = $inRange = $inError = false; goto Tggu1; F6aCi: while ($index < $formulaLength) { if ($inString) { goto UKfR6; UKfR6: if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::QUOTE_DOUBLE) { if ($index + 2 <= $formulaLength && $this->formula[$index + 1] == PHPExcel_Calculation_FormulaParser::QUOTE_DOUBLE) { $value .= PHPExcel_Calculation_FormulaParser::QUOTE_DOUBLE; ++$index; } else { goto yjfL1; XztQW: $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_TEXT); goto GgEmQ; yjfL1: $inString = false; goto XztQW; GgEmQ: $value = ''; goto OBOdm; OBOdm: } } else { $value .= $this->formula[$index]; } goto bUuGr; bUuGr: ++$index; goto oEMuY; oEMuY: continue; goto CNpoZ; CNpoZ: } if ($inPath) { goto YUPZE; LakAa: ++$index; goto Wv7W1; YUPZE: if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::QUOTE_SINGLE) { if ($index + 2 <= $formulaLength && $this->formula[$index + 1] == PHPExcel_Calculation_FormulaParser::QUOTE_SINGLE) { $value .= PHPExcel_Calculation_FormulaParser::QUOTE_SINGLE; ++$index; } else { $inPath = false; } } else { $value .= $this->formula[$index]; } goto LakAa; Wv7W1: continue; goto T3Sow; T3Sow: } if ($inRange) { goto G2mkz; lPTfQ: ++$index; goto F1_iE; G2mkz: if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::BRACKET_CLOSE) { $inRange = false; } goto Sh0YU; F1_iE: continue; goto zq9uV; Sh0YU: $value .= $this->formula[$index]; goto lPTfQ; zq9uV: } if ($inError) { goto o51Od; o51Od: $value .= $this->formula[$index]; goto wKDqK; wKDqK: ++$index; goto IuNoz; QUH0Q: continue; goto OHVGh; IuNoz: if (in_array($value, $ERRORS)) { goto BA4C4; nX0lb: $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_ERROR); goto IWaGX; BA4C4: $inError = false; goto nX0lb; IWaGX: $value = ''; goto fcUF4; fcUF4: } goto QUH0Q; OHVGh: } if (strpos(PHPExcel_Calculation_FormulaParser::OPERATORS_SN, $this->formula[$index]) !== false) { if (strlen($value) > 1) { if (preg_match("\57\136\x5b\61\x2d\x39\135\173\x31\175\50\x5c\x2e\x5b\x30\x2d\x39\135\x2b\x29\77\x45\x7b\x31\175\44\x2f", $this->formula[$index]) != 0) { goto Ydh_a; Ydh_a: $value .= $this->formula[$index]; goto t_nBQ; nAlZw: continue; goto fklKY; t_nBQ: ++$index; goto nAlZw; fklKY: } } } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::QUOTE_DOUBLE) { goto HbZ9J; HbZ9J: if (strlen($value > 0)) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_UNKNOWN); $value = ''; } goto EYn_2; kMcNY: ++$index; goto HJO3e; EYn_2: $inString = true; goto kMcNY; HJO3e: continue; goto HA0Zw; HA0Zw: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::QUOTE_SINGLE) { goto cIyjR; nU59Q: $inPath = true; goto fcHbQ; cIyjR: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_UNKNOWN); $value = ''; } goto nU59Q; fcHbQ: ++$index; goto Zfm8Y; Zfm8Y: continue; goto A4rrx; A4rrx: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::BRACKET_OPEN) { goto dbhsf; dbhsf: $inRange = true; goto knGkI; sY8sV: continue; goto gH_n0; bXBIl: ++$index; goto sY8sV; knGkI: $value .= PHPExcel_Calculation_FormulaParser::BRACKET_OPEN; goto bXBIl; gH_n0: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::ERROR_START) { goto Oaely; pPIGY: continue; goto inLO1; jeyyi: $value .= PHPExcel_Calculation_FormulaParser::ERROR_START; goto aeL67; aeL67: ++$index; goto pPIGY; FxKS7: $inError = true; goto jeyyi; Oaely: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_UNKNOWN); $value = ''; } goto FxKS7; inLO1: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::BRACE_OPEN) { goto nR07B; Uverh: $stack[] = clone $tmp; goto I6IKG; dU2fD: $tokens1[] = $tmp; goto q1evX; I6IKG: ++$index; goto SG_Iz; q1evX: $stack[] = clone $tmp; goto ij9w1; nR07B: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_UNKNOWN); $value = ''; } goto eMu_w; SG_Iz: continue; goto ax7Un; eMu_w: $tmp = new PHPExcel_Calculation_FormulaToken("\101\122\x52\x41\x59", PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START); goto dU2fD; hNRN7: $tokens1[] = $tmp; goto Uverh; ij9w1: $tmp = new PHPExcel_Calculation_FormulaToken("\101\x52\122\x41\131\122\117\x57", PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START); goto hNRN7; ax7Un: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::SEMICOLON) { goto PraH0; SpLaA: $tmp = array_pop($stack); goto NIdgd; ixgYC: $stack[] = clone $tmp; goto fykJI; NIdgd: $tmp->setValue(''); goto yI1e_; VfSN_: $tmp = new PHPExcel_Calculation_FormulaToken("\x41\122\x52\101\131\122\117\127", PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START); goto b88dT; A0_Ne: $tmp = new PHPExcel_Calculation_FormulaToken("\54", PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_ARGUMENT); goto gbsGn; fykJI: ++$index; goto l_D7a; yI1e_: $tmp->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP); goto nFJbB; nFJbB: $tokens1[] = $tmp; goto A0_Ne; gbsGn: $tokens1[] = $tmp; goto VfSN_; PraH0: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto SpLaA; l_D7a: continue; goto P_a2m; b88dT: $tokens1[] = $tmp; goto ixgYC; P_a2m: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::BRACE_CLOSE) { goto WFa7Y; Oy_q9: $tmp = array_pop($stack); goto K1jsJ; K1jsJ: $tmp->setValue(''); goto C8i7n; tI0vv: ++$index; goto NbjHB; A2Utr: $tmp->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP); goto x1jeo; WFa7Y: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto Oy_q9; x1jeo: $tokens1[] = $tmp; goto tI0vv; C0v79: $tmp->setValue(''); goto A2Utr; MXtxs: $tokens1[] = $tmp; goto PbnGB; NbjHB: continue; goto ksvCf; C8i7n: $tmp->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP); goto MXtxs; PbnGB: $tmp = array_pop($stack); goto C0v79; ksvCf: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::WHITESPACE) { goto OXVkA; EUJki: while ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::WHITESPACE && $index < $formulaLength) { ++$index; } goto s1AZv; s1AZv: continue; goto peySv; QuNbY: ++$index; goto EUJki; OXVkA: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto ErBPU; ErBPU: $tokens1[] = new PHPExcel_Calculation_FormulaToken('', PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_WHITESPACE); goto QuNbY; peySv: } if ($index + 2 <= $formulaLength) { if (in_array(substr($this->formula, $index, 2), $COMPARATORS_MULTI)) { goto dZf6A; dbDGe: $index += 2; goto gSygi; dZf6A: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto AhqK_; AhqK_: $tokens1[] = new PHPExcel_Calculation_FormulaToken(substr($this->formula, $index, 2), PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_LOGICAL); goto dbDGe; gSygi: continue; goto gI0L_; gI0L_: } } if (strpos(PHPExcel_Calculation_FormulaParser::OPERATORS_INFIX, $this->formula[$index]) !== false) { goto whXb6; JChFR: ++$index; goto GLQB7; whXb6: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto cYVhq; GLQB7: continue; goto bgXB5; cYVhq: $tokens1[] = new PHPExcel_Calculation_FormulaToken($this->formula[$index], PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX); goto JChFR; bgXB5: } if (strpos(PHPExcel_Calculation_FormulaParser::OPERATORS_POSTFIX, $this->formula[$index]) !== false) { goto kCdem; wYBwl: ++$index; goto d2i7X; d2i7X: continue; goto AZrg2; CUNnM: $tokens1[] = new PHPExcel_Calculation_FormulaToken($this->formula[$index], PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORPOSTFIX); goto wYBwl; kCdem: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto CUNnM; AZrg2: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::PAREN_OPEN) { goto JXjds; L3HZQ: ++$index; goto LuBkW; LuBkW: continue; goto BQRsf; JXjds: if (strlen($value) > 0) { goto Vdc_k; IEQLD: $stack[] = clone $tmp; goto nLRDQ; WZA3S: $tokens1[] = $tmp; goto IEQLD; Vdc_k: $tmp = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START); goto WZA3S; nLRDQ: $value = ''; goto kImyo; kImyo: } else { goto WfbdZ; bueid: $stack[] = clone $tmp; goto QW_Ix; WfbdZ: $tmp = new PHPExcel_Calculation_FormulaToken('', PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_SUBEXPRESSION, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START); goto FWIIH; FWIIH: $tokens1[] = $tmp; goto bueid; QW_Ix: } goto L3HZQ; BQRsf: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::COMMA) { goto AC2w_; UdHZd: $tmp->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP); goto dgh_3; AC2w_: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto ed10b; ecfAH: ++$index; goto DDvOx; DDvOx: continue; goto bBVSu; dgh_3: $stack[] = $tmp; goto ITb0v; loCdx: $tmp->setValue(''); goto UdHZd; ITb0v: if ($tmp->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION) { $tokens1[] = new PHPExcel_Calculation_FormulaToken("\54", PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_UNION); } else { $tokens1[] = new PHPExcel_Calculation_FormulaToken("\54", PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_ARGUMENT); } goto ecfAH; ed10b: $tmp = array_pop($stack); goto loCdx; bBVSu: } if ($this->formula[$index] == PHPExcel_Calculation_FormulaParser::PAREN_CLOSE) { goto tPbfT; x7lLW: $tmp->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP); goto PLb4d; KVoab: $tmp = array_pop($stack); goto B3dE3; YATYq: ++$index; goto n6r4D; tPbfT: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); $value = ''; } goto KVoab; PLb4d: $tokens1[] = $tmp; goto YATYq; B3dE3: $tmp->setValue(''); goto x7lLW; n6r4D: continue; goto jXaz1; jXaz1: } $value .= $this->formula[$index]; ++$index; } goto rudvR; weVvv: $COMPARATORS_MULTI = array("\76\75", "\74\x3d", "\74\x3e"); goto F6aCi; PWENQ: $this->tokens = array(); goto zbVOy; rudvR: if (strlen($value) > 0) { $tokens1[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND); } goto Dvy1v; FnDBx: $index = 1; goto CeXcW; Tggu1: $token = $previousToken = $nextToken = null; goto FnDBx; OJS_v: $formulaLength = strlen($this->formula); goto EwkF1; HlMIa: for ($i = 0; $i < $tokenCount; ++$i) { $token = $tokens2[$i]; if (isset($tokens2[$i - 1])) { $previousToken = $tokens2[$i - 1]; } else { $previousToken = null; } if (isset($tokens2[$i + 1])) { $nextToken = $tokens2[$i + 1]; } else { $nextToken = null; } if (is_null($token)) { continue; } if ($token->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX && $token->getValue() == "\x2d") { goto MEqKB; v_wTW: $this->tokens[] = $token; goto IUJwk; MEqKB: if ($i == 0) { $token->setTokenType(PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORPREFIX); } elseif ($previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION && $previousToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_SUBEXPRESSION && $previousToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORPOSTFIX || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND) { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_MATH); } else { $token->setTokenType(PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORPREFIX); } goto v_wTW; IUJwk: continue; goto ojZ4A; ojZ4A: } if ($token->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX && $token->getValue() == "\53") { goto TDShk; TDShk: if ($i == 0) { continue; } elseif ($previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION && $previousToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_SUBEXPRESSION && $previousToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORPOSTFIX || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND) { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_MATH); } else { continue; } goto n6dDc; n6dDc: $this->tokens[] = $token; goto z3Suj; z3Suj: continue; goto PFv5o; PFv5o: } if ($token->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX && $token->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_NOTHING) { goto jL_Y2; vhJeT: $this->tokens[] = $token; goto Mz6Oq; Mz6Oq: continue; goto DQAnI; jL_Y2: if (strpos("\x3c\x3e\75", substr($token->getValue(), 0, 1)) !== false) { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_LOGICAL); } elseif ($token->getValue() == "\46") { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_CONCATENATION); } else { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_MATH); } goto vhJeT; DQAnI: } if ($token->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND && $token->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_NOTHING) { goto DUfhF; JpDz2: $this->tokens[] = $token; goto NTqUD; NTqUD: continue; goto JZ7dJ; DUfhF: if (!is_numeric($token->getValue())) { if (strtoupper($token->getValue()) == "\x54\122\x55\105" || strtoupper($token->getValue() == "\106\101\114\x53\105")) { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_LOGICAL); } else { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_RANGE); } } else { $token->setTokenSubType(PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_NUMBER); } goto JpDz2; JZ7dJ: } if ($token->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION) { if (strlen($token->getValue() > 0)) { if (substr($token->getValue(), 0, 1) == "\x40") { $token->setValue(substr($token->getValue(), 1)); } } } $this->tokens[] = $token; } goto nZupL; IE_WY: $ERRORS = array("\43\x4e\125\x4c\114\x21", "\x23\104\111\x56\57\60\x21", "\43\126\101\x4c\x55\105\x21", "\x23\x52\x45\106\41", "\43\x4e\x41\x4d\x45\x3f", "\43\116\125\x4d\41", "\x23\116\57\101"); goto weVvv; CeXcW: $value = ''; goto IE_WY; ZM6Gg: for ($i = 0; $i < $tokenCount; ++$i) { $token = $tokens1[$i]; if (isset($tokens1[$i - 1])) { $previousToken = $tokens1[$i - 1]; } else { $previousToken = null; } if (isset($tokens1[$i + 1])) { $nextToken = $tokens1[$i + 1]; } else { $nextToken = null; } if (is_null($token)) { continue; } if ($token->getTokenType() != PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_WHITESPACE) { $tokens2[] = $token; continue; } if (is_null($previousToken)) { continue; } if (!($previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION && $previousToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_SUBEXPRESSION && $previousToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_STOP || $previousToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND)) { continue; } if (is_null($nextToken)) { continue; } if (!($nextToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_FUNCTION && $nextToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START || $nextToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_SUBEXPRESSION && $nextToken->getTokenSubType() == PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_START || $nextToken->getTokenType() == PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERAND)) { continue; } $tokens2[] = new PHPExcel_Calculation_FormulaToken($value, PHPExcel_Calculation_FormulaToken::TOKEN_TYPE_OPERATORINFIX, PHPExcel_Calculation_FormulaToken::TOKEN_SUBTYPE_INTERSECTION); } goto PWENQ; pIMvZ: $tokens1 = $tokens2 = $stack = array(); goto HxmFe; Dvy1v: $tokenCount = count($tokens1); goto ZM6Gg; zbVOy: $tokenCount = count($tokens2); goto HlMIa; EwkF1: if ($formulaLength < 2 || $this->formula[0] != "\x3d") { return; } goto pIMvZ; nZupL: } }
