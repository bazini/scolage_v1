<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-09-11 13:11:18              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/
/*

*/
 defined("\x42\x41\x53\x45\x50\101\x54\x48") or exit("\x4e\157\40\144\151\x72\145\143\164\x20\x73\143\x72\151\x70\x74\40\141\143\x63\x65\163\163\x20\141\x6c\154\157\x77\x65\144"); class Perm { protected $CI; private $mydb; private $session; private $table; private $group; private $ptu; private $ptg; public function __construct() { goto ZE9gG; iMGQ6: $this->group =& $this->CI->group; goto Ozx1A; uAwAt: $this->ptu = "\x70\x65\162\155\x5f\164\x6f\137\x75\163\145\x72"; goto J0_Vp; n2Gw3: $this->mydb =& $this->CI->mydb; goto iMGQ6; Ozx1A: $this->session =& $this->CI->session; goto YimFX; YimFX: $this->table = "\160\145\162\155\163"; goto uAwAt; J0_Vp: $this->ptg = "\160\x65\x72\x6d\x5f\x74\x6f\137\147\x72\x6f\165\x70"; goto M_7Ru; ZE9gG: $this->CI =& get_instance(); goto n2Gw3; M_7Ru: } public function get($id) { goto AqSB3; AqSB3: if (intval($id) !== 0) { $where["\151\x64"] = $id; } else { $where["\156\141\155\145"] = $id; } goto jAnRJ; JZg_F: if (!empty($d)) { $d->users = $this->mydb->gets($this->ptu, array(array("\165\163\x65\162\x73\56\151\x64" => "\151\x64"), "\156\x61\155\x65", "\x65\155\x61\x69\x6c", "\163\x65\170\145", "\156\x6f\x6d", "\160\x72\145\156\157\155\163", "\x62\x61\156\156\145\x64"), array("\x70\145\162\x6d\x5f\164\157\x5f\165\163\145\162\x2e\x70\145\162\x6d\x5f\x69\x64" => $d->id), array("\x75\163\145\x72\x73" => array("\x69\156\156\x65\162" => array("\x75\x73\145\x72\137\151\144", "\151\144")))); $d->groups = $this->mydb->gets($this->ptg, array("\156\141\x6d\x65", "\x64\x65\146\151\156\151\x74\x69\x6f\156", array("\147\162\157\165\x70\x73\x2e\x69\144" => "\x69\x64")), array("\x70\145\162\x6d\137\x74\x6f\137\x67\162\157\x75\x70\56\x70\x65\x72\x6d\x5f\151\x64" => $d->id), array("\147\162\157\165\x70\x73" => array("\151\x6e\x6e\145\162" => array("\x67\162\x6f\x75\160\137\151\x64", "\x69\144")))); } goto xLD_l; xLD_l: return $d; goto yBzlP; jAnRJ: $d = $this->mydb->get($this->table, '', $where); goto JZg_F; yBzlP: } public function gets() { goto tL0C2; oKvKD: if (!empty($perms)) { goto kGrz5; zZuJ9: foreach ($perms as $p) { goto JB18M; JB18M: $p->users = $this->mydb->gets($this->ptu, array(array("\165\x73\145\x72\x73\x2e\151\144" => "\x69\x64"), "\x6e\x61\x6d\x65", "\145\x6d\141\x69\154", "\x73\145\x78\145", "\156\157\x6d", "\x70\162\x65\x6e\x6f\155\x73", "\142\141\156\156\x65\144"), array("\x70\x65\162\155\137\164\157\137\x75\163\145\162\56\x70\x65\x72\155\137\151\x64" => $p->id), array("\x75\163\x65\162\x73" => array("\151\156\x6e\145\162" => array("\165\163\x65\x72\x5f\151\144", "\x69\x64")))); goto VPsYu; VPsYu: $p->groups = $this->mydb->gets($this->ptg, array("\156\x61\x6d\145", "\144\145\x66\151\156\x69\x74\x69\157\156", array("\147\x72\157\165\160\x73\x2e\x69\x64" => "\151\144")), array("\160\x65\x72\155\x5f\164\157\137\x67\162\157\x75\160\56\160\x65\x72\x6d\x5f\151\144" => $p->id), array("\x67\162\x6f\x75\x70\x73" => array("\x69\x6e\x6e\145\x72" => array("\147\162\157\165\160\137\151\144", "\x69\x64")))); goto exIz7; exIz7: array_push($data, $p); goto OoxZ_; OoxZ_: } goto Lz_qj; kGrz5: $data = array(); goto zZuJ9; Lz_qj: $d = $data; goto wD2GI; wD2GI: } goto Zq_jc; Zq_jc: return $d; goto KVoH8; tL0C2: $perms = $this->mydb->gets($this->table); goto oKvKD; KVoH8: } public function user_perm($id = false) { goto aDXRf; SYeCO: if (!empty($perm)) { $d = $perm; } goto w6QUQ; aDXRf: $d = false; goto KzfZt; w6QUQ: return $d; goto DBEpB; XftgD: $perm = $this->mydb->get($this->ptu, '', array("\x75\x73\x65\162\137\151\x64" => $id), array("\x70\x65\162\155\x73" => array("\151\156\x6e\x65\x72" => array("\x70\x65\x72\x6d\137\x69\144", "\x69\144")))); goto SYeCO; KzfZt: if ($id == false) { $id = $this->session->userdata("\x69\x64"); } goto XftgD; DBEpB: } public function group_perm($id) { goto maAj4; iQnxl: $perm = $this->mydb->get($this->ptg, '', array("\x67\x72\x6f\165\x70\137\151\x64" => $id), array("\x70\145\162\155\163" => array("\151\156\156\x65\x72" => array("\x70\145\162\x6d\137\151\x64", "\x69\x64")))); goto Lxf5E; EkjoV: return $d; goto b3Gg0; Lxf5E: if (!empty($perm)) { $d = $perm; } goto EkjoV; maAj4: $d = false; goto iQnxl; b3Gg0: } public function perm_exist($name, $id = false) { goto hfYzN; H4jdZ: $where["\156\x61\x6d\145"] = $name; goto HOXLa; kwBze: if (!empty($perm)) { $d = $perm; } goto QBraz; HOXLa: if ($id != false) { $where["\151\x64"] = array("\74\x3e" => $id); } goto m2RQ4; QBraz: return $d; goto T8HVI; hfYzN: $d = false; goto H4jdZ; m2RQ4: $perm = $this->mydb->get($this->table, '', $where); goto kwBze; T8HVI: } public function is_allowed($user, $perm) { goto agoo5; GGB7k: return $d; goto VkQxc; agoo5: $d = false; goto pFPi1; puHdu: if ($res != 0) { $d = true; } goto GGB7k; IK5Am: $res = $this->mydb->count($this->ptu, array("\x75\x73\x65\162\x5f\x69\x64" => $user, "\160\x65\162\x6d\x5f\x69\144" => $perm_id)); goto puHdu; pFPi1: if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } goto IK5Am; VkQxc: } public function is_group_allowed($group, $perm) { goto duv3g; Y1Vms: if ($res != 0) { $d = true; } goto JybOU; duv3g: $d = false; goto DUtLG; DUtLG: if (intval($group) !== 0) { $group_id = $group; } else { $group_id = $this->group->getid($group); } goto NrkAA; KWwjV: $res = $this->mydb->count($this->ptg, array("\x67\x72\x6f\165\160\137\151\x64" => $group_id, "\x70\x65\162\x6d\x5f\151\x64" => $perm_id)); goto Y1Vms; JybOU: return $d; goto GqV3w; NrkAA: if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } goto KWwjV; GqV3w: } public function allow($user, $perm) { goto vPQY8; pJtA9: return $d; goto y4YJt; Cdg41: if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } goto dm8XZ; dm8XZ: if ($this->is_allowed($user, $perm_id)) { return true; } else { $vrf = $this->mydb->get($this->ptu, '', array("\165\163\145\x72\x5f\x69\x64" => $user)); if (!empty($vrf)) { $d = $this->mydb->update($this->ptu, array("\160\x65\x72\155\x5f\151\x64" => $perm_id), array("\x75\x73\145\x72\137\151\144" => $user)); } else { $d = $this->mydb->set($this->ptu, array("\165\x73\145\162\137\151\144" => $user, "\160\x65\x72\155\137\x69\x64" => $perm_id)); } } goto pJtA9; vPQY8: $d = false; goto Cdg41; y4YJt: } public function allow_group($group, $perm) { goto P8dky; P8dky: $d = false; goto K2U0M; MPV6c: if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } goto Fi1n2; K2U0M: if (intval($group) !== 0) { $group_id = $group; } else { $group_id = $this->group->getid($group); } goto MPV6c; Fi1n2: if ($this->is_group_allowed($group_id, $perm_id)) { return true; } else { $vrf = $this->mydb->get($this->ptg, '', array("\147\162\x6f\165\160\x5f\x69\x64" => $group_id)); if (!empty($vrf)) { $d = $this->mydb->update($this->ptg, array("\x70\x65\x72\x6d\137\151\x64" => $perm_id), array("\x67\162\157\x75\160\x5f\151\144" => $group_id)); } else { $d = $this->mydb->set($this->ptg, array("\x67\162\157\x75\160\x5f\x69\144" => $group_id, "\160\x65\162\155\137\151\x64" => $perm_id)); } } goto kyTED; kyTED: return $d; goto iZ9lf; iZ9lf: } public function update_permission($user, $perm) { goto DIzZs; VTxna: $perm = $this->user_perm($user); goto v2ilM; v2ilM: if (!empty($perm)) { $this->mydb->update($this->ptu, array("\160\145\162\x6d\x5f\x69\x64" => $perm_id), array("\165\x73\x65\162\x5f\x69\144" => $user)); } else { $this->allow($user, $perm); } goto p1Qii; DIzZs: if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } goto VTxna; p1Qii: } public function deny($user, $perm) { if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } return $this->mydb->delete($this->ptu, array("\x75\163\x65\x72\137\x69\144" => $user, "\160\x65\162\155\x5f\151\x64" => $perm_id)); } public function deny_group($group, $perm) { goto FvHut; FvHut: if (intval($group) !== 0) { $group_id = $group; } else { $group_id = $this->group->getid($group); } goto FHN2p; r3B82: return $this->mydb->delete($this->ptg, array("\x67\x72\157\165\x70\x5f\x69\x64" => $group_id, "\160\x65\162\155\137\x69\144" => $perm_id)); goto DbQqp; FHN2p: if (intval($perm) !== 0) { $perm_id = $perm; } else { $perm_id = $this->getid($perm); } goto r3B82; DbQqp: } public function set($name, $def = '') { return $this->mydb->set($this->table, array("\156\141\x6d\x65" => $name, "\144\145\146\x69\156\x69\164\x69\157\156" => $def)); } public function update($name, $def, $id) { return $this->mydb->update($this->table, array("\x6e\141\155\145" => $name, "\x64\x65\x66\x69\x6e\x69\x74\x69\x6f\x6e" => $def), array("\151\x64" => $id)); } public function delete($id) { goto KwBQQ; KwBQQ: if (intval($id) !== 0) { $where["\151\x64"] = $id; $perm_id = $id; } else { $where["\x6e\x61\155\145"] = $id; $perm_id = $this->getid($id); } goto sr4i3; sr4i3: $this->mydb->delete($this->ptu, array("\x70\145\x72\155\x5f\x69\x64" => $perm_id)); goto xy6LU; rHA9T: return $this->mydb->delete($this->table, $where); goto YluUf; xy6LU: $this->mydb->delete($this->ptg, array("\160\x65\162\x6d\x5f\x69\144" => $perm_id)); goto rHA9T; YluUf: } public function getid($name) { goto Tlrea; ChabW: return $d; goto iivr9; Tlrea: $d = false; goto zoSaP; UUW2v: if (!empty($pid)) { $d = $pid->id; } goto ChabW; zoSaP: $pid = $this->mydb->get($this->table, array("\151\144"), array("\x6e\x61\x6d\145" => $name)); goto UUW2v; iivr9: } }
